[
  {
    "Id": "1239479",
    "ThreadId": "543789",
    "Html": "I have a report with roughly 1000 rows and 27 columns of data that takes around 45 minutes to generate. I originally thought the slowness could be due to the MySQL query, but I cleaned it up and it's now executing in under a second. I've tried totally disabling formatting for the cells, thinking that could be slowing things down, but the improvement is minimal. Can anyone see anything I am doing wrong? Thanks in advance!<br />\n<pre><code>/** PHPExcel */\n    include 'PHPExcel.php';\n    \n    // Create new PHPExcel object\n    $objPHPExcel = new PHPExcel();\n    \n    // Set properties\n    $objPHPExcel-&gt;getProperties()-&gt;setCreator(&quot;duhshuh&quot;);\n    $objPHPExcel-&gt;getProperties()-&gt;setLastModifiedBy(&quot;duhshuh&quot;);\n    $objPHPExcel-&gt;getProperties()-&gt;setTitle(&quot;XX Report&quot;);\n    $objPHPExcel-&gt;getProperties()-&gt;setSubject(&quot;XX Report&quot;);\n    $objPHPExcel-&gt;getProperties()-&gt;setDescription(&quot;XX Report&quot;);\n    $objPHPExcel-&gt;setActiveSheetIndex(0);\n    \n    $sheet = $objPHPExcel-&gt;getActiveSheet();\n    $sheet-&gt;getColumnDimension('A')-&gt;setAutoSize(true);\n    $sheet-&gt;getColumnDimension('B')-&gt;setAutoSize(true);\n    $sheet-&gt;getColumnDimension('C')-&gt;setAutoSize(true);\n    $sheet-&gt;getColumnDimension('D')-&gt;setAutoSize(true);\n    $sheet-&gt;getColumnDimension('E')-&gt;setAutoSize(true);\n    $sheet-&gt;getColumnDimension('F')-&gt;setAutoSize(true);\n    $sheet-&gt;getColumnDimension('G')-&gt;setAutoSize(true);\n    $sheet-&gt;getColumnDimension('H')-&gt;setAutoSize(true);\n    $sheet-&gt;getColumnDimension('I')-&gt;setAutoSize(true);\n    $sheet-&gt;getColumnDimension('J')-&gt;setAutoSize(true);\n    $sheet-&gt;getColumnDimension('K')-&gt;setAutoSize(true);\n    $sheet-&gt;getColumnDimension('L')-&gt;setAutoSize(true);\n    $sheet-&gt;getColumnDimension('M')-&gt;setAutoSize(true);\n    $sheet-&gt;getColumnDimension('N')-&gt;setAutoSize(true);\n    $sheet-&gt;getColumnDimension('O')-&gt;setAutoSize(true);\n    $sheet-&gt;getColumnDimension('P')-&gt;setAutoSize(true);\n    $sheet-&gt;getColumnDimension('Q')-&gt;setAutoSize(true);\n    $sheet-&gt;getColumnDimension('R')-&gt;setAutoSize(true);\n    $sheet-&gt;getColumnDimension('S')-&gt;setAutoSize(true);\n    $sheet-&gt;getColumnDimension('T')-&gt;setAutoSize(true);\n    $sheet-&gt;getColumnDimension('U')-&gt;setAutoSize(true);\n    $sheet-&gt;getColumnDimension('V')-&gt;setAutoSize(true);\n\n// Formatting\n            $sheet-&gt;getPageSetup()-&gt;setRowsToRepeatAtTopByStartAndEnd(1, 1);\n            $sheet-&gt;freezePane('A2');\n\n            $letter = 'A';\n            $sheet-&gt;SetCellValue($letter.'1', 'Nomenclature'); $letter++;\n            $sheet-&gt;SetCellValue($letter.'1', 'P/N'); $letter++;\n            $sheet-&gt;SetCellValue($letter.'1', 'NSN'); $letter++;\n            $sheet-&gt;SetCellValue($letter.'1', 'CAGE'); $letter++;\n            $sheet-&gt;SetCellValue($letter.'1', 'Model'); $letter++;\n            //$sheet-&gt;SetCellValue($letter.'1', 'Manufacturer'); $letter++;\n            $sheet-&gt;SetCellValue($letter.'1', 'System'); $letter++;\n            $sheet-&gt;SetCellValue($letter.'1', 'UOI'); $letter++;\n            $sheet-&gt;SetCellValue($letter.'1', 'Vendor'); $letter++;\n            $sheet-&gt;SetCellValue($letter.'1', 'Criticality'); $letter++;\n            $sheet-&gt;SetCellValue($letter.'1', 'Current Inv.'); $letter++;\n            $sheet-&gt;SetCellValue($letter.'1', 'Current Conus Inv.'); $letter++;\n            $sheet-&gt;SetCellValue($letter.'1', 'Current KNB Inv.'); $letter++;\n            $sheet-&gt;SetCellValue($letter.'1', 'Re-order Point'); $letter++;\n            $sheet-&gt;SetCellValue($letter.'1', 'Stock Level'); $letter++;\n            $sheet-&gt;SetCellValue($letter.'1', 'Lead Time'); $letter++;\n            $sheet-&gt;SetCellValue($letter.'1', 'Weighted Avg.\\nAnnual Demand'); \n             $sheet-&gt;getStyle($letter.'1')-&gt;getAlignment()-&gt;setWrapText(true);   $letter++;\n            $sheet-&gt;SetCellValue($letter.'1', 'Weighted Value'); $letter++;\n            $sheet-&gt;SetCellValue($letter.'1', 'Avg. Cost'); $letter++;\n            $sheet-&gt;SetCellValue($letter.'1', 'Quantity to Order'); $letter++;\n            $sheet-&gt;SetCellValue($letter.'1', 'Ext. Order Cost'); $letter++;\n            for($y=0; $y&lt;=max($years_purch,$years_inv); $y++)\n            {\n              if($y&lt;$years_purch)\n              {\n                $sheet-&gt;SetCellValue($letter.'1', &quot;Demand Met Thru\\nPurchases FY&quot;.$FYpurch[$y]);\n                $sheet-&gt;getStyle($letter.'1')-&gt;getAlignment()-&gt;setWrapText(true); \n                $letter++; \n              }\n              if($y&lt;$years_inv)\n              {\n                $sheet-&gt;SetCellValue($letter.'1', &quot;Inventory Demand\\nFY&quot;.$FYinv[$y]); \n                $sheet-&gt;getStyle($letter.'1')-&gt;getAlignment()-&gt;setWrapText(true); \n                $letter++; \n              }  \n            }                                                        \n            $sheet-&gt;SetCellValue($letter.'1', 'Deactivate'); \n\n            $i++;\n          }\n               \n          // Values and Formatting\n          $letter = 'A';\n          // A\n          $sheet-&gt;SetCellValue($letter.$i, trim($row['part_name'])); \n          //  $sheet-&gt;getStyle($letter.$i)-&gt;getNumberFormat()-&gt;setFormatCode('@'); \n          $letter++;\n          // B\n          $sheet-&gt;getCell($letter.$i)-&gt;setValueExplicit(trim($row['part_number']), PHPExcel_Cell_DataType::TYPE_STRING); // to avoid scientific notation for long strings\n          //  $sheet-&gt;getStyle($letter.$i)-&gt;getNumberFormat()-&gt;setFormatCode('@'); \n          $letter++;\n          // C\n          $sheet-&gt;SetCellValue($letter.$i, trim($row['part_nsn'])); \n           // $sheet-&gt;getStyle($letter.$i)-&gt;getNumberFormat()-&gt;setFormatCode('@'); \n           $letter++;\n          // D\n          $sheet-&gt;SetCellValue($letter.$i, trim($row['part_cage_code'])); \n           // $sheet-&gt;getStyle($letter.$i)-&gt;getNumberFormat()-&gt;setFormatCode('@'); \n           $letter++;\n          // E\n          $sheet-&gt;SetCellValue($letter.$i, trim($row['part_model']));\n           // $sheet-&gt;getStyle($letter.$i)-&gt;getNumberFormat()-&gt;setFormatCode('@'); \n           $letter++;\n          // F\n          $sheet-&gt;SetCellValue($letter.$i, trim($row['system']));\n           // $sheet-&gt;getStyle($letter.$i)-&gt;getNumberFormat()-&gt;setFormatCode('@'); \n           $letter++;\n          // G\n          $sheet-&gt;SetCellValue($letter.$i, trim($row['code']));\n            //$sheet-&gt;getStyle($letter.$i)-&gt;getNumberFormat()-&gt;setFormatCode('@'); \n            $letter++;    \n          // H\n          $sheet-&gt;SetCellValue($letter.$i, trim($row['vendor_name']));\n           // $sheet-&gt;getStyle($letter.$i)-&gt;getNumberFormat()-&gt;setFormatCode('@'); \n           $letter++;\n          // I\n          $sheet-&gt;SetCellValue($letter.$i, trim($readiness_impact));\n           // $sheet-&gt;getStyle($letter.$i)-&gt;getNumberFormat()-&gt;setFormatCode('@'); \n           $letter++;    \n          // J\n          $sheet-&gt;SetCellValue($letter.$i, trim($row['part_oh_qty'])); \n           // $sheet-&gt;getStyle($letter.$i)-&gt;getNumberFormat()-&gt;setFormatCode('0'); \n           $letter++;\n          // K\n          $sheet-&gt;SetCellValue($letter.$i, '=J'.$i.'-L'.$i); \n            //$sheet-&gt;getStyle($letter.$i)-&gt;getNumberFormat()-&gt;setFormatCode('0'); \n            $letter++;\n          // L\n          $sheet-&gt;SetCellValue($letter.$i, trim($row['part_oh_qty_knb'])); \n            //$sheet-&gt;getStyle($letter.$i)-&gt;getNumberFormat()-&gt;setFormatCode('0'); \n            $letter++;\n          // M  -- Reorder Point\n          $sheet-&gt;SetCellValue($letter.$i, '=IF(Q'.$i.'&lt;62.5,0,IF(AND(Q'.$i.'&gt;=62.5,Q'.$i.'&lt;134.5),1,IF(AND(Q'.$i.'&gt;=134.5,Q'.$i.'&lt;363.6),2,IF(AND(Q'.$i.'&gt;=363.6,Q'.$i.'&lt;505.7),3,IF(AND(Q'.$i.'&gt;=505.7,Q'.$i.'&lt;745.2),4,IF(AND(Q'.$i.'&gt;=745.2,Q'.$i.'&lt;1180.4),5,6))))))');\n            //$sheet-&gt;getStyle($letter.$i)-&gt;getNumberFormat()-&gt;setFormatCode('0'); \n            $letter++;\n          // N\n          $sheet-&gt;SetCellValue($letter.$i, '=IF(Q'.$i.'&lt;14.5,0,IF(AND(Q'.$i.'&gt;=14.5,Q'.$i.'&lt;34.5),1,IF(AND(Q'.$i.'&gt;=34.5,Q'.$i.'&lt;73.6),2,IF(AND(Q'.$i.'&gt;=73.6,Q'.$i.'&lt;116.5),3,IF(AND(Q'.$i.'&gt;=116.5,Q'.$i.'&lt;291.2),4,IF(AND(Q'.$i.'&gt;=291.2,Q'.$i.'&lt;505.7),5,IF(AND(Q'.$i.'&gt;=505.7,Q'.$i.'&lt;673.2),6,IF(AND(Q'.$i.'&gt;=673.2,Q'.$i.'&lt;745.2),7,IF(AND(Q'.$i.'&gt;=745.2,Q'.$i.'&lt;1180.4),8,10))))))))))');\n            //$sheet-&gt;getStyle($letter.$i)-&gt;getNumberFormat()-&gt;setFormatCode('0'); \n            $letter++;\n          // O\n          $sheet-&gt;SetCellValue($letter.$i, trim($part_lead_time));\n           // $sheet-&gt;getStyle($letter.$i)-&gt;getNumberFormat()-&gt;setFormatCode('0'); \n           $letter++;\n          // P\n          $sheet-&gt;SetCellValue($letter.$i, trim($row['part_weighted_annual_demand']));\n            //$sheet-&gt;getStyle($letter.$i)-&gt;getNumberFormat()-&gt;setFormatCode('0');\n             $letter++;\n          // Q\n         $sheet-&gt;SetCellValue($letter.$i, '=SUM((IF(I'.$i.'=&quot;HIGH&quot;,15*0.4,IF(I'.$i.'=&quot;MEDIUM&quot;,8*0.4,IF(I'.$i.'=&quot;LOW&quot;,0.4,0))))+(IF(O'.$i.'&lt;=5,1*0.4,IF(AND(O'.$i.'&gt;5,O'.$i.'&lt;=9),2*0.4,IF(AND(O'.$i.'&gt;9,O'.$i.'&lt;=15),5*0.4,IF(AND(O'.$i.'&gt;15,O'.$i.'&lt;=29),10*0.4,IF(AND(O'.$i.'&gt;29,O'.$i.'&lt;=59),20*0.4,25*0.4))))))+(IF(R'.$i.'&lt;=1000,5*0.2,IF(AND(R'.$i.'&gt;1000,R'.$i.'&lt;=3000),4*0.2,IF(AND(R'.$i.'&gt;3000,R'.$i.'&lt;=5000),3*0.2,IF(AND(R'.$i.'&gt;5000,R'.$i.'&lt;=20000),2*0.2,1*0.2)))))+(P'.$i.'*2))))');     \n            //$sheet-&gt;getStyle($letter.$i)-&gt;getNumberFormat()-&gt;setFormatCode('0'); \n            $letter++;\n          // R\n          $sheet-&gt;SetCellValue($letter.$i, trim($row['part_avg_cost'])); \n           // $sheet-&gt;getStyle($letter.$i)-&gt;getNumberFormat()-&gt;setFormatCode('$#,##0.00'); \n           $letter++;\n          // S\n          $sheet-&gt;SetCellValue($letter.$i, '=IF(J'.$i.'&lt;=M'.$i.',N'.$i.'-J'.$i.',0)');  \n            //$sheet-&gt;getStyle($letter.$i)-&gt;getNumberFormat()-&gt;setFormatCode('0'); \n            $letter++;\n          // T\n          $sheet-&gt;SetCellValue($letter.$i, '=R'.$i.'*S'.$i);\n            //$sheet-&gt;getStyle($letter.$i)-&gt;getNumberFormat()-&gt;setFormatCode('$#,##0.00');\n             $letter++;</code></pre>\n\ncontinued below<br />\n",
    "PostedDate": "2014-04-29T11:27:44.04-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1239481",
    "ThreadId": "543789",
    "Html": "<pre><code>          for($y=0; $y&lt;=max($years_purch,$years_inv); $y++)\n          {\n            if($y&lt;$years_purch)\n            {\n              $sheet-&gt;SetCellValue($letter.$i, trim($row['FY'.$FYpurch[$y].'purchdemand']));\n              //$sheet-&gt;getStyle($letter.$i)-&gt;getNumberFormat()-&gt;setFormatCode('0');  \n              $letter++; \n            }\n            if($y&lt;$years_inv)\n            {\n              $sheet-&gt;SetCellValue($letter.$i, trim($row['FY'.$FYinv[$y].'invdemand']));\n             // $sheet-&gt;getStyle($letter.$i)-&gt;getNumberFormat()-&gt;setFormatCode('0'); \n              $letter++; \n            }   \n          } \n          $sheet-&gt;SetCellValue($letter.$i, trim($row['part_obsolete_next12mo']));\n         //   $sheet-&gt;getStyle($letter.$i)-&gt;getNumberFormat()-&gt;setFormatCode('@');  \n          $i++; \n          \n          if($result['num_rows']==($i))\n          {\n            $sheet-&gt;getStyle('A1:'.$letter.'1')-&gt;getFill()-&gt;setFillType(PHPExcel_Style_Fill::FILL_SOLID)-&gt;getStartColor()-&gt;setARGB('000066FF');\n            $sheet-&gt;getStyle('A1:'.$letter.'1')-&gt;getFont()-&gt;setBold(true);\n            $sheet-&gt;getStyle('A1:'.$letter.'1')-&gt;getFont()-&gt;getColor()-&gt;setARGB(PHPExcel_Style_Color::COLOR_WHITE);  \n          } </code></pre>\n\n",
    "PostedDate": "2014-04-29T11:28:10.073-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1244947",
    "ThreadId": "543789",
    "Html": "Any ideas?<br />\n",
    "PostedDate": "2014-05-13T11:47:44.847-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]