[
  {
    "Id": "711392",
    "ThreadId": "282770",
    "Html": "<p>PHP ver 5.3.1</p>\n<p>PHPExcel ver 1.7.6</p>\n<p>this is the portion of code where i access PHPExcel</p>\n<p>&nbsp;</p>\n<p>the commented line (with a arrow in front) is the source of all evil....</p>\n<p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('B:C')-&gt;getFill()-&gt;setFillType(PHPExcel_Style_Fill::FILL_SOLID);<br /> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('B:C')-&gt;getFill()-&gt;getStartColor()-&gt;setARGB('00ff9933');<br /> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('D')-&gt;getAlignment()-&gt;setWrapText(true);<br /> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension('E')-&gt;setAutoSize(true);<br /> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension('G')-&gt;setAutoSize(true);<br /> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('I:J')-&gt;getFill()-&gt;setFillType(PHPExcel_Style_Fill::FILL_SOLID);<br /> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('I:J')-&gt;getFill()-&gt;getStartColor()-&gt;setARGB('00ff9933');<br /> -&gt; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; //$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('A:B')-&gt;getBorders()-&gt;getAllBorders()-&gt;setBorderStyle(PHPExcel_Style_Border::BORDER_THIN);<br /> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; echo phpversion();<br /> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; while ($first = mysql_fetch_array($query))<br /> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {<br /> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('A'.$i,$first['NR_SESIZ']);<br /> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; //$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('A'.$i)-&gt;getBorders()-&gt;getLeft()-&gt;setBorderStyle(PHPExcel_Style_Border::BORDER_THIN);<br /> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; //$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('A'.$i)-&gt;getBorders()-&gt;getRight()-&gt;setBorderStyle(PHPExcel_Style_Border::BORDER_THIN);<br /> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; //$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('A'.$i)-&gt;getBorders()-&gt;getBottom()-&gt;setBorderStyle(PHPExcel_Style_Border::BORDER_THIN);<br /> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; //$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('A'.$i)-&gt;getBorders()-&gt;getTop()-&gt;setBorderStyle(PHPExcel_Style_Border::BORDER_THIN);<br /> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <br /> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <br /> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; //$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('B',$i)-&gt;getFill()-&gt;setFillType(PHPExcel_Style_Fill::FILL_SOLID);<br /> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; //$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('B',$i)-&gt;getFill()-&gt;getStartColor()-&gt;setARGB('00ff9933');<br /> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('B'.$i,strip_date($first['DATA_S']));<br /> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; //$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('B'.$i)-&gt;getBorders()-&gt;getLeft()-&gt;setBorderStyle(PHPExcel_Style_Border::BORDER_THIN);<br /> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; //$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('B'.$i)-&gt;getBorders()-&gt;getRight()-&gt;setBorderStyle(PHPExcel_Style_Border::BORDER_THIN);<br /> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; //$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('B'.$i)-&gt;getBorders()-&gt;getBottom()-&gt;setBorderStyle(PHPExcel_Style_Border::BORDER_THIN);<br /> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; //$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('B'.$i)-&gt;getBorders()-&gt;getTop()-&gt;setBorderStyle(PHPExcel_Style_Border::BORDER_THIN);<br /> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <br /> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; //$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('C',$i)-&gt;getFill()-&gt;setFillType(PHPExcel_Style_Fill::FILL_SOLID);<br /> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; //$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('C',$i)-&gt;getFill()-&gt;getStartColor()-&gt;setARGB('00ff9933');<br /> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('C'.$i,strip_time($first['DATA_S']));<br /> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; //$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('C'.$i)-&gt;getBorders()-&gt;getAllBorders()-&gt;setBorderStyle(PHPExcel_Style_Border::BORDER_THIN);<br /> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <br /> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('D'.$i,$first['NUME']);<br /> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <br /> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('E'.$i,$first['TELEFON']);<br /> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $query_cod = mysql_query(\"SELECT COD FROM cod_deranj WHERE ID_COD_DERANJ=\".$first['ID_COD_DERANJ_S'],$dbconnection) or die('Raport L:124');<br /> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $cod_der_s = mysql_fetch_array($query_cod);<br /> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('F'.$i,$cod_der_s['COD']);<br /> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <br /> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $query_strada = mysql_query(\"SELECT ID_LOCALITATE FROM strazi WHERE ID_STRADA='\".$first['ID_STRADA'].\"'\",$dbconnection) or die('Raport L:127');&nbsp;&nbsp;&nbsp; <br /> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $strada = mysql_fetch_array($query_strada);<br /> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $query_localitate = mysql_query(\"SELECT DENUMIRE FROM localitati WHERE ID_LOCALITATE='\".$strada['ID_LOCALITATE'].\"'\",$dbconnection) or die(mysql_error());&nbsp;&nbsp;&nbsp; <br /> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $localitate = mysql_fetch_array($query_localitate);<br /> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <br /> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('G'.$i,$localitate['DENUMIRE']);<br /> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('H'.$i,$first['ADRESA']);<br /> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <br /> <br /> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('I'.$i,strip_date($first['DATA_T']));<br /> &nbsp;&nbsp;&nbsp; <br /> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('J'.$i,strip_time($first['DATA_T']));<br /> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <br /> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $i++;<br /> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; //echo 'data_s : '.$first['DATA_S'].' NR_SESIZ : '.$first['NR_SESIZ'].' ID_SESIZ : '.$first['ID_SESIZ'].' Localitate : '.$localitate['DENUMIRE'].'&lt;/br&gt;';<br /> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <br /> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <br /> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</p>\n<p>&nbsp;</p>\n<p>sometimes it gives me this error <strong>Fatal error</strong>: Allowed memory size of 268435456 bytes exhausted (tried to allocate 43 bytes) in <strong>*\\classes\\PHPExcel\\CachedObjectStorage\\Memory.php</strong> on line <strong> 47</strong></p>\n<p><strong>and sometimes it refers to line 1008 within Worksheet.php (didn't copy paste that one).</strong></p>\n<p>Same amount of memory being referenced.</p>\n<p>It so happens that the current query i was playing with amounts to 2860 cells within the excel file. That means..with border styling activated...every cell wants more than 100KB mem....</p>\n<p>With that line commented it barely budges beyond 10MB of memory usage...</p>\n<p>with &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; //$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('A'.$i)-&gt;getBorders()-&gt;getLeft()-&gt;setBorderStyle(PHPExcel_Style_Border::BORDER_THIN)) bla bla (all 4 lines that manually add borders to every cell accesed) uncommented it goes to around  10 MB.</p>\n<p>with the lines for B row activated same story...more or less 10MB. (i'm talking about task manager httpd process monitoring as i presume it gets ram for the php process).</p>\n<p>Also for C...Also if i add for row D.</p>\n<p>Does AllBorders method get ALL the borders of even blank cells? It's pretty weird..</p>\n<p>Hope i'm not being a bug myself... :)</p>\n<p>(edited) even if i leave only Column A on that getStyle , it still exhausts the memory.</p>\n<p><strong><br /> </strong></p>",
    "PostedDate": "2011-12-13T05:07:27.323-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "712046",
    "ThreadId": "282770",
    "Html": "<p>Try using cell caching, as described in the documentation</p>",
    "PostedDate": "2011-12-14T04:00:53.733-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "712558",
    "ThreadId": "282770",
    "Html": "<p>Applying style for multiple cell range once with getStyle('Ax:AAy')-&gt;getAllBorders solved the problem :).</p>\r\n<p>Individual applying of cell to cell with loop is tenfold memory and time consuming...</p>\r\n<p>Applying for whole column like getStyle('A')-&gt;getAllBorders will result in a sure memory insufficiency.(allocated 1GB to scripts from .ini and that's eaten up too)</p>\r\n<p>There's also some other possible issues....as i stumbled upon some other but related articles on the www, regarding the usage of PHP 5.3.x.</p>\r\n<p>5.3.x apparently has some memory allocation issues that don't appear in 5.2.x usage. So...if possible go with 5.2.x for now. differences are in a 8~10 factor (10MB in 5.2.x&nbsp; - 100MB+ 5.3.x mem usage for same script).</p>",
    "PostedDate": "2011-12-15T00:53:37.463-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]