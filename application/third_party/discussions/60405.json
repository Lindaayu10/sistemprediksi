[
  {
    "Id": "204547",
    "ThreadId": "60405",
    "Html": "<p>&nbsp;Hi,</p>\r\n<p>Im creating several xlsx files in a foreach that are send by email.</p>\r\n<p>Each xlsx file contains 1 or more sheets.</p>\r\n<p>Each sheets start with +- the same header.</p>\r\n<p>The first xlsx created is as is should al those that follow are missing certain background colors.</p>\r\n<p>A bit more details,</p>\r\n<p>foreach($data as $key=&gt;$item){<br>&nbsp;&nbsp;&nbsp; $file = $list-&gt;get_price_list($lists, &quot;pl&quot;, &quot;false&quot;, &quot;file&quot;);<br>&nbsp;&nbsp; //code to send the recieved file<br>&nbsp;&nbsp;&nbsp; unset($file);<br>}</p>\r\n<p>The get_price_list function</p>\r\n<p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $xls = new PHPExcel();<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; //Layout head1<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $this-&gt;layout['head1'] = new PHPExcel_Style();<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $this-&gt;layout['head1']-&gt;getFill()-&gt;setFillType(PHPExcel_Style_Fill::FILL_SOLID);<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $this-&gt;layout['head1']-&gt;getFill()-&gt;getStartColor()-&gt;setARGB('FF000080');<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $this-&gt;layout['head1']-&gt;getFont()-&gt;getColor()-&gt;setARGB(PHPExcel_Style_Color::COLOR_WHITE);<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $this-&gt;layout['head1']-&gt;getFont()-&gt;setBold(true);<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; //Layout head2<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $this-&gt;layout['head2'] = new PHPExcel_Style();<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $this-&gt;layout['head2']-&gt;getFont()-&gt;setBold(true);<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $this-&gt;layout['head2']-&gt;getFill()-&gt;setFillType(PHPExcel_Style_Fill::FILL_SOLID);<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $this-&gt;layout['head2']-&gt;getFill()-&gt;getStartColor()-&gt;setARGB('FFD15FEE');<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; //Layout titel<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $this-&gt;layout['titel'] = new PHPExcel_Style();<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $this-&gt;layout['titel']-&gt;getFill()-&gt;setFillType(PHPExcel_Style_Fill::FILL_SOLID);<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $this-&gt;layout['titel']-&gt;getFill()-&gt;getStartColor()-&gt;setARGB('FFD15FEE');<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $this-&gt;layout['titel']-&gt;getFont()-&gt;setBold(true);<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $this-&gt;layout['titel']-&gt;getAlignment()-&gt;setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_CENTER);<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; //layout changed<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $this-&gt;layout['changed'] = new PHPExcel_Style();<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $this-&gt;layout['changed']-&gt;getFill()-&gt;setFillType(PHPExcel_Style_Fill::FILL_SOLID);<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $this-&gt;layout['changed']-&gt;getFill()-&gt;getStartColor()-&gt;setARGB('FFFFFF00');<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $this-&gt;layout['changed']-&gt;getNumberFormat()-&gt;setFormatCode(PHPExcel_Style_NumberFormat::FORMAT_NUMBER_00);<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; //layout newArt 00<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $this-&gt;layout['newArt00'] = new PHPExcel_Style();<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $this-&gt;layout['newArt00']-&gt;getFill()-&gt;setFillType(PHPExcel_Style_Fill::FILL_SOLID);<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $this-&gt;layout['newArt00']-&gt;getFill()-&gt;getStartColor()-&gt;setARGB('FF00FF00');<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $this-&gt;layout['newArt00']-&gt;getNumberFormat()-&gt;setFormatCode(PHPExcel_Style_NumberFormat::FORMAT_NUMBER_00);<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; //layout newArt<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $this-&gt;layout['newArt'] = new PHPExcel_Style();<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $this-&gt;layout['newArt']-&gt;getFill()-&gt;setFillType(PHPExcel_Style_Fill::FILL_SOLID);<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $this-&gt;layout['newArt']-&gt;getFill()-&gt;getStartColor()-&gt;setARGB('FF00FF00');<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $this-&gt;layout['newArt']-&gt;getNumberFormat()-&gt;setFormatCode(PHPExcel_Style_NumberFormat::FORMAT_NUMBER);<br></p>\r\n<p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $this-&gt;add_page(&amp;$xls, &amp;$this-&gt;data1, $sheet, &quot;Sheet1&quot;);</p>\r\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $this-&gt;add_page(&amp;$xls, &amp;$this-&gt;data2, $sheet, &quot;Sheet2&quot;);</p>\r\n<p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $xls-&gt;setActiveSheetIndex(0);<br><br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $filename = &quot;example.xlsx&quot;;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $objWriter = new PHPExcel_Writer_Excel2007($xls);<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $objWriter-&gt;save(&quot;/tmp/$file);</p>\r\n<p>The add_page function</p>\r\n<p>.</p>\r\n<p>.</p>\r\n<p>.</p>\r\n<p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; // Wijzigingen<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $xls-&gt;getActiveSheet()-&gt;mergeCells('H3:'.$colums[$colum_merge].'3');<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $xls-&gt;getActiveSheet()-&gt;setCellValue('H3', $this-&gt;titel['history'].&quot; &quot;.date(&quot;d/m/Y&quot;,$this-&gt;histo_time));<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<strong> $xls-&gt;getActiveSheet()-&gt;getStyle('H3')-&gt;getFill()-&gt;setFillType(PHPExcel_Style_Fill::FILL_SOLID);<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $xls-&gt;getActiveSheet()-&gt;getStyle('H3')-&gt;getFill()-&gt;getStartColor()-&gt;setARGB('FFFFFF00');</strong><br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; //Nieuw artikel zin<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $xls-&gt;getActiveSheet()-&gt;mergeCells('H4:'.$colums[$colum_merge].'4');<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $xls-&gt;getActiveSheet()-&gt;setCellValue('H4', $this-&gt;titel['history2']);<br><strong>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $xls-&gt;getActiveSheet()-&gt;getStyle('H4')-&gt;getFill()-&gt;setFillType(PHPExcel_Style_Fill::FILL_SOLID);<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $xls-&gt;getActiveSheet()-&gt;getStyle('H4')-&gt;getFill()-&gt;getStartColor()-&gt;setARGB('FF00FF00');</strong></p>\r\n<p>&nbsp;</p>\r\n<p>the lines in Bold no longer work after the first loop.</p>\r\n<p>Thanks in advance,</p>\r\n<p>Carl</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2009-06-23T09:00:34.403-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "204559",
    "ThreadId": "60405",
    "Html": "<p>Just as a check, are you unsetting $objWriter after each save?</p>",
    "PostedDate": "2009-06-23T09:18:28.447-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "204567",
    "ThreadId": "60405",
    "Html": "<p>Well, not sure if Mark's suggestion works or not, but I remember we had a similar issue not long ago:<br> <a href=\"View.aspx?ThreadId=56914\">http://phpexcel.codeplex.com/Thread/View.aspx?ThreadId=56914</a><br> <br> It turned out to be a problem with the old style engine used by PHPExcel 1.6.7 and before. With the new style engine it was not happening.<br> <br> Perhaps try to download latest source code and report back whether it works or not:<br> <a href=\"../SourceControl/ListDownloadableCommits.aspx\">http://phpexcel.codeplex.com/SourceControl/ListDownloadableCommits.aspx</a></p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2009-06-23T09:26:08.437-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "204842",
    "ThreadId": "60405",
    "Html": "<p>&nbsp; Hi,</p>\r\n<p>To MarkBaker: I did not unset $objWriter, so i did but it didn't help.</p>\r\n<p>To koyama: I downloaded the latest source code and the problem is solved.</p>\r\n<p>Thanks both for your help.</p>",
    "PostedDate": "2009-06-24T00:29:39.38-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]