[
  {
    "Id": "650403",
    "ThreadId": "267259",
    "Html": "\r\n<p>I am using version 1.7.6 of PHPExcel.</p>\r\n<p>I am using PHPExcel to convert data from a MySQL DB to the .xls format.</p>\r\n<p>My code is at the bottom. My primary question is: <em>Is cell caching only have an effect when reading a file in from disk?</em> As I am timing and measuring memory usage I see very negligible&nbsp; differences between using cell-caching and not using cell-caching.\r\n I've read the documentation in the PHPExcel Word files included in the source file package but they don't seem to give a very thorough example. What would be helpful is a an example in the examples section that show people how to use cell caching. I can provide\r\n actual metrics if that is helpful; I suspect that I am using the API incorrectly.</p>\r\n<p>Thanks,</p>\r\n<p>Avery</p>\r\n<p></p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre>$startTime = time();\r\n$startMMB = memory_get_peak_usage(true)/(1024*1204);\r\n  \r\n$cacheMethod = PHPExcel_CachedObjectStorageFactory::cache_to_discISAM;\r\nPHPExcel_Settings::setCacheStorageMethod($cacheMethod);      \r\n\r\n<span style=\"color:green\">/*\t    \r\n$cacheMethod = PHPExcel_CachedObjectStorageFactory::cache_to_phpTemp;\r\n$cacheSettings = array('memoryCacheSize' =&gt;'1MB');\r\nPHPExcel_Settings::setCacheStorageMethod($cacheMethod, $cacheSettings);\r\n*/</span>\r\n$exportDoc = <span style=\"color:blue\">new</span> PHPExcel();\r\n\r\n<span style=\"color:blue\">for</span> ($i = 1; $i &lt;= $numSurveys; $i&#43;&#43;){\r\n  \r\n      $surveyData = $this-&gt;_retrieveSurveyData($surveyIndices[$i-1], $agencyID, $includeAnon, $sortBy);\r\n      $exportDoc-&gt;createSheet($i);\r\n      $exportDoc-&gt;setActiveSheetIndex($i);    \r\n      $exportDoc = $this-&gt;_formatSpreadsheet($exportDoc, $surveyData[<span style=\"color:#a31515\">'docData'</span>], $surveyData[<span style=\"color:#a31515\">'docHeader'</span>]);\t    \r\n\r\n      <span style=\"color:green\">// Rename sheet</span>\r\n      $exportDoc-&gt;getActiveSheet()-&gt;setTitle($surveyObj[$surveyIndices[$i-1]][F_NAME]);\r\n      \r\n  $usedTime = time() - $startTime;\r\n  $usedMem = (memory_get_peak_usage(true)/(1024*1204)) - $startMMB;\r\n  $t = sprintf(<span style=\"color:#a31515\">&quot;%3ds&quot;</span>, $usedTime);\r\n  $m = sprintf(<span style=\"color:#a31515\">&quot;%.2fMB&quot;</span>, $usedMem);\r\n  $d = date(<span style=\"color:#a31515\">'H:i:s'</span>);\r\n  error_log(<span style=\"color:#a31515\">&quot;[$d] time:$t memoryUsed: $m\\n&quot;</span>, 3, <span style=\"color:#a31515\">&quot;/source/epwbst/phpexcel.txt&quot;</span>);\r\n} \r\n\r\n$exportDoc-&gt;setActiveSheetIndex(0);\r\n$docWriter = PHPExcel_IOFactory::createWriter($exportDoc, <span style=\"color:#a31515\">'Excel5'</span>);\r\n$docWriter-&gt;save($filePath);\r\n\r\n$usedTime = time() - $startTime;\r\n$usedMem = (memory_get_peak_usage(true)/(1024*1204));\r\n$t = sprintf(<span style=\"color:#a31515\">&quot;%3ds&quot;</span>, $usedTime);\r\n$m = sprintf(<span style=\"color:#a31515\">&quot;%.2fMB&quot;</span>, $usedMem);\r\n$d = date(<span style=\"color:#a31515\">'H:i:s'</span>);        \r\nerror_log(<span style=\"color:#a31515\">&quot;[$d] total time:$t total memory: $m\\n&quot;</span>, 3, <span style=\"color:#a31515\">&quot;source/epwbst/phpexcel.txt&quot;</span>);\r\n</pre>\r\n</div>\r\n<p></p>\r\n",
    "PostedDate": "2011-08-01T00:43:58.653-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]