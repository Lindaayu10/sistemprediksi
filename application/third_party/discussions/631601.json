[
  {
    "Id": "1415649",
    "ThreadId": "631601",
    "Html": "good morning,<br />\nsorry for my english, but i am italian...<br />\nI have to make a series of sheet with, within each, an external excel (matrice.xls).<br />\nwhat can i do?<br />\nthis is my code:<br />\n<br />\nrequire_once '../phpexcel/Classes/PHPExcel.php';<br />\n<br />\n$objPHPExcel = new PHPExcel();<br />\n$inputFileName = 'matrice.xls';<br />\n$inputFileType = PHPExcel_IOFactory::identify($inputFileName);<br />\n$objReader = PHPExcel_IOFactory::createReader($inputFileType);<br />\n<br />\n///// 1° SHEET<br />\n// load matrix<br />\n$objPHPExcel = $objReader-&gt;load($inputFileName);<br />\n<br />\n$objPHPExcel-&gt;setActiveSheetIndex(0);<br />\n$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue('K9', 'Hello');<br />\n$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue('K10', 'world!');<br />\n// rename il sheet<br />\n$objPHPExcel-&gt;getSheet(0)-&gt;setTitle('SHEET 1');<br />\n<br />\n///// 2° SHEET<br />\n// Create a new worksheet at index 1<br />\n$objPHPExcel-&gt;createSheet(1);<br />\n$objPHPExcel-&gt;setActiveSheetIndex(1);<br />\n// load matrix<br />\n$objPHPExcel = $objReader-&gt;load($inputFileName);<br />\n// write <br />\n$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue('K9', '2Hello');<br />\n$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue('K10', '2world!');<br />\n<br />\n// rename il sheet<br />\n$objPHPExcel-&gt;getSheet()-&gt;setTitle('SHEET 2');<br />\n<br />\n// Salvo il file Excel 2007<br />\n$objWriter = new PHPExcel_Writer_Excel2007($objPHPExcel);<br />\n$objWriter-&gt;save('myfile.xlsx');<br />\n<br />\nthis is error log:<br />\n[19-Apr-2015 08:26:24 Europe/Rome] PHP Fatal error:  Uncaught exception 'PHPExcel_Exception' with message 'You tried to set a sheet active by the out of bounds index: 1. The actual number of sheets is 1.' in /home/msericecp/public_html/new/ms/phpexcel/Classes/PHPExcel.php:688<br />\nStack trace:<br />\n0 /home/msericecp/public_html/new/ms/turni/test.php(39): PHPExcel-&gt;setActiveSheetIndex(1)<br />\n1 {main}<br />\n  thrown in /home/msericecp/public_html/new/ms/phpexcel/Classes/PHPExcel.php on line 688<br />\n<br />\n<br />\ntanks!<br />\n",
    "PostedDate": "2015-04-18T23:58:14.91-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]