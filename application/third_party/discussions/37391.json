[
  {
    "Id": "124070",
    "ThreadId": "37391",
    "Html": "<p>I have an html&nbsp;form&nbsp;and I want to collect all data in an excel sheet. <br>\r\nSo the 1st time, a user fills in&nbsp;the fields and presses Submit -&gt; the excel file is created like in your examples from Tests.<br>\r\nThe 2nd, 3rd time a user fills&nbsp; in the fields, I check if the file already exists and if it does, I calculate the higestRow and want to add the new data on the (higestRow+1) row.<br>\r\nI've tried the below code, but it doesn't work. <br>\r\n<br>\r\nif (file_exists($nume_fis)) {<br>\r\n&nbsp;&nbsp;&nbsp; echo &quot;The file $nume_fis exists&quot;;<br>\r\n&nbsp;//write in the already existing file<br>\r\n&nbsp;echo date('H:i:s') . &quot; Load from Excel2007 file\\n&quot;;<br>\r\n&nbsp;$objReader = PHPExcel_IOFactory::createReader('Excel2007');<br>\r\n&nbsp;$objPHPExcel = $objReader-&gt;load($nume_fis);<br>\r\n&nbsp;<br>\r\n$objPHPExcel-&gt;setActiveSheetIndex(0);<br>\r\n$highestRow = $objPHPExcel-&gt;getActiveSheet()-&gt;getHighestRow(); <br>\r\n//echo &quot;maxRows=&quot;.$highestRow;</p>\r\n<p>$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue($highestRow+1, $my_date);<br>\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue($highestRow+1, $mancare);<br>\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue($highestRow+1, $rating);<br>\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue($highestRow+1, $comentariu);</p>\r\n<p>// Set active sheet index to the first sheet, so Excel opens this as the first sheet<br>\r\n$objPHPExcel-&gt;setActiveSheetIndex(0);</p>\r\n<p>// Save Excel 2007 file<br>\r\necho date('H:i:s') . &quot; Write to Excel2007 format\\n&quot;;<br>\r\n$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, 'Excel2007');<br>\r\n$objWriter-&gt;save($nume_fis);</p>\r\n<p>} else {<br>\r\n&nbsp;&nbsp;&nbsp; echo &quot;The file $nume_fis does not exist&quot;;<br>\r\n&nbsp;//creating the new file<br>\r\n// Set properties<br>\r\necho date('H:i:s') . &quot; Set properties\\n&quot;;<br>\r\n$objPHPExcel-&gt;getProperties()-&gt;setCreator(&quot;Maarten Balliauw&quot;);<br>\r\n$objPHPExcel-&gt;getProperties()-&gt;setLastModifiedBy(&quot;Maarten Balliauw&quot;);<br>\r\n$objPHPExcel-&gt;getProperties()-&gt;setTitle(&quot;Office 2007 XLSX Test Document&quot;);<br>\r\n$objPHPExcel-&gt;getProperties()-&gt;setSubject(&quot;Office 2007 XLSX Test Document&quot;);<br>\r\n$objPHPExcel-&gt;getProperties()-&gt;setDescription(&quot;Test document for Office 2007 XLSX, generated using PHP classes.&quot;);<br>\r\n$objPHPExcel-&gt;getProperties()-&gt;setKeywords(&quot;office 2007 openxml php&quot;);<br>\r\n$objPHPExcel-&gt;getProperties()-&gt;setCategory(&quot;Test result file&quot;);</p>\r\n<p>// Create a first sheet<br>\r\necho date('H:i:s') . &quot; Add data\\n&quot;;<br>\r\n$objPHPExcel-&gt;setActiveSheetIndex(0);<br>\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('A1', &quot;Data&quot;);<br>\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('B1', &quot;Fel mancare&quot;);<br>\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('C1', &quot;Rating&quot;);<br>\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('D1', &quot;Comentariu&quot;);</p>\r\n<p>$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('A2', $my_date);<br>\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('B2', $mancare);<br>\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('C2', $rating);<br>\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('D2', $comentariu);</p>\r\n<p>......<br>\r\nI've received:<br>\r\nFatal error: Uncaught exception 'Exception' with message 'Column string index can not be empty.' in C:\\Win16App\\wamp\\www\\PHPExcel\\Classes\\PHPExcel\\Cell.php:500 Stack trace: #0 C:\\Win16App\\wamp\\www\\PHPExcel\\Classes\\PHPExcel\\Worksheet.php(635): PHPExcel_Cell::columnIndexFromString('') #1 C:\\Win16App\\wamp\\www\\PHPExcel\\Classes\\PHPExcel\\Worksheet.php(432): PHPExcel_Worksheet-&gt;getHighestColumn() #2 C:\\Win16App\\wamp\\www\\PHPExcel\\Classes\\PHPExcel\\Writer\\Excel2007\\Worksheet.php(212): PHPExcel_Worksheet-&gt;calculateWorksheetDimension() #3 C:\\Win16App\\wamp\\www\\PHPExcel\\Classes\\PHPExcel\\Writer\\Excel2007\\Worksheet.php(104): PHPExcel_Writer_Excel2007_Worksheet-&gt;_writeDimension(Object(PHPExcel_Shared_XMLWriter), Object(PHPExcel_Worksheet)) #4 C:\\Win16App\\wamp\\www\\PHPExcel\\Classes\\PHPExcel\\Writer\\Excel2007.php(312): PHPExcel_Writer_Excel2007_Worksheet-&gt;writeWorksheet(Object(PHPExcel_Worksheet), Array) #5 C:\\Win16App\\wamp\\www\\feedback\\process.php(78): PHPExcel_Writer_Excel2007-&gt;save('feedback_6-10-2...') #6 {main} thrown in C:\\Win16App\\wamp\\www\\PHPExcel\\Classes\\PHPExcel\\Cell.php on line 500<br>\r\n<br>\r\nIs it possible to write data in an already created excel file?<br>\r\nCan you please advise me how to do that?<br>\r\nThank you very much.<br>\r\nLaura</p>\r\n",
    "PostedDate": "2008-10-09T08:29:00.717-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "124094",
    "ThreadId": "37391",
    "Html": "The error seems to be here:<br>\r\n<br>\r\n<code>$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue($highestRow+1, $my_date);<br>\r\n</code>\r\n<br>\r\nFirst parameter <code>$highestRow+1</code> is not a complete cell reference, but just an integer.<br>\r\n<br>\r\nAssuming you want to set value in column A, use any of these alternatives:<br>\r\n<br>\r\n<code>$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('A' . ($highestRow+1), $my_date);<br>\r\n</code>\r\n<br>\r\n<code>$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValueByColumnAndRow(0, $highestRow+1, $my_date);<br>\r\n<br>\r\n</code>\r\n",
    "PostedDate": "2008-10-09T09:39:11.84-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "124668",
    "ThreadId": "37391",
    "Html": "txs! it worked:)\r\n",
    "PostedDate": "2008-10-13T03:12:06.067-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]