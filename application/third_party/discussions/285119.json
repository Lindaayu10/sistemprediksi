[
  {
    "Id": "720941",
    "ThreadId": "285119",
    "Html": "\r\n<p>I want to read a xls/xlsx file that is on my server. Then i want to add content to a cell and save this file with the new content.</p>\r\n<p>My problem is that when i run my code nothing happend to my file.<br>\r\nThe examples work all.</p>\r\n<p>Here is my test code built from the sample file:</p>\r\n<p>&nbsp;</p>\r\n<p></p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre>error_reporting(E_ALL);\r\n\r\ndate_default_timezone_set(<span style=\"color:#a31515\">'Europe/London'</span>);\r\n\r\n<span style=\"color:green\">/** PHPExcel_IOFactory */</span>\r\n<span style=\"color:blue\">require_once</span> <span style=\"color:#a31515\">'../Classes/PHPExcel/IOFactory.php'</span>;\r\n\r\n<span style=\"color:green\">/** PHPExcel */</span>\r\n<span style=\"color:blue\">require_once</span> <span style=\"color:#a31515\">'../Classes/PHPExcel.php'</span>;\r\n\r\n\r\n<span style=\"color:blue\">if</span> (!file_exists(<span style=\"color:#a31515\">&quot;test.xlsx&quot;</span>)) {\r\n\t<span style=\"color:blue\">exit</span>(<span style=\"color:#a31515\">&quot;Please run 05featuredemo.php first.\\n&quot;</span>);\r\n}\r\n\r\n<span style=\"color:blue\">echo</span> date(<span style=\"color:#a31515\">'H:i:s'</span>) . <span style=\"color:#a31515\">&quot; Load from Excel2007 file\\n&quot;</span>;\r\n$objPHPExcel = PHPExcel_IOFactory::load(<span style=\"color:#a31515\">&quot;test.xlsx&quot;</span>);\r\n\r\n\r\n<span style=\"color:green\">// Add some data</span>\r\n$i=0;\r\n<span style=\"color:blue\">echo</span> date(<span style=\"color:#a31515\">'H:i:s'</span>) . <span style=\"color:#a31515\">&quot; Add some data\\n&quot;</span>;\r\n$objPHPExcel-&gt;setActiveSheetIndex(0)\r\n            -&gt;setCellValue(<span style=\"color:#a31515\">'A1'</span>, <span style=\"color:#a31515\">'Hello'</span>)\r\n            -&gt;setCellValue(<span style=\"color:#a31515\">'B2'</span>, <span style=\"color:#a31515\">'world!'</span>)\r\n            -&gt;setCellValue(<span style=\"color:#a31515\">'C1'</span>, <span style=\"color:#a31515\">'Hello'</span>)\r\n            -&gt;setCellValue(<span style=\"color:#a31515\">'D2'</span>, <span style=\"color:#a31515\">'world!'</span>);\r\n\r\n\r\n<span style=\"color:blue\">echo</span> date(<span style=\"color:#a31515\">'H:i:s'</span>) . <span style=\"color:#a31515\">&quot; Write to Excel2007 format\\n&quot;</span>;\r\n$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, <span style=\"color:#a31515\">'Excel2007'</span>);\r\n$objWriter-&gt;save(str_replace(<span style=\"color:#a31515\">'.php'</span>, <span style=\"color:#a31515\">'.xlsx'</span>, <span style=\"color:blue\">__FILE__</span>));\r\n\r\n\r\n<span style=\"color:green\">// Echo memory peak usage</span>\r\n<span style=\"color:blue\">echo</span> date(<span style=\"color:#a31515\">'H:i:s'</span>) . <span style=\"color:#a31515\">&quot; Peak memory usage: &quot;</span> . (memory_get_peak_usage(true) / 1024 / 1024) . <span style=\"color:#a31515\">&quot; MB\\r\\n&quot;</span>;\r\n\r\n<span style=\"color:green\">// Echo done</span>\r\n<span style=\"color:blue\">echo</span> date(<span style=\"color:#a31515\">'H:i:s'</span>) . <span style=\"color:#a31515\">&quot; Done writing files.\\r\\n&quot;</span>;\r\n</pre>\r\n</div>\r\n<p></p>\r\n",
    "PostedDate": "2012-01-05T10:53:28.53-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "721068",
    "ThreadId": "285119",
    "Html": "<p>The Writer's save() method accepts a filename as its argument.</p>\r\n<p>You're reading test.xlsx but saving as str_replace(<span style=\"color: #a31515;\">'.php'</span>, <span style=\"color: #a31515;\">'.xlsx'</span>, <span style=\"color: blue;\">__FILE__</span>) ie an xlsx file sharing the same name&nbsp;as your script but with an xlsx extension.</p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2012-01-05T14:08:06.347-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]