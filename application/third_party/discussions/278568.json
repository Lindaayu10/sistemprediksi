[
  {
    "Id": "694650",
    "ThreadId": "278568",
    "Html": "<p>Hi it is my first time here and i hope anybody can help me to fin a solution about my Problem.<br /> <br /> I want to export a resultset of my queries, but it dosn't works with one Colum. It is the last while query, where i want to export in Excel in the column C row 7 the resultset of '$nombre_coupures'. There i have 43 records and export for this resultset begins  at Cell C7 to C50.<br /> I don't knox how to realise that, i try something and i have searced the Form here, but without success.<br /> Here is my code:</p>\n<p>&nbsp;</p>\n<div style=\"color: black; background-color: white;\">\n<pre>&lt;?php\n<span style=\"color: blue;\">include</span>(<span style=\"color: #a31515;\">\"inc/connexion.php\"</span>); \nmysql_connect($serverDB,$userDB,$passDB); \nmysql_select_db($databDB) <span style=\"color: blue;\">or</span> <span style=\"color: blue;\">die</span> (<span style=\"color: #a31515;\">\"La base des donn�es n'existe pas - Verifie le nom de la base des donn�es.\"</span>);\n\n$id_acores = $_GET[<span style=\"color: #a31515;\">'id'</span>];\n$date_demande \t= $_GET[<span style=\"color: #a31515;\">'ddemande'</span>];\n$code_acores \t= $_GET[<span style=\"color: #a31515;\">'codeAcore'</span>];\n$code_regate \t= $_GET[<span style=\"color: #a31515;\">'codeRegate'</span>];\n\n$abfrage0 = \"SELECT DISTINCT acores.code_regate, acores.libelle, infos_bureau.telephone, infos_bureau.mail, demande_appro_devise.date_demande <br />             FROM demande_appro_devise, acores, infos_bureau, detail_demande_appro_devise\n             WHERE acores.id_acores = <span style=\"color: #a31515;\">'$id_acores'</span>\n             AND demande_appro_devise.num_demande = detail_demande_appro_devise.num_demande\n             AND demande_appro_devise.code_acores = acores.code_acores\n             AND demande_appro_devise.num_demande = detail_demande_appro_devise.num_demande\";\n$ergebnis0 = mysql_query($abfrage0) <span style=\"color: blue;\">or</span> <span style=\"color: blue;\">die</span>(<span style=\"color: #a31515;\">\"Query failed with error: \"</span>.mysql_error());\n<span style=\"color: blue;\">if</span>( mysql_numrows($ergebnis0) &gt; 0)\n{\n\t$codeRegate\t \t= mysql_result($ergebnis0 , 0 , <span style=\"color: #a31515;\">\"code_regate\"</span>);\n\t$libBureau\t \t= mysql_result($ergebnis0 , 0 , <span style=\"color: #a31515;\">\"libelle\"</span>);\n\t$acoreTelephone\t= mysql_result($ergebnis0 , 0 , <span style=\"color: #a31515;\">\"telephone\"</span>);\n\t$acoreEmail\t \t= mysql_result($ergebnis0 , 0 , <span style=\"color: #a31515;\">\"mail\"</span>);\n\t$date_demande\t = mysql_result($ergebnis0 , 0 , <span style=\"color: #a31515;\">\"date_demande\"</span>);\n}\n<span style=\"color: blue;\">else</span>\n{\n\t$codeRegate\t \t= <span style=\"color: #a31515;\">\"\"</span>;\n\t$libBureau\t \t= <span style=\"color: #a31515;\">\"\"</span>;\n\t$acoreTelephone\t= <span style=\"color: #a31515;\">\"\"</span>;\n\t$acoreEmail\t\t= <span style=\"color: #a31515;\">\"\"</span>;\n\t$date_demande\t= <span style=\"color: #a31515;\">\"\"</span>;\n}\n<span style=\"color: green;\">// Test Bereich</span>\n$abfrage1 \t= <span style=\"color: #a31515;\">\"select devises as 'devis' from details_coupures order by devises\"</span>;\n$ergebnis1 \t= mysql_query($abfrage1) <span style=\"color: blue;\">or</span> <span style=\"color: blue;\">die</span>(<span style=\"color: #a31515;\">\"Query failed with error: \"</span>.mysql_error());\n\n\n<span style=\"color: blue;\">while</span>($row = mysql_fetch_row($ergebnis1))\n{\n\n\n\t$abfrage2 \t\t= <span style=\"color: #a31515;\">\"select count(coupure) as 'ncoupures' from details_coupures where devises = '\"</span>.$row[0].<span style=\"color: #a31515;\">\"'\"</span>;\n\t$ergebnis2 \t\t= mysql_query($abfrage2) <span style=\"color: blue;\">or</span> <span style=\"color: blue;\">die</span>(<span style=\"color: #a31515;\">\"Query failed with error: \"</span>.mysql_error());\n\t$ncoupures\t \t= mysql_result($ergebnis2 , 0 , <span style=\"color: #a31515;\">\"ncoupures\"</span>);\n\n\t<span style=\"color: green;\">//echo '&lt;tr&gt;&lt;td&gt;&amp;nbsp;'.$row[0].'&lt;/td&gt;&lt;td colspan=\"3\"&gt;';</span>\n\t$abfrage3 \t= <span style=\"color: #a31515;\">\"select coupure from details_coupures where devises = '\"</span>.$row[0].<span style=\"color: #a31515;\">\"' order by coupure\"</span>;\n\t$ergebnis3 \t= mysql_query($abfrage3) <span style=\"color: blue;\">or</span> <span style=\"color: blue;\">die</span>(<span style=\"color: #a31515;\">\"Query failed with error: \"</span>.mysql_error());\n\t<span style=\"color: green;\">//echo '&lt;table border=\"0\" width=\"240\" cellspacing=\"0\" cellpadding=\"0\"&gt;';</span>\n\t\n\t<span style=\"color: blue;\">while</span>($row1 = mysql_fetch_row($ergebnis3))\n\t{\n\t\t$abfrage4 = <span style=\"color: #a31515;\">\"SELECT DISTINCT detail_demande_appro_devise.quantite as 'quantite' <br />                             FROM demande_appro_devise, acores, infos_bureau, detail_demande_appro_devise <br />                             WHERE acores.id_acores = '\"</span>.$id_acores.<span style=\"color: #a31515;\">\"' <br />                             AND demande_appro_devise.num_demande = detail_demande_appro_devise.num_demande <br />                             AND demande_appro_devise.code_acores = '\"</span>.$code_acores.<span style=\"color: #a31515;\">\"' <br />                             AND demande_appro_devise.num_demande = detail_demande_appro_devise.num_demande <br />                             AND demande_appro_devise.date_demande = '\"</span>.$date_demande.<span style=\"color: #a31515;\">\"' <br />                             AND detail_demande_appro_devise.coupure = '\"</span>.$row1[0].<span style=\"color: #a31515;\">\"' <br />                             AND demande_appro_devise.code_devise = '\"</span>.$row[0].<span style=\"color: #a31515;\">\"' \"</span>;\n\t\t$ergebnis4 \t= mysql_query($abfrage4) <span style=\"color: blue;\">or</span> <span style=\"color: blue;\">die</span>(<span style=\"color: #a31515;\">\"Query failed with error: \"</span>.mysql_error());\n\t\t<span style=\"color: blue;\">if</span>( mysql_numrows($ergebnis4) &gt; 0)\n\t\t{\n\t\t\t$nombre_coupures\t \t= mysql_result($ergebnis4 , 0 , <span style=\"color: #a31515;\">\"quantite\"</span>);\n\t\t}\n\t\t<span style=\"color: blue;\">else</span>\n\t\t{\n\t\t\t$nombre_coupures\t \t= <span style=\"color: #a31515;\">\"0\"</span>;\n\t\t}\n\n\n\t<span style=\"color: green;\">//\techo '&lt;tr&gt;&lt;td width=\"80\"&gt;&amp;nbsp;'.$row1[0].'&lt;/td&gt;&lt;td width=\"80\"&gt;&amp;nbsp;&amp;nbsp;'.$nombre_coupures.'&lt;/td&gt;<br />        //        &lt;td width=\"80\"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;'.( $nombre_coupures * $row1[0] ).'&lt;/td&gt;&lt;/tr&gt;';</span>\n\t\t<span style=\"color: green;\">//echo '&lt;/tr&gt;';</span>\n\t\t$mTotal = ( $nombre_coupures * $row1[0] ) + $mTotal;\n\t}\n\t<span style=\"color: green;\">//echo '&lt;/table&gt;&lt;/td&gt;';</span>\n\t<span style=\"color: green;\">//echo '&lt;td&gt;&amp;nbsp;'.$mTotal.'&lt;/td&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;';</span>\n\t$mTotal = 0;\n}\n<span style=\"color: green;\">//echo '&lt;/table&gt;';</span>\n<span style=\"color: green;\">//Ende Testbereich</span>\n\n\n\n<span style=\"color: green;\">/** PHPExcel */</span>\n<span style=\"color: blue;\">require_once</span> <span style=\"color: #a31515;\">'lib/phpexcel/Classes/PHPExcel.php'</span>;\n\n<span style=\"color: blue;\">require_once</span> <span style=\"color: #a31515;\">'lib/phpexcel/Classes/PHPExcel/Cell/AdvancedValueBinder.php'</span>;\n\n<span style=\"color: green;\">/** PHPExcel_IOFactory */</span>\n<span style=\"color: blue;\">require_once</span> <span style=\"color: #a31515;\">'lib/phpexcel/Classes/PHPExcel/IOFactory.php'</span>;\n\n<span style=\"color: green;\">/** PHPExcel_RichText */</span>\n<span style=\"color: blue;\">require_once</span> <span style=\"color: #a31515;\">'lib/phpexcel/Classes/PHPExcel/RichText.php'</span>;\n\n<span style=\"color: green;\">/** PHPExcel_Drawing */</span>\n<span style=\"color: blue;\">require_once</span> <span style=\"color: #a31515;\">'lib/phpexcel/Classes/PHPExcel/Worksheet/Drawing.php'</span>;\n\n<span style=\"color: green;\">// Create new PHPExcel object</span>\n$objPHPExcel = <span style=\"color: blue;\">new</span> PHPExcel();\n\n<span style=\"color: green;\">// Set properties</span>\n$objPHPExcel-&gt;getProperties()-&gt;setCreator(<span style=\"color: #a31515;\">\"Unknown\"</span>)\n\t\t\t\t\t\t\t -&gt;setLastModifiedBy(<span style=\"color: #a31515;\">\"Unknown\"</span>)\n\t\t\t\t\t\t\t -&gt;setTitle(<span style=\"color: #a31515;\">\"Export Commandes  de Devises\"</span>)\n\t\t\t\t\t\t\t -&gt;setSubject(<span style=\"color: #a31515;\">\"Resultat\"</span>)\n\t\t\t\t\t\t\t -&gt;setDescription(<span style=\"color: #a31515;\">\"Running Order Export\"</span>)\n\t\t\t\t\t\t\t -&gt;setKeywords(<span style=\"color: #a31515;\">\"CMD\"</span>)\n\t\t\t\t\t\t\t -&gt;setCategory(<span style=\"color: #a31515;\">\"Results\"</span>);\n\n<span style=\"color: green;\">//Header and Footer</span>\n$objDrawing = <span style=\"color: blue;\">new</span> PHPExcel_Worksheet_HeaderFooterDrawing();\n$objDrawing-&gt;setPath(<span style=\"color: #a31515;\">'lib/phpexcel/tests/images/logo.gif'</span>);\n$objPHPExcel-&gt;getActiveSheet()-&gt;getHeaderFooter()-&gt;addImage($objDrawing,PHPExcel_Worksheet_HeaderFooter::IMAGE_HEADER_LEFT);\n$objPHPExcel-&gt;getActiveSheet()-&gt;getHeaderFooter()-&gt;setOddHeader(<span style=\"color: #a31515;\">'&amp;L&amp;G'</span>);\n$objPHPExcel-&gt;getActiveSheet()-&gt;getHeaderFooter()-&gt;setOddHeader(<span style=\"color: #a31515;\">'&amp;R GESTION DES DEVISES - SCM'</span>);\n<span style=\"color: green;\">/*\n$objDrawing = new PHPExcel_Worksheet_HeaderFooterDrawing();\n$this-&gt;getActiveSheet()-&gt;getHeaderFooter()-&gt;setOddHeader('&amp;L&amp;G');\n$objDrawing-&gt;setName('La Banque Postale');\n$objDrawing-&gt;setPath('lib/phpexcel/tests/images/logo.gif');\n$objDrawing-&gt;setHeight(33);\n$objPHPExcel-&gt;getActiveSheet()-&gt;getHeaderFooter()-&gt;addImage($objDrawing, PHPExcel_Worksheet_HeaderFooter::IMAGE_HEADER_LEFT);\n$objPHPExcel-&gt;getActiveSheet()-&gt;getHeaderFooter()-&gt;setOddHeader('&amp;C&amp;Gestion des devises!');\n$objPHPExcel-&gt;getActiveSheet()-&gt;getHeaderFooter()-&gt;setOddFooter('&amp;L&amp;B' . $objPHPExcel-&gt;getProperties()-&gt;getTitle() . '&amp;RPage &amp;P of &amp;N'); */</span>\n\t\t\t\t\t\t\t \n<span style=\"color: green;\">// Titre du Formulaire</span>\n$objPHPExcel-&gt;setActiveSheetIndex(0);\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color: #a31515;\">'A1'</span>, <span style=\"color: #a31515;\">'COMMANDES DE DEVISES'</span>);\n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color: #a31515;\">'A1'</span>)-&gt;getAlignment()-&gt;setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_CENTER);\n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color: #a31515;\">'A1'</span>)-&gt;getFont()-&gt;setBold(false);\n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color: #a31515;\">'A1'</span>)-&gt;getFont()-&gt;setSize(10);\n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color: #a31515;\">'A1'</span>)-&gt;getFont()-&gt;getColor()-&gt;setRGB(f7f8f9);\n$objPHPExcel-&gt;getActiveSheet()-&gt;mergeCells(<span style=\"color: #a31515;\">'A1:G1'</span>);\n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color: #a31515;\">'A1:G1'</span>)-&gt;getFill()-&gt;setFillType(PHPExcel_Style_Fill::FILL_SOLID);\n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color: #a31515;\">'A1:G1'</span>)-&gt;getFill()-&gt;getStartColor()-&gt;setRGB(<span style=\"color: #a31515;\">'3a62a1'</span>);\n<span style=\"color: green;\">// Les Enregistrement Code_Regate </span>\n$objPHPExcel-&gt;getActiveSheet()-&gt;getDefaultStyle()-&gt;getFont()-&gt;setSize(10);\n$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension(<span style=\"color: #a31515;\">'A'</span>)-&gt;setAutoSize(true);\n$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension(<span style=\"color: #a31515;\">'B'</span>)-&gt;setAutoSize(true);\n$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension(<span style=\"color: #a31515;\">'C'</span>)-&gt;setAutoSize(true);\n$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension(<span style=\"color: #a31515;\">'D'</span>)-&gt;setAutoSize(true);\n$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension(<span style=\"color: #a31515;\">'E'</span>)-&gt;setAutoSize(true);\n$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension(<span style=\"color: #a31515;\">'F'</span>)-&gt;setAutoSize(true);\n$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension(<span style=\"color: #a31515;\">'G'</span>)-&gt;setAutoSize(true);\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color: #a31515;\">'A2'</span>, <span style=\"color: #a31515;\">'Nom Du Bureau:'</span>);\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color: #a31515;\">'A3'</span>, <span style=\"color: #a31515;\">'Code Du Bureau:'</span>);\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color: #a31515;\">'A4'</span>, <span style=\"color: #a31515;\">'Telephone:'</span>);\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color: #a31515;\">'A5'</span>, <span style=\"color: #a31515;\">'Email:'</span>);\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color: #a31515;\">'F2'</span>, <span style=\"color: #a31515;\">'Date Operation:'</span>);\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color: #a31515;\">'B2'</span> . $abfrage, $libBureau);\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color: #a31515;\">'B3'</span> . $abfrage, $codeRegate);\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color: #a31515;\">'B4'</span> . $abfrage, $acoreTelephone);\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color: #a31515;\">'B5'</span> . $abfrage, $acoreEmail);\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color: #a31515;\">'G2'</span> . $abfrage, $date_demande);\n\n<span style=\"color: green;\">// Deuxieme Header avec 7 colonnes</span>\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color: #a31515;\">'A6'</span>, <span style=\"color: #a31515;\">'DEVISES:'</span>);\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color: #a31515;\">'B6'</span>, <span style=\"color: #a31515;\">'COUPURES:'</span>);\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color: #a31515;\">'C6'</span>, <span style=\"color: #a31515;\">'NOMBRE TOTAL:'</span>);\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color: #a31515;\">'D6'</span>, <span style=\"color: #a31515;\">'TOTAL COMMANDE:'</span>);\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color: #a31515;\">'E6'</span>, <span style=\"color: #a31515;\">'COURS:'</span>);\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color: #a31515;\">'F6'</span>, <span style=\"color: #a31515;\">'FOURNISSEUR:'</span>);\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color: #a31515;\">'G6'</span>, <span style=\"color: #a31515;\">'CONTREVALEUR:'</span>);\n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color: #a31515;\">'A6:G6'</span>)-&gt;getFont()-&gt;getColor()-&gt;setRGB(f7f8f9);\n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color: #a31515;\">'A6:G6'</span>)-&gt;getFont()-&gt;setSize(10); \n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color: #a31515;\">'A6:G6'</span>)-&gt;getFont()-&gt;setBold(false);\n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color: #a31515;\">'A6:G6'</span>)-&gt;getFill()-&gt;setFillType(PHPExcel_Style_Fill::FILL_SOLID);\n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color: #a31515;\">'A6:G6'</span>)-&gt;getFill()-&gt;getStartColor()-&gt;setRGB(<span style=\"color: #a31515;\">'3a62a1'</span>);\n<span style=\"color: green;\">//$objPHPExcel-&gt;getActiveSheet()-&gt;getDefaultStyle()-&gt;getFont()-&gt;setName('Arial');</span>\n\n<span style=\"color: green;\">//Les Devises</span>\n\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color: #a31515;\">'A7'</span>, \t<span style=\"color: #a31515;\">'AUD'</span>);\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color: #a31515;\">'A12'</span>, <span style=\"color: #a31515;\">'CAD'</span>);\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color: #a31515;\">'A17'</span>, <span style=\"color: #a31515;\">'CHF'</span>);\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color: #a31515;\">'A24'</span>, <span style=\"color: #a31515;\">'DKK'</span>);\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color: #a31515;\">'A29'</span>, <span style=\"color: #a31515;\">'GBP'</span>);\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color: #a31515;\">'A33'</span>, <span style=\"color: #a31515;\">'JPY'</span>);\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color: #a31515;\">'A36'</span>, <span style=\"color: #a31515;\">'NOK'</span>);\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color: #a31515;\">'A41'</span>, <span style=\"color: #a31515;\">'SEK'</span>);\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color: #a31515;\">'A46'</span>, <span style=\"color: #a31515;\">'USD'</span>);\n$objPHPExcel-&gt;getActiveSheet()-&gt;mergeCells(<span style=\"color: #a31515;\">'A7:A11'</span>);\n$objPHPExcel-&gt;getActiveSheet()-&gt;mergeCells(<span style=\"color: #a31515;\">'A12:A16'</span>);\n$objPHPExcel-&gt;getActiveSheet()-&gt;mergeCells(<span style=\"color: #a31515;\">'A17:A23'</span>);\n$objPHPExcel-&gt;getActiveSheet()-&gt;mergeCells(<span style=\"color: #a31515;\">'A24:A28'</span>);\n$objPHPExcel-&gt;getActiveSheet()-&gt;mergeCells(<span style=\"color: #a31515;\">'A29:A32'</span>);\n$objPHPExcel-&gt;getActiveSheet()-&gt;mergeCells(<span style=\"color: #a31515;\">'A33:A35'</span>);\n$objPHPExcel-&gt;getActiveSheet()-&gt;mergeCells(<span style=\"color: #a31515;\">'A36:A40'</span>);\n$objPHPExcel-&gt;getActiveSheet()-&gt;mergeCells(<span style=\"color: #a31515;\">'A41:A45'</span>);\n$objPHPExcel-&gt;getActiveSheet()-&gt;mergeCells(<span style=\"color: #a31515;\">'A46:A50'</span>);\n<span style=\"color: green;\">//Les Coupures AUD</span>\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color: #a31515;\">'B7'</span>, \t<span style=\"color: #a31515;\">'5'</span>);\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color: #a31515;\">'B8'</span>,\t<span style=\"color: #a31515;\">'10'</span>);\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color: #a31515;\">'B9'</span>,\t<span style=\"color: #a31515;\">'20'</span>);\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color: #a31515;\">'B10'</span>,\t<span style=\"color: #a31515;\">'50'</span>);\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color: #a31515;\">'B11'</span>,\t<span style=\"color: #a31515;\">'100'</span>);\n<span style=\"color: green;\">//Les Coupures CAD</span>\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color: #a31515;\">'B12'</span>,\t<span style=\"color: #a31515;\">'5'</span>);\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color: #a31515;\">'B13'</span>,\t<span style=\"color: #a31515;\">'10'</span>);\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color: #a31515;\">'B14'</span>,\t<span style=\"color: #a31515;\">'20'</span>);\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color: #a31515;\">'B15'</span>,\t<span style=\"color: #a31515;\">'50'</span>);\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color: #a31515;\">'B16'</span>,\t<span style=\"color: #a31515;\">'100'</span>);\n<span style=\"color: green;\">//Les Coupures CHF</span>\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color: #a31515;\">'B17'</span>,\t<span style=\"color: #a31515;\">'10'</span>);\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color: #a31515;\">'B18'</span>,\t<span style=\"color: #a31515;\">'20'</span>);\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color: #a31515;\">'B19'</span>,\t<span style=\"color: #a31515;\">'50'</span>);\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color: #a31515;\">'B20'</span>,\t<span style=\"color: #a31515;\">'100'</span>);\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color: #a31515;\">'B21'</span>,\t<span style=\"color: #a31515;\">'200'</span>);\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color: #a31515;\">'B22'</span>,\t<span style=\"color: #a31515;\">'500'</span>);\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color: #a31515;\">'B23'</span>,\t<span style=\"color: #a31515;\">'1000'</span>);\n<span style=\"color: green;\">//Les Coupures DKK</span>\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color: #a31515;\">'B24'</span>,\t<span style=\"color: #a31515;\">'50'</span>);\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color: #a31515;\">'B25'</span>,\t<span style=\"color: #a31515;\">'100'</span>);\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color: #a31515;\">'B26'</span>,\t<span style=\"color: #a31515;\">'200'</span>);\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color: #a31515;\">'B27'</span>,\t<span style=\"color: #a31515;\">'500'</span>);\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color: #a31515;\">'B28'</span>,\t<span style=\"color: #a31515;\">'1000'</span>);\n<span style=\"color: green;\">//Les Coupures GBP</span>\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color: #a31515;\">'B29'</span>,\t<span style=\"color: #a31515;\">'5'</span>);\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color: #a31515;\">'B30'</span>,\t<span style=\"color: #a31515;\">'10'</span>);\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color: #a31515;\">'B31'</span>,\t<span style=\"color: #a31515;\">'20'</span>);\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color: #a31515;\">'B32'</span>,\t<span style=\"color: #a31515;\">'50'</span>);\n<span style=\"color: green;\">//Les Coupures JPY</span>\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color: #a31515;\">'B33'</span>,\t<span style=\"color: #a31515;\">'1000'</span>);\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color: #a31515;\">'B34'</span>,\t<span style=\"color: #a31515;\">'5000'</span>);\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color: #a31515;\">'B35'</span>,\t<span style=\"color: #a31515;\">'10000'</span>);\n<span style=\"color: green;\">//Les Coupures NOK</span>\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color: #a31515;\">'B36'</span>,\t<span style=\"color: #a31515;\">'50'</span>);\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color: #a31515;\">'B37'</span>,\t<span style=\"color: #a31515;\">'100'</span>);\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color: #a31515;\">'B38'</span>,\t<span style=\"color: #a31515;\">'200'</span>);\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color: #a31515;\">'B39'</span>,\t<span style=\"color: #a31515;\">'500'</span>);\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color: #a31515;\">'B40'</span>,\t<span style=\"color: #a31515;\">'1000'</span>);\n<span style=\"color: green;\">//Les Coupures SEK</span>\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color: #a31515;\">'B41'</span>,\t<span style=\"color: #a31515;\">'20'</span>);\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color: #a31515;\">'B42'</span>,\t<span style=\"color: #a31515;\">'50'</span>);\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color: #a31515;\">'B43'</span>,\t<span style=\"color: #a31515;\">'100'</span>);\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color: #a31515;\">'B44'</span>,\t<span style=\"color: #a31515;\">'500'</span>);\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color: #a31515;\">'B45'</span>,\t<span style=\"color: #a31515;\">'1000'</span>);\n<span style=\"color: green;\">//Les Coupures USD</span>\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color: #a31515;\">'B46'</span>,\t<span style=\"color: #a31515;\">'1'</span>);\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color: #a31515;\">'B47'</span>,\t<span style=\"color: #a31515;\">'5'</span>);\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color: #a31515;\">'B48'</span>,\t<span style=\"color: #a31515;\">'10'</span>);\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color: #a31515;\">'B49'</span>,\t<span style=\"color: #a31515;\">'20'</span>);\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color: #a31515;\">'B50'</span>,\t<span style=\"color: #a31515;\">'50'</span>);\n\n<span style=\"color: green;\">//Doesn't Work !!!</span>\n<span style=\"color: green;\">//Row Output Total numbers</span>\n<span style=\"color: green;\">//$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('C7,C'. $abfrage, $nombre_coupures);</span>\n<span style=\"color: green;\">//$col = ('C');</span>\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValueByColumnAndRow(<span style=\"color: #a31515;\">'C7:C'</span>. $abfrage, $nombre_coupures);\n\n<span style=\"color: green;\">// Rename sheet -        </span>\n\n$objPHPExcel-&gt;getActiveSheet()-&gt;setTitle(<span style=\"color: #a31515;\">''</span>. $codeRegate);\n$objPHPExcel-&gt;getActiveSheet()-&gt;getTabColor()-&gt;setRGB(<span style=\"color: #a31515;\">'3a62a1'</span>);\n<span style=\"color: green;\">//Set active sheet index to the first sheet, so Excel opens this as the first sheet</span>\n<span style=\"color: green;\">// Rename sheet</span>\n<span style=\"color: green;\">//</span>\n$objPHPExcel-&gt;setActiveSheetIndex(0);\n\n<span style=\"color: green;\">// redirect output to client browser</span>\nheader(<span style=\"color: #a31515;\">'Content-Type: application/vnd.ms-excel'</span>);\nheader(<span style=\"color: #a31515;\">'Content-Disposition: attachment;filename=\"export_scm.xls\"'</span>);\nheader(<span style=\"color: #a31515;\">'Cache-Control: max-age=0'</span>);\n\n$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, <span style=\"color: #a31515;\">'Excel5'</span>);\n$objWriter-&gt;save(<span style=\"color: #a31515;\">'php://output'</span>);\n<span style=\"color: green;\">//$objWriter = new PHPExcel_Writer_Excel5($objPHPExcel);</span>\n$objWriter-&gt;save(<span style=\"color: #a31515;\">'export/cdd/'</span>. $codeRegate .<span style=\"color: #a31515;\">'.xls'</span>);\n?&gt;\n</pre>\n</div>\n<p>I hope anybody can Help me</p>\n<p>cheers</p>\n<p>Achillix</p>",
    "PostedDate": "2011-11-07T02:58:46.567-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "694939",
    "ThreadId": "278568",
    "Html": "<p>Well.... setCellValue define the value of ONE cell, so you can't use a address like 'C7,Cx', with a comma and 'x' coming from nowhere (as far as i can see $abfrage isn't defined).</p>\r\n<p>setCellValueByColumnAndRow want three parameters : a column (integer), a row (integer) and the value.</p>\r\n<p>You need only to increment the row, so, use what you want, using a counter :</p>\r\n<p>$Row=7;<br />[...]setCellValue('C'.$Row, $nombre_coupures);</p>\r\n<p>or</p>\r\n<p>[...]setCellValueByColumnAndRow(2, $Row, $nombre_coupures);</p>\r\n<p>$Row++;</p>\r\n<p>Note : in PHPExcel, column index is zero based, row index is 1 based. ('A1' : 0,1).<br />In your script, you don't write value in the loop, you got only the last $nombre_coupures...<br />I wrote hardcoded values, easy to read in a snippet, but using some constants/variables is better, of course.</p>",
    "PostedDate": "2011-11-07T13:23:01.697-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "695237",
    "ThreadId": "278568",
    "Html": "<p>Hi<br /> <br /> At first - thank you for your Answer and your Help.<br /> I have changed the line with the problem</p>\n<p>&nbsp;</p>\n<div style=\"color: black; background-color: white;\">\n<pre><span style=\"color: blue;\">require</span>(<span style=\"color: #a31515;\">'date_demande_appdev_form_query2.php'</span>);\n$col=2;\n$Row=7;\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValueByColumnAndRow($col, $Row, $nombre_coupures);\n$Row++;\n</pre>\n</div>\n<p>but i get only the last record of my resultset in the export</p>\n<p><br /> Here the part of date_demande_appdev_form_query2.php<br /> <br /></p>\n<div style=\"color: black; background-color: white;\">\n<pre>&lt;?php\n$abfrage1 \t= <span style=\"color: #a31515;\">\"select distinct devises from details_coupures order by devises\"</span>;\n$ergebnis1 \t= mysql_query($abfrage1) <span style=\"color: blue;\">or</span> <span style=\"color: blue;\">die</span>(<span style=\"color: #a31515;\">\"Query failed with error: \"</span>.mysql_error());\n<span style=\"color: blue;\">while</span>($row = mysql_fetch_row($ergebnis1))\n{\n$abfrage2 \t\t= <span style=\"color: #a31515;\">\"select count(coupure) as 'ncoupures' from details_coupures where devises = '\"</span>.$row[0].<span style=\"color: #a31515;\">\"'\"</span>;\n$ergebnis2 \t\t= mysql_query($abfrage2) <span style=\"color: blue;\">or</span> <span style=\"color: blue;\">die</span>(<span style=\"color: #a31515;\">\"Query failed with error: \"</span>.mysql_error());\n$ncoupures\t \t= mysql_result($ergebnis2 , 0 , <span style=\"color: #a31515;\">\"ncoupures\"</span>);\n\t\n\t<span style=\"color: green;\">//echo '&lt;tr id=\"tdformcol\"&gt;&lt;td id=\"formGlob\" width=\"70\" &gt;&amp;nbsp;'.$row[0].'&lt;/td&gt;&lt;td colspan=\"3\" id=\"formGlob\" width=\"200\"&gt;';</span>\n\t$abfrage3 \t= <span style=\"color: #a31515;\">\"select coupure from details_coupures where devises = '\"</span>.$row[0].<span style=\"color: #a31515;\">\"' order by coupure\"</span>;\n\t$ergebnis3 \t= mysql_query($abfrage3) <span style=\"color: blue;\">or</span> <span style=\"color: blue;\">die</span>(<span style=\"color: #a31515;\">\"Query failed with error: \"</span>.mysql_error());\n\t\t<span style=\"color: green;\">//echo '&lt;table border=\"0\" width=\"200\" cellspacing=\"0\" cellpadding=\"0\"&gt;';</span>\n\t<span style=\"color: blue;\">while</span>($row1 = mysql_fetch_row($ergebnis3))\n\t{\n\t$abfrage4 = \" SELECT DISTINCT detail_demande_appro_devise.quantite\n\t\t\tFROM demande_appro_devise, acores, infos_bureau, detail_demande_appro_devise \n\t\t\tWHERE acores.id_acores = <span style=\"color: #a31515;\">'\".$id_acores.\"'</span> \n\t\t\tAND demande_appro_devise.num_demande = detail_demande_appro_devise.num_demande \n\t\t\tAND demande_appro_devise.code_acores = <span style=\"color: #a31515;\">'\".$code_acores.\"'</span> \n\t\t\tAND demande_appro_devise.date_demande = <span style=\"color: #a31515;\">'\".$date_demande.\"'</span> \n\t\t\tAND detail_demande_appro_devise.coupure = <span style=\"color: #a31515;\">'\".$row1[0].\"'</span> \n\t\t\tAND demande_appro_devise.code_devise = <span style=\"color: #a31515;\">'\".$row[0].\"'</span> \";\n\t$ergebnis4 \t= mysql_query($abfrage4) <span style=\"color: blue;\">or</span> <span style=\"color: blue;\">die</span>(<span style=\"color: #a31515;\">\"Query failed with error: \"</span>.mysql_error());\n\t<span style=\"color: blue;\">if</span>( mysql_numrows($ergebnis4) &gt; 0)\n\t{\n\t\t$nombre_coupures\t \t= mysql_result($ergebnis4 , 0 , <span style=\"color: #a31515;\">\"quantite\"</span>);\n\t}\n\t<span style=\"color: blue;\">else</span>\n\t{\n\t\t$nombre_coupures\t \t= <span style=\"color: #a31515;\">\"0\"</span>;\n\t}\n\t<span style=\"color: green;\">//echo \"$nombre_coupures\";</span>\n\t<span style=\"color: green;\">//echo '&lt;tr id=\"formcol\"&gt;&lt;td id=\"formcol\" width=\"100\"&gt;&amp;nbsp;'.$row1[0].'&lt;/td&gt;<br />          &lt;td id=\"formcol\" width=\"80\"&gt;&amp;nbsp;&amp;nbsp;'.$nombre_coupures.'&lt;/td&gt;<br />          &lt;td id=\"formcol\" width=\"40\"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;'.( $nombre_coupures * $row1[0] ).'&lt;/td&gt;&lt;/tr&gt;';</span>\n\t<span style=\"color: green;\">//echo '&lt;/tr&gt;';</span>\n\t$mTotal = ( $nombre_coupures * $row1[0] ) + $mTotal;\n\t}\n\t<span style=\"color: green;\">//echo '&lt;/table&gt;&lt;/td&gt;';</span>\n\t<span style=\"color: green;\">//echo '&lt;td id=\"formGlob\" width=\"100\"&gt;&amp;nbsp;'.$mTotal.'&lt;/td&gt;<br />        &lt;td id=\"formGlob\" width=\"130\"&gt;&amp;nbsp;&lt;/td&gt;&lt;td id=\"formGlob\" width=\"130\"&gt;&amp;nbsp;&lt;/td&gt;';</span>\n\t$mTotal = 0;\n}\n?&gt;\n</pre>\n</div>\n<p>How you can see, i have HTML Code desactivated, because with HTML i get a crypted exported Excelfile .<br /><br /> <br /> <a href=\"http://www.hostingpics.net/viewer.php?id=243539sshot3.png\"></a><br /> <br /> I don't know what or where i can change something to get all records in the colum \"<strong>NOMBRE</strong>\"<br /> If you have another Idea?<br /> <br /> Thanks in advanced<br /> <br /> Achillix</p>",
    "PostedDate": "2011-11-08T03:25:41.123-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "695472",
    "ThreadId": "278568",
    "Html": "<p>If you don't have moved your line, i'm not suprised. You need to have something like :</p>\r\n<p>0) getting your parameters, open your db connection, require needed files and the like.</p>\r\n<p>1) Create your Excel workbook, define counter start value.</p>\r\n<p>2 ) Execute your query.</p>\r\n<p>3) Loop on each record, doing additional tasks needed</p>\r\n<p>3b) In the loop, when your data is \"ready to show\", set the cell with your data</p>\r\n<p>3c) Increment your row counter, preparing for the next data.</p>\r\n<p>4)(here or after 1) Add static labels, font, color, etc. to your workbook.</p>\r\n<p>5) \"Write\" the Workbook on the user browser.</p>\r\n<p>If you have some trouble, comment the save('php://output') and add some brutal echo to display the target cell address and value, you must have something like C7, C8,..., C50 and 0,0,...1,21,...displayed in your loop.</p>",
    "PostedDate": "2011-11-08T11:47:16.887-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "696313",
    "ThreadId": "278568",
    "Html": "<p>It works now.</p>\r\n<p>THX</p>",
    "PostedDate": "2011-11-10T01:53:03.11-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]