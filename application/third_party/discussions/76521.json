[
  {
    "Id": "261630",
    "ThreadId": "76521",
    "Html": "<p>Hello,</p>\r\n<p>i cant use =SUBTOTAL &nbsp;function. my source return this error:</p>\r\n<p>20:39:13 Create new PHPExcel object 20:39:13 Set properties 20:39:13 Add data 20:39:13 Set title row bold 20:39:13 Set autofilter 20:39:13 Write to Excel2007 format _raiseFormulaError message is Formula Error: An unexpected error occured<br><br><strong>Fatal error</strong>: Uncaught exception 'Exception' with message 'Formula Error: An unexpected error occured' in C:\\web\\www-projects\\www\\excel\\Classes\\PHPExcel\\Calculation.php:3032 Stack trace: #0 C:\\web\\www-projects\\www\\excel\\Classes\\PHPExcel\\Calculation.php(2483): PHPExcel_Calculation-&gt;_raiseFormulaError('Formula Error: ...') #1 C:\\web\\www-projects\\www\\excel\\Classes\\PHPExcel\\Calculation.php(1935): PHPExcel_Calculation-&gt;_parseFormula('SUBTOTAL(9;C2:C...') #2 C:\\web\\www-projects\\www\\excel\\Classes\\PHPExcel\\Calculation.php(1802): PHPExcel_Calculation-&gt;_calculateFormulaValue('=SUBTOTAL(9;C2:...', 'C10', Object(PHPExcel_Cell)) #3 C:\\web\\www-projects\\www\\excel\\Classes\\PHPExcel\\Cell.php(301): PHPExcel_Calculation-&gt;calculateCellValue(Object(PHPExcel_Cell), true) #4 C:\\web\\www-projects\\www\\excel\\Classes\\PHPExcel\\Writer\\Excel2007\\Worksheet.php(1002): PHPExcel_Cell-&gt;getCalculatedValue() #5 C:\\web\\www-projects\\www\\excel\\Classes\\PHPExcel\\Writer\\Excel2007\\Worksheet.php(946): PHPExcel_Writer_Excel2007_Worksheet-&gt;_writeCell(Object(PHPExcel_Shar in&nbsp;<strong>C:\\web\\www-projects\\www\\excel\\Classes\\PHPExcel\\Calculation.php</strong>&nbsp;on line&nbsp;<strong>3032</strong></p>\r\n<p>&nbsp;</p>\r\n<p><strong>and source is:</strong></p>\r\n<p><strong><span style=\"font-weight:normal\">&nbsp;</span></strong></p>\r\n<p><strong>&nbsp;</strong></p>\r\n<p><strong>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre>&lt;?php\r\n<span style=\"color:Green\">/**\r\n * PHPExcel\r\n *\r\n * Copyright (C) 2006 - 2009 PHPExcel\r\n *\r\n * This library is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU Lesser General Public\r\n * License as published by the Free Software Foundation; either\r\n * version 2.1 of the License, or (at your option) any later version.\r\n * \r\n * This library is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\r\n * Lesser General Public License for more details.\r\n * \r\n * You should have received a copy of the GNU Lesser General Public\r\n * License along with this library; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA\r\n *\r\n * @category   PHPExcel\r\n * @package    PHPExcel\r\n * @copyright  Copyright (c) 2006 - 2009 PHPExcel (http://www.codeplex.com/PHPExcel)\r\n * @license    http://www.gnu.org/licenses/old-licenses/lgpl-2.1.txt\tLGPL\r\n * @version    1.7.1, 2009-11-02\r\n */</span>\r\n\r\n<span style=\"color:Green\">/** Error reporting */</span>\r\nerror_reporting(E_ALL);\r\n\r\n<span style=\"color:Green\">/** PHPExcel */</span>\r\n<span style=\"color:Blue\">require_once</span> <span style=\"color:#A31515\">'../Classes/PHPExcel.php'</span>;\r\n\r\n<span style=\"color:Green\">/** PHPExcel_IOFactory */</span>\r\n<span style=\"color:Blue\">require_once</span> <span style=\"color:#A31515\">'../Classes/PHPExcel/IOFactory.php'</span>;\r\n\r\n<span style=\"color:Green\">// Create new PHPExcel object</span>\r\n<span style=\"color:Blue\">echo</span> date(<span style=\"color:#A31515\">'H:i:s'</span>) . <span style=\"color:#A31515\">&quot; Create new PHPExcel object\\n&quot;</span>;\r\n$objPHPExcel = <span style=\"color:Blue\">new</span> PHPExcel();\r\n\r\n<span style=\"color:Green\">// Set properties</span>\r\n<span style=\"color:Blue\">echo</span> date(<span style=\"color:#A31515\">'H:i:s'</span>) . <span style=\"color:#A31515\">&quot; Set properties\\n&quot;</span>;\r\n$objPHPExcel-&gt;getProperties()-&gt;setCreator(<span style=\"color:#A31515\">&quot;Maarten Balliauw&quot;</span>)\r\n\t\t\t\t\t\t\t -&gt;setLastModifiedBy(<span style=\"color:#A31515\">&quot;Maarten Balliauw&quot;</span>)\r\n\t\t\t\t\t\t\t -&gt;setTitle(<span style=\"color:#A31515\">&quot;Office 2007 XLSX Test Document&quot;</span>)\r\n\t\t\t\t\t\t\t -&gt;setSubject(<span style=\"color:#A31515\">&quot;Office 2007 XLSX Test Document&quot;</span>)\r\n\t\t\t\t\t\t\t -&gt;setDescription(<span style=\"color:#A31515\">&quot;Test document for Office 2007 XLSX, generated using PHP classes.&quot;</span>)\r\n\t\t\t\t\t\t\t -&gt;setKeywords(<span style=\"color:#A31515\">&quot;office 2007 openxml php&quot;</span>)\r\n\t\t\t\t\t\t\t -&gt;setCategory(<span style=\"color:#A31515\">&quot;Test result file&quot;</span>);\r\n\r\n\r\n<span style=\"color:Green\">// Create a first sheet</span>\r\n<span style=\"color:Blue\">echo</span> date(<span style=\"color:#A31515\">'H:i:s'</span>) . <span style=\"color:#A31515\">&quot; Add data\\n&quot;</span>;\r\n$objPHPExcel-&gt;setActiveSheetIndex(0);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#A31515\">'A1'</span>, <span style=\"color:#A31515\">&quot;Quarter&quot;</span>);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#A31515\">'B1'</span>, <span style=\"color:#A31515\">&quot;Country&quot;</span>);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#A31515\">'C1'</span>, <span style=\"color:#A31515\">&quot;Sales&quot;</span>);\r\n\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#A31515\">'A2'</span>, <span style=\"color:#A31515\">&quot;Q1&quot;</span>);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#A31515\">'B2'</span>, <span style=\"color:#A31515\">&quot;United States&quot;</span>);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#A31515\">'C2'</span>, <span style=\"color:#A31515\">&quot;800&quot;</span>);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#A31515\">'A3'</span>, <span style=\"color:#A31515\">&quot;Q2&quot;</span>);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#A31515\">'B3'</span>, <span style=\"color:#A31515\">&quot;United States&quot;</span>);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#A31515\">'C3'</span>, <span style=\"color:#A31515\">&quot;700&quot;</span>);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#A31515\">'A4'</span>, <span style=\"color:#A31515\">&quot;Q3&quot;</span>);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#A31515\">'B4'</span>, <span style=\"color:#A31515\">&quot;United States&quot;</span>);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#A31515\">'C4'</span>, <span style=\"color:#A31515\">&quot;900&quot;</span>);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#A31515\">'A5'</span>, <span style=\"color:#A31515\">&quot;Q4&quot;</span>);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#A31515\">'B5'</span>, <span style=\"color:#A31515\">&quot;United States&quot;</span>);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#A31515\">'C5'</span>, <span style=\"color:#A31515\">&quot;950&quot;</span>);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#A31515\">'A6'</span>, <span style=\"color:#A31515\">&quot;Q1&quot;</span>);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#A31515\">'B6'</span>, <span style=\"color:#A31515\">&quot;Belgium&quot;</span>);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#A31515\">'C6'</span>, <span style=\"color:#A31515\">&quot;400&quot;</span>);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#A31515\">'A7'</span>, <span style=\"color:#A31515\">&quot;Q2&quot;</span>);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#A31515\">'B7'</span>, <span style=\"color:#A31515\">&quot;Belgium&quot;</span>);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#A31515\">'C7'</span>, <span style=\"color:#A31515\">&quot;350&quot;</span>);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#A31515\">'A8'</span>, <span style=\"color:#A31515\">&quot;Q3&quot;</span>);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#A31515\">'B8'</span>, <span style=\"color:#A31515\">&quot;Belgium&quot;</span>);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#A31515\">'C8'</span>, <span style=\"color:#A31515\">&quot;450&quot;</span>);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#A31515\">'A9'</span>, <span style=\"color:#A31515\">&quot;Q4&quot;</span>);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#A31515\">'B9'</span>, <span style=\"color:#A31515\">&quot;Belgium&quot;</span>);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#A31515\">'C9'</span>, <span style=\"color:#A31515\">&quot;500&quot;</span>);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#A31515\">'C10'</span>, <span style=\"color:#A31515\">'=SUBTOTAL(9;C2:C9)'</span>);\r\n\r\n\r\n<span style=\"color:Green\">// Set title row bold</span>\r\n<span style=\"color:Blue\">echo</span> date(<span style=\"color:#A31515\">'H:i:s'</span>) . <span style=\"color:#A31515\">&quot; Set title row bold\\n&quot;</span>;\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#A31515\">'A1'</span>)-&gt;getFont()-&gt;setBold(true);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#A31515\">'B1'</span>)-&gt;getFont()-&gt;setBold(true);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#A31515\">'C1'</span>)-&gt;getFont()-&gt;setBold(true);\r\n\r\n\r\n<span style=\"color:Green\">// Set autofilter</span>\r\n<span style=\"color:Blue\">echo</span> date(<span style=\"color:#A31515\">'H:i:s'</span>) . <span style=\"color:#A31515\">&quot; Set autofilter\\n&quot;</span>;\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setAutoFilter(<span style=\"color:#A31515\">'A1:C9'</span>);\t<span style=\"color:Green\">// Always include the complete filter range!</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span style=\"color:Green\">// Excel does support setting only the caption</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span style=\"color:Green\">// row, but that's not a best practise...</span>\r\n\r\n<span style=\"color:Green\">// Set active sheet index to the first sheet, so Excel opens this as the first sheet</span>\r\n$objPHPExcel-&gt;setActiveSheetIndex(0);\r\n\r\n\t\t\r\n<span style=\"color:Green\">// Save Excel 2007 file</span>\r\n<span style=\"color:Blue\">echo</span> date(<span style=\"color:#A31515\">'H:i:s'</span>) . <span style=\"color:#A31515\">&quot; Write to Excel2007 format\\n&quot;</span>;\r\n$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, <span style=\"color:#A31515\">'Excel2007'</span>);\r\n$objWriter-&gt;save(str_replace(<span style=\"color:#A31515\">'.php'</span>, <span style=\"color:#A31515\">'.xlsx'</span>, <span style=\"color:Blue\">__FILE__</span>));\r\n\r\n<span style=\"color:Green\">// Echo memory peak usage</span>\r\n<span style=\"color:Blue\">echo</span> date(<span style=\"color:#A31515\">'H:i:s'</span>) . <span style=\"color:#A31515\">&quot; Peak memory usage: &quot;</span> . (memory_get_peak_usage(true) / 1024 / 1024) . <span style=\"color:#A31515\">&quot; MB\\r\\n&quot;</span>;\r\n\r\n<span style=\"color:Green\">// Echo done</span>\r\n<span style=\"color:Blue\">echo</span> date(<span style=\"color:#A31515\">'H:i:s'</span>) . <span style=\"color:#A31515\">&quot; Done writing file.\\r\\n&quot;</span>;\r\n?&gt;\r\n</pre>\r\n</div>\r\n</strong></p>\r\n<p>&nbsp;</p>\r\n<p><strong>If i delete this command: </strong></p>\r\n<pre style=\"color:#000000;font-family:Consolas, 'Courier New', Courier, monospace;font-size:1em;margin:8px\">$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#a31515\">'C10'</span>, <span style=\"color:#a31515\">'=SUBTOTAL(9;C2:C9)'</span>);</pre>\r\n<pre style=\"color:#000000;font-family:Consolas, 'Courier New', Courier, monospace;font-size:1em;margin:8px\">than this script is ok and will be genered XLS.</pre>\r\n<pre style=\"color:#000000;font-family:Consolas, 'Courier New', Courier, monospace;font-size:1em;margin:8px\"></pre>\r\n<pre style=\"color:#000000;font-family:Consolas, 'Courier New', Courier, monospace;font-size:1em;margin:8px\"></pre>\r\n<pre style=\"color:#000000;font-family:Consolas, 'Courier New', Courier, monospace;font-size:1em;margin:8px\">Could you tell me how I can use SUBTOTAL?</pre>\r\n<pre style=\"color:#000000;font-family:Consolas, 'Courier New', Courier, monospace;font-size:1em;margin:8px\">many thanks, pavel</pre>\r\n<pre style=\"color:#000000;font-family:Consolas, 'Courier New', Courier, monospace;font-size:1em;margin:8px\"></pre>\r\n<p>&nbsp;</p>",
    "PostedDate": "2009-11-29T11:42:29.417-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "264167",
    "ThreadId": "76521",
    "Html": "<p>Formula&rsquo;s argument separator is <strong>comma </strong>and not semicolon. (According to the manual.)</p>\r\n<p>That is why your code didn&rsquo;t work.</p>\r\n<p>Replace formula <strong><span style=\"color:#800000\">'=SUBTOTAL(9;C2:C9)'</span></strong> with <strong><span style=\"color:#008000\">'=SUBTOTAL(9,C2:C9)'</span></strong> and then it should be okay.</p>",
    "PostedDate": "2009-12-06T09:19:59.017-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]