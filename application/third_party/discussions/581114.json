[
  {
    "Id": "1353110",
    "ThreadId": "581114",
    "Html": "Hello All,\r<br />\n<br />\nWith all the searching I have done, I cant seem to find quite the right direction for my project.\r<br />\n<br />\nI am trying to import a file that has multiple sheets, all with data that needs to be added to a given record. I will try my best to explain what the format is a where I am stuck.\r<br />\n<br />\nSo the file has three sheets, Summary, Data, and Rates.  On the summary page, a project number is input (12345) This number is unique. The data page the number of hours are plugged in with a date and based off of the column they are in, who worked the hours (ex 1/1/2015, Manager column,8 hrs....etc) Then on the Rates page, the position would be listed in column A with a rate (ex Manager $35.00)\r<br />\n<br />\nBasically I need to be able to import the rate from the Rates page on cell A7 to a particular column in my database like Manager_Base_Rate then from the Data page, import the hours worked from cell G6 to Manager_ST_Hours then all associate that with a unique porject 12345 from the Summary page.\r<br />\n<br />\nNow I can get the data to be displayed in all its unformatted glory after i import it, however, I am running into a wall when I try to figure out how to import this information.\r<br />\n<br />\nA kick in the right direction/examples/ideas would be appreciated.\r<br />\n<br />\nAlso I have thought (if its possible) that maybe I should have phpexcel import the file and add a new sheet to the workbook and that would be full of formulas with one row. Then just building off of the one row.  Im not sure if that is smarter or not.\r<br />\n<br />\nThanks!<br />\n",
    "PostedDate": "2015-02-16T08:50:16.783-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1354447",
    "ThreadId": "581114",
    "Html": "After a lot of lost sleep and feeling as if i was just so close - I found the following and modified it to my use the best.<br />\n<pre><code>&lt;?php\nsession_start();\nrequire 'Classes/PHPExcel.php';\nrequire_once 'Classes/PHPExcel/IOFactory.php';\n\nforeach ($objPHPExcel-&gt;getWorksheetIterator() as $worksheet) {\n            $worksheetTitle     = $worksheet-&gt;getTitle();\n            $highestRow         = $worksheet-&gt;getHighestRow();\n            $highestColumn      = $worksheet-&gt;getHighestColumn(''); \n            $highestColumnIndex = PHPExcel_Cell::columnIndexFromString($highestColumn);\n            $nrColumns = ord($highestColumn) - 64;\n            //$arrayData = $worksheet-&gt;toArray(); old function\n            $arrayData[$worksheet-&gt;getTitle()] = $worksheet-&gt;toArray(null,false,true,true);\n}</code></pre>\n\nThis loops through each sheet and gives you an array with letters and numbers.<br />\n<br />\nFor my application a quick echo of a few items I figure to be useful for those using this.  \n<br />\n<pre><code>echo ($arrayData[&quot;Data&quot;]['4']['B']);</code></pre>\n\nThe trick I had to wrap my mind around was the fact that phpexcel i giving you a multi-dimensional array vs a different array for each sheet.<br />\n<br />\nAs a side note- sheets with spaces in their names work fine just make sure you have &quot;&quot;.<br />\n<br />\nAlso passing arrayData into a session array I felt was smart to keep me from meddling with the phpexcel coding.<br />\n<pre><code>$_SESSION['arrayData'] = $arrayData;</code></pre>\n\nAnd I currently spit it out for myself to look at<br />\n<pre><code>echo &quot;&lt;pre&gt;&quot;;\nprint_r($arrayData);\necho &quot;&lt;/pre&gt;&quot;;</code></pre>\n\nOnce i got this concept it was mostly painless to build my sql etc.<br />\n<br />\nI really hopes this helps someone else.<br />\n",
    "PostedDate": "2015-02-20T12:08:11.923-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]