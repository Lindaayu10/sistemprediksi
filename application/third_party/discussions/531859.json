[
  {
    "Id": "1208286",
    "ThreadId": "531859",
    "Html": "hello,\r<br />\n<br />\nI create an excel file (as a model ==&gt;export-commande-2007.xlsx) in it there are conditional formatting (If less than 0.3 then text in red / pink background and size% percent).\r<br />\nIn my php page (below) I import data from my DB in the &quot;data&quot; tab.<br />\n<pre><code>connexion_mysql(); \n$path = '../php/Classes';\nset_include_path(get_include_path() . PATH_SEPARATOR . $path);\nfunction __autoload($classe)\n{\n//echo '&lt;p&gt;' . $classe . '&lt;/p&gt;';\n$fichier = str_replace('_',DIRECTORY_SEPARATOR, $classe ) . '.php' ;\n//echo '&lt;p&gt;' . $fichier . '&lt;/p&gt;';\nrequire_once($fichier) ; # Chargement de la classe.\n}\n \n \n$objet = PHPExcel_IOFactory::createReader('Excel2007');\n \n$excel = $objet-&gt;load('../modele/export-commande-2007.xlsx');\n \n$sheet = $excel-&gt;getSheetByName('Data1');\n$sql='SELECT m.nom as Marque,.......'\n//echo $sql;\n$requete=mysql_query($sql) or die ('Echec select tablea');\n//$sheet-&gt;setCellValue('A50', 'MaitrePylos');\n//$writer = PHPExcel_IOFactory::createWriter($excel);\n$writer = PHPExcel_IOFactory::createWriter($excel, 'Excel2007');\n//$writer = new \\PHPExcel_Writer_Excel5($excel);\n$writer -&gt;setPreCalculateFormulas(false);\n$col=0;\n$lig=2;\nwhile( $result = mysql_fetch_object( $requete ) )\n{\n      $sheet-&gt;setCellValueByColumnAndRow($col,$lig,$result-&gt;Marque);\n \n      $col=$col+1;\n      $sheet-&gt;setCellValueByColumnAndRow($col,$lig,$result-&gt;tt);\n \n      $col=$col+1;\n      $sheet-&gt;setCellValueByColumnAndRow($col,$lig,$result-&gt;cden);\n      $col=$col+1;\n      $sheet-&gt;setCellValueByColumnAndRow($col,$lig,$result-&gt;societe);\n      $col=$col+1;\n            $sheet-&gt;setCellValueByColumnAndRow($col,$lig,$result-&gt;obj);\n      $col=$col+1;\n            $sheet-&gt;setCellValueByColumnAndRow($col,$lig,$result-&gt;objcal);\n      $col=$col+1;\n            $sheet-&gt;setCellValueByColumnAndRow($col,$lig,$result-&gt;pour);\n      $col=$col+1;\n            $sheet-&gt;setCellValueByColumnAndRow($col,$lig,$result-&gt;diff);\n      $col=$col+1;\n            $sheet-&gt;setCellValueByColumnAndRow($col,$lig,$result-&gt;cden1);\n      $col=$col+1;\n            $sheet-&gt;setCellValueByColumnAndRow($col,$lig,$result-&gt;realn1);\n      $col=$col+1;\n                $sheet-&gt;setCellValueByColumnAndRow($col,$lig,$result-&gt;entretien);\n      $col=$col+1;\n                $sheet-&gt;setCellValueByColumnAndRow($col,$lig,$result-&gt;fi);\n      $col=$col+1;\n                $sheet-&gt;setCellValueByColumnAndRow($col,$lig,$result-&gt;box);\n      $col=$col+1;\n                $sheet-&gt;setCellValueByColumnAndRow($col,$lig,$result-&gt;cld);\n      $col=$col+1;\n                $sheet-&gt;setCellValueByColumnAndRow($col,$lig,$result-&gt;T_entretien);\n      $col=$col+1;\n                    $sheet-&gt;setCellValueByColumnAndRow($col,$lig,$result-&gt;T_fi);\n      $col=$col+1;\n                    $sheet-&gt;setCellValueByColumnAndRow($col,$lig,$result-&gt;T_box);\n      $col=$col+1;\n                    $sheet-&gt;setCellValueByColumnAndRow($col,$lig,$result-&gt;T_cld);\n      $col=$col+1;\n                        $sheet-&gt;setCellValueByColumnAndRow($col,$lig,$result-&gt;cdenn);\n      $col=$col+1;\n                            $sheet-&gt;setCellValueByColumnAndRow($col,$lig,$result-&gt;vsn1);\n      $col=$col+1;\n            $col=0;\n      $lig=$lig+1;\n      }\n//$writer-&gt;save('Exemple14.xlsx');\nheader('Content-type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');\nheader('Content-Disposition:inline;filename=Exemple14.xlsx ');\nheader(&quot;Content-Type: application/force-download&quot;);\nheader(&quot;Content-Type: application/octet-stream&quot;);\nheader(&quot;Content-Type: application/download&quot;);;\n$writer-&gt;save('php://output');</code></pre>\n\nOnce the problem the generated file I lose the format that is in the conditional update (standard)\r<br />\n<br />\nWhat a mistake I committed? Is this normal?\r<br />\n<br />\n(Sorry don't speak english)\r<br />\nguigui69<br />\n",
    "PostedDate": "2014-02-14T02:03:45.353-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]