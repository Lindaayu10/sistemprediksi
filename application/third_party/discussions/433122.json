[
  {
    "Id": "1001084",
    "ThreadId": "433122",
    "Html": "Hi PHPExcel forum!!!<br />\n<br />\nI have been working with PHPExcel now for quite some time and absolutely loving it, constantly finding way to improve my work i need help/suggestions on how I can improve the 'bulky' sector of my code, please see code sector:<br />\n<br />\n$objDrawing = new PHPExcel_Worksheet_Drawing();<br />\n$objDrawing-&gt;setName('');<br />\n$objDrawing-&gt;setDescription('');<br />\n$objDrawing-&gt;setPath('../../media/catalog/product/cache/1/thumbnail/75x75/9df78eab33525d08d6e5fb8d27136e95'.$_product-&gt;getThumbnail()); <br />\n$objDrawing-&gt;setCoordinates('A'.$sum_total);<br />\n$objDrawing-&gt;setOffsetX(10);<br />\n$objDrawing-&gt;setOffsetY(10);<br />\n$objDrawing-&gt;setHeight(110);<br />\n$objDrawing-&gt;setWorksheet($objPHPExcel-&gt;getActiveSheet());<br />\n<br />\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('A7', 'IMAGE');<br />\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('B7', 'SKU');<br />\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('C7', 'BRAND');<br />\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('D7', 'GENDER');<br />\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('E7', 'NAME');<br />\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('F7', 'PRICE PER UNIT');<br />\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('G7', 'RRP');<br />\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('J7', 'TOTAL UNITS');<br />\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('B'.$sum_total, $_product-&gt;getSku());<br />\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('E'.$sum_total, $_product-&gt;getName());<br />\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('C'.$sum_total, $_product-&gt;getAttributeText('manufacturer'));<br />\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('D'.$sum_total, $_product-&gt;getAttributeText('gender'));<br />\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('F'.$sum_total, '£'.number_format($_product-&gt;getPrice(),2));<br />\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('G'.$sum_total, '£'.number_format($_product-&gt;getMsrp(),2));<br />\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('I'.$sum_total, 'CLICK HERE TO BUY');<br />\n$objPHPExcel-&gt;getActiveSheet()-&gt;getCell('I'.$sum_total)-&gt;getHyperlink()-&gt;setUrl('$_product-&gt;getUrlPath());<br />\n$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension(&quot;A&quot;)-&gt;setWidth(23);<br />\n<br />\n<br />\n<br />\n<br />\nHere are the results:<br />\n(These two lines are externally related)<br />\n10:48:03 Collecting Product Data...<br />\n10:48:36 Data Collected... <br />\n<br />\nApplying date is when the show code above starts to process<br />\n10:48:36 Applying Data to Document...<br />\n<br />\nWhen the process finishes (5 seconds to save):<br />\n10:49:32 Writing to file<br />\nCreate Writer OK<br />\nPreCalculate OK<br />\nSaving as OK<br />\n10:49:37Your file has been created<br />\n<br />\nSo Im looking at the roughly reducing the 1 minute processing time for the code above to be shortened if possible, at the moments its only 400+ rows in the spreadsheet baring in mind majorite is images.<br />\n<br />\nI have cached it (Gzip).<br />\nIf you need more info let me know and Il be happy to asist!<br />\n",
    "PostedDate": "2013-02-14T02:52:24.72-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1001112",
    "ThreadId": "433122",
    "Html": "Take advantage of PHPExcel's fluent interface:<br />\n<pre><code>$objDrawing = new PHPExcel_Worksheet_Drawing();\n$objDrawing-&gt;setName('')\n    -&gt;setDescription('')\n    -&gt;setPath('../../media/catalog/product/cache/1/thumbnail/75x75/9df78eab33525d08d6e5fb8d27136e95'.$_product-&gt;getThumbnail())\n    -&gt;setCoordinates('A'.$sum_total)\n    -&gt;setOffsetX(10)\n    -&gt;setOffsetY(10)\n    -&gt;setHeight(110)\n    -&gt;setWorksheet($objPHPExcel-&gt;getActiveSheet());</code></pre>\n\nor<br />\n<pre><code>$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('A7', 'IMAGE')\n    -&gt;setCellValue('B7', 'SKU');\n    -&gt;getActiveSheet()-&gt;setCellValue('C7', 'BRAND')\n    -&gt;getActiveSheet()-&gt;setCellValue('D7', 'GENDER')\n    -&gt;getActiveSheet()-&gt;setCellValue('E7', 'NAME')\n    -&gt;getActiveSheet()-&gt;setCellValue('F7', 'PRICE PER UNIT')\n    -&gt;getActiveSheet()-&gt;setCellValue('G7', 'RRP')\n    -&gt;getActiveSheet()-&gt;setCellValue('J7', 'TOTAL UNITS');</code></pre>\n\nAvoid unnecessary duplication of nested method calls<br />\n<pre><code>$sheet = $objPHPExcel-&gt;getActiveSheet();\n$sheet-&gt;setCellValue('A7', 'IMAGE');\n$sheet-&gt;setCellValue('B7', 'SKU');\n$sheet-&gt;setCellValue('C7', 'BRAND');\n$sheet-&gt;setCellValue('D7', 'GENDER');\n$sheet-&gt;setCellValue('E7', 'NAME');\n$sheet-&gt;setCellValue('F7', 'PRICE PER UNIT');\n$sheet-&gt;setCellValue('G7', 'RRP');\n$sheet-&gt;setCellValue('J7', 'TOTAL UNITS');</code></pre>\n\nLook at using the worksheet's fromArray() method<br />\n<pre><code>$data = array(\n     'SKU', 'BRAND', 'GENDER', 'NAME', 'PRICE PER UNIT', 'RRP', 'TOTAL UNITS'\n);\n$objPHPExcel-&gt;getActiveSheet()-&gt;fromArray($data, NULL, 'A7');</code></pre>\n\nCombine these techniques as appropriate<br />\n",
    "PostedDate": "2013-02-14T04:01:33.057-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1001132",
    "ThreadId": "433122",
    "Html": "Hi Mark,\r<br />\n<br />\nFirst of all thanks for showing me a more simple way instead of copy and pasting and me just simply changing cell values!!\r<br />\n<br />\nWhat is the difference between\r<br />\n<br />\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('A7', 'IMAGE')\r<br />\n-&gt;setCellValue('B7', 'SKU');\r<br />\n<br />\n&amp;\r<br />\n<br />\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('A7', 'IMAGE')\r<br />\n$objPHPExcel-&gt;getActiveSheet()-&gt;-&gt;setCellValue('B7', 'SKU');\r<br />\n<br />\nIn the way that it is processed?\r<br />\n<br />\nIm going to look at array-ing everything which will hopefully increase processing!\r<br />\nAlso ive started to apply the auto filter, and I have looked through the docs but cant find the information to select ascending or descending? is this functionality in yet?\r<br />\n<br />\nKind Regards\r<br />\nAdam<br />\n",
    "PostedDate": "2013-02-14T04:29:52.533-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1001137",
    "ThreadId": "433122",
    "Html": "The difference between<br />\n<pre><code>$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('A7', 'IMAGE') \n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('B7', 'SKU'); </code></pre>\n\n&amp; <br />\n<pre><code>$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('A7', 'IMAGE') \n    -&gt;setCellValue('B7', 'SKU'); </code></pre>\n\nis the elimination of a second call to <br />\n<pre><code>$objPHPExcel-&gt;getActiveSheet()</code></pre>\n\nas setCellValue() returns the worksheet object, allowing you to chain the calls<br />\n<blockquote>\nAlso ive started to apply the auto filter, and I have looked through the docs but cant find the information to select ascending or descending? is this functionality in yet? <br />\n</blockquote>\nNo, and nor is it likely to be! I looked at implementing it when I was working on autofilter expressions; but sorting in an autofilter range is a massive overhead; and actually changes the content of each row to replicate the sort sequence, making it awkward for script writers who expect a degree of consistency in the data they store.... if I put &quot;Hello&quot; in cell A1 and &quot;World&quot; in cell A2, and have an autofilter sort descending; then cell A1 will subsequently contain &quot;World&quot; and cell A2 will contain &quot;Hello&quot;.<br />\n",
    "PostedDate": "2013-02-14T04:43:01.317-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]