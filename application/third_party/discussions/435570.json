[
  {
    "Id": "1011147",
    "ThreadId": "435570",
    "Html": "Hi,<br />\n<br />\nI'm currently working with PHPExcel to generate Excel files (filled with data retrieved from a database).<br />\n<br />\nHowever, I've got a problem when generating the Excel file and letting the user download it through the web browser.<br />\n<br />\nWhen opening the Excel document after its download, I can't read anything else than special characters...<br />\n<br />\n<br />\nCould you help to understand why ? <br />\nHere is a few configurations of my web server :<br />\n<pre><code>root@web:~# php -v\nPHP 5.3.3-7+squeeze14 with Suhosin-Patch (cli) (built: Aug  6 2012 14:18:06)\nCopyright (c) 1997-2009 The PHP Group\nZend Engine v2.3.0, Copyright (c) 1998-2010 Zend Technologies\n    with Suhosin v0.9.32.1, Copyright (c) 2007-2010, by SektionEins GmbH</code></pre>\n\n<pre><code>root@web:~# php -m\n[PHP Modules]\nbcmath\nbz2\ncalendar\nCore\nctype\ndate\ndba\ndom\nereg\nexif\nfileinfo\nfilter\nftp\ngd\ngettext\nhash\niconv\nimap\njson\nldap\nlibxml\nmbstring\nmcrypt\nmhash\nmssql\nmysql\nmysqli\nopenssl\npcntl\npcre\nPDO\npdo_dblib\npdo_mysql\nPhar\nposix\nReflection\nsession\nshmop\nSimpleXML\nsoap\nsockets\nSPL\nstandard\nsuhosin\nsysvmsg\nsysvsem\nsysvshm\ntokenizer\nwddx\nxml\nxmlreader\nxmlrpc\nxmlwriter\nzip\nzlib\n\n[Zend Modules]\nSuhosin</code></pre>\n\nNote that the gd version installed is the 2.0<br />\n<br />\n<br />\n<br />\nHere is the code I'm testing and that generates unreadable characters.<br />\n<pre><code>include_once('Excel/PHPExcel.php');\n\n$phpExcel = new PHPExcel();\n$phpExcel-&gt;getActiveSheet()-&gt;setTitle(&quot;My Sheet&quot;);\n\n$phpExcel-&gt;setActiveSheetIndex(0);\nheader(&quot;Content-Type: application/vnd.ms-excel&quot;);\nheader(&quot;Content-Disposition: attachment; filename=\\&quot;filename.xls\\&quot;&quot;);\nheader(&quot;Cache-Control: max-age=0&quot;);\n\n$objWriter = PHPExcel_IOFactory::createWriter($phpExcel, &quot;Excel5&quot;);\n$objWriter-&gt;save(&quot;php://output&quot;);\nexit;</code></pre>\n\nThanks a lot for your help!<br />\n<br />\n<br />\nEdit : This is what I get when I open the file <br />\n<a href=\"http://www.hostingpics.net/viewer.php?id=133098excelerror.png\" rel=\"nofollow\">http://www.hostingpics.net/viewer.php?id=133098excelerror.png</a><br />\n<a href=\"http://www.hostingpics.net/viewer.php?id=350258excelerror2.png\" rel=\"nofollow\">http://www.hostingpics.net/viewer.php?id=350258excelerror2.png</a><br />\n",
    "PostedDate": "2013-03-06T05:20:18.72-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1011186",
    "ThreadId": "435570",
    "Html": "Well... I've found my mistake...<br />\nIt was a stupid one (like every mistake we could say :] )<br />\n<br />\nI forgot to comment one line before the generation of the document :<br />\n<pre><code>echo '&lt;pre&gt;';</code></pre>\n\nThese few characters were enough to corrupt the whole excel file !<br />\n",
    "PostedDate": "2013-03-06T06:32:43.41-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1011632",
    "ThreadId": "435570",
    "Html": "Hi again,<br />\n<br />\nSince the last time, I tried to include this code into the CakePHP framework (which I'm currently using) but the Excel file generated is corrupted as if there was unexpected character before the encoding of the XLS.<br />\n<br />\nAfter some researchs, I found that the framework insert a space before printing the view I want. That space corrupts my excel file.<br />\nActually, when I delete this first space with notepad, I'm then able to open and read the Excel file I just downloaded...<br />\n<br />\nI didn't find a way to prevent CakePHP print this space, thus I try to delete it manually before sending out the XLS file.<br />\n<br />\nIs there a way to display the string generated by the <br />\n<pre><code>$objWriter = PHPExcel_IOFactory::createWriter($phpExcel, &quot;Excel5&quot;);</code></pre>\n\nIf yes, I could delete the first character and then send the file without any issue !<br />\n<br />\n<br />\nThanks a lot for your help :]<br />\n<br />\n<br />\nEdit : I just realized my method is not good... The XLS encoding generated by PHPExcel is good. It is what CakePHP adds that generates my issue... I'll try to find a solution on CakePHP's forums.<br />\n",
    "PostedDate": "2013-03-07T01:58:33-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1011717",
    "ThreadId": "435570",
    "Html": "FYI\r<br />\n<br />\nThere was a space after my final &quot;?&gt;&quot; in a class I wrote in my framework. This space was interpreted in HTML and printed !<br />\n",
    "PostedDate": "2013-03-07T04:33:57.28-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]