[
  {
    "Id": "1022445",
    "ThreadId": "438337",
    "Html": "I have used PHPExcel quite a bit. I hadn't worked with it for a while until recently when I revised an earlier file. As far as I can tell I have everything set up right, but I am getting the above error when I try to open the file in Excel and can't tell what the problem is. After closing the error I can open the file in Notepad++ and it shows the usual Excel gibberish. Doing that I was able to debug problems with the data, but now that those are handled, still cannot open the file.\r<br />\n<br />\nHere's my code for setting the properties and writing the file:<br />\n<pre><code>protected function set_excel_properties(){\n        $title = &quot;DNCS Video Upstream Capacity Report&quot;;\n        $this-&gt;vce-&gt;getProperties()-&gt;setCreator(&quot;D Newey&quot;)\n                                     -&gt;setLastModifiedBy(&quot;D Newey&quot;)\n                                     -&gt;setTitle($title)\n                                     -&gt;setSubject($title)\n                                     -&gt;setDescription(&quot;Office 2007 XLSX document for &quot;. $this-&gt;last_we)\n                                     -&gt;setKeywords(&quot;office 2007 openxml php capacity &quot; . $this-&gt;last_we)\n                                     -&gt;setCategory(&quot;DNCS Capacity &quot; . $this-&gt;last_we);  \n        $this-&gt;vce-&gt;setActiveSheetIndex(0);                              \n        }\n\npublic function write_excel(){\n        $this-&gt;vce-&gt;objWriter = PHPExcel_IOFactory::createWriter($this-&gt;vce, 'Excel2007');\n        $this-&gt;vce-&gt;objWriter-&gt;save('php://output');\n        }</code></pre>\n\nI seem to recall there being some particular errors that caused that error message to display when trying to open the file in Excel, but I haven't been able to find anything on the site here. If you need anything else let me know.<br />\n",
    "PostedDate": "2013-03-28T07:55:28.35-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1022468",
    "ThreadId": "438337",
    "Html": "The normal circumstance is that your code is echoing something to php://output (whitespace, BOM header, or error messages being the most common) that can be seen in a text editor; especially if save to disk works and save to php://output doesn't. Failing that, it requires detailed examination of the code an file to identify the problem<br />\n",
    "PostedDate": "2013-03-28T08:25:25.287-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1022495",
    "ThreadId": "438337",
    "Html": "Yes, I was able to locate error messages using the text editor and made sure those were all handled. The last download I tried to create looks like it has white space at the beginning and end. How do I prevent that? Also, how would I recognize a BOM header? Thanks.<br />\n",
    "PostedDate": "2013-03-28T09:04:05.623-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1022657",
    "ThreadId": "438337",
    "Html": "If there's any open/close PHP tags such as &lt;?php and ?&gt; within your script, they can give whitespace; Your IDE/Editor will normally allow you to save a file as UTF-8 with or without BOM markers, ensure that you've saved without... the UTF-8 BOM is \\xEF\\xBB\\xBF<br />\n",
    "PostedDate": "2013-03-28T14:42:46.2-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1022933",
    "ThreadId": "438337",
    "Html": "\r\n<div dir=\"ltr\">All I have are the open and close tags at the beginning and end of the file. I'm not sure I understand what you're saying about the IDE/Editor saving &quot;the file as UTF-8 with or without BOM markers.&quot; How does this apply to generating an Excel\r\n Download from a webpage? Are you saying that BOM markers in the code file would cause it to not generate a clean xlsx file?</div>\r\n<div><br>\r\n<br>\r\n<div></div>\r\n</div>\r\n",
    "PostedDate": "2013-03-29T08:16:13.34-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1023000",
    "ThreadId": "438337",
    "Html": "I am saying exactly that. <strong>Anything</strong> that is output by the script to a browser (ie to php://output), other than the actual output generated by executing the save() will corrupt the file because it will be included as part of the file. Even a trailing newline character after a closing ?&gt; can corrupt a file: that's why none of the PHPExcel scripts themselves have any closing ?&gt;<br />\n",
    "PostedDate": "2013-03-29T11:47:05.063-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1023005",
    "ThreadId": "438337",
    "Html": "\r\n<div dir=\"ltr\">Ok, I guess I'll have to just keep combing through it. The file is writing utf-8 and not creating BOM markers as near as I can tell. It appears to create extra white space, but for the life of me I can't tell where. I don't have a trailing ?&gt;\r\n tag. When I open up the file in Notepad&#43;&#43; white space appears at the top. I've tried removing that and resaving, but that still doesn't work, so I'm at a loss - I'll keep combing.</div>\r\n<div><br>\r\n<br>\r\n<div></div>\r\n</div>\r\n",
    "PostedDate": "2013-03-29T12:00:23.6-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1028678",
    "ThreadId": "438337",
    "Html": "\r\n<div dir=\"ltr\">Mark,\r\n<div><br>\r\n</div>\r\n<div style=\"\">I wanted to let you know that it was a problem with white space which I finally located at the bottom of the extended class. It works fine now.</div>\r\n<div style=\"\"><br>\r\n</div>\r\n<div style=\"\">- David</div>\r\n<div style=\"\"><br>\r\n</div>\r\n<div style=\"\"><br>\r\n</div>\r\n</div>\r\n<div><br>\r\n<br>\r\n<div></div>\r\n</div>\r\n",
    "PostedDate": "2013-04-10T13:46:49.003-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1034394",
    "ThreadId": "438337",
    "Html": "Checkout these reference would be help you:\r<br />\n<br />\n<a href=\"http://social.technet.microsoft.com/Forums/en-US/excel/thread/51bde1c2-ab35-4716-afa9-8e3207b2d7f5/\" rel=\"nofollow\">http://social.technet.microsoft.com/Forums/en-US/excel/thread/51bde1c2-ab35-4716-afa9-8e3207b2d7f5/</a>\r<br />\n<br />\n<a href=\"http://in.answers.yahoo.com/question/index?qid=20091222225206AA9K9uN\" rel=\"nofollow\">http://in.answers.yahoo.com/question/index?qid=20091222225206AA9K9uN</a>\r<br />\n<br />\nIf the above solution did not help you then you can try this third party utility from here: \r<br />\n<br />\n<a href=\"http://www.recoverexcel.org\" rel=\"nofollow\">http://www.recoverexcel.org</a>\r<br />\n<br />\n<br />\nThanks<br />\n",
    "PostedDate": "2013-04-23T02:12:40.11-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1405989",
    "ThreadId": "438337",
    "Html": "Hi,\r<br />\n<br />\nJust wanted to add solution for my recent problem in PHPExcel.\r<br />\nI got error while opening excel because I used scandic in &quot;Set document properties&quot;.\r<br />\nI took me over an hour to solve this issue, but when I removed those 'illegal' letters from properties, everything worked fine again<br />\n",
    "PostedDate": "2015-04-12T11:43:21.087-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]