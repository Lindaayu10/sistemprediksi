[
  {
    "Id": "812435",
    "ThreadId": "349164",
    "Html": "\r\n<p>Hello All,</p>\r\n<p>&nbsp;</p>\r\n<p>Kindly see below code on why ms excel crash after entering some data on D3</p>\r\n<p>&nbsp;</p>\r\n<p></p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre>$workbook = <span style=\"color:blue\">new</span> PHPExcel();\r\n$workbook-&gt;setActiveSheetIndex(0);\r\n$sheet\t= $workbook-&gt;getActiveSheet();\r\n$filename = <span style=\"color:#a31515\">&quot;akel.xls&quot;</span>;\r\n$sheet-&gt;setTitle(<span style=\"color:#a31515\">&quot;akel&quot;</span>);\r\n\r\n<span style=\"color:blue\">for</span> ( $row=2;$row&lt;=10;$row&#43;&#43; ) {\r\n        $objValidation1 = $sheet-&gt;getCell(<span style=\"color:#a31515\">'D'</span>.$row)-&gt;getDataValidation();\r\n        $objValidation1-&gt;setType( PHPExcel_Cell_DataValidation::TYPE_DECIMAL );\r\n        $objValidation1-&gt;setErrorStyle( PHPExcel_Cell_DataValidation::STYLE_INFORMATION );\r\n        $objValidation1-&gt;setAllowBlank(true);\r\n        $objValidation1-&gt;setShowInputMessage(true);\r\n        $objValidation1-&gt;setShowErrorMessage(true);\r\n        $objValidation1-&gt;setErrorTitle(<span style=\"color:#a31515\">'Net Energy Input Error'</span>);\r\n        $objValidation1-&gt;setError(<span style=\"color:#a31515\">'Only numeric entries are allowed.'</span> );\r\n        $objValidation1-&gt;setPromptTitle(<span style=\"color:#a31515\">'Net Energy Input Error'</span>);\r\n        $objValidation1-&gt;setPrompt(<span style=\"color:#a31515\">'Only numeric entries are allowed.'</span> );\r\n\r\n        $objValidation2 = $sheet-&gt;getCell(<span style=\"color:#a31515\">'G'</span>.$row)-&gt;getDataValidation();\r\n        $objValidation2-&gt;setType( PHPExcel_Cell_DataValidation::TYPE_DECIMAL );\r\n        $objValidation2-&gt;setErrorStyle( PHPExcel_Cell_DataValidation::STYLE_INFORMATION );\r\n        $objValidation2-&gt;setAllowBlank(true);\r\n        $objValidation2-&gt;setShowInputMessage(true);\r\n        $objValidation2-&gt;setShowErrorMessage(true);\r\n        $objValidation2-&gt;setErrorTitle(<span style=\"color:#a31515\">'Net Energy Input Error'</span>);\r\n        $objValidation2-&gt;setError(<span style=\"color:#a31515\">'Only numeric entries are allowed.'</span> );\r\n        $objValidation2-&gt;setPromptTitle(<span style=\"color:#a31515\">'Net Energy Input Error'</span>);\r\n        $objValidation2-&gt;setPrompt(<span style=\"color:#a31515\">'Only numeric entries are allowed.'</span> );\r\n\r\n        $objValidation = $sheet-&gt;getCell(<span style=\"color:#a31515\">'E'</span>.$row)-&gt;getDataValidation();\r\n        $objValidation-&gt;setType( PHPExcel_Cell_DataValidation::TYPE_LIST );\r\n        $objValidation-&gt;setErrorStyle( PHPExcel_Cell_DataValidation::STYLE_INFORMATION );\r\n        $objValidation-&gt;setAllowBlank(false);\r\n        $objValidation-&gt;setShowInputMessage(true);\r\n        $objValidation-&gt;setShowErrorMessage(true);\r\n        $objValidation-&gt;setShowDropDown(true);\r\n        $objValidation-&gt;setErrorTitle(<span style=\"color:#a31515\">'Input error'</span>);\r\n        $objValidation-&gt;setError(<span style=\"color:#a31515\">'Value is not in list.'</span>);\r\n        $objValidation-&gt;setPromptTitle(<span style=\"color:#a31515\">'Pick from list'</span>);\r\n        $objValidation-&gt;setPrompt(<span style=\"color:#a31515\">'Please pick a value from the drop-down list.'</span>);\r\n        $objValidation-&gt;setFormula1(<span style=\"color:#a31515\">'&quot;Available,Scheduled Outage&quot;'</span>);\r\n        $sheet-&gt;setCellValue(<span style=\"color:#a31515\">'H'</span>.$row,<span style=\"color:#a31515\">'Available'</span>);\r\n\r\n        $objValidation = $sheet-&gt;getCell(<span style=\"color:#a31515\">'H'</span>.$row)-&gt;getDataValidation();\r\n        $objValidation-&gt;setType( PHPExcel_Cell_DataValidation::TYPE_LIST );\r\n        $objValidation-&gt;setErrorStyle( PHPExcel_Cell_DataValidation::STYLE_INFORMATION );\r\n        $objValidation-&gt;setAllowBlank(false);\r\n        $objValidation-&gt;setShowInputMessage(true);\r\n        $objValidation-&gt;setShowErrorMessage(true);\r\n        $objValidation-&gt;setShowDropDown(true);\r\n        $objValidation-&gt;setErrorTitle(<span style=\"color:#a31515\">'Input error'</span>);\r\n        $objValidation-&gt;setError(<span style=\"color:#a31515\">'Value is not in list.'</span>);\r\n        $objValidation-&gt;setPromptTitle(<span style=\"color:#a31515\">'Pick from list'</span>);\r\n        $objValidation-&gt;setPrompt(<span style=\"color:#a31515\">'Please pick a value from the drop-down list.'</span>);\r\n        $objValidation-&gt;setFormula1(<span style=\"color:#a31515\">'&quot;Available,Scheduled Outage&quot;'</span>);\r\n}\r\n\r\nheader(<span style=\"color:#a31515\">'Content-Type: application/vnd.ms-excel'</span>);\r\nheader(<span style=\"color:#a31515\">'Content-Disposition: attachment;filename=&quot;'</span>.$filename.<span style=\"color:#a31515\">'&quot;'</span>);\r\n\r\n$objWriter = PHPExcel_IOFactory::createWriter($workbook,<span style=\"color:#a31515\">'Excel5'</span>);\r\n$objWriter-&gt;save(<span style=\"color:#a31515\">'php://output'</span>);\r\n</pre>\r\n</div>\r\n<p></p>\r\n<p>&nbsp;</p>\r\n<p>Thank you.</p>\r\n",
    "PostedDate": "2012-03-19T04:47:27.637-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]