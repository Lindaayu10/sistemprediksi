[
  {
    "Id": "905135",
    "ThreadId": "393362",
    "Html": "\r\n<p>Hello,</p>\r\n<p>&nbsp; &nbsp; &nbsp; Currently I am trying to read a workbook, sheet for sheet, and insert the data into my DB. How would I go about getting the values from the second, third sheet ,etc.......and insert the values for them. I have written code that will\r\n read a workbook and return the values. My problem is just getting values from the workbook excluding page 1. With that said, my workbook has 6 worksheets and data from each sheet goes to different tables in my database. Furthermore, my worksheets have pre-defined\r\n sheet names if that helps. Having said all of that, I know that I have to use Insert Into in order to insert values into my DB.&nbsp;Any input would be greatly appreciated! Thanks in advance!&nbsp;Here is my code so far....&nbsp;</p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre><span style=\"color:blue\">require_once</span> <span style=\"color:#a31515\">'PHPExcel/IOFactory.php'</span>;\n$objPHPExcel = PHPExcel_IOFactory::load(<span style=\"color:#a31515\">'.'</span>);\n<span style=\"color:blue\">foreach</span> ($objPHPExcel-&gt;getWorksheetIterator() <span style=\"color:blue\">as</span> $worksheet) {\n    $worksheetTitle     = $worksheet-&gt;getTitle();\n    $highestRow         = $worksheet-&gt;getHighestRow(); \n    $highestColumn      = $worksheet-&gt;getHighestColumn(); \n    $highestColumnIndex = PHPExcel_Cell::columnIndexFromString($highestColumn);\n    $nrColumns = ord($highestColumn) - 64;\n    <span style=\"color:blue\">echo</span> <span style=\"color:#a31515\">&quot;&lt;br&gt;The worksheet &quot;</span>.$worksheetTitle.<span style=\"color:#a31515\">&quot; has &quot;</span>;\n    <span style=\"color:blue\">echo</span> $nrColumns . <span style=\"color:#a31515\">' columns (A-'</span> . $highestColumn . <span style=\"color:#a31515\">') '</span>;\n    <span style=\"color:blue\">echo</span> <span style=\"color:#a31515\">' and '</span> . $highestRow . <span style=\"color:#a31515\">' row.'</span>;\n    <span style=\"color:blue\">echo</span> <span style=\"color:#a31515\">'&lt;br&gt;Data: &lt;table border=&quot;1&quot;&gt;&lt;tr&gt;'</span>;\n    <span style=\"color:blue\">for</span> ($row = 1; $row &lt;= $highestRow; &#43;&#43; $row) {\n        <span style=\"color:blue\">echo</span> <span style=\"color:#a31515\">'&lt;tr&gt;'</span>;\n        <span style=\"color:blue\">for</span> ($col = 0; $col &lt; $highestColumnIndex; &#43;&#43; $col) {\n            $cell = $worksheet-&gt;getCellByColumnAndRow($col, $row);\n            $val = $cell-&gt;getValue();\n            $dataType = PHPExcel_Cell_DataType::dataTypeForValue($val);\n            <span style=\"color:blue\">echo</span> <span style=\"color:#a31515\">'&lt;td&gt;'</span> . $val . <span style=\"color:#a31515\">'&lt;br&gt;&lt;/td&gt;'</span>;\n          }\n           <span style=\"color:blue\">echo</span> <span style=\"color:#a31515\">'&lt;/tr&gt;'</span>;\n        }\n      <span style=\"color:blue\">echo</span> <span style=\"color:#a31515\">'&lt;/table&gt;'</span>;\n</pre>\r\n<pre><br></pre>\r\n<pre><br></pre>\r\n<pre><br></pre>\r\n<pre><br></pre>\r\n<pre><br></pre>\r\n</div>\r\n",
    "PostedDate": "2012-08-28T07:42:10.527-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1084433",
    "ThreadId": "393362",
    "Html": "$cellValueAsString='';<br />\n<pre><code>                echo '&lt;br &gt;'.'&lt;table&gt;' . &quot;\\n&quot;;\n                    foreach ($objPHPExcel-&gt;getWorksheetIterator() as $sheet) {\n                        //print_r($sheet);\n                        $highestRow =$sheet-&gt;getHighestRow(); // e.g. 10\n                        //$highestColumn ='M'; // e.g 'F'\n                        $highestColumn =$sheet-&gt;getHighestColumn(); // e.g 'F'\n                        $highestColumnIndex = PHPExcel_Cell::columnIndexFromString($highestColumn); // e.g. 5\n\n                        for ($row = 2; $row &lt;= $highestRow; ++$row) {\n                          echo '&lt;tr&gt;' . &quot;\\n&quot;;\n                          for ($col = 1; $col &lt;= $highestColumnIndex; ++$col) {\n                              $option=$sheet-&gt;getCellByColumnAndRow($col, $row)-&gt;getValue();\n                                if ($option instanceof PHPExcel_RichText) {\n                                    $elementrfs = $option-&gt;getRichTextElements();\n                                    // Loop through rich text elements\n                                    foreach ($elementrfs as $element) {\n                                        if ($element instanceof PHPExcel_RichText_Run) {\n\n                                            if ($element-&gt;getFont()-&gt;getSuperScript()) {\n                                                $cellValueAsString .= '&lt;sup&gt;';\n                                            } else if ($element-&gt;getFont()-&gt;getSubScript()) {\n                                                $cellValueAsString .= '&lt;sub&gt;';\n                                            }\n                                        }\n                                         // Convert UTF8 data to PCDATA\n                                        $cellText = $element-&gt;getText();\n                                        $cellValueAsString .= htmlspecialchars($cellText);\n                                        if ($element instanceof PHPExcel_RichText_Run) {\n                                            if ($element-&gt;getFont()-&gt;getSuperScript()) {\n                                                $cellValueAsString .= '&lt;/sup&gt;';\n                                            } else if ($element-&gt;getFont()-&gt;getSubScript()) {\n                                                $cellValueAsString .= '&lt;/sub&gt;';\n                                            }\n                                        }\n                                    }\n                                      echo '&lt;td&gt;'.$cellValueAsString . '&lt;/td&gt;' . &quot;\\n&quot;;\n                                }\n                                else\n                                {\n                                    echo '&lt;td&gt;'.$option.'&lt;/td&gt;';\n                                }\n                            }\n                      echo '&lt;/tr&gt;';\n                    }\n\n                    }echo '&lt;/table&gt;' . &quot;\\n&quot;;\n\n\n\n\n</code></pre>\n\nI want  to get superscript and subscript values in each cell value in separately. And how to validate each cell values and  insert these values in mysql table.Please clearly explained with exapmples.<br />\n<br />\n<br />\nThanks in advance.<br />\n",
    "PostedDate": "2013-08-24T04:29:41.773-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1084495",
    "ThreadId": "393362",
    "Html": "This doesn't address the superscript/subscript portion but it will give you a working example that inserts data into MySQL tables.<br />\n<br />\n<a href=\"https://phpexcel.codeplex.com/discussions/453644\" rel=\"nofollow\">https://phpexcel.codeplex.com/discussions/453644</a><br />\n<ul>\n<li>Christopher Mullins</li>\n</ul>\n",
    "PostedDate": "2013-08-24T10:58:08.727-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]