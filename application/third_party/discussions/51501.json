[
  {
    "Id": "172729",
    "ThreadId": "51501",
    "Html": "Well, there is an example on how to use RichText:<br>\r\n(from dev documentation)<br>\r\n<br>\r\n<br>\r\n<div style=\"border:1pt dotted windowtext;padding:1pt 4pt;background:#f3f3f3 none repeat scroll 0% 0%\">\r\n<p><span lang=EN-GB>$objRichText = new PHPExcel_RichText(\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getCell('A18') );</span></p>\r\n<p><span lang=EN-GB>$objRichText-&gt;createText('This invoice is ');</span></p>\r\n<p><span lang=EN-GB>&lt;o:p&gt;&nbsp;&lt;/o:p&gt;</span></p>\r\n<p><span lang=EN-GB>$objPayable =\r\n$objRichText-&gt;createTextRun('payable within thirty days after the end of the\r\nmonth');</span></p>\r\n<p><span lang=EN-GB>$objPayable-&gt;getFont()-&gt;setBold(true);</span></p>\r\n<p><span lang=EN-GB>$objPayable-&gt;getFont()-&gt;setItalic(true);</span></p>\r\n<p><span lang=EN-GB>$objPayable-&gt;getFont()-&gt;setColor( new\r\nPHPExcel_Style_Color( PHPExcel_Style_Color::COLOR_DARKGREEN ) );</span></p>\r\n<p><span lang=EN-GB>&lt;o:p&gt;&nbsp;&lt;/o:p&gt;</span></p>\r\n<p><span lang=EN-GB>$objRichText-&gt;createText(', unless specified\r\notherwise on the invoice.');</span></p>\r\n</div>\r\n<br>\r\nas i see, <img alt=\"\"><img alt=\"\">$objRichText corresponds to A18 cell. <br>\r\n<br>\r\nfirst of all, i'd like to create $objRichText object, then fill it with content and styles. and after all set the cell it should be corresponded with.<br>\r\nis there any ways to set it independent from creating object?<br>\r\n",
    "PostedDate": "2009-03-27T05:42:06.303-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "173332",
    "ThreadId": "51501",
    "Html": "You can create an &quot;orphan&quot; <span lang=EN-GB>PHPExcel_RichText</span> and then later assign it to a cell:<br>\r\n<br>\r\n<code>\r\n$objRichText = new PHPExcel_RichText();<br>\r\n$objRichText-&gt;createText('This invoice is ');<br>\r\n$objPayable = $objRichText-&gt;createTextRun('payable within thirty days after the end of the month');<br>\r\n$objPayable-&gt;getFont()-&gt;setBold(true);<br>\r\n$objPayable-&gt;getFont()-&gt;setItalic(true);<br>\r\n$objPayable-&gt;getFont()-&gt;setColor( new PHPExcel_Style_Color( PHPExcel_Style_Color::COLOR_DARKGREEN ) );<br>\r\n$objRichText-&gt;createText(', unless specified otherwise on the invoice.');<br>\r\n<br>\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getCell('A18')-&gt;setValue($objRichText);<br>\r\n</code>\r\n<br>\r\nHowever, watch out if you assign the same Rich-Text object to several cells. This could give some confusion in your script.<br>\r\n<br>\r\n",
    "PostedDate": "2009-03-29T22:36:27.537-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "173376",
    "ThreadId": "51501",
    "Html": "it works, thanks!<br>\r\n<br>\r\nbtw, <br>\r\n<code>$objPHPExcel-&gt;getActiveSheet()-&gt;getCell('A18')-&gt;setValue($objRichText);<br>\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getCell('B19')-&gt;setValue($objRichText);<br>\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getCell('C20')-&gt;setValue($objRichText);<br>\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getCell('D21')-&gt;setValue($objRichText);</code><br>\r\nmake <code>$objRichText</code> seems like it shoud be. <br>\r\n<br>\r\nwhat kind of confusion do you mean? <br>\r\n",
    "PostedDate": "2009-03-30T01:25:43.79-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "173457",
    "ThreadId": "51501",
    "Html": "&gt;&gt; what kind of confusion do you mean?<br>\r\n<br>\r\nWhat I had in mind was just that sharing <code>$objRichText</code> between cells this way is not really documented. It might be safer to do like this, so each cell has its own Rich-Text object.<br>\r\n<code><br>\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getCell('A18')-&gt;setValue(clone $objRichText);<br>\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getCell('B19')-&gt;setValue(<code>clone </code>$objRichText);<br>\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getCell('C20')-&gt;setValue(<code>clone </code>$objRichText);<br>\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getCell('D21')-&gt;setValue(<code>clone </code>$objRichText);</code><br>\r\n<br>\r\nBut if the other thing works, I would not worry too much about this.<br>\r\n",
    "PostedDate": "2009-03-30T06:44:36.763-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "173465",
    "ThreadId": "51501",
    "Html": "I understand the difference.<br>\r\n<br>\r\nOK, if something goes wrong - I'll tell, but some tests resulted without errors.<br>\r\n<br>\r\nThanks any way.<br>\r\n",
    "PostedDate": "2009-03-30T06:59:47.617-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "237543",
    "ThreadId": "51501",
    "Html": "<p>Is there a reason that I am unable to create <span lang=EN-GB>$objRichText = new PHPExcel_RichText( $objPHPExcel-&gt;getActiveSheet()-&gt;getCell('A18') ); twice on the same page for different cells on different sheets?</span></p>",
    "PostedDate": "2009-09-22T15:11:24.187-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "237548",
    "ThreadId": "51501",
    "Html": "<p>@gknight:</p>\r\n<p>Can you post a complete example?</p>",
    "PostedDate": "2009-09-22T15:32:47.717-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "237549",
    "ThreadId": "51501",
    "Html": "<p>I am presently trying to get the &quot;orphan&quot; plan to work for me, but it is putting the first value over and over instead of overwriting each time in the loop</p>",
    "PostedDate": "2009-09-22T15:38:43.61-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "237551",
    "ThreadId": "51501",
    "Html": "<p>oops, forgot the code.....................</p>\r\n<p>&lt;?php<br>session_start();<br>require_once('../../Connections/bgo.php');<br>mysql_select_db($database_bgo, $bgo);<br>$sub_total = 0;<br>$discounts = 0;<br>$points = 0;<br>$shipping = 0;<br>$taxes = 0;<br>$total = 0;</p>\r\n<p>$accent = array(&quot;&Agrave;&quot;, &quot;&agrave;&quot;, &quot;&Aacute;&quot;, &quot;&aacute;&quot;, &quot;&Auml;&quot;, &quot;&auml;&quot;, &quot;&Acirc;&quot;, &quot;&acirc;&quot;, &quot;&Ccedil;&quot;, &quot;&ccedil;&quot;, &quot;&Egrave;&quot;, &quot;&egrave;&quot;, &quot;&Eacute;&quot;, &quot;&eacute;&quot;, &quot;&Euml;&quot;, &quot;&euml;&quot;, &quot;&Ecirc;&quot;, &quot;&ecirc;&quot;, &quot;&Iuml;&quot;, &quot;&iuml;&quot;, &quot;&Icirc;&quot;, &quot;&icirc;&quot;, &quot;&Ocirc;&quot;, &quot;&ocirc;&quot;, &quot;&Ugrave;&quot;, &quot;&ugrave;&quot;, &quot;&Uuml;&quot;, &quot;&uuml;&quot;, &quot;&Ucirc;&quot;, &quot;&ucirc;&quot;);<br>$character = array(&quot;&amp;Agrave;&quot;, &quot;&amp;agrave;&quot;, &quot;&amp;Aacute;&quot;, &quot;&amp;aacute;&quot;, &quot;&amp;Auml;&quot;, &quot;&amp;auml;&quot;, &quot;&amp;Acirc;&quot;, &quot;&amp;acirc;&quot;, &quot;&amp;Ccedil;&quot;, &quot;&amp;ccedil;&quot;, &quot;&amp;Egrave;&quot;, &quot;&amp;egrave;&quot;, &quot;&amp;Eacute;&quot;, &quot;&amp;eacute;&quot;, &quot;&amp;Euml;&quot;, &quot;&amp;euml;&quot;, &quot;&amp;Ecirc;&quot;, &quot;&amp;ecirc;&quot;, &quot;&amp;Iuml;&quot;, &quot;&amp;iuml;&quot;, &quot;&amp;Icirc;&quot;, &quot;&amp;icirc;&quot;, &quot;&amp;Ocirc;&quot;, &quot;&amp;ocirc;&quot;, &quot;&amp;Ugrave;&quot;, &quot;&amp;ugrave;&quot;, &quot;&amp;Uuml;&quot;, &quot;&amp;uuml;&quot;, &quot;&amp;Ucirc;&quot;, &quot;&amp;ucirc;&quot;);</p>\r\n<p>if(isset($_REQUEST['length']) &amp;&amp; $_REQUEST['length'] != &quot;&quot;)<br>{<br>&nbsp;switch($_REQUEST['length']) {<br>&nbsp;&nbsp;case &quot;1&quot;:<br>&nbsp;&nbsp;&nbsp;$orderDateSql = &quot;SELECT * FROM order_totals WHERE date &gt;= '&quot;.$_REQUEST['sdate'].&quot;' AND date &lt;= '&quot;.$_REQUEST['edate'].&quot;' ORDER BY date, orderid&quot;;<br>&nbsp;&nbsp;&nbsp;break;<br>&nbsp;&nbsp;case &quot;2&quot;;<br>&nbsp;&nbsp;&nbsp;$orderDateSql = &quot;SELECT * FROM order_totals WHERE date &gt;= '&quot;.$_REQUEST['past'].&quot;-01-01' AND date &lt;= '&quot;.$_REQUEST['past'].&quot;-12-31' ORDER BY date, orderid&quot;;<br>&nbsp;&nbsp;&nbsp;break;<br>&nbsp;&nbsp;case &quot;3&quot;;<br>&nbsp;&nbsp;&nbsp;$orderDateSql = &quot;SELECT * FROM order_totals WHERE date &gt;= '&quot;.date(&quot;Y&quot;).&quot;-01-01' AND date &lt;= '&quot;.date(&quot;Y-m-d&quot;).&quot;' ORDER BY date, orderid&quot;;<br>&nbsp;&nbsp;&nbsp;break;<br>&nbsp;&nbsp;case &quot;4&quot;:<br>&nbsp;&nbsp;&nbsp;$orderDateSql = &quot;SELECT * FROM order_totals ORDER BY date, orderid&quot;;<br>&nbsp;&nbsp;&nbsp;break;<br>&nbsp;}<br>&nbsp;require_once &quot;../Classes/PHPExcel.php&quot;;<br>&nbsp;require_once &quot;../Classes/PHPExcel/RichText.php&quot;;<br>&nbsp;<br>&nbsp;$dateTime = date(&quot;Y-m-d H:i:s&quot;);<br>&nbsp;$objPHPExcel = new PHPExcel();<br>&nbsp;$objPHPExcel-&gt;getProperties()-&gt;setCreator(&quot;BuyGreenOnline&quot;)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -&gt;setLastModifiedBy(&quot;BuyGReenOnline&quot;)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -&gt;setTitle(&quot;Sales report generated &quot;.$dateTime)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -&gt;setSubject(&quot;Sales report generated &quot;.$dateTime)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -&gt;setDescription(&quot;Sales report generated &quot;.$dateTime)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -&gt;setKeywords(&quot;Sales report generated &quot;.$dateTime)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -&gt;setCategory(&quot;Sales report generated &quot;.$dateTime);<br>&nbsp;$i=0;<br>&nbsp;$orderDateQuery = mysql_query($orderDateSql) or die($orderDateSql.&quot;&lt;br&gt;&lt;br&gt;&quot;.mysql_error());<br>&nbsp;$orderDateNumRows = mysql_num_rows($orderDateQuery);<br>&nbsp;<br>&nbsp;if($orderDateNumRows &gt; 0)<br>&nbsp;{<br>&nbsp;&nbsp;$objRichText = new PHPExcel_RichText();<br>&nbsp;&nbsp;while($row_orderDate = mysql_fetch_assoc($orderDateQuery))<br>&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;$i++;<br>&nbsp;&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('A'.$i, 'Order Number');<br>&nbsp;&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('B'.$i, $row_orderDate['orderid']);<br>&nbsp;&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('E'.$i, 'Date');<br>&nbsp;&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('F'.$i, $row_orderDate['date']);<br>&nbsp;&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('A'.$i.':F'.$i)-&gt;applyFromArray(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;array(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'font'&nbsp;&nbsp;&nbsp; =&gt; array(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'bold'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; =&gt; true<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'borders' =&gt; array(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'top'&nbsp;&nbsp;&nbsp;&nbsp; =&gt; array(<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'style' =&gt; PHPExcel_Style_Border::BORDER_THIN<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;), <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'bottom'&nbsp;&nbsp;&nbsp;&nbsp; =&gt; array(<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'style' =&gt; PHPExcel_Style_Border::BORDER_THIN<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'fill' =&gt; array(<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;'type'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; =&gt; PHPExcel_Style_Fill::FILL_GRADIENT_LINEAR,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;'rotation'&nbsp;&nbsp; =&gt; 90,<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;'startcolor' =&gt; array(<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;'argb' =&gt; 'FFA0A0A0'<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;),<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;'endcolor'&nbsp;&nbsp; =&gt; array(<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;'argb' =&gt; 'FFFFFFFF'<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;)<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br>&nbsp;&nbsp;&nbsp;);<br>&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('A'.$i)-&gt;applyFromArray(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;array(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'alignment' =&gt; array(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'horizontal' =&gt; PHPExcel_Style_Alignment::HORIZONTAL_LEFT,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'borders' =&gt; array(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'left'&nbsp;&nbsp;&nbsp;&nbsp; =&gt; array(<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'style' =&gt; PHPExcel_Style_Border::BORDER_THIN<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br>&nbsp;&nbsp;&nbsp;);<br>&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('E'.$i)-&gt;applyFromArray(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;array(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'alignment' =&gt; array(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'horizontal' =&gt; PHPExcel_Style_Alignment::HORIZONTAL_LEFT,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br>&nbsp;&nbsp;&nbsp;);</p>\r\n<p>&nbsp;&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('F'.$i)-&gt;applyFromArray(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;array(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'borders' =&gt; array(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'right'&nbsp;&nbsp;&nbsp;&nbsp; =&gt; array(<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'style' =&gt; PHPExcel_Style_Border::BORDER_THIN<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br>&nbsp;&nbsp;&nbsp;);<br>&nbsp;&nbsp;&nbsp;$i++;<br>&nbsp;&nbsp;&nbsp;$orderDetailSql = &quot;SELECT * FROM order_details WHERE orderid=&quot;.$row_orderDate['orderid'];<br>&nbsp;&nbsp;&nbsp;$orderDetailQuery = mysql_query($orderDetailSql) or die($orderDetailSql.&quot;&lt;br&gt;&lt;br&gt;&quot;.mysql_error());<br>&nbsp;&nbsp;&nbsp;while($row_orderDetail = mysql_fetch_assoc($orderDetailQuery))<br>&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;$objRichText-&gt;createText($row_orderDetail['sku']);<br>&nbsp;&nbsp;&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;getCell('A'.$i)-&gt;setValue($objRichText);<br>&nbsp;&nbsp;&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('B'.$i, utf8_encode(str_replace($character, $accent, $row_orderDetail['name'])));<br>&nbsp;&nbsp;&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('C'.$i, utf8_encode(str_replace($character, $accent, $row_orderDetail['orderoption'])));<br>&nbsp;&nbsp;&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('D'.$i, $row_orderDetail['qty']);<br>&nbsp;&nbsp;&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('E'.$i, $row_orderDetail['price']);<br>&nbsp;&nbsp;&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('F'.$i, '=D'.$i.'*E'.$i);<br>&nbsp;&nbsp;&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('E'.$i.':F'.$i)-&gt;getNumberFormat()-&gt;setFormatCode(PHPExcel_Style_NumberFormat::FORMAT_CURRENCY_USD_SIMPLE);<br>&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('A'.$i.':E'.$i)-&gt;applyFromArray(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;array(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'alignment' =&gt; array(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'horizontal' =&gt; PHPExcel_Style_Alignment::HORIZONTAL_LEFT,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br>&nbsp;&nbsp;&nbsp;&nbsp;);<br>&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;$i++;<br>&nbsp;&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('E'.$i, 'Sub-Total');<br>&nbsp;&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('F'.$i, $row_orderDate['subtotal']);<br>&nbsp;&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('E'.$i.':F'.$i)-&gt;getNumberFormat()-&gt;setFormatCode(PHPExcel_Style_NumberFormat::FORMAT_CURRENCY_USD_SIMPLE);<br>&nbsp;&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('E'.$i.':F'.$i)-&gt;applyFromArray(array('font'=&gt;array('bold'=&gt;true)));<br>&nbsp;&nbsp;&nbsp;$i++;<br>&nbsp;&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('E'.$i, 'Coupon('.$row_orderDate['coupon'].')');<br>&nbsp;&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('F'.$i, '-'.$row_orderDate['discount']);<br>&nbsp;&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('E'.$i.':F'.$i)-&gt;getNumberFormat()-&gt;setFormatCode(PHPExcel_Style_NumberFormat::FORMAT_CURRENCY_USD_SIMPLE);<br>&nbsp;&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('E'.$i.':F'.$i)-&gt;applyFromArray(array('font'=&gt;array('bold'=&gt;true)));<br>&nbsp;&nbsp;&nbsp;$i++;<br>&nbsp;&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('E'.$i, 'Points');<br>&nbsp;&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('F'.$i, '-'.$row_orderDate['points']);<br>&nbsp;&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('E'.$i.':F'.$i)-&gt;getNumberFormat()-&gt;setFormatCode(PHPExcel_Style_NumberFormat::FORMAT_CURRENCY_USD_SIMPLE);<br>&nbsp;&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('E'.$i.':F'.$i)-&gt;applyFromArray(array('font'=&gt;array('bold'=&gt;true)));<br>&nbsp;&nbsp;&nbsp;$i++;<br>&nbsp;&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('E'.$i, 'Shipping');<br>&nbsp;&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('F'.$i, $row_orderDate['shipping']);<br>&nbsp;&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('E'.$i.':F'.$i)-&gt;getNumberFormat()-&gt;setFormatCode(PHPExcel_Style_NumberFormat::FORMAT_CURRENCY_USD_SIMPLE);<br>&nbsp;&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('E'.$i.':F'.$i)-&gt;applyFromArray(array('font'=&gt;array('bold'=&gt;true)));<br>&nbsp;&nbsp;&nbsp;$i++;<br>&nbsp;&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('E'.$i, 'Taxes');<br>&nbsp;&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('F'.$i, $row_orderDate['taxes']);<br>&nbsp;&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('E'.$i.':F'.$i)-&gt;getNumberFormat()-&gt;setFormatCode(PHPExcel_Style_NumberFormat::FORMAT_CURRENCY_USD_SIMPLE);<br>&nbsp;&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('E'.$i.':F'.$i)-&gt;applyFromArray(array('font'=&gt;array('bold'=&gt;true)));<br>&nbsp;&nbsp;&nbsp;$i++;<br>&nbsp;&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('E'.$i, 'Total');<br>&nbsp;&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('F'.$i, $row_orderDate['total']);<br>&nbsp;&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('E'.$i.':F'.$i)-&gt;getNumberFormat()-&gt;setFormatCode(PHPExcel_Style_NumberFormat::FORMAT_CURRENCY_USD_SIMPLE);<br>&nbsp;&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('E'.$i.':F'.$i)-&gt;applyFromArray(array('font'=&gt;array('bold'=&gt;true)));<br>&nbsp;&nbsp;&nbsp;$i++;<br>&nbsp;&nbsp;}<br>&nbsp;&nbsp;<br>&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;setTitle('Order List');<br>&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension('A')-&gt;setWidth(15);<br>&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension('B')-&gt;setWidth(30);<br>&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension('C')-&gt;setWidth(30);<br>&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension('D')-&gt;setWidth(8);<br>&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension('E')-&gt;setWidth(20);<br>&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension('F')-&gt;setWidth(12);<br>&nbsp;&nbsp;<br>&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;getPageSetup()-&gt;setOrientation(PHPExcel_Worksheet_PageSetup::ORIENTATION_PORTRAIT);<br>&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;getPageSetup()-&gt;setPaperSize(PHPExcel_Worksheet_PageSetup::PAPERSIZE_A4);<br>&nbsp;&nbsp;<br>&nbsp;&nbsp;//SHEET 2<br>&nbsp;&nbsp;$objPHPExcel-&gt;createSheet();<br>&nbsp;&nbsp;$objPHPExcel-&gt;setActiveSheetIndex(1);<br>&nbsp;&nbsp;$j=1;<br>&nbsp;&nbsp;<br>&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('A'.$j, 'Date');<br>&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('B'.$j, 'Order');<br>&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('C'.$j, 'Coupon Code');<br>&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('D'.$j, 'Discount');<br>&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('E'.$j, 'Points');<br>&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('F'.$j, 'Sub-Total');<br>&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('G'.$j, 'Shipping');<br>&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('H'.$j, 'Taxes');<br>&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('I'.$j, 'Total');</p>\r\n<p>&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('A'.$j.':I'.$j)-&gt;applyFromArray(<br>&nbsp;&nbsp;&nbsp;&nbsp;array(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'font'&nbsp;&nbsp;&nbsp; =&gt; array(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'bold'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; =&gt; true<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'borders' =&gt; array(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'top'&nbsp;&nbsp;&nbsp;&nbsp; =&gt; array(<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'style' =&gt; PHPExcel_Style_Border::BORDER_THIN<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;), <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'bottom'&nbsp;&nbsp;&nbsp;&nbsp; =&gt; array(<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'style' =&gt; PHPExcel_Style_Border::BORDER_THIN<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'fill' =&gt; array(<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;'type'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; =&gt; PHPExcel_Style_Fill::FILL_GRADIENT_LINEAR,<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;'rotation'&nbsp;&nbsp; =&gt; 90,<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;'startcolor' =&gt; array(<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;'argb' =&gt; 'FFA0A0A0'<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;),<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;'endcolor'&nbsp;&nbsp; =&gt; array(<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;'argb' =&gt; 'FFFFFFFF'<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;)<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;)<br>&nbsp;&nbsp;&nbsp;&nbsp;)<br>&nbsp;&nbsp;);</p>\r\n<p>&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('I'.$i)-&gt;applyFromArray(<br>&nbsp;&nbsp;&nbsp;&nbsp;array(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'borders' =&gt; array(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'right'&nbsp;&nbsp;&nbsp;&nbsp; =&gt; array(<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'style' =&gt; PHPExcel_Style_Border::BORDER_THIN<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br>&nbsp;&nbsp;&nbsp;&nbsp;)<br>&nbsp;&nbsp;);</p>\r\n<p>&nbsp;&nbsp;$j++;<br>&nbsp;&nbsp;$skuSql = &quot;SELECT * FROM order_totals ORDER BY orderid&quot;;<br>&nbsp;&nbsp;$skuQuery = mysql_query($skuSql) or die($skuSql.&quot;&lt;br&gt;&lt;br&gt;&quot;.mysql_error());<br>&nbsp;&nbsp;while($row_sku = mysql_fetch_assoc($skuQuery))<br>&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('A'.$j, $row_sku['date']);<br>&nbsp;&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('B'.$j, $row_sku['orderid']);<br>&nbsp;&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('C'.$j, $row_sku['coupon']);<br>&nbsp;&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('D'.$j, $row_sku['discount']);<br>&nbsp;&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('D'.$j)-&gt;getNumberFormat()-&gt;setFormatCode(PHPExcel_Style_NumberFormat::FORMAT_CURRENCY_USD_SIMPLE&nbsp;);<br>&nbsp;&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('E'.$j, $row_sku['points']);<br>&nbsp;&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('F'.$j, $row_sku['subtotal']);<br>&nbsp;&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('F'.$j)-&gt;getNumberFormat()-&gt;setFormatCode(PHPExcel_Style_NumberFormat::FORMAT_CURRENCY_USD_SIMPLE&nbsp;);<br>&nbsp;&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('G'.$j, $row_sku['shipping']);<br>&nbsp;&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('G'.$j)-&gt;getNumberFormat()-&gt;setFormatCode(PHPExcel_Style_NumberFormat::FORMAT_CURRENCY_USD_SIMPLE&nbsp;);<br>&nbsp;&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('H'.$j, $row_sku['taxes']);<br>&nbsp;&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('H'.$j)-&gt;getNumberFormat()-&gt;setFormatCode(PHPExcel_Style_NumberFormat::FORMAT_CURRENCY_USD_SIMPLE&nbsp;);<br>&nbsp;&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('I'.$j, $row_sku['total']);<br>&nbsp;&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('I'.$j)-&gt;getNumberFormat()-&gt;setFormatCode(PHPExcel_Style_NumberFormat::FORMAT_CURRENCY_USD_SIMPLE&nbsp;);<br>&nbsp;&nbsp;&nbsp;$j++;<br>&nbsp;&nbsp;}<br>&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension('A')-&gt;setWidth(15);<br>&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension('B')-&gt;setWidth(8);<br>&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension('C')-&gt;setWidth(15);<br>&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension('D')-&gt;setWidth(10);<br>&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension('E')-&gt;setWidth(8);<br>&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension('F')-&gt;setWidth(10);<br>&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension('G')-&gt;setWidth(10);<br>&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension('H')-&gt;setWidth(10);<br>&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension('I')-&gt;setWidth(10);</p>\r\n<p>&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;getPageSetup()-&gt;setOrientation(PHPExcel_Worksheet_PageSetup::ORIENTATION_PORTRAIT);<br>&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;getPageSetup()-&gt;setPaperSize(PHPExcel_Worksheet_PageSetup::PAPERSIZE_A4);<br>&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;setTitle('Order Details');<br>&nbsp;&nbsp;<br>&nbsp;&nbsp;//SHEET 3<br>&nbsp;&nbsp;$objPHPExcel-&gt;createSheet();<br>&nbsp;&nbsp;$objPHPExcel-&gt;setActiveSheetIndex(2);<br>&nbsp;&nbsp;$k=1;<br>&nbsp;&nbsp;<br>&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('A'.$k, 'Bar Code');<br>&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('B'.$k, 'Order');<br>&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('C'.$k, 'Product');<br>&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('D'.$k, 'Option');<br>&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('E'.$k, 'Qty');<br>&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('F'.$k, 'Price');<br>&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('A'.$k.':F'.$k)-&gt;applyFromArray(<br>&nbsp;&nbsp;&nbsp;&nbsp;array(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'font'&nbsp;&nbsp;&nbsp; =&gt; array(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'bold'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; =&gt; true<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'borders' =&gt; array(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'top'&nbsp;&nbsp;&nbsp;&nbsp; =&gt; array(<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'style' =&gt; PHPExcel_Style_Border::BORDER_THIN<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;), <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'bottom'&nbsp;&nbsp;&nbsp;&nbsp; =&gt; array(<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'style' =&gt; PHPExcel_Style_Border::BORDER_THIN<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'fill' =&gt; array(<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;'type'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; =&gt; PHPExcel_Style_Fill::FILL_GRADIENT_LINEAR,<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;'rotation'&nbsp;&nbsp; =&gt; 90,<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;'startcolor' =&gt; array(<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;'argb' =&gt; 'FFA0A0A0'<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;),<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;'endcolor'&nbsp;&nbsp; =&gt; array(<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;'argb' =&gt; 'FFFFFFFF'<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;)<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;)<br>&nbsp;&nbsp;&nbsp;&nbsp;)<br>&nbsp;&nbsp;);</p>\r\n<p>&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('F'.$i)-&gt;applyFromArray(<br>&nbsp;&nbsp;&nbsp;&nbsp;array(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'borders' =&gt; array(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'right'&nbsp;&nbsp;&nbsp;&nbsp; =&gt; array(<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'style' =&gt; PHPExcel_Style_Border::BORDER_THIN<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br>&nbsp;&nbsp;&nbsp;&nbsp;)<br>&nbsp;&nbsp;);<br>&nbsp;&nbsp;<br>&nbsp;&nbsp;$k++;<br>&nbsp;&nbsp;$detailsSql = &quot;SELECT * FROM order_details ORDER BY sku, orderid&quot;;<br>&nbsp;&nbsp;$detailsQuery = mysql_query($detailsSql) or die($detailsSql.&quot;&lt;br&gt;&lt;br&gt;&quot;.mysql_error());<br>&nbsp;&nbsp;while($row_details = mysql_fetch_assoc($detailsQuery))<br>&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;$objRichText-&gt;createText($row_details['sku']);<br>&nbsp;&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;getCell('A'.$k)-&gt;setValue($objRichText);<br>&nbsp;&nbsp;&nbsp;//$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('A'.$k, $row_details['sku']);<br>&nbsp;&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('B'.$k, $row_details['orderid']);<br>&nbsp;&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('C'.$k, utf8_encode(str_replace($character, $accent, $row_details['name'])));<br>&nbsp;&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('D'.$k, utf8_encode(str_replace($character, $accent, $row_details['orderoption'])));<br>&nbsp;&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('E'.$k, $row_details['qty']);<br>&nbsp;&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('F'.$k, $row_details['price']);<br>&nbsp;&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('F'.$k)-&gt;getNumberFormat()-&gt;setFormatCode(PHPExcel_Style_NumberFormat::FORMAT_CURRENCY_USD_SIMPLE&nbsp;);<br>&nbsp;&nbsp;&nbsp;$k++;<br>&nbsp;&nbsp;}<br>&nbsp;&nbsp;<br>&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension('A')-&gt;setWidth(18);<br>&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension('B')-&gt;setWidth(8);<br>&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension('C')-&gt;setWidth(30);<br>&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension('D')-&gt;setWidth(30);<br>&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension('E')-&gt;setWidth(8);<br>&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension('F')-&gt;setWidth(10);</p>\r\n<p>&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;getPageSetup()-&gt;setOrientation(PHPExcel_Worksheet_PageSetup::ORIENTATION_PORTRAIT);<br>&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;getPageSetup()-&gt;setPaperSize(PHPExcel_Worksheet_PageSetup::PAPERSIZE_A4);<br>&nbsp;&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;setTitle('Product Details');</p>\r\n<p>&nbsp;&nbsp;require_once('../Classes/PHPExcel/IOFactory.php');<br>&nbsp;&nbsp;<br>&nbsp;&nbsp;$objPHPExcel-&gt;setActiveSheetIndex(0);<br>&nbsp;&nbsp;$filename = date(&quot;Y-m-d&quot;).'_Sales_Report';<br>&nbsp;&nbsp;$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel,'Excel2007');<br>&nbsp;&nbsp;$objWriter-&gt;save($filename.&quot;.xlsx&quot;);<br>&nbsp;&nbsp;<br>&nbsp;&nbsp;$zipname = $filename.&quot;.zip&quot;;<br>&nbsp;&nbsp;$zip = new ZipArchive();<br>&nbsp;&nbsp;<br>&nbsp;&nbsp;if ($zip-&gt;open($zipname, ZIPARCHIVE::CREATE)!==TRUE) {<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;exit(&quot;cannot open &lt;$zipname&gt;\\n&quot;);<br>&nbsp;&nbsp;}<br>&nbsp;&nbsp;$zip-&gt;addFile($filename.&quot;.xlsx&quot;);<br>&nbsp;&nbsp;$zip-&gt;close();<br>&nbsp;&nbsp;unlink($filename.&quot;.xlsx&quot;);<br>&nbsp;&nbsp;header(&quot;location: &quot;.$zipname);</p>\r\n<p>&nbsp;}<br>&nbsp;else<br>&nbsp;{<br>&nbsp;&nbsp;//header(&quot;location: reports.php&quot;);<br>&nbsp;&nbsp;echo &quot;No data&quot;;<br>&nbsp;}<br>}<br>else<br>{<br>&nbsp;//header(&quot;location: reports.php&quot;);<br>&nbsp;echo &quot;No request&quot;;<br>}<br>?&gt;</p>",
    "PostedDate": "2009-09-22T15:41:47.803-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "237557",
    "ThreadId": "51501",
    "Html": "<p>Essentially you have this:<br><br></p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre>$objRichText = <span style=\"color:Blue\">new</span> PHPExcel_RichText();<br><span style=\"color:Blue\">while</span>($row_orderDetail = mysql_fetch_assoc($orderDetailQuery))<br>{<br>    $objRichText-&gt;createText($row_orderDetail[<span style=\"color:#A31515\">'sku'</span>]);<br>    $objPHPExcel-&gt;getActiveSheet()-&gt;getCell('A'.$i)-&gt;setValue($objRichText);<br>    ...<br>}<br><br><br></pre>\r\n</div>\r\n<p>Can you try this instead and report back if it solves the problem?<br><br></p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre><span style=\"color:Blue\">while</span>($row_orderDetail = mysql_fetch_assoc($orderDetailQuery))<br>{<br>    $objRichText = <span style=\"color:Blue\">new</span> PHPExcel_RichText();<br>    $objRichText-&gt;createText($row_orderDetail[<span style=\"color:#A31515\">'sku'</span>]);<pre>   $objPHPExcel-&gt;getActiveSheet()-&gt;getCell('A'.$i)-&gt;setValue($objRichText);</pre>\r\n</pre>\r\n</div>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre>    ...<br>}<br></pre>\r\n</div>\r\n<p>&nbsp;</p>",
    "PostedDate": "2009-09-22T16:01:40.93-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "237559",
    "ThreadId": "51501",
    "Html": "<p>It worked perfectly. Thank you so very much. That was actually the END of that contract......................lol</p>",
    "PostedDate": "2009-09-22T16:23:26.61-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]