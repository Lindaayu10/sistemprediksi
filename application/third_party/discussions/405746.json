[
  {
    "Id": "952011",
    "ThreadId": "405746",
    "Html": "\r\n<p>Hello everybody,</p>\r\n<p>Directly to the issue: I'm not able to create a web chart (radar chart) with PHPExcel.</p>\r\n<p><br>\r\nI paste my code below. I'm able to generate a 4 bars chart without problems but the same code doesn't work when I try to do the same with the web / radar chart.</p>\r\n<p><br>\r\nAccording the the API of the library, I pass the constant PHPExcel_Chart_DataSeries::TYPE_RADARCHART to the object PHPExcel_Chart_DataSeries.</p>\r\n<p><br>\r\nAfter creating the Excel file and trying to open it, Excel 2010 crashes with a reference to &nbsp; /xl/drawings/drawing1.xml and I never see any chart.&nbsp;</p>\r\n<p>Let me know where's the problem if you see it.</p>\r\n<p><br>\r\nWorking with PHP 5 and the latest version of PHPExcel, 1.7.8, testing on Apache Server 2.2 in Unix.&nbsp;</p>\r\n<p><br>\r\nThanks a lot.</p>\r\n<p>CODE:</p>\r\n<p>&nbsp;</p>\r\n<p></p>\r\n<div>$total_datos=mysql_num_rows($result_gene);</div>\r\n<div>$datos_generales=array();</div>\r\n<div>array_push($datos_generales, array('', 'Sup.', 'Sub.', 'Pares', 'TÃº'));</div>\r\n<div>while($datos_gene=mysql_fetch_array($result_gene)) {</div>\r\n<div><span></span>array_push($datos_generales, array($datos_gene['nombre'], $datos_gene['media_sup'], $datos_gene['media_sub'], $datos_gene['media_par'], $datos_gene['sol']));</div>\r\n<div><span></span>$fila_actual&#43;&#43;;</div>\r\n<div>}</div>\r\n<div>$sheet = $workbook-&gt;getActiveSheet();</div>\r\n<div>$sheet-&gt;fromArray($datos_generales, null, 'B18');</div>\r\n<div>$labels=array();</div>\r\n<div>$categories=array(new PHPExcel_Chart_DataSeriesValues('String', 'Worksheet!$B$19:$B$22', null, 4));</div>\r\n<div>$values=array();</div>\r\n<div>for($fila=19; $fila&lt;19&#43;$total_datos; $fila&#43;&#43;) {</div>\r\n<div><span></span>array_push($values, new PHPExcel_Chart_DataSeriesValues('Number', 'Worksheet!$C$'.$fila.':$F$'.$fila, null, 4));</div>\r\n<div>}</div>\r\n<div>array_push($labels, new PHPExcel_Chart_DataSeriesValues('String', 'Worksheet!$C$18', null, 4));</div>\r\n<div>array_push($labels, new PHPExcel_Chart_DataSeriesValues('String', 'Worksheet!$D$18', null, 4));</div>\r\n<div>array_push($labels, new PHPExcel_Chart_DataSeriesValues('String', 'Worksheet!$E$18', null, 4));</div>\r\n<div>array_push($labels, new PHPExcel_Chart_DataSeriesValues('String', 'Worksheet!$F$18', null, 4));</div>\r\n<div>$series = new PHPExcel_Chart_DataSeries(</div>\r\n<div>&nbsp; PHPExcel_Chart_DataSeries::TYPE_BARCHART, &nbsp; &nbsp; &nbsp; // plotType</div>\r\n<div>&nbsp; PHPExcel_Chart_DataSeries::GROUPING_CLUSTERED, &nbsp;// plotGrouping</div>\r\n<div>&nbsp; array(0, 1, 2, 3), &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // plotOrder</div>\r\n<div>&nbsp; $labels, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// plotLabel</div>\r\n<div>&nbsp; $categories, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// plotCategory</div>\r\n<div>&nbsp; $values &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // plotValues</div>\r\n<div>);</div>\r\n<div>$series-&gt;setPlotDirection(PHPExcel_Chart_DataSeries::DIRECTION_COL);</div>\r\n<div>$plotarea = new PHPExcel_Chart_PlotArea(null, array($series));</div>\r\n<div>$legend = new PHPExcel_Chart_Legend(PHPExcel_Chart_Legend::POSITION_RIGHT, null, false);</div>\r\n<div>$chart = new PHPExcel_Chart(</div>\r\n<div>&nbsp; 'chart1', &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // name</div>\r\n<div>&nbsp; null, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // title</div>\r\n<div>&nbsp; $legend, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// legend</div>\r\n<div>&nbsp; $plotarea, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// plotArea</div>\r\n<div>&nbsp; true, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // plotVisibleOnly</div>\r\n<div>&nbsp; 0, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// displayBlanksAs</div>\r\n<div>&nbsp; null, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // xAxisLabel</div>\r\n<div>&nbsp; null &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// yAxisLabel</div>\r\n<div>);</div>\r\n<div>$fila_actual&#43;=2;</div>\r\n<div>$chart-&gt;setTopLeftPosition('H'.($fila_actual-13));</div>\r\n<div>$chart-&gt;setBottomRightPosition('O'.($fila_actual-1));</div>\r\n<div>$sheet-&gt;addChart($chart);</div>\r\n<p></p>\r\n",
    "PostedDate": "2012-12-05T18:31:45.417-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "952077",
    "ThreadId": "405746",
    "Html": "\r\n<p>Taken directly from the example 33chartcreate-radar.php from the current github develop branch:</p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre>$objPHPExcel = <span style=\"color:blue\">new</span> PHPExcel();\r\n$objWorksheet = $objPHPExcel-&gt;getActiveSheet();\r\n$objWorksheet-&gt;fromArray(\r\n <span style=\"color:blue\">array</span>(\r\n  <span style=\"color:blue\">array</span>(<span style=\"color:#a31515\">''</span>, 2010, 2011, 2012),\r\n  <span style=\"color:blue\">array</span>(<span style=\"color:#a31515\">'Jan'</span>,   47,   45,  71),\r\n  <span style=\"color:blue\">array</span>(<span style=\"color:#a31515\">'Feb'</span>,   56,   73,  86),\r\n  <span style=\"color:blue\">array</span>(<span style=\"color:#a31515\">'Mar'</span>,   52,   61,  69),\r\n  <span style=\"color:blue\">array</span>(<span style=\"color:#a31515\">'Apr'</span>,   40,   52,  60),\r\n  <span style=\"color:blue\">array</span>(<span style=\"color:#a31515\">'May'</span>,   42,   55,  71),\r\n  <span style=\"color:blue\">array</span>(<span style=\"color:#a31515\">'Jun'</span>,   58,   63,  76),\r\n  <span style=\"color:blue\">array</span>(<span style=\"color:#a31515\">'Jul'</span>,   53,   61,  89),\r\n  <span style=\"color:blue\">array</span>(<span style=\"color:#a31515\">'Aug'</span>,   46,   69,  85),\r\n  <span style=\"color:blue\">array</span>(<span style=\"color:#a31515\">'Sep'</span>,   62,   75,  81),\r\n  <span style=\"color:blue\">array</span>(<span style=\"color:#a31515\">'Oct'</span>,   51,   70,  96),\r\n  <span style=\"color:blue\">array</span>(<span style=\"color:#a31515\">'Nov'</span>,   55,   66,  89),\r\n  <span style=\"color:blue\">array</span>(<span style=\"color:#a31515\">'Dec'</span>,   68,   62,  0),\r\n )\r\n);\r\n\r\n<span style=\"color:green\">// Set the Labels for each data series we want to plot</span>\r\n<span style=\"color:green\">//  Datatype</span>\r\n<span style=\"color:green\">//  Cell reference for data</span>\r\n<span style=\"color:green\">//  Format Code</span>\r\n<span style=\"color:green\">//  Number of datapoints in series</span>\r\n<span style=\"color:green\">//  Data values</span>\r\n<span style=\"color:green\">//  Data Marker</span>\r\n$dataseriesLabels = <span style=\"color:blue\">array</span>(\r\n <span style=\"color:blue\">new</span> PHPExcel_Chart_DataSeriesValues(<span style=\"color:#a31515\">'String'</span>, <span style=\"color:#a31515\">'Worksheet!$C$1'</span>, NULL, 1), <span style=\"color:green\">// 2011</span>\r\n <span style=\"color:blue\">new</span> PHPExcel_Chart_DataSeriesValues(<span style=\"color:#a31515\">'String'</span>, <span style=\"color:#a31515\">'Worksheet!$D$1'</span>, NULL, 1), <span style=\"color:green\">// 2012</span>\r\n);\r\n<span style=\"color:green\">// Set the X-Axis Labels</span>\r\n<span style=\"color:green\">//  Datatype</span>\r\n<span style=\"color:green\">//  Cell reference for data</span>\r\n<span style=\"color:green\">//  Format Code</span>\r\n<span style=\"color:green\">//  Number of datapoints in series</span>\r\n<span style=\"color:green\">//  Data values</span>\r\n<span style=\"color:green\">//  Data Marker</span>\r\n$xAxisTickValues = <span style=\"color:blue\">array</span>(\r\n <span style=\"color:blue\">new</span> PHPExcel_Chart_DataSeriesValues(<span style=\"color:#a31515\">'String'</span>, <span style=\"color:#a31515\">'Worksheet!$A$2:$A$13'</span>, NULL, 12), <span style=\"color:green\">// Jan to Dec</span>\r\n <span style=\"color:blue\">new</span> PHPExcel_Chart_DataSeriesValues(<span style=\"color:#a31515\">'String'</span>, <span style=\"color:#a31515\">'Worksheet!$A$2:$A$13'</span>, NULL, 12), <span style=\"color:green\">// Jan to Dec</span>\r\n);\r\n<span style=\"color:green\">// Set the Data values for each data series we want to plot</span>\r\n<span style=\"color:green\">//  Datatype</span>\r\n<span style=\"color:green\">//  Cell reference for data</span>\r\n<span style=\"color:green\">//  Format Code</span>\r\n<span style=\"color:green\">//  Number of datapoints in series</span>\r\n<span style=\"color:green\">//  Data values</span>\r\n<span style=\"color:green\">//  Data Marker</span>\r\n$dataSeriesValues = <span style=\"color:blue\">array</span>(\r\n <span style=\"color:blue\">new</span> PHPExcel_Chart_DataSeriesValues(<span style=\"color:#a31515\">'Number'</span>, <span style=\"color:#a31515\">'Worksheet!$C$2:$C$13'</span>, NULL, 12),\r\n <span style=\"color:blue\">new</span> PHPExcel_Chart_DataSeriesValues(<span style=\"color:#a31515\">'Number'</span>, <span style=\"color:#a31515\">'Worksheet!$D$2:$D$13'</span>, NULL, 12),\r\n);\r\n<span style=\"color:green\">// Build the dataseries</span>\r\n$series = <span style=\"color:blue\">new</span> PHPExcel_Chart_DataSeries(\r\n PHPExcel_Chart_DataSeries::TYPE_RADARCHART,    <span style=\"color:green\">// plotType</span>\r\n NULL,             <span style=\"color:green\">// plotGrouping</span>\r\n range(0, count($dataSeriesValues)-1),     <span style=\"color:green\">// plotOrder</span>\r\n $dataseriesLabels,          <span style=\"color:green\">// plotLabel</span>\r\n $xAxisTickValues,          <span style=\"color:green\">// plotCategory</span>\r\n $dataSeriesValues,          <span style=\"color:green\">// plotValues</span>\r\n NULL,             <span style=\"color:green\">// smooth line</span>\r\n PHPExcel_Chart_DataSeries::STYLE_MARKER     <span style=\"color:green\">// plotStyle</span>\r\n);\r\n<span style=\"color:green\">// Set up a layout object for the Pie chart</span>\r\n$layout = <span style=\"color:blue\">new</span> PHPExcel_Chart_Layout();\r\n<span style=\"color:green\">// Set the series in the plot area</span>\r\n$plotarea = <span style=\"color:blue\">new</span> PHPExcel_Chart_PlotArea($layout, <span style=\"color:blue\">array</span>($series));\r\n<span style=\"color:green\">// Set the chart legend</span>\r\n$legend = <span style=\"color:blue\">new</span> PHPExcel_Chart_Legend(PHPExcel_Chart_Legend::POSITION_RIGHT, NULL, false);\r\n$title = <span style=\"color:blue\">new</span> PHPExcel_Chart_Title(<span style=\"color:#a31515\">'Test Radar Chart'</span>);\r\n\r\n<span style=\"color:green\">// Create the chart</span>\r\n$chart = <span style=\"color:blue\">new</span> PHPExcel_Chart(\r\n <span style=\"color:#a31515\">'chart1'</span>,  <span style=\"color:green\">// name</span>\r\n $title,   <span style=\"color:green\">// title</span>\r\n $legend,  <span style=\"color:green\">// legend</span>\r\n $plotarea,  <span style=\"color:green\">// plotArea</span>\r\n true,   <span style=\"color:green\">// plotVisibleOnly</span>\r\n 0,    <span style=\"color:green\">// displayBlanksAs</span>\r\n NULL,   <span style=\"color:green\">// xAxisLabel</span>\r\n NULL   <span style=\"color:green\">// yAxisLabel  - Radar charts don't have a Y-Axis</span>\r\n);\r\n<span style=\"color:green\">// Set the position where the chart should appear in the worksheet</span>\r\n$chart-&gt;setTopLeftPosition(<span style=\"color:#a31515\">'F2'</span>);\r\n$chart-&gt;setBottomRightPosition(<span style=\"color:#a31515\">'M15'</span>);\r\n<span style=\"color:green\">// Add the chart to the worksheet</span>\r\n$objWorksheet-&gt;addChart($chart);\r\n\r\n<span style=\"color:green\">// Save Excel 2007 file</span>\r\n<span style=\"color:blue\">echo</span> date(<span style=\"color:#a31515\">'H:i:s'</span>) , <span style=\"color:#a31515\">&quot; Write to Excel2007 format&quot;</span> , EOL;\r\n$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, <span style=\"color:#a31515\">'Excel2007'</span>);\r\n$objWriter-&gt;setIncludeCharts(TRUE);\r\n$objWriter-&gt;save(str_replace(<span style=\"color:#a31515\">'.php'</span>, <span style=\"color:#a31515\">'.xlsx'</span>, <span style=\"color:blue\">__FILE__</span>));\r\n<span style=\"color:blue\">echo</span> date(<span style=\"color:#a31515\">'H:i:s'</span>) , <span style=\"color:#a31515\">&quot; File written to &quot;</span> , str_replace(<span style=\"color:#a31515\">'.php'</span>, <span style=\"color:#a31515\">'.xlsx'</span>, pathinfo(<span style=\"color:blue\">__FILE__</span>, PATHINFO_BASENAME)) , EOL;\r\n</pre>\r\n</div>\r\n",
    "PostedDate": "2012-12-05T23:31:58.417-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "952801",
    "ThreadId": "405746",
    "Html": "\r\n<p>Thank you!! That example helped a lot.&nbsp;</p>\r\n",
    "PostedDate": "2012-12-07T02:39:40.523-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]