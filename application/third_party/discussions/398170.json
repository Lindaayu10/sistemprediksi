[
  {
    "Id": "922430",
    "ThreadId": "398170",
    "Html": "\r\n<p>Hi All,<br>\r\n<br>\r\nI hope someone out there can help me. I installed my Cakephp based application on an Ubuntu server today.&nbsp;Previously&nbsp;it was running on a Debian server and I develop on a windows machine. I have noticed that a PhpExcel based function is behaving differently\r\n on the Ubuntu server and I do not know why....<br>\r\nWhat this code does is open a template Excel file, change some values and then sends the output to the browser so that it can be downloaded. This works fine on Windows/Debian but for some reason when I just try to open a reader/write to the output on the new\r\n server it add new numbered sheets to the outputted excel file. Eg the file has two sheets: 'monkey', 'cat'. and the output contains 'monkey' ,'cat', 'monkey 1' and &nbsp;'cat 1'. Plus the styling of the sheets are messed up.&nbsp;<br>\r\n<br>\r\nCan anyone explain this to me? Perhaps it is a lamp config setting that is missing but right now I do not know.&nbsp;<br>\r\n<br>\r\nHere an example of the the Code (it just opens a file and writes it to the output):<br>\r\n<br>\r\n</p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre><span style=\"white-space:pre\">\t\t\t</span>$objPHPExcel2 = <span style=\"color:blue\">new</span> PHPExcel();\r\n\t\t\t$objReader2 = PHPExcel_IOFactory::createReader(<span style=\"color:#a31515\">'Excel2007'</span>);\r\n\t\t\t$inputFileName = <span style=\"color:#a31515\">&quot;files/templates/FragebogenExportTemplate.xlsx&quot;</span>;\r\n\t\t\t$objPHPExcel2 = $objReader2-&gt;load($inputFileName);\r\n\r\n\t\t\t$objWriter2 = <span style=\"color:blue\">new</span> PHPExcel_Writer_Excel2007($objPHPExcel2);\r\n\t\t\t\t\r\n\r\n\t\t\tob_clean();\r\n\t\t\theader(<span style=\"color:#a31515\">'Content-type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'</span>);\r\n\t\t\theader(<span style=\"color:#a31515\">&quot;Content-Disposition: attachment; filename=&quot;</span>.$lieferant[<span style=\"color:#a31515\">'Lieferant'</span>][<span style=\"color:#a31515\">'ifa'</span>].<span style=\"color:#a31515\">&quot;_fragebogen.xlsx&quot;</span>);\r\n\t\t\t\r\n\t\t\t<span style=\"color:green\">// Write file to the browser</span>\r\n\t\t\t$objWriter2-&gt;save(<span style=\"color:#a31515\">'php://output'</span>);\r\n\t\t\t<span style=\"color:blue\">exit</span>();\t\t\r\n</pre>\r\n</div>\r\n<br>\r\nAny suggetions? Thanks guys.\r\n<p></p>\r\n",
    "PostedDate": "2012-10-05T07:03:05.297-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "922969",
    "ThreadId": "398170",
    "Html": "<p>I keep hearing about this problem with PHPExcel duplicating worsheet names, but have never seen it myself, never been able to replicate the problem; and until I'm able to test it for myself I have no way of addressing it.</p>\r\n<p>&nbsp;</p>\r\n<p>Can you please upload an example of the template file; together with a phpinfo() dump of the php configs for each of the two servers. The only thing I can think of that might cause this is mbstring settings.</p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2012-10-06T23:41:32.77-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "925174",
    "ThreadId": "398170",
    "Html": "<p>Hi Mark,</p>\r\n<p><br />Many thanks for answering my post. I still have not figured this out. I cant see a way to upload files on this forum but here is the phpinfo data from both servers....<br /><br />Here is the MBSting section for the working server:&nbsp;</p>\r\n<h2><a name=\"module_mbstring\">mbstring</a></h2>\r\n<table border=\"0\" cellpadding=\"3\" width=\"600\">\r\n<tbody>\r\n<tr>\r\n<td class=\"e\">Multibyte Support</td>\r\n<td class=\"v\">enabled</td>\r\n</tr>\r\n<tr>\r\n<td class=\"e\">Multibyte string engine</td>\r\n<td class=\"v\">libmbfl</td>\r\n</tr>\r\n<tr>\r\n<td class=\"e\">HTTP input encoding translation</td>\r\n<td class=\"v\">disabled</td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n<p>&nbsp;</p>\r\n<table border=\"0\" cellpadding=\"3\" width=\"600\">\r\n<tbody>\r\n<tr class=\"h\">\r\n<th>mbstring extension makes use of \"streamable kanji code filter and converter\", which is distributed under the GNU Lesser General Public License version 2.1.</th>\r\n</tr>\r\n</tbody>\r\n</table>\r\n<p>&nbsp;</p>\r\n<table border=\"0\" cellpadding=\"3\" width=\"600\">\r\n<tbody>\r\n<tr>\r\n<td class=\"e\">Multibyte (japanese) regex support</td>\r\n<td class=\"v\">enabled</td>\r\n</tr>\r\n<tr>\r\n<td class=\"e\">Multibyte regex (oniguruma) version</td>\r\n<td class=\"v\">4.7.1</td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n<p>&nbsp;</p>\r\n<table border=\"0\" cellpadding=\"3\" width=\"600\">\r\n<tbody>\r\n<tr class=\"h\">\r\n<th>Directive</th><th>Local Value</th><th>Master Value</th>\r\n</tr>\r\n<tr>\r\n<td class=\"e\">mbstring.detect_order</td>\r\n<td class=\"v\"><em>no value</em></td>\r\n<td class=\"v\"><em>no value</em></td>\r\n</tr>\r\n<tr>\r\n<td class=\"e\">mbstring.encoding_translation</td>\r\n<td class=\"v\">Off</td>\r\n<td class=\"v\">Off</td>\r\n</tr>\r\n<tr>\r\n<td class=\"e\">mbstring.func_overload</td>\r\n<td class=\"v\">0</td>\r\n<td class=\"v\">0</td>\r\n</tr>\r\n<tr>\r\n<td class=\"e\">mbstring.http_input</td>\r\n<td class=\"v\">pass</td>\r\n<td class=\"v\">pass</td>\r\n</tr>\r\n<tr>\r\n<td class=\"e\">mbstring.http_output</td>\r\n<td class=\"v\">pass</td>\r\n<td class=\"v\">pass</td>\r\n</tr>\r\n<tr>\r\n<td class=\"e\">mbstring.http_output_conv_mimetypes</td>\r\n<td class=\"v\">^(text/|application/xhtml\\+xml)</td>\r\n<td class=\"v\">^(text/|application/xhtml\\+xml)</td>\r\n</tr>\r\n<tr>\r\n<td class=\"e\">mbstring.internal_encoding</td>\r\n<td class=\"v\"><em>no value</em></td>\r\n<td class=\"v\"><em>no value</em></td>\r\n</tr>\r\n<tr>\r\n<td class=\"e\">mbstring.language</td>\r\n<td class=\"v\">neutral</td>\r\n<td class=\"v\">neutral</td>\r\n</tr>\r\n<tr>\r\n<td class=\"e\">mbstring.strict_detection</td>\r\n<td class=\"v\">Off</td>\r\n<td class=\"v\">\r\n<p>Off</p>\r\n<p>&nbsp;</p>\r\n</td>\r\n</tr>\r\n<tr>\r\n<td class=\"e\">mbstring.substitute_character</td>\r\n<td class=\"v\"><em>no value</em></td>\r\n<td class=\"v\"><em>no value<br /><br /></em></td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n<h2></h2>\r\n<p>&nbsp;</p>\r\n<p>Here it is for the server that is not working (Ubuntu):</p>\r\n<h2><a name=\"module_mbstring\">mbstring</a></h2>\r\n<table border=\"0\" cellpadding=\"3\" width=\"600\">\r\n<tbody>\r\n<tr>\r\n<td class=\"e\">Multibyte Support</td>\r\n<td class=\"v\">enabled</td>\r\n</tr>\r\n<tr>\r\n<td class=\"e\">Multibyte string engine</td>\r\n<td class=\"v\">libmbfl</td>\r\n</tr>\r\n<tr>\r\n<td class=\"e\">HTTP input encoding translation</td>\r\n<td class=\"v\">disabled</td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n<p>&nbsp;</p>\r\n<table border=\"0\" cellpadding=\"3\" width=\"600\">\r\n<tbody>\r\n<tr class=\"h\">\r\n<th>mbstring extension makes use of \"streamable kanji code filter and converter\", which is distributed under the GNU Lesser General Public License version 2.1.</th>\r\n</tr>\r\n</tbody>\r\n</table>\r\n<p>&nbsp;</p>\r\n<table border=\"0\" cellpadding=\"3\" width=\"600\">\r\n<tbody>\r\n<tr>\r\n<td class=\"e\">Multibyte (japanese) regex support</td>\r\n<td class=\"v\">enabled</td>\r\n</tr>\r\n<tr>\r\n<td class=\"e\">Multibyte regex (oniguruma) backtrack check</td>\r\n<td class=\"v\">On</td>\r\n</tr>\r\n<tr>\r\n<td class=\"e\">Multibyte regex (oniguruma) version</td>\r\n<td class=\"v\">4.7.1</td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n<p>&nbsp;</p>\r\n<table border=\"0\" cellpadding=\"3\" width=\"600\">\r\n<tbody>\r\n<tr class=\"h\">\r\n<th>Directive</th><th>Local Value</th><th>Master Value</th>\r\n</tr>\r\n<tr>\r\n<td class=\"e\">mbstring.detect_order</td>\r\n<td class=\"v\"><em>no value</em></td>\r\n<td class=\"v\"><em>no value</em></td>\r\n</tr>\r\n<tr>\r\n<td class=\"e\">mbstring.encoding_translation</td>\r\n<td class=\"v\">Off</td>\r\n<td class=\"v\">Off</td>\r\n</tr>\r\n<tr>\r\n<td class=\"e\">mbstring.func_overload</td>\r\n<td class=\"v\">0</td>\r\n<td class=\"v\">0</td>\r\n</tr>\r\n<tr>\r\n<td class=\"e\">mbstring.http_input</td>\r\n<td class=\"v\">pass</td>\r\n<td class=\"v\">pass</td>\r\n</tr>\r\n<tr>\r\n<td class=\"e\">mbstring.http_output</td>\r\n<td class=\"v\">pass</td>\r\n<td class=\"v\">pass</td>\r\n</tr>\r\n<tr>\r\n<td class=\"e\">mbstring.http_output_conv_mimetypes</td>\r\n<td class=\"v\">^(text/|application/xhtml\\+xml)</td>\r\n<td class=\"v\">^(text/|application/xhtml\\+xml)</td>\r\n</tr>\r\n<tr>\r\n<td class=\"e\">mbstring.internal_encoding</td>\r\n<td class=\"v\"><em>no value</em></td>\r\n<td class=\"v\"><em>no value</em></td>\r\n</tr>\r\n<tr>\r\n<td class=\"e\">mbstring.language</td>\r\n<td class=\"v\">neutral</td>\r\n<td class=\"v\">neutral</td>\r\n</tr>\r\n<tr>\r\n<td class=\"e\">mbstring.strict_detection</td>\r\n<td class=\"v\">Off</td>\r\n<td class=\"v\">Off</td>\r\n</tr>\r\n<tr>\r\n<td class=\"e\">mbstring.substitute_character</td>\r\n<td class=\"v\"><em>no value</em></td>\r\n<td class=\"v\"><em>no value</em></td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n<p><br /><br />There is a difference between the two but I do not know what I should change.<br />Any assistance here would be greatly appreciated. Many thanks again....&nbsp;<br /><br />Brian&nbsp;</p>",
    "PostedDate": "2012-10-11T04:31:26.21-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "925177",
    "ThreadId": "398170",
    "Html": "\r\n<blockquote style=\"border:solid .1em #ccc; font-style:italic; margin:.25em 1em 0 1em; padding:0 .25em 0 .25em\">\r\n<strong>kseudo wrote:</strong><br>\r\n<p>Hi Mark,</p>\r\n<p><br>\r\nMany thanks for answering my post. I still have not figured this out. I cant see a way to upload files on this forum but here is the phpinfo data from both servers....<br>\r\n<br>\r\nHere is the MBSting section for the working server:&nbsp;</p>\r\n<h2><a name=\"module_mbstring\">mbstring</a></h2>\r\n<table border=\"0\" cellpadding=\"3\" width=\"600\">\r\n<tbody>\r\n<tr>\r\n<td>Multibyte Support</td>\r\n<td>enabled</td>\r\n</tr>\r\n<tr>\r\n<td>Multibyte string engine</td>\r\n<td>libmbfl</td>\r\n</tr>\r\n<tr>\r\n<td>HTTP input encoding translation</td>\r\n<td>disabled</td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n<p>&nbsp;</p>\r\n<table border=\"0\" cellpadding=\"3\" width=\"600\">\r\n<tbody>\r\n<tr>\r\n<th>mbstring extension makes use of &quot;streamable kanji code filter and converter&quot;, which is distributed under the GNU Lesser General Public License version 2.1.</th>\r\n</tr>\r\n</tbody>\r\n</table>\r\n<p>&nbsp;</p>\r\n<table border=\"0\" cellpadding=\"3\" width=\"600\">\r\n<tbody>\r\n<tr>\r\n<td>Multibyte (japanese) regex support</td>\r\n<td>enabled</td>\r\n</tr>\r\n<tr>\r\n<td>Multibyte regex (oniguruma) version</td>\r\n<td>4.7.1</td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n<p>&nbsp;</p>\r\n<table border=\"0\" cellpadding=\"3\" width=\"600\">\r\n<tbody>\r\n<tr>\r\n<th>Directive</th>\r\n<th>Local Value</th>\r\n<th>Master Value</th>\r\n</tr>\r\n<tr>\r\n<td>mbstring.detect_order</td>\r\n<td><em>no value</em></td>\r\n<td><em>no value</em></td>\r\n</tr>\r\n<tr>\r\n<td>mbstring.encoding_translation</td>\r\n<td>Off</td>\r\n<td>Off</td>\r\n</tr>\r\n<tr>\r\n<td>mbstring.func_overload</td>\r\n<td>0</td>\r\n<td>0</td>\r\n</tr>\r\n<tr>\r\n<td>mbstring.http_input</td>\r\n<td>pass</td>\r\n<td>pass</td>\r\n</tr>\r\n<tr>\r\n<td>mbstring.http_output</td>\r\n<td>pass</td>\r\n<td>pass</td>\r\n</tr>\r\n<tr>\r\n<td>mbstring.http_output_conv_mimetypes</td>\r\n<td>^(text/|application/xhtml\\&#43;xml)</td>\r\n<td>^(text/|application/xhtml\\&#43;xml)</td>\r\n</tr>\r\n<tr>\r\n<td>mbstring.internal_encoding</td>\r\n<td><em>no value</em></td>\r\n<td><em>no value</em></td>\r\n</tr>\r\n<tr>\r\n<td>mbstring.language</td>\r\n<td>neutral</td>\r\n<td>neutral</td>\r\n</tr>\r\n<tr>\r\n<td>mbstring.strict_detection</td>\r\n<td>Off</td>\r\n<td>\r\n<p>Off</p>\r\n<p>&nbsp;</p>\r\n</td>\r\n</tr>\r\n<tr>\r\n<td>mbstring.substitute_character</td>\r\n<td><em>no value</em></td>\r\n<td><em>no value<br>\r\n<br>\r\n</em></td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n<p>&nbsp;</p>\r\n<p>Here it is for the server that is not working (Ubuntu):</p>\r\n<h2><a name=\"module_mbstring\">mbstring</a></h2>\r\n<table border=\"0\" cellpadding=\"3\" width=\"600\">\r\n<tbody>\r\n<tr>\r\n<td>Multibyte Support</td>\r\n<td>enabled</td>\r\n</tr>\r\n<tr>\r\n<td>Multibyte string engine</td>\r\n<td>libmbfl</td>\r\n</tr>\r\n<tr>\r\n<td>HTTP input encoding translation</td>\r\n<td>disabled</td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n<p>&nbsp;</p>\r\n<table border=\"0\" cellpadding=\"3\" width=\"600\">\r\n<tbody>\r\n<tr>\r\n<th>mbstring extension makes use of &quot;streamable kanji code filter and converter&quot;, which is distributed under the GNU Lesser General Public License version 2.1.</th>\r\n</tr>\r\n</tbody>\r\n</table>\r\n<p>&nbsp;</p>\r\n<table border=\"0\" cellpadding=\"3\" width=\"600\">\r\n<tbody>\r\n<tr>\r\n<td>Multibyte (japanese) regex support</td>\r\n<td>enabled</td>\r\n</tr>\r\n<tr>\r\n<td>Multibyte regex (oniguruma) backtrack check</td>\r\n<td>On</td>\r\n</tr>\r\n<tr>\r\n<td>Multibyte regex (oniguruma) version</td>\r\n<td>4.7.1</td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n<p>&nbsp;</p>\r\n<table border=\"0\" cellpadding=\"3\" width=\"600\">\r\n<tbody>\r\n<tr>\r\n<th>Directive</th>\r\n<th>Local Value</th>\r\n<th>Master Value</th>\r\n</tr>\r\n<tr>\r\n<td>mbstring.detect_order</td>\r\n<td><em>no value</em></td>\r\n<td><em>no value</em></td>\r\n</tr>\r\n<tr>\r\n<td>mbstring.encoding_translation</td>\r\n<td>Off</td>\r\n<td>Off</td>\r\n</tr>\r\n<tr>\r\n<td>mbstring.func_overload</td>\r\n<td>0</td>\r\n<td>0</td>\r\n</tr>\r\n<tr>\r\n<td>mbstring.http_input</td>\r\n<td>pass</td>\r\n<td>pass</td>\r\n</tr>\r\n<tr>\r\n<td>mbstring.http_output</td>\r\n<td>pass</td>\r\n<td>pass</td>\r\n</tr>\r\n<tr>\r\n<td>mbstring.http_output_conv_mimetypes</td>\r\n<td>^(text/|application/xhtml\\&#43;xml)</td>\r\n<td>^(text/|application/xhtml\\&#43;xml)</td>\r\n</tr>\r\n<tr>\r\n<td>mbstring.internal_encoding</td>\r\n<td><em>no value</em></td>\r\n<td><em>no value</em></td>\r\n</tr>\r\n<tr>\r\n<td>mbstring.language</td>\r\n<td>neutral</td>\r\n<td>neutral</td>\r\n</tr>\r\n<tr>\r\n<td>mbstring.strict_detection</td>\r\n<td>Off</td>\r\n<td>Off</td>\r\n</tr>\r\n<tr>\r\n<td>mbstring.substitute_character</td>\r\n<td><em>no value</em></td>\r\n<td><em>no value</em></td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n<p><br>\r\n<br>\r\nThere is a difference between the two but I do not know what I should change.<br>\r\nAny assistance here would be greatly appreciated. Many thanks again....&nbsp;<br>\r\n<br>\r\nBrian&nbsp;</p>\r\n</blockquote>\r\n<p><br>\r\nThanks again,<br>\r\n<br>\r\nbrian.&nbsp;</p>\r\n",
    "PostedDate": "2012-10-11T04:37:30.383-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "927244",
    "ThreadId": "398170",
    "Html": "<p>Hi again,<br /><br />Has anyone out there a suggestion for me? Perhaps you have seen a&nbsp;similar&nbsp;issue? &nbsp;I am not making any progress unfortunately ;(</p>\r\n<p>Thanks,<br /><br />Brian.</p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2012-10-16T03:22:06.137-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]