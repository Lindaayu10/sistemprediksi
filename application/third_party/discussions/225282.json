[
  {
    "Id": "486378",
    "ThreadId": "225282",
    "Html": "<p>Hi to everyone and excuse me for my english.</p>\r\n<p>I have an xls-file&nbsp; with set named sheets.</p>\r\n<p>I can't&nbsp; iterate thou them to grab the data.&nbsp;</p>\r\n<p>Doing like that:</p>\r\n<div style=\"color:black;background-color:white\">\r\n<pre>$objReader = <span style=\"color:blue\">new</span> PHPExcel_Reader_Excel5();\r\n$objReader-&gt;setReadDataOnly(true);\r\n$objReader-&gt;setLoadSheetsOnly($sheets_names);\r\n$objXLS = $objReader-&gt;load($dir.<span style=\"color:#a31515\">&quot;/&quot;</span>.$<span style=\"color:blue\">file</span>-&gt;filename);\r\n\r\n<span style=\"color:blue\">foreach</span> ($sheets <span style=\"color:blue\">as</span> $sheet){\r\n   $objWorksheet = $objXLS-&gt;setActiveSheetIndexByName($sheet[<span style=\"color:#a31515\">'name'</span>]);\r\n\r\n   <span style=\"color:green\">/*        some actions */</span>\r\n}\r\n<br><br><div style=\"color:black;background-color:white\"><pre>  WHERE <br>$sheets = <span style=\"color:blue\">array</span>( <br>    <span style=\"color:blue\">array</span>(<span style=\"color:#a31515\">'name'</span> =&gt; <span style=\"color:#a31515\">'sheet name'</span>,<br>          <span style=\"color:#a31515\">'language'</span> =&gt; <span style=\"color:#a31515\">'ru'</span>,<br>          <span style=\"color:#a31515\">'vid'</span> =&gt; 7      <br>    ))<br><br><br></pre>\r\n</div>\r\n</pre>\r\n</div>\r\n<p>Help me please</p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2010-08-30T05:48:24.867-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "487556",
    "ThreadId": "225282",
    "Html": "<p>You don't show how you're creating the $sheets_names array:</p>\r\n<p>I've created a workbook with three sheets ('Sheet1', 'Sheet2' and 'Sheet3'), and executed the following code without any problems.</p>\r\n<div style=\"color:black;background-color:white\">\r\n<pre>$sheets = <span style=\"color:blue\">array</span>( <span style=\"color:blue\">array</span>(<span style=\"color:#a31515\">'name'</span> =&gt; <span style=\"color:#a31515\">'Sheet1'</span> ),\r\n                 <span style=\"color:blue\">array</span>(<span style=\"color:#a31515\">'name'</span> =&gt; <span style=\"color:#a31515\">'Sheet4'</span> ),\r\n                 <span style=\"color:blue\">array</span>(<span style=\"color:#a31515\">'name'</span> =&gt; <span style=\"color:#a31515\">'Sheet2'</span> )\r\n               );\r\n$sheets_names = <span style=\"color:blue\">array</span>();\r\n<span style=\"color:blue\">foreach</span> ($sheets <span style=\"color:blue\">as</span> $sheet){\r\n   $sheets_names[] = $sheet[<span style=\"color:#a31515\">'name'</span>];\r\n}\r\n</pre>\r\n<pre>$objReader = <span style=\"color:blue\">new</span> PHPExcel_Reader_Excel5();\r\n$objReader-&gt;setReadDataOnly(true);\r\n$objReader-&gt;setLoadSheetsOnly($sheets_names);\r\n$objXLS = $objReader-&gt;load(<span style=\"color:#a31515\">'formula.xls'</span>);\r\n\r\n<span style=\"color:blue\">echo</span> <span style=\"color:#a31515\">'Loaded sheet names&lt;br /&gt;'</span>;\r\n<span style=\"color:blue\">echo</span> <span style=\"color:#a31515\">'&lt;pre&gt;'</span>;\r\nvar_dump($objXLS-&gt;getSheetNames());\r\n<span style=\"color:blue\">echo</span> <span style=\"color:#a31515\">'&lt;/pre&gt;'</span>;</pre>\r\n<pre><span style=\"color:blue\">echo</span> <span style=\"color:#a31515\">'Iterate through sheets&lt;br /&gt;'</span>;\r\n<span style=\"color:blue\">foreach</span> ($sheets <span style=\"color:blue\">as</span> $sheet){\r\n   <span style=\"color:blue\">try</span> {\r\n      $objWorksheet = $objXLS-&gt;setActiveSheetIndexByName($sheet[<span style=\"color:#a31515\">'name'</span>]);\r\n      <span style=\"color:blue\">echo</span> $objWorksheet-&gt;getTitle(),<span style=\"color:#a31515\">'&lt;br /&gt;'</span>;\r\n   } <span style=\"color:blue\">catch</span> (Exception $e) {\r\n      <span style=\"color:blue\">echo</span> $e-&gt;getMessage(),<span style=\"color:#a31515\">'&lt;br /&gt;'</span>;\r\n   }\r\n}\r\n</pre>\r\n</div>\r\n<p>&nbsp;This gives me the result:</p>\r\n<pre>Loaded sheet names\r\n\r\narray\r\n  0 =&gt; string 'Sheet1' (length=6)\r\n  1 =&gt; string 'Sheet2' (length=6)\r\n\r\nIterate through sheets\r\nSheet1\r\nWorkbook does not contain sheet:Sheet4\r\nSheet2</pre>",
    "PostedDate": "2010-09-01T05:51:38.17-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "487994",
    "ThreadId": "225282",
    "Html": "<p>You are absolutely right about how $sheet_names array were created</p>\r\n<p>\r\n<div style=\"color:black;background-color:white\">\r\n<pre>$sheets_names = <span style=\"color:blue\">array</span>();\r\n   <span style=\"color:blue\">foreach</span> ($sheets <span style=\"color:blue\">as</span> $sheet){\r\n     $sheets_names[] = $sheet[<span style=\"color:#a31515\">'name'</span>];   \r\n   }\r\n</pre>\r\n</div>\r\n</p>\r\n<p>Thank you for your response. But I could not understand why same code doesn't work for me.</p>",
    "PostedDate": "2010-09-01T22:25:37.753-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "488021",
    "ThreadId": "225282",
    "Html": "<p>I have tested tour code and you absolutely right - it works, but not how it should be.</p>\r\n<p>It successfully iterates through sheet names but if you want to get data from sheet it returns data for sheet $sheets['0'] only.</p>\r\n<p><a href=\"http://ukrshgz.gov.ua/test.tgz\">This is the code and sample xls i used</a></p>\r\n<p>I know that now it's not phpExcell question, but I'm hoping for help: i can't understand why why code is not working, if doing so:\r\n<div style=\"color:black;background-color:white\">\r\n<pre><span style=\"color:blue\">foreach</span> ($objWorksheet-&gt;getRowIterator() <span style=\"color:blue\">as</span> $row) {\r\n        $c = 0;\r\n        $cellIterator = $row-&gt;getCellIterator();\r\n        $cellIterator-&gt;setIterateOnlyExistingCells(false);\r\n        <span style=\"color:blue\">foreach</span> ($cellIterator <span style=\"color:blue\">as</span> $cell) {\r\n\r\n\r\n          var_dump($cell-&gt;getValue());\r\n        }\r\n       \r\n     }\r\n</pre>\r\n</div>\r\n</p>\r\n<p>It's working perfect, but if i try to do some thing like that:</p>\r\n<p>\r\n<div style=\"color:black;background-color:white\">\r\n<pre><span style=\"color:blue\">foreach</span> ($objWorksheet-&gt;getRowIterator() <span style=\"color:blue\">as</span> $row) {\r\n        $c = 0;\r\n        $cellIterator = $row-&gt;getCellIterator();\r\n        $cellIterator-&gt;setIterateOnlyExistingCells(false);\r\n        <span style=\"color:blue\">foreach</span> ($cellIterator <span style=\"color:blue\">as</span> $cell) {\r\n\r\n            $iqmenu_data[$objWorksheet-&gt;getTitle()][$r][$c] = trim($cell-&gt;getValue());\r\n            $c++;\r\n       \r\n        }\r\n        $r++;\r\n     }\r\n</pre>\r\n</div>\r\n</p>\r\n<p>It's do what i said before - it just writing values of sheet with first index in all other arrays</p>\r\n<pre dir=ltr><strong></strong><br></pre>",
    "PostedDate": "2010-09-01T23:32:08.207-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "488160",
    "ThreadId": "225282",
    "Html": "<div style=\"color:black;background-color:white\">\r\n<div style=\"color:black;background-color:white\">\r\n<pre><span style=\"color:blue\">echo</span> <span style=\"color:#a31515\">'Iterate through sheets&lt;br /&gt;'</span>;\r\n<span style=\"color:blue\">foreach</span> ($sheets <span style=\"color:blue\">as</span> $sheet) {\r\n    <span style=\"color:blue\">try</span> {\r\n        $r = 0;\r\n        $objWorksheet = $objXLS-&gt;setActiveSheetIndexByName($sheet[<span style=\"color:#a31515\">'name'</span>]);\r\n        <span style=\"color:blue\">echo</span> <span style=\"color:#a31515\">'&lt;b&gt;Sheet: '</span>,$objWorksheet-&gt;getTitle(),<span style=\"color:#a31515\">'&lt;/b&gt;&lt;br /&gt;'</span>;\r\n        <span style=\"color:blue\">foreach</span> ($objWorksheet-&gt;getRowIterator() <span style=\"color:blue\">as</span> $row) {\r\n            $c = 0;\r\n            $cellIterator = $row-&gt;getCellIterator();\r\n            $cellIterator-&gt;setIterateOnlyExistingCells(false);\r\n            <span style=\"color:blue\">foreach</span> ($cellIterator <span style=\"color:blue\">as</span> $cell) {\r\n                $iqmenu_data[$objWorksheet-&gt;getTitle()][$r][$c] = trim($cell-&gt;getValue());\r\n                $c++;\r\n            }\r\n            $r++;\r\n        }\r\n        var_dump($iqmenu_data[$objWorksheet-&gt;getTitle()][<span style=\"color:#a31515\">'2'</span>]);\r\n        var_dump($iqmenu_data[$objWorksheet-&gt;getTitle()][<span style=\"color:#a31515\">'3'</span>]);\r\n    } <span style=\"color:blue\">catch</span> (Exception $e) {\r\n        <span style=\"color:blue\">echo</span> $e-&gt;getMessage(),<span style=\"color:#a31515\">'&lt;br /&gt;'</span>;\r\n    }\r\n}\r\n</pre>\r\n</div>\r\n<p>Seems to work quite well. $iqmenu_data is being populated correctly as&nbsp;a 3d array indexed by [sheetName][row][column] then displaying a dump of rows 2 and 3 for each sheet.</p>\r\n<p>&nbsp;</p>\r\n<p>Note that there is also a toArray() method for the worksheet object, which can simplify your code (thpough it won't automatically trim the cell values)</p>\r\n<div style=\"color:black;background-color:white\">\r\n<div style=\"color:black;background-color:white\">\r\n<pre><span style=\"color:blue\">echo</span> <span style=\"color:#a31515\">'Iterate through sheets&lt;br /&gt;'</span>;\r\n<span style=\"color:blue\">foreach</span> ($sheets <span style=\"color:blue\">as</span> $sheet) {\r\n    <span style=\"color:blue\">try</span> {\r\n        $objWorksheet = $objXLS-&gt;setActiveSheetIndexByName($sheet[<span style=\"color:#a31515\">'name'</span>]);\r\n        <span style=\"color:blue\">echo</span> <span style=\"color:#a31515\">'&lt;b&gt;Sheet: '</span>,$objWorksheet-&gt;getTitle(),<span style=\"color:#a31515\">'&lt;/b&gt;&lt;br /&gt;'</span>;\r\n        $iqmenu_data[$objWorksheet-&gt;getTitle()] = $objWorksheet-&gt;toArray();\r\n        var_dump($iqmenu_data[$objWorksheet-&gt;getTitle()][<span style=\"color:#a31515\">'2'</span>]);\r\n        var_dump($iqmenu_data[$objWorksheet-&gt;getTitle()][<span style=\"color:#a31515\">'3'</span>]);\r\n    } <span style=\"color:blue\">catch</span> (Exception $e) {\r\n        <span style=\"color:blue\">echo</span> $e-&gt;getMessage(),<span style=\"color:#a31515\">'&lt;br /&gt;'</span>;\r\n    }\r\n}\r\n</pre>\r\n</div>\r\n<p>&nbsp;</p>\r\n</div>\r\n</div>",
    "PostedDate": "2010-09-02T04:22:59.01-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "488163",
    "ThreadId": "225282",
    "Html": "<p>Thank you vary much!</p>\r\n<p>I've just saw my mistake - I haven't set to zero $r row index on each iteration with sheet.</p>\r\n<p>Method toArray is great. <span id=\"result_box\"><span>If I found it before it would prevent this annoying error</span></span></p>\r\n<p>&nbsp;</p>\r\n<p>Thanks<span><span> for good product and for your help. Pay a bit more attention on documentation ;)</span></span></p>\r\n<p><span><span>Good luck<br></span></span></p>",
    "PostedDate": "2010-09-02T04:34:36.967-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]