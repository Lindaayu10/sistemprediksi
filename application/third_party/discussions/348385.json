[
  {
    "Id": "809534",
    "ThreadId": "348385",
    "Html": "\r\n<p>PHPExcel - 86490</p>\r\n<p>Writer - 2007</p>\r\n<p><br>\r\nI have a spread sheet with around 12,000 rows, I am setting data validation on 2 columns using the following code...</p>\r\n<p></p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre>\t$objValidation = $sheet-&gt;getCell(<span style=\"color:#a31515\">'I2'</span>)-&gt;getDataValidation();\r\n\t$objValidation-&gt;setType( PHPExcel_Cell_DataValidation::TYPE_DECIMAL );\r\n\t$objValidation-&gt;setOperator( PHPExcel_Cell_DataValidation::OPERATOR_BETWEEN );\t\t\r\n\t$objValidation-&gt;setErrorStyle( PHPExcel_Cell_DataValidation::STYLE_STOP );\r\n\t$objValidation-&gt;setAllowBlank(true);\r\n\t$objValidation-&gt;setShowInputMessage(true);\r\n\t$objValidation-&gt;setShowErrorMessage(true);\r\n\t$objValidation-&gt;setErrorTitle(<span style=\"color:#a31515\">'Discount % Error'</span>);\r\n\t$objValidation-&gt;setError(<span style=\"color:#a31515\">'Only numbers between 1 and 100 are allowed in this column.'</span>);\r\n\t$objValidation-&gt;setPromptTitle(<span style=\"color:#a31515\">'Discount %'</span>);\r\n\t$objValidation-&gt;setPrompt(<span style=\"color:#a31515\">'Enter a discount % between 1 and 100.'</span>);\r\n\t$objValidation-&gt;setFormula1(1.00);\r\n\t$objValidation-&gt;setFormula2(100.00);\r\n\t\r\n\t$objValidation1 = $sheet-&gt;getCell(<span style=\"color:#a31515\">'J2'</span>)-&gt;getDataValidation();\r\n\t$objValidation1-&gt;setType( PHPExcel_Cell_DataValidation::TYPE_DECIMAL );\r\n\t$objValidation1-&gt;setOperator( PHPExcel_Cell_DataValidation::OPERATOR_GREATERTHAN );\t\r\n\t$objValidation1-&gt;setErrorStyle( PHPExcel_Cell_DataValidation::STYLE_STOP );\r\n\t$objValidation1-&gt;setAllowBlank(true);\r\n\t$objValidation1-&gt;setShowInputMessage(true);\r\n\t$objValidation1-&gt;setShowErrorMessage(true);\r\n\t$objValidation1-&gt;setErrorTitle(<span style=\"color:#a31515\">'Nett Price Error'</span>);\r\n\t$objValidation1-&gt;setError(<span style=\"color:#a31515\">'Only numbers greater than 0 allowed in this column.'</span>);\r\n\t$objValidation1-&gt;setPromptTitle(<span style=\"color:#a31515\">'Nett Price'</span>);\r\n\t$objValidation1-&gt;setPrompt(<span style=\"color:#a31515\">'Enter a number greater than 0.'</span>);\r\n\t$objValidation1-&gt;setFormula1(0);\r\n\r\n------------------------------------\r\n\r\n<span style=\"white-space:pre\">\t</span>$sheet-&gt;getCell(<span style=\"color:#a31515\">'I'</span> .$row)-&gt;setDataValidation(<span style=\"color:blue\">clone</span> $objValidation);\r\n\t$sheet-&gt;getCell(<span style=\"color:#a31515\">'J'</span> .$row)-&gt;setDataValidation(<span style=\"color:blue\">clone</span> $objValidation1);\r\n</pre>\r\n</div>\r\n<p></p>\r\n<p><br>\r\nThe problem is that when I try to save in excel it is taking around a minute to save the file.</p>\r\n<p>If I use Save As in Excel and select XLS 2003 then the file saves immediately.</p>\r\n<p>If I remove the data validation that I have set in PHPExcel and add it using Excel itself then the file saves immediately.</p>\r\n<p>Is there a way I can set the validation to a whole range instead of setting it cell by cell, I think this might be the problem?</p>\r\n",
    "PostedDate": "2012-03-13T04:23:36.71-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "810171",
    "ThreadId": "348385",
    "Html": "<p>After looking at the XML file inside the different files, this is definitely due to me having to clone data validation per row instead of applying it to a range of cells.</p>\n<p>In the file where I created the validation using Excel the XML is one entry;</p>\n<p>&nbsp;</p>\n<div style=\"color: black; background-color: white;\">\n<pre><span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">dataValidations</span> <span style=\"color: red;\">count</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">2</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">&gt;</span></pre>\n<pre><span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">dataValidation</span> <span style=\"color: red;\">type</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">decimal</span><span style=\"color: black;\">\"</span> <span style=\"color: red;\">allowBlank</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">1</span><span style=\"color: black;\">\"</span> <span style=\"color: red;\">showInputMessage</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">1</span><span style=\"color: black;\">\"</span> <span style=\"color: red;\">showErrorMessage</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">1</span><span style=\"color: black;\">\"</span> <span style=\"color: red;\">errorTitle</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">Discount</span><span style=\"color: black;\">\"</span> <span style=\"color: red;\">error</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">Discount</span><span style=\"color: black;\">\"</span> <span style=\"color: red;\">promptTitle</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">Discount</span><span style=\"color: black;\">\"</span> <span style=\"color: red;\">prompt</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">Discount</span><span style=\"color: black;\">\"</span> <span style=\"color: red;\">sqref</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">I2:I12974</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">&gt;</span><span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">formula1</span><span style=\"color: blue;\">&gt;</span>1<span style=\"color: blue;\">&lt;/</span><span style=\"color: #a31515;\">formula1</span><span style=\"color: blue;\">&gt;</span><span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">formula2</span><span style=\"color: blue;\">&gt;</span>100<span style=\"color: blue;\">&lt;/</span><span style=\"color: #a31515;\">formula2</span><span style=\"color: blue;\">&gt;</span><span style=\"color: blue;\">&lt;/</span><span style=\"color: #a31515;\">dataValidation</span><span style=\"color: blue;\">&gt;</span></pre>\n<pre><span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">dataValidation</span> <span style=\"color: red;\">type</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">decimal</span><span style=\"color: black;\">\"</span> <span style=\"color: red;\">operator</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">greaterThan</span><span style=\"color: black;\">\"</span> <span style=\"color: red;\">allowBlank</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">1</span><span style=\"color: black;\">\"</span> <span style=\"color: red;\">showInputMessage</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">1</span><span style=\"color: black;\">\"</span> <span style=\"color: red;\">showErrorMessage</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">1</span><span style=\"color: black;\">\"</span> <span style=\"color: red;\">errorTitle</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">Nett</span><span style=\"color: black;\">\"</span> <span style=\"color: red;\">error</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">Nett</span><span style=\"color: black;\">\"</span> <span style=\"color: red;\">promptTitle</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">Nett</span><span style=\"color: black;\">\"</span> <span style=\"color: red;\">prompt</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">Nett</span><span style=\"color: black;\">\"</span> <span style=\"color: red;\">sqref</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">J2:J12974</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">&gt;</span><span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">formula1</span><span style=\"color: blue;\">&gt;</span>0<span style=\"color: blue;\">&lt;/</span><span style=\"color: #a31515;\">formula1</span><span style=\"color: blue;\">&gt;</span><span style=\"color: blue;\">&lt;/</span><span style=\"color: #a31515;\">dataValidation</span><span style=\"color: blue;\">&gt;</span></pre>\n<pre><span style=\"color: blue;\">&lt;/</span><span style=\"color: #a31515;\">dataValidations</span><span style=\"color: blue;\">&gt;</span>\n</pre>\n</div>\n<p>&nbsp;</p>\n<p>In the file where I created the validation using PHPExcel the XML has two entries per ROW;</p>\n<p>&nbsp;</p>\n<div style=\"color: black; background-color: white;\">\n<pre><span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">dataValidation</span> <span style=\"color: red;\">type</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">decimal</span><span style=\"color: black;\">\"</span> <span style=\"color: red;\">operator</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">greaterThan</span><span style=\"color: black;\">\"</span> <span style=\"color: red;\">allowBlank</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">1</span><span style=\"color: black;\">\"</span> <span style=\"color: red;\">showDropDown</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">1</span><span style=\"color: black;\">\"</span> <span style=\"color: red;\">showInputMessage</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">1</span><span style=\"color: black;\">\"</span> <span style=\"color: red;\">showErrorMessage</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">1</span><span style=\"color: black;\">\"</span> <span style=\"color: red;\">errorTitle</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">Nett Price Error</span><span style=\"color: black;\">\"</span> <span style=\"color: red;\">error</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">Only numbers greater than 0 allowed in this column.</span><span style=\"color: black;\">\"</span> <span style=\"color: red;\">promptTitle</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">Nett Price</span><span style=\"color: black;\">\"</span> <span style=\"color: red;\">prompt</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">Enter a number greater than 0.</span><span style=\"color: black;\">\"</span> <span style=\"color: red;\">sqref</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">J2</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">&gt;</span><span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">formula1</span><span style=\"color: blue;\">&gt;</span>0<span style=\"color: blue;\">&lt;/</span><span style=\"color: #a31515;\">formula1</span><span style=\"color: blue;\">&gt;</span><span style=\"color: blue;\">&lt;/</span><span style=\"color: #a31515;\">dataValidation</span><span style=\"color: blue;\">&gt;</span>\n</pre>\n</div>\n<div style=\"color: black; background-color: white;\">\n<pre><span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">dataValidation</span> <span style=\"color: red;\">type</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">decimal</span><span style=\"color: black;\">\"</span> <span style=\"color: red;\">allowBlank</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">1</span><span style=\"color: black;\">\"</span> <span style=\"color: red;\">showDropDown</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">1</span><span style=\"color: black;\">\"</span> <span style=\"color: red;\">showInputMessage</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">1</span><span style=\"color: black;\">\"</span> <span style=\"color: red;\">showErrorMessage</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">1</span><span style=\"color: black;\">\"</span> <span style=\"color: red;\">errorTitle</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">Discount % Error</span><span style=\"color: black;\">\"</span> <span style=\"color: red;\">error</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">Only numbers between 1 and 100 allowed in this column.</span><span style=\"color: black;\">\"</span> <span style=\"color: red;\">promptTitle</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">Discount %</span><span style=\"color: black;\">\"</span> <span style=\"color: red;\">prompt</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">Enter a discount % between 1 and 100.</span><span style=\"color: black;\">\"</span> <span style=\"color: red;\">sqref</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">I2</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">&gt;</span><span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">formula1</span><span style=\"color: blue;\">&gt;</span>1<span style=\"color: blue;\">&lt;/</span><span style=\"color: #a31515;\">formula1</span><span style=\"color: blue;\">&gt;</span><span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">formula2</span><span style=\"color: blue;\">&gt;</span>100<span style=\"color: blue;\">&lt;/</span><span style=\"color: #a31515;\">formula2</span><span style=\"color: blue;\">&gt;</span><span style=\"color: blue;\">&lt;/</span><span style=\"color: #a31515;\">dataValidation</span><span style=\"color: blue;\">&gt;</span>\n</pre>\n</div>\n<p>&nbsp;</p>\n<p>&nbsp;</p>\n<p>This is causing the XML file to be 3 times as big.</p>",
    "PostedDate": "2012-03-14T05:30:11.797-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "813306",
    "ThreadId": "348385",
    "Html": "<p>ale1981 - instead of getting each individual cell and looping to set each data validation, you should be able to use the worksheet object's setDataValidation method and pass to it your full range:&nbsp;</p>\n<div style=\"color: black; background-color: white;\">\n<pre>  $xlReader =  \\PHPExcel_IOFactory::createReader(<span style=\"color: #a31515;\">\"Excel2007\"</span>);\n  $xl = $xlReader-&gt;load(<span style=\"color: #a31515;\">\"../yourFile.xlsx\"</span>);\n  $sheet = $xl-&gt;getSheetByName(<span style=\"color: #a31515;\">\"YourSheet\"</span>);\n  $sheet-&gt;setDataValidation(<span style=\"color: #a31515;\">\"I2:I12974\"</span>, $objValidation);\n</pre>\n</div>\n<p>If you crawl through the classes you'll see that the Cell object's setDataValidation just calls the parent's (ie worksheet) setDataValidation method, passing the coordinate of the cell and the validation objects along:</p>\n<p>&nbsp;</p>\n<div style=\"color: black; background-color: white;\">\n<pre><span style=\"color: blue;\">public</span> <span style=\"color: blue;\">function</span> setDataValidation(PHPExcel_Cell_DataValidation $pDataValidation = null)\n\t{\n\t\t<span style=\"color: blue;\">if</span> (!<span style=\"color: blue;\">isset</span>($this-&gt;_parent)) {\n\t\t\t<span style=\"color: blue;\">throw</span> <span style=\"color: blue;\">new</span> Exception(<span style=\"color: #a31515;\">'Cannot set data validation for cell that is not bound to a worksheet'</span>);\n\t\t}\n\n\t\t$this-&gt;_parent-&gt;setDataValidation($this-&gt;getCoordinate(), $pDataValidation);\n\n\t\t<span style=\"color: blue;\">return</span> $this-&gt;notifyCacheController();\n\t}\n</pre>\n</div>\n<p>&nbsp;</p>\n<p>Looking at the worksheet's method you see:</p>\n<p>&nbsp;</p>\n<div style=\"color: black; background-color: white;\">\n<pre><span style=\"color: blue;\">public</span> <span style=\"color: blue;\">function</span> setDataValidation($pCellCoordinate = <span style=\"color: #a31515;\">'A1'</span>, PHPExcel_Cell_DataValidation $pDataValidation = null)\n\t{\n\t\t<span style=\"color: blue;\">if</span> ($pDataValidation === null) {\n\t\t\t<span style=\"color: blue;\">unset</span>($this-&gt;_dataValidationCollection[$pCellCoordinate]);\n\t\t} <span style=\"color: blue;\">else</span> {\n\t\t\t$this-&gt;_dataValidationCollection[$pCellCoordinate] = $pDataValidation;\n\t\t}\n\t\t<span style=\"color: blue;\">return</span> $this;\n\t}\n</pre>\n</div>\n<p>&nbsp;</p>\n<p>Lastly, looking at the Excel2007_Worksheet writer you find:</p>\n<p>&nbsp;</p>\n<div style=\"color: black; background-color: white;\">\n<pre><span style=\"color: blue;\">foreach</span> ($dataValidationCollection <span style=\"color: blue;\">as</span> $coordinate =&gt; $dv) {\n\t\t\t\t$objWriter-&gt;startElement(<span style=\"color: #a31515;\">'dataValidation'</span>);\n\n\t\t\t\t<span style=\"color: blue;\">if</span> ($dv-&gt;getType() != <span style=\"color: #a31515;\">''</span>) {\n\t\t\t\t\t$objWriter-&gt;writeAttribute(<span style=\"color: #a31515;\">'type'</span>, $dv-&gt;getType());\n\t\t\t\t}\n\n\t\t\t\t<span style=\"color: blue;\">if</span> ($dv-&gt;getErrorStyle() != <span style=\"color: #a31515;\">''</span>) {\n\t\t\t\t\t$objWriter-&gt;writeAttribute(<span style=\"color: #a31515;\">'errorStyle'</span>, $dv-&gt;getErrorStyle());\n\t\t\t\t}\n\n\t\t\t\t<span style=\"color: blue;\">if</span> ($dv-&gt;getOperator() != <span style=\"color: #a31515;\">''</span>) {\n\t\t\t\t\t$objWriter-&gt;writeAttribute(<span style=\"color: #a31515;\">'operator'</span>, $dv-&gt;getOperator());\n\t\t\t\t}\n\n\t\t\t\t$objWriter-&gt;writeAttribute(<span style=\"color: #a31515;\">'allowBlank'</span>,\t\t($dv-&gt;getAllowBlank()\t\t? <span style=\"color: #a31515;\">'1'</span>  : <span style=\"color: #a31515;\">'0'</span>));\n\t\t\t\t$objWriter-&gt;writeAttribute(<span style=\"color: #a31515;\">'showDropDown'</span>,\t\t(!$dv-&gt;getShowDropDown()\t? <span style=\"color: #a31515;\">'1'</span>  : <span style=\"color: #a31515;\">'0'</span>));\n\t\t\t\t$objWriter-&gt;writeAttribute(<span style=\"color: #a31515;\">'showInputMessage'</span>,\t($dv-&gt;getShowInputMessage()\t? <span style=\"color: #a31515;\">'1'</span>  : <span style=\"color: #a31515;\">'0'</span>));\n\t\t\t\t$objWriter-&gt;writeAttribute(<span style=\"color: #a31515;\">'showErrorMessage'</span>,\t($dv-&gt;getShowErrorMessage()\t? <span style=\"color: #a31515;\">'1'</span>  : <span style=\"color: #a31515;\">'0'</span>));\n\n\t\t\t\t<span style=\"color: blue;\">if</span> ($dv-&gt;getErrorTitle() !== <span style=\"color: #a31515;\">''</span>) {\n\t\t\t\t\t$objWriter-&gt;writeAttribute(<span style=\"color: #a31515;\">'errorTitle'</span>, $dv-&gt;getErrorTitle());\n\t\t\t\t}\n\t\t\t\t<span style=\"color: blue;\">if</span> ($dv-&gt;getError() !== <span style=\"color: #a31515;\">''</span>) {\n\t\t\t\t\t$objWriter-&gt;writeAttribute(<span style=\"color: #a31515;\">'error'</span>, $dv-&gt;getError());\n\t\t\t\t}\n\t\t\t\t<span style=\"color: blue;\">if</span> ($dv-&gt;getPromptTitle() !== <span style=\"color: #a31515;\">''</span>) {\n\t\t\t\t\t$objWriter-&gt;writeAttribute(<span style=\"color: #a31515;\">'promptTitle'</span>, $dv-&gt;getPromptTitle());\n\t\t\t\t}\n\t\t\t\t<span style=\"color: blue;\">if</span> ($dv-&gt;getPrompt() !== <span style=\"color: #a31515;\">''</span>) {\n\t\t\t\t\t$objWriter-&gt;writeAttribute(<span style=\"color: #a31515;\">'prompt'</span>, $dv-&gt;getPrompt());\n\t\t\t\t}\n\n\t\t\t\t<strong>$objWriter-&gt;writeAttribute(<span style=\"color: #a31515;\">'sqref'</span>, $coordinate);</strong>\n\n\t\t\t\t<span style=\"color: blue;\">if</span> ($dv-&gt;getFormula1() !== <span style=\"color: #a31515;\">''</span>) {\n\t\t\t\t\t$objWriter-&gt;writeElement(<span style=\"color: #a31515;\">'formula1'</span>, $dv-&gt;getFormula1());\n\t\t\t\t}\n\t\t\t\t<span style=\"color: blue;\">if</span> ($dv-&gt;getFormula2() !== <span style=\"color: #a31515;\">''</span>) {\n\t\t\t\t\t$objWriter-&gt;writeElement(<span style=\"color: #a31515;\">'formula2'</span>, $dv-&gt;getFormula2());\n\t\t\t\t}\n\n\t\t\t\t$objWriter-&gt;endElement();\n\t\t\t}\n</pre>\n</div>\n<p>&nbsp;</p>\n<p>That bold line is setting the sqref attribute of the dataValidation node to match whatever string (aka coordinate) you passed to the dataValidationCollection using the setDataValidation method of the worksheet. &nbsp;So if you pass \"I2:I12974\" then that's what'll  go into the sqref (Sequence of References). &nbsp;By the way, if you have a non-continuous range you can also hit all of those with one validation by separating them with spaces (eg \"I2:I6 I20:I30 K1:K3\" etc).</p>\n<p>Hope that helps!</p>\n<p>Alex</p>",
    "PostedDate": "2012-03-20T18:09:58.28-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "815485",
    "ThreadId": "348385",
    "Html": "<p>Thanks Alex, I did not know the method existed for the worksheet, this worked great and has solved the issue.</p>",
    "PostedDate": "2012-03-26T03:40:47.693-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "955388",
    "ThreadId": "348385",
    "Html": "\r\n<p>please help me about to put formula on large row without using iteration, cant find it anywhere on mr google.</p>\r\n<p>big thanks.</p>\r\n",
    "PostedDate": "2012-12-12T20:13:12.93-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1013726",
    "ThreadId": "348385",
    "Html": "I'm a chinese,Thanks a lot.It's awsome.<br />\n",
    "PostedDate": "2013-03-12T00:55:06.463-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]