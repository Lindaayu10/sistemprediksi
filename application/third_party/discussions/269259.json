[
  {
    "Id": "658845",
    "ThreadId": "269259",
    "Html": "\r\n<p>I was comparing Spreadsheet_Excel_Reader (2007) to PHPExcel for reading a 360 row excel document.</p>\r\n<p>The former took .20seconds and the latter took 1.8s. Is there anything I can do to speed up performance of reading a document?</p>\r\n<p>Here is PHP Excel code:</p>\r\n<p></p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre>&lt;?php\r\n\r\n$time_start = microtime(true);\r\n\r\n<span style=\"color:green\">#########################################################################################################</span>\r\n\r\n<span style=\"color:blue\">include</span> <span style=\"color:#a31515\">'PHPExcel/Classes/PHPExcel.php'</span>;\r\n\r\n<span style=\"color:green\">/** PHPExcel_IOFactory - Reader */</span>\r\n<span style=\"color:blue\">include</span> <span style=\"color:#a31515\">'PHPExcel/Classes/PHPExcel/IOFactory.php'</span>;\r\n\r\n\r\n$inputFileName = <span style=\"color:#a31515\">&quot;file1.xls&quot;</span>;  \r\n$inputFileType = PHPExcel_IOFactory::identify($inputFileName);  \r\n$objReader = PHPExcel_IOFactory::createReader($inputFileType);  \r\n$objReader-&gt;setReadDataOnly(true);  \r\n$objPHPExcel = $objReader-&gt;load($inputFileName);  \r\n\r\n\r\n$objWorksheet = $objPHPExcel-&gt;setActiveSheetIndex(0);\r\n$highestRow = $objWorksheet-&gt;getHighestRow();\r\n$highestColumn = $objWorksheet-&gt;getHighestColumn();\r\n\r\n$r = -1;\r\n$namedDataArray = <span style=\"color:blue\">array</span>();\r\n<span style=\"color:blue\">for</span> ($row = 1; $row &lt;= $highestRow; &#43;&#43;$row) {\r\n    $dataRow = $objWorksheet-&gt;rangeToArray(<span style=\"color:#a31515\">'A'</span>.$row.<span style=\"color:#a31515\">':'</span>.$highestColumn.$row,null, true, true, true);\r\n    <span style=\"color:blue\">if</span> ((<span style=\"color:blue\">isset</span>($dataRow[$row][<span style=\"color:#a31515\">'A'</span>])) &amp;&amp; ($dataRow[$row][<span style=\"color:#a31515\">'A'</span>] &gt; <span style=\"color:#a31515\">''</span>)) {\r\n        &#43;&#43;$r;\r\n        <span style=\"color:blue\">echo</span> <span style=\"color:#a31515\">'Doing row #'</span>. $r .<span style=\"color:#a31515\">'&lt;br/&gt;'</span>;\r\n        <span style=\"color:green\">//$namedDataArray[$r] = $dataRow[$row];</span>\r\n    }\r\n}\r\n\r\n<span style=\"color:green\">#########################################################################################################</span>\r\n\r\n<span style=\"color:green\">//echo '&lt;pre&gt;';</span>\r\n<span style=\"color:green\">//var_dump($namedDataArray);</span>\r\n<span style=\"color:green\">//echo '&lt;/pre&gt;&lt;hr /&gt;';</span>\r\n\r\n\r\n$time_end = microtime(true);\r\n$time = $time_end - $time_start;\r\n<span style=\"color:blue\">echo</span> <span style=\"color:#a31515\">'&lt;br/&gt;Took: '</span>. $time .<span style=\"color:#a31515\">' seconds'</span>;\r\n<span style=\"color:green\">//average 1.8s</span>\r\n<br><br>###############################################################################################################################################\r\n</pre>\r\n</div>\r\n<p></p>\r\n<p>Here is the Spreadsheet writer code:</p>\r\n<pre>###############################################################################################################################################<br></pre>\r\n<p></p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre>&lt;?php\r\n\r\n$time_start = microtime(true);\r\n<span style=\"color:green\">#########################################################################################################</span>\r\n\r\n<span style=\"color:blue\">include</span> <span style=\"color:#a31515\">'Spreadsheet_Excel_Reader/reader.php'</span>;\r\n\r\n$inputFileName = <span style=\"color:#a31515\">&quot;file1.xls&quot;</span>;  \r\n$reader = <span style=\"color:blue\">new</span> Spreadsheet_Excel_Reader();\r\n$reader-&gt;setOutputEncoding(<span style=\"color:#a31515\">&quot;UTF-8&quot;</span>);\r\n$reader-&gt;read($inputFileName);\r\n\r\n<span style=\"color:green\"># Traverse Rows</span>\r\n\r\n<span style=\"color:green\">//$_CellValue = $_Reader-&gt;getRC($_Row, $_CellCol);</span>\r\n<span style=\"color:blue\">for</span> ($i = 1; $i &lt;= $reader-&gt;sheets[0][<span style=\"color:#a31515\">'numRows'</span>]; $i&#43;&#43;) {\r\n  <span style=\"color:blue\">for</span> ($j = 1; $j &lt;= $reader-&gt;sheets[0][<span style=\"color:#a31515\">'numCols'</span>]; $j&#43;&#43;) {\r\n    <span style=\"color:blue\">echo</span> <span style=\"color:#a31515\">&quot;\\&quot;&quot;</span>.$reader-&gt;sheets[0][<span style=\"color:#a31515\">'cells'</span>][$i][$j].<span style=\"color:#a31515\">&quot;\\&quot;,&quot;</span>;\r\n  }\r\n  <span style=\"color:blue\">echo</span> <span style=\"color:#a31515\">&quot;\\n&quot;</span>;\r\n}\r\n\r\n\r\n<span style=\"color:green\">####################################################################################</span>\r\n\r\n$time_end = microtime(true);\r\n$time = $time_end - $time_start;\r\n<span style=\"color:blue\">echo</span> <span style=\"color:#a31515\">'&lt;br/&gt;Took: '</span>. $time .<span style=\"color:#a31515\">' seconds'</span>;\r\n<span style=\"color:green\">//average .2s</span>\r\n\r\n</pre>\r\n</div>\r\n<p></p>\r\n<p>&nbsp;</p>\r\n",
    "PostedDate": "2011-08-16T07:24:57.043-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]