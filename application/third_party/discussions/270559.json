[
  {
    "Id": "663928",
    "ThreadId": "270559",
    "Html": "\r\n<p>The OOCalc Reader does not seem to set the data value, just the column ID for parsing, on repeated cells if the cell XML uses attribute 'number-columns-repeated' (which LibreOffice seems to use extensively unlike OpenOffice.org).</p>\r\n<p>So I edited the following in OOCalc.php, and it seems to resolve it -- basically just copy-pasting the cell setter code after $columnID is changed...</p>\r\n<p>&nbsp;</p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre><span style=\"color:blue\">if</span> (<span style=\"color:blue\">isset</span>($cellDataTableAttributes[<span style=\"color:#a31515\">'number-columns-repeated'</span>])) {\r\n<span style=\"color:green\">//\techo 'Repeated '.$cellDataTableAttributes['number-columns-repeated'].' times&lt;br /&gt;';</span>\r\n\t$columnID = PHPExcel_Cell::stringFromColumnIndex(PHPExcel_Cell::columnIndexFromString($columnID) &#43; $cellDataTableAttributes[<span style=\"color:#a31515\">'number-columns-repeated'</span>] - 2);\r\n\t\r\n\t<span style=\"color:blue\">if</span> (!is_null($type)) { <span style=\"color:green\">// new, like above</span>\r\n\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;getCell($columnID.$rowID)-&gt;setValueExplicit((($hasCalculatedValue) ? $cellDataFormula : $dataValue),$type);\r\n\t\t<span style=\"color:blue\">if</span> ($hasCalculatedValue) {\r\n<span style=\"color:green\">//\t\techo 'Formula result is '.$dataValue.'&lt;br /&gt;';</span>\r\n\t\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;getCell($columnID.$rowID)-&gt;setCalculatedValue($dataValue);\r\n\t\t}\r\n\t\t<span style=\"color:blue\">if</span> (($cellDataOfficeAttributes[<span style=\"color:#a31515\">'value-type'</span>] == <span style=\"color:#a31515\">'date'</span>) ||\r\n\t\t\t($cellDataOfficeAttributes[<span style=\"color:#a31515\">'value-type'</span>] == <span style=\"color:#a31515\">'time'</span>)) {\r\n\t\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle($columnID.$rowID)-&gt;getNumberFormat()-&gt;setFormatCode($formatting);\r\n\t\t}\r\n\t\t<span style=\"color:blue\">if</span> (!is_null($hyperlink)) {\r\n\t\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;getCell($columnID.$rowID)-&gt;getHyperlink()-&gt;setUrl($hyperlink);\r\n\t\t}\r\n\t}\r\n}\r\n</pre>\r\n</div>\r\n<p>I hope that some of these OOCalc fixes (doubles, rich text, this one) if OK could appear in the next PHPExcel. :)</p>\r\n<p>&nbsp;</p>\r\n",
    "PostedDate": "2011-08-26T10:07:33.917-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]