[
  {
    "Id": "921862",
    "ThreadId": "398029",
    "Html": "\r\n<p>Hi there,&nbsp;</p>\r\n<p>I have developped a program which consists of creating new Excel worksheets containing different cells. The next step would be to generate a vertical bar chart to display various data retrieved from data cells.</p>\r\n<p>All the chart examples work fine, I don't encounter any specific problem, however whenever I try to create my own chart, by calling the rangeToArray() and fromArray() methods, nothing appears in the worksheet, see the subset of my code below to clarify this\r\n issue:</p>\r\n<p>The first step consists of creating a new worksheet containing two cells with 40 data per cell, after that, I retrieve the data from those cells by calling rangeToArray() method, then the final step is to call the fromArray() method to use these data to\r\n create a graph but it does not work, the graph remains empty, I can only display the title and the yAxisLabel,</p>\r\n<p>I suspect a problem with the fromArray() method but I can't figure out why, could you please help me by giving a similar working example by using this approach? Thanks in advance</p>\r\n<p>$retrieve_data = array();</p>\r\n<p>$retrieve_data =&nbsp;$worksheet-&gt;rangetoArray(&quot;D8:E48&quot;,null,null,null);</p>\r\n<p>$worksheet = $objPHPExcel-&gt;getActiveSheet();<span> </span>&nbsp;&nbsp;</p>\r\n<p>$objWorksheet = $worksheet;&nbsp;&nbsp;&nbsp;</p>\r\n<p>$objWorksheet-&gt;fromArray($retrieve_data, NULL, 'D8', false);</p>\r\n<p>$dataseriesLabels = array(<span> </span>new PHPExcel_Chart_DataSeriesValues('String', 'Worksheet!$D$8', null, 1),&nbsp;new PHPExcel_Chart_DataSeriesValues('String', 'Worksheet!$E$8', null, 1),);</p>\r\n<p>$xAxisTickValues = array(<span> </span>new PHPExcel_Chart_DataSeriesValues('String', 'Worksheet!$D$8:$D$27', null, 20),);</p>\r\n<p>$dataSeriesValues = array(<span> </span>new PHPExcel_Chart_DataSeriesValues('Number', 'Worksheet!$D$8:$D$27', null, 20),<span>\r\n</span>new PHPExcel_Chart_DataSeriesValues('Number', 'Worksheet!$E$8:$E$27', null, 20),);</p>\r\n<p>$series = new PHPExcel_Chart_DataSeries(<span> </span>PHPExcel_Chart_DataSeries::TYPE_BARCHART,&nbsp;plotType<span>\r\n</span>PHPExcel_Chart_DataSeries::GROUPING_STANDARD,<span> </span>range(0, count($dataSeriesValues)-1),<span>&nbsp;</span>$dataseriesLabels,<span>\r\n</span>$xAxisTickValues,<span> </span>$dataSeriesValues);</p>\r\n<p>$series-&gt;setPlotDirection(PHPExcel_Chart_DataSeries::DIRECTION_COL);</p>\r\n<p>$plotarea = new PHPExcel_Chart_PlotArea(null, array($series));</p>\r\n<p>$legend = new PHPExcel_Chart_Legend(PHPExcel_Chart_Legend::POSITION_RIGHT, null, false);</p>\r\n<p>$title = new PHPExcel_Chart_Title('Test Column Chart');</p>\r\n<p>$yAxisLabel = new PHPExcel_Chart_Title('Value');</p>\r\n<p>$chart = new PHPExcel_Chart(<span> </span>'chart1',<span> </span>$title,<span>\r\n</span>$legend,<span> </span>$plotarea,<span> </span>true,<span> </span>0,<span> </span>\r\nnull,<span> </span>$yAxisLabel);</p>\r\n<p>$chart-&gt;setTopLeftPosition('G2');</p>\r\n<p>$chart-&gt;setBottomRightPosition('S20');</p>\r\n<p>$objWorksheet-&gt;addChart($chart);</p>\r\n<p>header('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');&nbsp; &nbsp;header('Content-Disposition: attachment;filename=&quot;BAL_Delhaize2012.xlsx&quot;');&nbsp; &nbsp;header('Cache-Control: max-age=0');<br>\r\n&nbsp; $objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, 'Excel2007');&nbsp;</p>\r\n<p>$objWriter-&gt;setIncludeCharts(TRUE);&nbsp;</p>\r\n<p>$objWriter-&gt;save('php://output');</p>\r\n",
    "PostedDate": "2012-10-04T06:00:34.763-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "922276",
    "ThreadId": "398029",
    "Html": "<p>Hi there,&nbsp;</p>\r\n<p>I made some typo in my code, here's the little change. The cells data are retrieved with the rangeToArray() method like this:</p>\r\n<p>$retrieve_data = array();</p>\r\n<p>$retrieve_data =&nbsp;$worksheet-&gt;rangetoArray(\"D8:E48\",null,null,null);</p>\r\n<p>&nbsp;</p>\r\n<p>Then, the data series labels is as follows:</p>\r\n<p><span>$dataseriesLabels = array(</span><span>&nbsp;</span><span>new PHPExcel_Chart_DataSeriesValues('String', 'Worksheet!$D$8', null, 1),&nbsp;</span>new PHPExcel_Chart_DataSeriesValues('String', 'Worksheet!$E$8', null, 1),);</p>\r\n<p>and the x-Axis tick values as follows:</p>\r\n<p><span>$xAxisTickValues = array(</span><span>&nbsp;</span><span>new PHPExcel_Chart_DataSeriesValues('String', 'Worksheet!$D$9:$D$29', null, 20),);</span></p>\r\n<p>&nbsp;</p>\r\n<p><span>If I use the following array with the same code it works fine:</span></p>\r\n<p><span>$objWorksheet-&gt;fromArray(<span> </span>array(<span> </span>array('',<span> </span>2010,<span> </span>2011,<span> </span>2012),&nbsp;</span>array('1', &nbsp; 12, &nbsp; 15, 21), array('2', &nbsp; 56, &nbsp; 73, 86), array('3', &nbsp; 52, &nbsp; 61, 69), ... ....)),</p>\r\n<p>On the other hand, if I call the rangeToArray() to display the same data in a bar graph, it doesn't work, there is no error message, what's wrong?</p>\r\n<p>By the way, does anybody know the best way to debug chart problems when we are faced with such a similar problem? Thanks in advance for your help</p>\r\n<p>&nbsp;</p>\r\n<p>Yves Hardy</p>",
    "PostedDate": "2012-10-04T21:31:07.15-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]