[
  {
    "Id": "915238",
    "ThreadId": "396276",
    "Html": "\r\n<p>Recently I have been working on some code that reads an Excel spreadsheet and imports the data into a remote database. When I run my script I get the following error message.....</p>\r\n<p><strong>Fatal error</strong><span>: Uncaught exception 'Exception' with message 'Could not open spreadsheet.xls for reading! File does not exist.' in /home/xoxox/public_html/xoxo/source/vendors/PHPExcel/Classes/PHPExcel/Reader/Excel5.php:519 Stack trace:\r\n #0 /home/xoxox/public_html/xoxox/source/vendors/PHPExcel/Classes/PHPExcel/IOFactory.php(258): PHPExcel_Reader_Excel5-&gt;canRead('spreadsheet.xls') #1 /home/xoxox/public_html/xoxox/source/vendors/PHPExcel/Classes/PHPExcel/IOFactory.php(192): PHPExcel_IOFactory::createReaderForFile('spreadsheet.xls')\r\n #2 /home/xoxox/public_html/xoxox/source/app/controllers/coverages_controller.php(209): PHPExcel_IOFactory::load('spreadsheet.xls') #3 [internal function]: CoveragesController-&gt;processSpreadsheet() #4 /home/xoxox/public_html/xoxox/source/cake/dispatcher.php(204):\r\n call_user_func_array(Array, Array) #5 /home/xoxox/public_html/xoxox/source/cake/dispatcher.php(171): Dispatcher-&gt;_invoke(Object(CoveragesController), Array) #6 /home/xoxox/public_html/xoxox/source/app/webroot/index.php(83): Dispatcher-&gt;dispatch() #7\r\n {main} in&nbsp;</span><strong>/home/xoxox/public_html/xoxox/source/vendors/PHPExcel/Classes/PHPExcel/Reader/Excel5.php</strong><span>&nbsp;on line&nbsp;</span><strong>519</strong></p>\r\n<p>Now with that said, I have read a couple of posts concerning the same issue but I didn't find a definite solution to the problem. Here is my script</p>\r\n<p>&nbsp;</p>\r\n<pre>public function processSpreadsheet() {\n$saveTimeZone = date_default_timezone_get();\ndate_default_timezone_set('UTC'); // Php's date function uses this value!\n\nrequire_once '/home/xoxox/public_html/xoxoxo/source/vendors/PHPExcel/Classes/PHPExcel/IOFactory.php';\n$objPHPExcel = PHPExcel_IOFactory::load(&quot;spreadsheet.xls&quot;);\nforeach ($objPHPExcel-&gt;getWorksheetIterator() as $worksheet) {\n    $worksheetTitle     = $worksheet-&gt;getTitle();\n    $highestRow         = $worksheet-&gt;getHighestRow(); // e.g. 10\n    $highestColumn      = $worksheet-&gt;getHighestColumn(); // e.g 'F'\n    $highestColumnIndex = PHPExcel_Cell::columnIndexFromString($highestColumn);\n    $nrColumns = ord($highestColumn) - 64;\n    echo &quot;<br>The Worksheet &quot;.$worksheetTitle.&quot; has &quot;;\n    echo $nrColumns . ' columns (A-' . $highestColumn . ') ';\n    echo ' and ' . $highestRow . ' rows.';\n    echo '<br>Data: ';\n    for ($row = 1; $row &lt;= $highestRow; &#43;&#43; $row) {\n\n        $rw1 = $worksheet-&gt;getCellByColumnAndRow(1,$row)-&gt;getValue();\n                    $rw2 = $worksheet-&gt;getCellByColumnAndRow(2,$row)-&gt;getValue();\n                    $rw3 = $worksheet-&gt;getCellByColumnAndRow(3,$row)-&gt;getValue();\n                    $rw4 = $worksheet-&gt;getCellByColumnAndRow(4,$row)-&gt;getValue();\n                    $rw5 = $worksheet-&gt;getCellByColumnAndRow(5,$row)-&gt;getValue();\n                    $rw6 = $worksheet-&gt;getCellByColumnAndRow(6,$row)-&gt;getValue();\n                    $rw7 = $worksheet-&gt;getCellByColumnAndRow(7,$row)-&gt;getValue();\n                    $rw8 = $worksheet-&gt;getCellByColumnAndRow(8,$row)-&gt;getValue();\n                    $rw9 = $worksheet-&gt;getCellByColumnAndRow(9,$row)-&gt;getValue();\n                    $rw10 = $worksheet-&gt;getCellByColumnAndRow(10,$row)-&gt;getValue();\n                    $rw11 = $worksheet-&gt;getCellByColumnAndRow(11,$row)-&gt;getValue();\n\n        $slic = mysql_connect(&quot;xoxoxoxo&quot;, &quot;xoxoxoxo&quot;, &quot;xoxoxo&quot;);\n                      if(!$slic) {\n                    die('Could not connect' . mysql_error());;\n\n                        }\n        mysql_select_db(&quot;xoxoxo&quot;, $slic); \n        $dbc = &quot;INSERT INTO  Coverages( Name, Comments, Premium, Effective_Date, Expiration_Date, Broker_First_Name , Broker_Middle_Initial, Broker_Last_Name, Broker_Suffix, Broker_License_Number,  DateCreated)\n                VALUES ('$rw1','$rw10','$rw2','$rw3', '$rw4', '$rw5','$rw6', '$rw7', '$rw8', '$rw9', '$rw11')&quot;;\n\n            for ($col = 0; $col &lt; $highestColumnIndex; &#43;&#43; $col) {\n            $cell = $worksheet-&gt;getCellByColumnAndRow($col, $row);\n            $val = $cell-&gt;getFormattedValue();\n            $dataType = PHPExcel_Cell_DataType::dataTypeForValue($val);\n            echo '';\n        }\n         $conn = mysql_query($dbc, $conn); {\n            if (!msql_query($dbc, $conn)) {\n                die ('Error: ' . mysql_error());\n                echo &quot;recorded added&quot;;\n            }\n         }\n\n\n    }\n    \n}\n\ndate_default_timezone_set($saveTimeZone);\n}</pre>\r\n<p>&nbsp;</p>\r\n<table border=\"1\">\r\n<tbody>\r\n<tr>\r\n<td>' . $val . '<br>\r\n</td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n<p>Having said all that, I think I have some errors in my coding. Any input on this issue would be greatly appreciated! Thank You!</p>\r\n",
    "PostedDate": "2012-09-20T09:08:31.713-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "915282",
    "ThreadId": "396276",
    "Html": "<p>You're looking for the file spreadsheet.xls in the current working directory of your script (which can be ascertained using the getcwd() function in PHP): either the file is not at that location, or your PHP execution doesn't have permissions to access the file.</p>",
    "PostedDate": "2012-09-20T10:40:00.243-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "915325",
    "ThreadId": "396276",
    "Html": "<p>Thanks Mark!! You are awesome!!</p>",
    "PostedDate": "2012-09-20T12:12:14.14-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]