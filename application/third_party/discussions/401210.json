[
  {
    "Id": "934119",
    "ThreadId": "401210",
    "Html": "\r\n<p>Here is my code.</p>\r\n<p>&nbsp;</p>\r\n<p>No errors, PDF is created but not formatted with my settings at all.</p>\r\n<p>&nbsp;</p>\r\n<p>Really frustrating.</p>\r\n<p>&nbsp;</p>\r\n<p>Plese help.</p>\r\n<p>&nbsp;</p>\r\n<p><br>\r\n<span></span>$fileLocation = $file_directory.&quot;certificates/&quot;;<span> </span>$fileName = &quot;Payment Certificate - &quot;.$_GET[&quot;invoice&quot;].&quot;.xlsx&quot;;<br>\r\n<span></span>error_reporting(E_ALL);<span> </span>ini_set(&quot;display_errors&quot;, TRUE);<span>\r\n</span>ini_set(&quot;display_startup_errors&quot;, TRUE);<br>\r\n<span></span>define(&quot;EOL&quot;,(PHP_SAPI == &quot;cli&quot;) ? PHP_EOL : &quot;&lt;br /&gt;&quot;);<br>\r\n<span></span>require_once &quot;include/PHPExcel.php&quot;;<span> </span>require_once &quot;include/PHPExcel/IOFactory.php&quot;;<br>\r\n<span></span>// NB -- SPECIFY RENDERING LIBRARY<span> </span>$rendererName = PHPExcel_Settings::PDF_RENDERER_DOMPDF;<span>\r\n</span>$rendererLibrary = 'DomPDF';<span> </span>$rendererLibraryPath = 'include/PHPExcel/Writer/PDF/';<span>\r\n</span>if (!PHPExcel_Settings::setPdfRenderer(<span> </span>$rendererName,<span> </span>\r\n$rendererLibraryPath<span> </span>))<span> </span>{<span> </span>die('Please set the RENDER NAME and RENDER LIBRARY PATH (serveFile.php LINE: 34)');<span>\r\n</span>}<br>\r\n<span></span>// LOAD EXCEL FILE<span> </span>$objPHPExcel = PHPExcel_IOFactory::load(preg_replace(&quot;/ /&quot;,&quot;_&quot;,$fileLocation.$fileName));<br>\r\n<span></span>$sheets = $objPHPExcel-&gt;getSheetNames();<br>\r\n<span></span>$objPageSetup = new PHPExcel_Worksheet_PageSetup();<span> </span>$objPageSetup-&gt;setPaperSize(PHPExcel_Worksheet_PageSetup::PAPERSIZE_A4);<span>\r\n</span>$objPageSetup-&gt;setFitToPage(true);<span> </span>$objPageSetup-&gt;setFitToHeight(1);<span>\r\n</span>$objPageSetup-&gt;setFitToWidth(1);<span> </span>$objPageSetup-&gt;setHorizontalCentered(true);<span>\r\n</span>$objPageSetup-&gt;setVerticalCentered(true);<br>\r\n<span></span>foreach ($sheets as $key=&gt;$value)<span> </span>{<span> </span>$objPHPExcel-&gt;setActiveSheetIndex(array_search($value, $sheets))-&gt;setShowGridlines(false);<span>\r\n</span>switch ($value)<span> </span>{<span> </span>case &quot;Tax Invoice&quot;:<span> </span>\r\n{<span> </span>$objPageSetup-&gt;setOrientation(PHPExcel_Worksheet_PageSetup::ORIENTATION_LANDSCAPE);<span>\r\n</span>$objPageSetup-&gt;setPrintArea(&quot;B2:C50&quot;);<span> </span>break;<span> </span>\r\n}<span> </span>case &quot;Payment Certificate&quot;:<span> </span>{<span> </span>$objPageSetup-&gt;setOrientation(PHPExcel_Worksheet_PageSetup::ORIENTATION_LANDSCAPE);<span>\r\n</span>$objPageSetup-&gt;setPrintArea(&quot;B2:L88&quot;);<span> </span>break;<span> </span>\r\n}<span> </span>case &quot;Time Based&quot;:<span> </span>case &quot;Travel Time&quot;:<span> </span>case &quot;Motor Vehicle&quot;:<span>\r\n</span>case &quot;Car Hire&quot;:<span> </span>case &quot;Flights&quot;:<span> </span>case &quot;Accommodation&quot;:<span>\r\n</span>case &quot;Other&quot;:<span> </span>case &quot;Toll Gate&quot;:<span> </span>case &quot;Prints &amp; Copies&quot;:<span>\r\n</span>{<span> </span>$objPageSetup-&gt;setOrientation(PHPExcel_Worksheet_PageSetup::ORIENTATION_PORTRAIT);<span>\r\n</span>break;<span> </span>}<span> </span>default:<span> </span>break;<span> </span>\r\n}<span> </span>$objPHPExcel-&gt;getActiveSheet()-&gt;setPageSetup($objPageSetup);<span>\r\n</span>}<br>\r\n<span></span>// SAVE PDF FILE<span> </span>$objWriter = new PHPExcel_Writer_PDF($objPHPExcel);<span>\r\n</span>$objWriter-&gt;setSheetIndex(2);<span> </span>//$objWriter-&gt;writeAllSheets();<span>\r\n</span>$objWriter-&gt;save(preg_replace(&quot;/.xlsx/&quot;,&quot;.pdf&quot;,preg_replace(&quot;/ /&quot;,&quot;_&quot;,$fileLocation.$fileName)));<span>\r\n</span>echo date('H:i:s') . &quot;- Done writing files -&quot;;</p>\r\n",
    "PostedDate": "2012-10-30T02:27:07.56-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "934205",
    "ThreadId": "401210",
    "Html": "<p>Not all page settings work with PDF output, they're primarily intended to work with the Excel output. This includes setting print areas, alignment within the page, headers/footers, etc. The only settings that should work are paper size and orientation.</p>",
    "PostedDate": "2012-10-30T06:32:59.143-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]