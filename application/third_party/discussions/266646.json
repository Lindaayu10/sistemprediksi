[
  {
    "Id": "647968",
    "ThreadId": "266646",
    "Html": "\r\n<p>Hi,</p>\r\n<p>I have generated <a href=\"http://clients.stanfordrosenthal.com/RES/public_notices_copy.xlsx\">\r\nthis spreadsheet</a> for a client. &nbsp;It opens fine for me on Excel 2011 for Mac, but my client is using Excel 2007 for Windows and is receiving the error message below. &nbsp;He says this results in the hyperlinks not working on the effected sheets. &nbsp;</p>\r\n<p>My code:</p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre>$hyperlinkStyle = <span style=\"color:blue\">array</span>(\r\n\t<span style=\"color:#a31515\">'underline'</span> =&gt; PHPExcel_Style_Font::UNDERLINE_SINGLE,\r\n\t<span style=\"color:#a31515\">'color'</span>\t =&gt; <span style=\"color:blue\">array</span>(\r\n\t\t<span style=\"color:#a31515\">'rgb'</span> =&gt; <span style=\"color:#a31515\">'0000ff'</span>\r\n\t)\r\n);\r\n</pre>\r\n<pre>$object-&gt;getActiveSheet()-&gt;SetCellValue($column.($row), 'PDF');<span>&nbsp;</span></pre>\r\n<pre>$object-&gt;getActiveSheet()-&gt;getCell($column.($row))-&gt;getHyperlink()-&gt;setUrl($this-&gt;cleanup(pdf_path($pdf, get_class($this))));<span>&nbsp;</span></pre>\r\n<pre>$object-&gt;getActiveSheet()-&gt;getStyle($column.($row))-&gt;applyFromArray($hyperlinkStyle);<span>&nbsp;</span></pre>\r\n<pre>$object-&gt;getActiveSheet()-&gt;getStyle($column.($row))-&gt;getFont()-&gt;applyFromArray($hyperlinkStyle);<br></pre>\r\n</div>\r\n<p>(I don't remember why I have both of those last rows; they seem redundant)</p>\r\n<p>The error:</p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre><span style=\"color:blue\">&lt;?</span><span style=\"color:#a31515\">xml</span> <span style=\"color:red\">version</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">1.0</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">encoding</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">UTF-8</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">standalone</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">yes</span><span style=\"color:black\">&quot;</span> <span style=\"color:blue\">?&gt;</span>\r\n- <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">recoveryLog</span> <span style=\"color:red\">xmlns</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">http://schemas.openxmlformats.org/spreadsheetml/2006/main</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">&gt;</span>\r\n  <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">logFileName</span><span style=\"color:blue\">&gt;</span>error047240_01.xml<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">logFileName</span><span style=\"color:blue\">&gt;</span>\r\n  <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">summary</span><span style=\"color:blue\">&gt;</span>Errors were detected in file 'C:\\Users\\Sales Admin\\Downloads\\public_notices (2).xlsx'<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">summary</span><span style=\"color:blue\">&gt;</span>\r\n- <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">additionalInfo</span><span style=\"color:blue\">&gt;</span>\r\n  <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">info</span><span style=\"color:blue\">&gt;</span>Excel completed file level validation and repair. Some parts of this workbook may have been repaired or discarded.<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">info</span><span style=\"color:blue\">&gt;</span>\r\n  <span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">additionalInfo</span><span style=\"color:blue\">&gt;</span>\r\n- <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">repairedParts</span> <span style=\"color:red\">summary</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">Following is a list of repairs:</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">&gt;</span>\r\n  <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">repairedPart</span> <span style=\"color:red\">xml:space</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">preserve</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">&gt;</span>Repaired Part: /xl/worksheets/sheet1.xml part.<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">repairedPart</span><span style=\"color:blue\">&gt;</span>\r\n  <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">repairedPart</span> <span style=\"color:red\">xml:space</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">preserve</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">&gt;</span>Repaired Part: /xl/worksheets/sheet4.xml part.<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">repairedPart</span><span style=\"color:blue\">&gt;</span>\r\n  <span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">repairedParts</span><span style=\"color:blue\">&gt;</span>\r\n- <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">removedFeatures</span> <span style=\"color:red\">summary</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">Following is a list of removed features:</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">&gt;</span>\r\n  <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">removedFeature</span><span style=\"color:blue\">&gt;</span>Removed Feature: Hyperlinks from /xl/worksheets/sheet1.xml part<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">removedFeature</span><span style=\"color:blue\">&gt;</span>\r\n  <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">removedFeature</span><span style=\"color:blue\">&gt;</span>Removed Feature: Hyperlinks from /xl/worksheets/sheet4.xml part<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">removedFeature</span><span style=\"color:blue\">&gt;</span>\r\n  <span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">removedFeatures</span><span style=\"color:blue\">&gt;</span>\r\n  <span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">recoveryLog</span><span style=\"color:blue\">&gt;</span>\r\n</pre>\r\n</div>\r\n<p>&nbsp;</p>\r\n",
    "PostedDate": "2011-07-26T14:09:49.33-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "648928",
    "ThreadId": "266646",
    "Html": "<p>At first look, Excel 2007 don't like urls with space and remove all hyperlinks in the sheet. Perhaps you can try to urlencode yours links.</p>",
    "PostedDate": "2011-07-28T06:03:31.417-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]