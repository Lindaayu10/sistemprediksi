[
  {
    "Id": "613771",
    "ThreadId": "257881",
    "Html": "\r\n<p>Hello All,</p>\r\n<p>I have been using PHPExcel for quite some time now for a client of mine. I have a report written in php that he runs and he often needs to export it to excel, therefore PHPExcel was the ideal solution.</p>\r\n<p>However the reporting database has grown, and therefore so has excel. I have noticed that when excel creates a workbook with over 150 rows, its starts to go a bick haywire. Basically misplacing columns. there are 11 columns and after row 150ish it starts\r\n to put column 11 in column 1, column 10 in column 11, etc..</p>\r\n<p>If anyone can help me with this I would be very grateful, as I am getting a lot of pressure from my client and I cannot seem to figure a solution.</p>\r\n<p>Below is the code I am using:</p>\r\n<p>&nbsp;</p>\r\n<p></p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre>&lt;?php\r\n\t\t\t\t\t\t\t\t\t\t\r\n\r\n<span style=\"color:green\">/*\r\n * @category   PHPExcel\r\n * @package    PHPExcel\r\n * @copyright  Copyright (c) 2006 - 2011 PHPExcel (http://www.codeplex.com/PHPExcel)\r\n * @license    http://www.gnu.org/licenses/old-licenses/lgpl-2.1.txt\tLGPL\r\n * @version    1.7.6, 2011-02-27\r\n */</span>\r\n\r\n<span style=\"color:green\">/** Error reporting */</span>\r\nerror_reporting(E_ALL);\r\n$q=$_POST[<span style=\"color:#a31515\">&quot;my_hidden_data&quot;</span>];\r\n<span style=\"color:blue\">if</span>($q!==<span style=\"color:#a31515\">&quot;&quot;</span>)\r\n{\r\n\t$r=$_POST[<span style=\"color:#a31515\">&quot;my_hidden_row&quot;</span>];\r\n\t\r\n\t$qst=strip_tags($q);\r\n\t$data=explode(<span style=\"color:#a31515\">&quot;,&quot;</span>,$qst);\r\n\t<span style=\"color:green\">//$data=strip_tags($_data);</span>\r\n\tdate_default_timezone_set(<span style=\"color:#a31515\">'Africa/Johannesburg'</span>);\r\n\r\n\t<span style=\"color:green\">/** PHPExcel*/</span> \r\n\t<span style=\"color:blue\">require_once</span> <span style=\"color:#a31515\">'DA/Classes/PHPExcel.php'</span>;\r\n\t<span style=\"color:green\">//require_once '../Classes/PHPExcel/IOFactory.php';</span>\r\n\r\n\r\n\t<span style=\"color:green\">// Create new PHPExcel object</span>\r\n\t$objPHPExcel = <span style=\"color:blue\">new</span> PHPExcel();\r\n\r\n\t<span style=\"color:green\">// Set properties</span>\r\n\t$objPHPExcel-&gt;getProperties()-&gt;setCreator(<span style=\"color:#a31515\">&quot;WeExcel&quot;</span>)\r\n\t\t\t\t\t\t\t\t -&gt;setLastModifiedBy(<span style=\"color:#a31515\">&quot;zedd&quot;</span>)\r\n\t\t\t\t\t\t\t\t -&gt;setTitle(<span style=\"color:#a31515\">&quot;Report&quot;</span>)\r\n\t\t\t\t\t\t\t\t -&gt;setSubject(<span style=\"color:#a31515\">&quot;Client Report&quot;</span>)\r\n\t\t\t\t\t\t\t\t -&gt;setDescription(<span style=\"color:#a31515\">&quot;Report for Client.&quot;</span>)\r\n\t\t\t\t\t\t\t\t -&gt;setKeywords(<span style=\"color:#a31515\">&quot;office 2007 openxml php&quot;</span>)\r\n\t\t\t\t\t\t\t\t -&gt;setCategory(<span style=\"color:#a31515\">&quot;DB Report&quot;</span>);\r\n\r\n\r\n\t<span style=\"color:green\">/* Add some data */</span>\r\n\t$x=0;\r\n\t<span style=\"color:blue\">for</span> ($i = 1; $i &lt;=$r; $i&#43;&#43;) \r\n\t{\r\n\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;getCell(<span style=\"color:#a31515\">'A'</span> . $i)-&gt;setValueExplicit($data[$x],PHPExcel_Cell_DataType::TYPE_STRING);\r\n\t\t$x=$x&#43;1;\r\n\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;getCell(<span style=\"color:#a31515\">'B'</span> . $i)-&gt;setValueExplicit($data[$x],PHPExcel_Cell_DataType::TYPE_STRING);\r\n\t\t$x=$x&#43;1;\r\n\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;getCell(<span style=\"color:#a31515\">'C'</span> . $i)-&gt;setValueExplicit($data[$x],PHPExcel_Cell_DataType::TYPE_STRING);\r\n\t\t$x=$x&#43;1;\r\n\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;getCell(<span style=\"color:#a31515\">'D'</span> . $i)-&gt;setValueExplicit($data[$x],PHPExcel_Cell_DataType::TYPE_STRING);\r\n\t\t$x=$x&#43;1;\r\n\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;getCell(<span style=\"color:#a31515\">'E'</span> . $i)-&gt;setValueExplicit($data[$x],PHPExcel_Cell_DataType::TYPE_STRING);\r\n\t\t$x=$x&#43;1;\r\n\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;getCell(<span style=\"color:#a31515\">'F'</span> . $i)-&gt;setValueExplicit($data[$x],PHPExcel_Cell_DataType::TYPE_STRING);\r\n\t\t$x=$x&#43;1;\r\n\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;getCell(<span style=\"color:#a31515\">'G'</span> . $i)-&gt;setValueExplicit($data[$x],PHPExcel_Cell_DataType::TYPE_STRING);\r\n\t\t$x=$x&#43;1;\r\n\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;getCell(<span style=\"color:#a31515\">'H'</span> . $i)-&gt;setValueExplicit($data[$x],PHPExcel_Cell_DataType::TYPE_STRING);\r\n\t\t$x=$x&#43;1;\r\n\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;getCell(<span style=\"color:#a31515\">'I'</span> . $i)-&gt;setValueExplicit($data[$x],PHPExcel_Cell_DataType::TYPE_STRING);\r\n\t\t$x=$x&#43;1;\r\n\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;getCell(<span style=\"color:#a31515\">'J'</span> . $i)-&gt;setValueExplicit($data[$x],PHPExcel_Cell_DataType::TYPE_STRING);\r\n\t\t$x=$x&#43;1;\r\n\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;getCell(<span style=\"color:#a31515\">'K'</span> . $i)-&gt;setValueExplicit($data[$x],PHPExcel_Cell_DataType::TYPE_STRING);\r\n\t\t$x=$x&#43;1;\r\n\t\t\r\n\t\t<span style=\"color:green\">//$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('B' . $i, $data[$x]);</span>\r\n\t}\r\n\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension(<span style=\"color:#a31515\">'A'</span>)-&gt;setAutoSize(true);\r\n\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension(<span style=\"color:#a31515\">'B'</span>)-&gt;setAutoSize(true);\r\n\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension(<span style=\"color:#a31515\">'C'</span>)-&gt;setAutoSize(true);\r\n\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension(<span style=\"color:#a31515\">'D'</span>)-&gt;setAutoSize(true);\r\n\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension(<span style=\"color:#a31515\">'E'</span>)-&gt;setAutoSize(true);\r\n\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension(<span style=\"color:#a31515\">'F'</span>)-&gt;setAutoSize(true);\r\n\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension(<span style=\"color:#a31515\">'G'</span>)-&gt;setAutoSize(true);\r\n\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension(<span style=\"color:#a31515\">'H'</span>)-&gt;setAutoSize(true);\r\n\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension(<span style=\"color:#a31515\">'I'</span>)-&gt;setAutoSize(true);\r\n\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension(<span style=\"color:#a31515\">'J'</span>)-&gt;setAutoSize(true);\r\n\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension(<span style=\"color:#a31515\">'K'</span>)-&gt;setAutoSize(true);\r\n\t<span style=\"color:green\">//foreach($data as $cll)</span>\r\n\t\t<span style=\"color:green\">//$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('A' . $i, $data[$x]);</span>\r\n\t\t\r\n\t<span style=\"color:green\">// Rename sheet</span>\r\n\t$objPHPExcel-&gt;getActiveSheet()-&gt;setTitle(<span style=\"color:#a31515\">'Report'</span>);\r\n\r\n\r\n\t<span style=\"color:green\">// Set active sheet index to the first sheet, so Excel opens this as the first sheet</span>\r\n\t$objPHPExcel-&gt;setActiveSheetIndex(0);\r\n\r\n\r\n\t<span style=\"color:green\">// Redirect output to a clientï¿½s web browser (Excel2007)</span>\r\n\theader(<span style=\"color:#a31515\">'Content-Type: application/vnd.ms-excel'</span>);\r\n\theader(<span style=\"color:#a31515\">'Content-Disposition: attachment;filename=&quot;Report&quot;'</span>);\r\n\theader(<span style=\"color:#a31515\">'Cache-Control: max-age=0'</span>);\r\n\r\n\t$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, <span style=\"color:#a31515\">'Excel5'</span>);\r\n\t$objWriter-&gt;save(<span style=\"color:#a31515\">'php://output'</span>);\r\n\t<span style=\"color:green\">/*$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, 'Excel2003XML');\r\n\t$objWriter-&gt;save('php://output');\r\n\t$objWriter = new PHPExcel_Writer_Excel5($objPHPExcel);\r\n\t$objWriter-&gt;save(&quot;Report.xls&quot;);*/</span>\r\n\r\n\t<span style=\"color:blue\">exit</span>;\r\n\r\n}\r\n<span style=\"color:blue\">else</span>\r\n{\r\n<span style=\"color:blue\">echo</span> <span style=\"color:#a31515\">&quot;You have not entered any data. &lt;br /&gt;Please enter an ID Number and try again. &lt;br /&gt;Or alternatively re-try downloading the report.&quot;</span>;\r\n}\r\n\r\n?&gt;\r\n</pre>\r\n</div>\r\n<p></p>\r\n",
    "PostedDate": "2011-05-17T01:13:58.143-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]