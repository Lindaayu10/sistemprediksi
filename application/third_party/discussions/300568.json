[
  {
    "Id": "749513",
    "ThreadId": "300568",
    "Html": "\r\n<p>Hy</p>\r\n<p>i try insert head and footer using template, but in moment that my app read the file, the program show following error:</p>\r\n<p>Notice: Undefined index: margin-left in C:\\Users\\operador\\wamp\\www\\hidrocontroll\\util\\excelMicrosoft\\PHPExcel\\Reader\\Excel2007.php on line &lt;i&gt;1263&lt;/i&gt;</p>\r\n<p>&nbsp;</p>\r\n<p>C:\\Users\\operador\\wamp\\www\\hidrocontroll\\scripts\\relatorioClima\\gerarRelatorioExcel.php' bgcolor='#eeeeec'&gt;..\\gerarRelatorioExcel.php&lt;b&gt;:&lt;/b&gt;102&lt;/td&gt;&lt;/tr&gt;</p>\r\n<p><br>\r\n&lt;tr&gt;&lt;td bgcolor='#eeeeec' align='center'&gt;3&lt;/td&gt;&lt;td bgcolor='#eeeeec' align='center'&gt;0.0411&lt;/td&gt;&lt;td bgcolor='#eeeeec' align='right'&gt;3401912&lt;/td&gt;&lt;td bgcolor='#eeeeec'&gt;PHPExcel_Reader_Excel2007-&gt;load(&nbsp; )&lt;/td&gt;&lt;td\r\n title='C:\\Users\\operador\\wamp\\www\\hidrocontroll\\util\\excelMicrosoft\\PHPExcel\\IOFactory.php' bgcolor='#eeeeec'&gt;..\\IOFactory.php&lt;b&gt;:&lt;/b&gt;193&lt;/td&gt;&lt;/tr&gt;<br>\r\n&lt;/table&gt;&lt;/font&gt;</p>\r\n<p>&nbsp;</p>\r\n<p>In line 1263 on Excel2007.php the code represent is:</p>\r\n<p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $hfImages[ (string)$shape['id'] ]-&gt;setOffsetX($style['margin-left']);</p>\r\n<p>if i ajust the image on template the error ocurred, if i not ajust the same nothing problem occored, but the image will show small</p>\r\n<p>help-me</p>\r\n",
    "PostedDate": "2012-02-09T11:54:16.243-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1245500",
    "ThreadId": "300568",
    "Html": "Hi Virgilio, the request found to your problem is that page -----excel2007.php have a error for de images\r<br />\n<br />\nThe code original is:<br />\n<pre><code>           foreach ($shapes as $shape) {\n        $shape-&gt;registerXPathNamespace('v', 'urn:schemas-microsoft-com:vml');\n        $imageData = $shape-&gt;xpath('//v:imagedata');\n\n        $imageData = $imageData[0]; \n\n        $imageData = $imageData-&gt;attributes('urn:schemas-microsoft-com:office:office');\n        $style = self::toCSSArray( (string)$shape['style'] );\n        $hfImages[ (string)$shape['id'] ] = new PHPExcel_Worksheet_HeaderFooterDrawing();\n\n                    if (isset($imageData['title'])) {\n                    $hfImages[ (string)$shape['id'] ]-&gt;setName( (string)$imageData['title'] );  \n\n        }\n\n        $hfImages[ (string)$shape['id'] ]-&gt;setPath(&quot;zip://&quot;.PHPExcel_Shared_File::realpath($pFilename).&quot;#&quot; . $drawings[(string)$imageData['relid']], false);\n        $hfImages[ (string)$shape['id'] ]-&gt;setResizeProportional(false);\n        $hfImages[ (string)$shape['id'] ]-&gt;setWidth($style['width']);\n        $hfImages[ (string)$shape['id'] ]-&gt;setHeight($style['height']);\n            $hfImages[ (string)$shape['id'] ]-&gt;setOffsetX($style['margin-left']);\n                   $hfImages[ (string)$shape['id'] ]-&gt;setOffsetY($style['margin-top']);\n          $hfImages[ (string)$shape['id'] ]-&gt;setResizeProportional(true);\n\n    }\n\n</code></pre>\n\nI changed to:<br />\n<pre><code>       $i=0; //************ add  count for images___________\n\n           foreach ($shapes as $shape) {\n        $shape-&gt;registerXPathNamespace('v', 'urn:schemas-microsoft-com:vml');\n        $imageData = $shape-&gt;xpath('//v:imagedata');\n\n        $imageData = $imageData[$i]; // original 0\n\n        $imageData = $imageData-&gt;attributes('urn:schemas-microsoft-com:office:office');\n        $style = self::toCSSArray( (string)$shape['style'] );\n        $hfImages[ (string)$shape['id'] ] = new PHPExcel_Worksheet_HeaderFooterDrawing();\n\n                    if (isset($imageData['title'])) {\n                    $hfImages[ (string)$shape['id'] ]-&gt;setName( (string)$imageData['title'] );  \n\n        }\n\n        $hfImages[ (string)$shape['id'] ]-&gt;setPath(&quot;zip://&quot;.PHPExcel_Shared_File::realpath($pFilename).&quot;#&quot; . $drawings[(string)$imageData['relid']], false);\n        $hfImages[ (string)$shape['id'] ]-&gt;setResizeProportional(false);\n        $hfImages[ (string)$shape['id'] ]-&gt;setWidth($style['width']);\n        $hfImages[ (string)$shape['id'] ]-&gt;setHeight($style['height']);\n</code></pre>\n\n//**************change line<br />\n<pre><code>                   $hfImages[ (string)$shape['id'] ]-&gt;setOffsetX(isset($style['margin-left'])? $style['margin-left']:0);     end**************************///\n\n          $hfImages[ (string)$shape['id'] ]-&gt;setOffsetY($style['margin-top']);\n          $hfImages[ (string)$shape['id'] ]-&gt;setResizeProportional(true);\n\n                 //********************** increment to count    for image                       \n                  $i++;\n    }\n\nThus the problem over images in the header is solved.\n</code></pre>\n\nCris.\t\t\t\t\t\t\t\t<br />\n",
    "PostedDate": "2014-05-14T13:39:25.433-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]