[
  {
    "Id": "521359",
    "ThreadId": "234534",
    "Html": "\r\n<p>In a file which has been working, I am suddenly getting the error:</p>\r\n<p><em>Excel found unreadable content in '*.xlsx'. Do you want to recover the contents of this workbook? If you trust the source of this workbook, click Yes.</em></p>\r\n<p>I have determined that this only occurs when I have more than 9 columns of data being output. If I comment out everything past column I, the file is readable. If I comment out column I, show column J and comment out K and beyond, it still works. The file\r\n is fairly large (a few thousand rows of data) and does not seem to matter what data is in the columns that I comment out (I have tried rearranging columns to no effect).</p>\r\n<p>The report works perfectly with fewer columns and I can put some things in later columns (for instance, you'll see that M1, M2, N1 and N2 are populated by the code) but when including more than 9 columns in my loop it is causing the error.</p>\r\n<p>Server is a Windows 2003 / IIS6 / PHP 5.2.14 setup. PHPExcel is 1.7.4. My apologies for the length, here is the full code of my report generation:</p>\r\n<p></p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre>&lt;html&gt;\r\n&lt;head&gt;\r\n&lt;/head&gt;\r\n&lt;body onload=<span style=\"color:#a31515\">&quot;parent.stopWait();&quot;</span>&gt;\r\n&lt;?php\r\n<span style=\"color:green\">/** Error reporting */</span>\r\nerror_reporting(E_ALL);\r\n\r\n<span style=\"color:green\">/** Include path **/</span>\r\nini_set(<span style=\"color:#a31515\">'include_path'</span>, ini_get(<span style=\"color:#a31515\">'include_path'</span>).';C:\\\\php\\\\PEAR\\\\PHPExcel\\\\;C:\\\\program files\\\\php\\\\pear\\\\PHPExcel\\\\');\r\n\r\n<span style=\"color:green\">/** PHPExcel */</span>\r\n<span style=\"color:blue\">include</span> <span style=\"color:#a31515\">'PHPExcel.php'</span>;\r\n\r\n<span style=\"color:green\">/** PHPExcel_Writer_Excel2007 */</span>\r\n<span style=\"color:blue\">include</span> <span style=\"color:#a31515\">'PHPExcel/Writer/Excel2007.php'</span>;\r\n$objPHPExcel = <span style=\"color:blue\">new</span> PHPExcel();\r\n\r\n<span style=\"color:green\">// Set properties</span>\r\n<span style=\"color:green\">// echo date('H:i:s') . &quot; Set properties\\n&quot;;</span>\r\n$objPHPExcel-&gt;getProperties()-&gt;setCreator(<span style=\"color:#a31515\">&quot;Reporting&quot;</span>);\r\n$objPHPExcel-&gt;getProperties()-&gt;setLastModifiedBy(<span style=\"color:#a31515\">&quot;Reporting&quot;</span>);\r\n$objPHPExcel-&gt;getProperties()-&gt;setTitle(<span style=\"color:#a31515\">&quot;Dashboard By Sales Rep&quot;</span>);\r\n$objPHPExcel-&gt;getProperties()-&gt;setSubject(<span style=\"color:#a31515\">&quot;Dashboard By Sales Rep&quot;</span>);\r\n$objPHPExcel-&gt;getProperties()-&gt;setDescription(<span style=\"color:#a31515\">&quot;List of assigned clients by sales rep.&quot;</span>);\r\n\r\n$objPHPExcel-&gt;setActiveSheetIndex(0);\r\n\r\n<span style=\"color:green\">// Here we populate the cells</span>\r\n<span style=\"color:blue\">include</span> <span style=\"color:#a31515\">'../scripts/config.inc.php'</span>; <span style=\"color:green\">// Get database settings/variables. Connect to DB</span>\r\n$query = <span style=\"color:#a31515\">&quot;SELECT tbl_Companies.salesRep, tbl_Companies.name, clientstatus.description as clientStatus, coalesce(calls.colorCode, \\&quot;#00ff00\\&quot;) as colorCode, calls.callDate, callstatus.description as callStatus, &quot;</span>;\r\n$query .= <span style=\"color:#a31515\">&quot;calls.spokeTo, calls.nextCallBack, replace( trim( tbl_Companies.state ) , '', NULL ) as state, salestatus.description as saleStatus, calls.cycleStatus &quot;</span>;\r\n$query .= <span style=\"color:#a31515\">&quot;FROM tbl_companies AS tbl_Companies LEFT JOIN tbl_lastcalls ON tbl_lastcalls.companyID = tbl_Companies.id LEFT JOIN tbl_calls AS calls ON calls.id = tbl_lastcalls.callID &quot;</span>;\r\n$query .= <span style=\"color:#a31515\">&quot;LEFT JOIN tbl_statusdetails as clientstatus on clientstatus.id = tbl_Companies.clientStatus &quot;</span>;\r\n$query .= <span style=\"color:#a31515\">&quot;LEFT JOIN tbl_statusdetails as callstatus ON callstatus.id = calls.callStatus &quot;</span>;\r\n$query .= <span style=\"color:#a31515\">&quot;LEFT JOIN tbl_statusdetails as salestatus ON salestatus.id = calls.saleStatus &quot;</span>;\r\n$query .= <span style=\"color:#a31515\">&quot;WHERE salesRep &lt;&gt; '' AND salesRep is not null &quot;</span>;\r\n$query .= <span style=\"color:#a31515\">&quot;ORDER BY salesRep, name;&quot;</span>;\r\n\r\n<span style=\"color:green\">// Column headers</span>\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue(<span style=\"color:#a31515\">'A1'</span>, <span style=\"color:#a31515\">'Sales Rep'</span>);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue(<span style=\"color:#a31515\">'B1'</span>, <span style=\"color:#a31515\">'Company Name'</span>);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue(<span style=\"color:#a31515\">'C1'</span>, <span style=\"color:#a31515\">'Client Status'</span>);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue(<span style=\"color:#a31515\">'D1'</span>, <span style=\"color:#a31515\">'Color Code'</span>);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue(<span style=\"color:#a31515\">'E1'</span>, <span style=\"color:#a31515\">'Last Call Date'</span>);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue(<span style=\"color:#a31515\">'F1'</span>, <span style=\"color:#a31515\">'Last Call Status'</span>);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue(<span style=\"color:#a31515\">'G1'</span>, <span style=\"color:#a31515\">'Last Call Spoke With'</span>);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue(<span style=\"color:#a31515\">'H1'</span>, <span style=\"color:#a31515\">'Next Callback Date'</span>);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue(<span style=\"color:#a31515\">'I1'</span>, <span style=\"color:#a31515\">'Last Call Sale Status'</span>);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue(<span style=\"color:#a31515\">'J1'</span>, <span style=\"color:#a31515\">'State'</span>);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue(<span style=\"color:#a31515\">'K1'</span>, <span style=\"color:#a31515\">'Sale Cycle Status'</span>);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue(<span style=\"color:#a31515\">'M1'</span>, <span style=\"color:#a31515\">'Generated on:'</span>);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue(<span style=\"color:#a31515\">'N1'</span>, date(<span style=\"color:#a31515\">'m/d/Y H:i:s'</span>));\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue(<span style=\"color:#a31515\">'M2'</span>, <span style=\"color:#a31515\">'Number of Records:'</span>);\r\n\r\n$i = 1;\r\n<span style=\"color:blue\">if</span> ($result = mysqli_query($dbConn, $query)) {\r\n\t$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue(<span style=\"color:#a31515\">'N2'</span>, mysqli_num_rows($result));\r\n\t<span style=\"color:blue\">while</span> ($row = mysqli_fetch_assoc($result)) {\r\n\t\t$i&#43;&#43;;\r\n\t\t\r\n\t\t<span style=\"color:green\">// Dump row values into cells</span>\r\n\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue(<span style=\"color:#a31515\">'A'</span> . $i, $row[<span style=\"color:#a31515\">'salesRep'</span>]);\r\n\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue(<span style=\"color:#a31515\">'B'</span> . $i, $row[<span style=\"color:#a31515\">'name'</span>]);\r\n\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue(<span style=\"color:#a31515\">'C'</span> . $i, $row[<span style=\"color:#a31515\">'clientStatus'</span>]);\r\n\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue(<span style=\"color:#a31515\">'D'</span> . $i, $row[<span style=\"color:#a31515\">'colorCode'</span>]);\r\n\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue(<span style=\"color:#a31515\">'E'</span> . $i, $row[<span style=\"color:#a31515\">'callDate'</span>]);\r\n\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue(<span style=\"color:#a31515\">'F'</span> . $i, $row[<span style=\"color:#a31515\">'callStatus'</span>]);\r\n\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue(<span style=\"color:#a31515\">'G'</span> . $i, $row[<span style=\"color:#a31515\">'spokeTo'</span>]);\r\n\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue(<span style=\"color:#a31515\">'H'</span> . $i, $row[<span style=\"color:#a31515\">'nextCallBack'</span>]);\r\n\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue(<span style=\"color:#a31515\">'I'</span> . $i, $row[<span style=\"color:#a31515\">'saleStatus'</span>]);\r\n\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue(<span style=\"color:#a31515\">'J'</span> . $i, $row[<span style=\"color:#a31515\">'state'</span>]);\r\n\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue(<span style=\"color:#a31515\">'K'</span> . $i, $row[<span style=\"color:#a31515\">'cycleStatus'</span>]);\r\n\t\t\t\t\r\n\t\t<span style=\"color:green\">// Style the color code</span>\r\n\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#a31515\">'D'</span> . $i)-&gt;getFill()-&gt;setFillType(PHPExcel_Style_Fill::FILL_SOLID);\r\n\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#a31515\">'D'</span> . $i)-&gt;getFill()-&gt;getStartColor()-&gt;setRGB(str_replace(<span style=\"color:#a31515\">'#'</span>, <span style=\"color:#a31515\">''</span>, $row[<span style=\"color:#a31515\">'colorCode'</span>]));\r\n\t\t\r\n\t\t<span style=\"color:green\">// Format the date field</span>\r\n\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#a31515\">'E'</span> . $i)-&gt;getNumberFormat()-&gt;setFormatCode(<span style=\"color:#a31515\">'mm/dd/yyyy'</span>);\r\n\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#a31515\">'H'</span> . $i)-&gt;getNumberFormat()-&gt;setFormatCode(<span style=\"color:#a31515\">'mm/dd/yyyy'</span>);\r\n\t\t\r\n\t}\r\n}\r\n\r\n<span style=\"color:green\">// Auto-fit the columns</span>\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension(<span style=\"color:#a31515\">'A'</span>)-&gt;setAutoSize(true);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension(<span style=\"color:#a31515\">'B'</span>)-&gt;setAutoSize(true);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension(<span style=\"color:#a31515\">'C'</span>)-&gt;setAutoSize(true);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension(<span style=\"color:#a31515\">'D'</span>)-&gt;setAutoSize(true);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension(<span style=\"color:#a31515\">'E'</span>)-&gt;setAutoSize(true);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension(<span style=\"color:#a31515\">'F'</span>)-&gt;setAutoSize(true);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension(<span style=\"color:#a31515\">'G'</span>)-&gt;setAutoSize(true);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension(<span style=\"color:#a31515\">'H'</span>)-&gt;setAutoSize(true);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension(<span style=\"color:#a31515\">'I'</span>)-&gt;setAutoSize(true);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension(<span style=\"color:#a31515\">'J'</span>)-&gt;setAutoSize(true);\r\n\r\n<span style=\"color:green\">// Rename sheet</span>\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setTitle(<span style=\"color:#a31515\">'Report'</span>);\r\n\t\t\r\n<span style=\"color:green\">// Save Excel 2007 file</span>\r\n$objWriter = <span style=\"color:blue\">new</span> PHPExcel_Writer_Excel2007($objPHPExcel);\r\n$objWriter-&gt;save(str_replace(<span style=\"color:#a31515\">'.php'</span>, <span style=\"color:#a31515\">'.xlsx'</span>, <span style=\"color:blue\">__FILE__</span>));\r\n\r\n?&gt;\r\n&lt;!--\r\n&lt;?php\r\n<span style=\"color:blue\">echo</span> $query . <span style=\"color:#a31515\">&quot;\\r\\n&quot;</span>;\r\n<span style=\"color:blue\">echo</span> mysqli_error($dbConn) . <span style=\"color:#a31515\">&quot;\\r\\n&quot;</span>;\r\n?&gt;\r\n--&gt;\r\n&lt;/body&gt;\r\n&lt;/html&gt;\r\n\r\n</pre>\r\n</div>\r\nThank you for any suggestions. For now, I am spitting out the data with two of the columns shown as empty but I would like to be able to provide all of the data being requested.\r\n<p></p>\r\n",
    "PostedDate": "2010-11-12T17:55:17.837-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "521461",
    "ThreadId": "234534",
    "Html": "\r\n<p>This is a new one on me, and I regularly work with workbooks that contain more than 10 columns. Is there anything in the values of the saleStatus and cycleStatus in your database that could be causing the problem. What datatype are the columns? What are\r\n typical data values? Do they contain NULLS?</p>\r\n",
    "PostedDate": "2010-11-13T04:33:03.643-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "521498",
    "ThreadId": "234534",
    "Html": "\r\n<p>It doesn't seem to matter which 9 columns I have -- I can comment out two fields that are currently working and the sheet appears perfectly fine.</p>\r\n<p>To answer your specific questions, saleStatus and cycleStatus can be null, but otherwise are only characters (no numbers or punctuation, they are enumerated values in the database). But they will appear in the sheet just fine if I comment out say State and\r\n nextCallBack or salesRep and name. I can show the column headers but it seems to be something about drawing them in the loop that breaks the sheet.</p>\r\n",
    "PostedDate": "2010-11-13T07:28:41.08-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "521592",
    "ThreadId": "234534",
    "Html": "\r\n<p>I really am stumped by this. I've never experienced it, and can see no logical reason why PHPExcel should do this... the library doesn't even know that it's methods are being called from within a loop.</p>\r\n<p>Is it possible for you to create a simple script (not dependent on a database) that will replicate this problem?</p>\r\n",
    "PostedDate": "2010-11-13T14:21:29.063-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "521883",
    "ThreadId": "234534",
    "Html": "\r\n<pre>It appears to be a data size issue -- When using around 10,000 rows with the below it created a document just fine but setting it up to 40,000 I consistently get the error. <br>Am I running into a memory limit with the phpExcel object? The script memory limit on the server is 256M</pre>\r\n<p></p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre><br><br>&lt;html&gt;\r\n&lt;head&gt;\r\n&lt;/head&gt;\r\n&lt;body onload=<span style=\"color:#a31515\">&quot;parent.stopWait();&quot;</span>&gt;\r\n&lt;?php\r\n<span style=\"color:blue\">function</span> rand_str($length = 32, $chars = <span style=\"color:#a31515\">'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz1234567890'</span>)\r\n{\r\n    <span style=\"color:green\">// Length of character list</span>\r\n    $chars_length = (strlen($chars) - 1);\r\n\r\n    <span style=\"color:green\">// Start our string</span>\r\n    $string = $chars{rand(0, $chars_length)};\r\n   \r\n    <span style=\"color:green\">// Generate random string</span>\r\n    <span style=\"color:blue\">for</span> ($i = 1; $i &lt; $length; $i = strlen($string))\r\n    {\r\n        <span style=\"color:green\">// Grab a random character from our list</span>\r\n        $r = $chars{rand(0, $chars_length)};\r\n       \r\n        <span style=\"color:green\">// Make sure the same two characters don't appear next to each other</span>\r\n        <span style=\"color:blue\">if</span> ($r != $string{$i - 1}) $string .=  $r;\r\n    }\r\n   \r\n    <span style=\"color:green\">// Return the string</span>\r\n    <span style=\"color:blue\">return</span> $string;\r\n}\r\n\r\n<span style=\"color:green\">/** Error reporting */</span>\r\nerror_reporting(E_ALL);\r\n\r\n<span style=\"color:green\">/** Include path **/</span>\r\nini_set(<span style=\"color:#a31515\">'include_path'</span>, ini_get(<span style=\"color:#a31515\">'include_path'</span>).';C:\\\\php\\\\PEAR\\\\PHPExcel\\\\;C:\\\\program files\\\\php\\\\pear\\\\PHPExcel\\\\');\r\n\r\n<span style=\"color:green\">/** PHPExcel */</span>\r\n<span style=\"color:blue\">include</span> <span style=\"color:#a31515\">'PHPExcel.php'</span>;\r\n\r\n<span style=\"color:green\">/** PHPExcel_Writer_Excel2007 */</span>\r\n<span style=\"color:blue\">include</span> <span style=\"color:#a31515\">'PHPExcel/Writer/Excel2007.php'</span>;\r\n\r\n<span style=\"color:green\">// Create new PHPExcel object. Start drawing wait bar</span>\r\n\r\n<span style=\"color:green\">/*\r\n * echo &quot;&lt;html&gt;&lt;head&gt;&lt;title&gt;MCA CRM Report Generator&lt;/title&gt;&lt;/head&gt;&lt;body&gt;\\r\\n&quot;;\r\n * echo &quot;&lt;span id=\\&quot;preload\\&quot;&gt;Generating Report, please wait...&lt;/span&gt;\\r\\n&quot;;\r\n * echo &quot;&lt;span id=\\&quot;loadbar\\&quot;&gt;&lt;/span&gt;\\r\\n&quot;; \r\n */</span>\r\n\r\n\r\n$objPHPExcel = <span style=\"color:blue\">new</span> PHPExcel();\r\n\r\n<span style=\"color:green\">// Set properties</span>\r\n<span style=\"color:green\">// echo date('H:i:s') . &quot; Set properties\\n&quot;;</span>\r\n$objPHPExcel-&gt;getProperties()-&gt;setCreator(<span style=\"color:#a31515\">&quot;MCA CRM Reporting&quot;</span>);\r\n$objPHPExcel-&gt;getProperties()-&gt;setLastModifiedBy(<span style=\"color:#a31515\">&quot;MCA CRM Reporting&quot;</span>);\r\n$objPHPExcel-&gt;getProperties()-&gt;setTitle(<span style=\"color:#a31515\">&quot;Dashboard By Sales Rep&quot;</span>);\r\n$objPHPExcel-&gt;getProperties()-&gt;setSubject(<span style=\"color:#a31515\">&quot;Dashboard By Sales Rep&quot;</span>);\r\n$objPHPExcel-&gt;getProperties()-&gt;setDescription(<span style=\"color:#a31515\">&quot;List of assigned clients by sales rep.&quot;</span>);\r\n\r\n\r\n<span style=\"color:green\">// Add some data</span>\r\n<span style=\"color:green\">// echo date('H:i:s') . &quot; Add some data\\n&quot;;</span>\r\n$objPHPExcel-&gt;setActiveSheetIndex(0);\r\n\r\n<span style=\"color:green\">// Here we populate the cells</span>\r\n<span style=\"color:green\">// echo date('H:i:s') . &quot;Generating Report...\\r\\n&quot;;</span>\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue(<span style=\"color:#a31515\">'A1'</span>, <span style=\"color:#a31515\">'Sales Rep'</span>);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue(<span style=\"color:#a31515\">'B1'</span>, <span style=\"color:#a31515\">'Company Name'</span>);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue(<span style=\"color:#a31515\">'C1'</span>, <span style=\"color:#a31515\">'Client Status'</span>);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue(<span style=\"color:#a31515\">'D1'</span>, <span style=\"color:#a31515\">'Color Code'</span>);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue(<span style=\"color:#a31515\">'E1'</span>, <span style=\"color:#a31515\">'Last Call Date'</span>);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue(<span style=\"color:#a31515\">'F1'</span>, <span style=\"color:#a31515\">'Last Call Status'</span>);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue(<span style=\"color:#a31515\">'G1'</span>, <span style=\"color:#a31515\">'Last Call Spoke With'</span>);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue(<span style=\"color:#a31515\">'H1'</span>, <span style=\"color:#a31515\">'Next Callback Date'</span>);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue(<span style=\"color:#a31515\">'I1'</span>, <span style=\"color:#a31515\">'Last Call Sale Status'</span>);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue(<span style=\"color:#a31515\">'J1'</span>, <span style=\"color:#a31515\">'State'</span>);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue(<span style=\"color:#a31515\">'K1'</span>, <span style=\"color:#a31515\">'Sale Cycle Status'</span>);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue(<span style=\"color:#a31515\">'M1'</span>, <span style=\"color:#a31515\">'Generated on:'</span>);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue(<span style=\"color:#a31515\">'N1'</span>, date(<span style=\"color:#a31515\">'m/d/Y H:i:s'</span>));\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue(<span style=\"color:#a31515\">'M2'</span>, <span style=\"color:#a31515\">'Number of Records:'</span>);\r\n\r\n$i = 1;\r\n$x = rand(10000, 50000);\r\n<span style=\"color:blue\">if</span> ($result = true) {\r\n\t$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue(<span style=\"color:#a31515\">'N2'</span>, 40000);\r\n\t<span style=\"color:blue\">while</span> ($i &lt;= 40000) {\r\n\t\t$i&#43;&#43;;\r\n\t\t\r\n\t\t<span style=\"color:green\">// Dump row values into cells</span>\r\n\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue(<span style=\"color:#a31515\">'A'</span> . $i, rand_str(rand(1,50)));\r\n\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue(<span style=\"color:#a31515\">'B'</span> . $i, rand_str(rand(1,50)));\r\n\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue(<span style=\"color:#a31515\">'C'</span> . $i, rand_str(rand(1,50)));\r\n\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue(<span style=\"color:#a31515\">'D'</span> . $i, rand_str(rand(1,50)));\r\n\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue(<span style=\"color:#a31515\">'E'</span> . $i, <span style=\"color:#a31515\">'1/1/2001'</span>);\r\n\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue(<span style=\"color:#a31515\">'F'</span> . $i, rand_str(rand(1,50)));\r\n\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue(<span style=\"color:#a31515\">'G'</span> . $i, rand_str(rand(1,50)));\r\n\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue(<span style=\"color:#a31515\">'H'</span> . $i, <span style=\"color:#a31515\">'1/2/2001'</span>);\r\n\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue(<span style=\"color:#a31515\">'I'</span> . $i, rand_str(rand(1,50)));\r\n\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue(<span style=\"color:#a31515\">'J'</span> . $i, rand_str(2));\r\n\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue(<span style=\"color:#a31515\">'K'</span> . $i, rand(0, 6));\r\n\t\t\t\t\r\n\t\t<span style=\"color:green\">// Style the color code</span>\r\n\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#a31515\">'D'</span> . $i)-&gt;getFill()-&gt;setFillType(PHPExcel_Style_Fill::FILL_SOLID);\r\n\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#a31515\">'D'</span> . $i)-&gt;getFill()-&gt;getStartColor()-&gt;setRGB(str_replace(<span style=\"color:#a31515\">'#'</span>, <span style=\"color:#a31515\">''</span>, <span style=\"color:#a31515\">'f0f0f0'</span>));\r\n\t\t\r\n\t\t<span style=\"color:green\">// Format the date field</span>\r\n\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#a31515\">'E'</span> . $i)-&gt;getNumberFormat()-&gt;setFormatCode(<span style=\"color:#a31515\">'mm/dd/yyyy'</span>);\r\n\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#a31515\">'H'</span> . $i)-&gt;getNumberFormat()-&gt;setFormatCode(<span style=\"color:#a31515\">'mm/dd/yyyy'</span>);\r\n\t\t\r\n\t}\r\n}\r\n\r\n<span style=\"color:green\">/*\r\n * echo &quot;&lt;script type=\\&quot;text/javascript\\&quot;&gt;\\r\\n&quot;;\r\n * echo &quot;\tdocument.getElementById('preload').innerHTML = 'Nearly finished, please wait...';\\r\\n&quot;;\r\n * echo &quot;&lt;/script&gt;\\r\\n&quot;;\r\n */</span>\r\n\r\n\r\n<span style=\"color:green\">// echo date('H:i:s') . &quot;Finished generation, cleanup and output...\\r\\n&quot;;</span>\r\n<span style=\"color:green\">// Auto-fit the columns</span>\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension(<span style=\"color:#a31515\">'A'</span>)-&gt;setAutoSize(true);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension(<span style=\"color:#a31515\">'B'</span>)-&gt;setAutoSize(true);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension(<span style=\"color:#a31515\">'C'</span>)-&gt;setAutoSize(true);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension(<span style=\"color:#a31515\">'D'</span>)-&gt;setAutoSize(true);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension(<span style=\"color:#a31515\">'E'</span>)-&gt;setAutoSize(true);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension(<span style=\"color:#a31515\">'F'</span>)-&gt;setAutoSize(true);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension(<span style=\"color:#a31515\">'G'</span>)-&gt;setAutoSize(true);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension(<span style=\"color:#a31515\">'H'</span>)-&gt;setAutoSize(true);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension(<span style=\"color:#a31515\">'I'</span>)-&gt;setAutoSize(true);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension(<span style=\"color:#a31515\">'J'</span>)-&gt;setAutoSize(true);\r\n\r\n<span style=\"color:green\">// Rename sheet</span>\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setTitle(<span style=\"color:#a31515\">'Report'</span>);\r\n\r\n\t\t\r\n<span style=\"color:green\">// Save Excel 2007 file</span>\r\n<span style=\"color:green\">// echo date('H:i:s') . &quot; Write to Excel2007 format\\n&quot;;</span>\r\n$objWriter = <span style=\"color:blue\">new</span> PHPExcel_Writer_Excel2007($objPHPExcel);\r\n$objWriter-&gt;save(str_replace(<span style=\"color:#a31515\">'.php'</span>, <span style=\"color:#a31515\">'.xlsx'</span>, <span style=\"color:blue\">__FILE__</span>));\r\n\r\n<span style=\"color:green\">// Echo done</span>\r\n<span style=\"color:green\">// echo date('H:i:s') . &quot; Done writing file.\\r\\n&quot;;</span>\r\n<span style=\"color:green\">/*\r\n * echo &quot;&lt;script type=\\&quot;text/javascript\\&quot;&gt;\\r\\n&quot;;\r\n * echo &quot;\tdocument.getElementById('preload').innerHTML = 'Finished!';\\r\\n&quot;;\r\n * echo &quot;\twindow.location = '&quot; . str_replace('.php', '.xlsx', $_SERVER[&quot;PHP_SELF&quot;]) . &quot;';\\r\\n&quot;;\r\n * echo &quot;&lt;/script&gt;\\r\\n&quot;;\r\n * echo &quot;&lt;/body&gt;&lt;/html&gt;&quot;;\r\n */</span>\r\n?&gt;\r\n&lt;?php\r\n<span style=\"color:blue\">echo</span> <span style=\"color:#a31515\">&quot;Done.&quot;</span>\r\n?&gt;\r\n&lt;/body&gt;\r\n&lt;/html&gt;\r\n</pre>\r\n</div>\r\n<p></p>\r\n",
    "PostedDate": "2010-11-14T14:51:34.787-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "521888",
    "ThreadId": "234534",
    "Html": "\r\n<p>Normally a memory problem would give you a PHP Allowed memory size of xxxx bytes exhausted (tried to allocate yyyy bytes) error</p>\r\n<p>However, if you believe that it could be a memory issue, try enabling cell caching. This will allow you to work with up to 3 times as many cells in the same memory, albeit at a cost in speed.</p>\r\n",
    "PostedDate": "2010-11-14T15:15:01.383-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "522015",
    "ThreadId": "234534",
    "Html": "\r\n<p>I have no problem with creating xlsx files with over 200K rows, so if the number of rows appears to be the problem, I don't think phpexcel is the limiting factor.</p>\r\n",
    "PostedDate": "2010-11-15T02:11:46.73-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]