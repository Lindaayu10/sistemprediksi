[
  {
    "Id": "596011",
    "ThreadId": "253580",
    "Html": "\r\n<p>Hi all</p>\r\n<p>I am using PHPExcel 1.7.5 with Zend Framework 1.11.2 on XAMP set up on Windows 7.</p>\r\n<p>I am trying to load an existing xls file and then add data to it then output it to user's browser to be opened/downloaded.</p>\r\n<p>The file does get output to the browser, however upon opening it is full of errors:</p>\r\n<p>Here is my code:</p>\r\n<pre>\t\t<span style=\"color:green\">// create reader</span>\r\n\t\t$objReader = PHPExcel_IOFactory::createReader(<span style=\"color:#a31515\">'Excel5'</span>);\r\n\t\t$objReader-&gt;setReadDataOnly(false);\r\n\t\t\r\n\t\t$objPHPExcel = $objReader-&gt;load(APPLICATION_PATH . <span style=\"color:#a31515\">&quot;/views/scripts/template.xls&quot;</span>);\r\n\t\t$objWorksheet = $objPHPExcel-&gt;getActiveSheet(0); \r\n\t\t$objWorksheet-&gt;getCell(<span style=\"color:#a31515\">'A1'</span>)-&gt;setValue(<span style=\"color:#a31515\">'tet'</span>);\r\n\t\t\r\n\t\tob_end_clean();\r\n\t\t\r\n\t\t<span style=\"color:green\">// this is to prevent ZF generating all layout</span>\r\n\t\t$this-&gt;_helper-&gt;layout-&gt;disableLayout();\r\n\t\t$this-&gt;_helper-&gt;viewRenderer-&gt;setNoRender();\r\n\r\n\t\t<span style=\"color:green\">// Redirect output to a clientï¿½s web browser</span>\r\n\t\theader(<span style=\"color:#a31515\">'Content-Type: application/vnd.ms-excel'</span>);\r\n\t\theader(<span style=\"color:#a31515\">'Content-Disposition: attachment;filename=&quot;'</span>.$safe_filename.<span style=\"color:#a31515\">'&quot;'</span>);\r\n\t\theader(<span style=\"color:#a31515\">'Cache-Control: max-age=0'</span>);\t\r\n\t\t\r\n    \t$objWriter = <span style=\"color:blue\">new</span> PHPExcel_Writer_Excel5($objPHPExcel);\r\n\t\tob_end_clean();\r\n\t\t\r\n\t\t$objWriter-&gt;save(<span style=\"color:#a31515\">'php://output'</span>);\r\n\t\t$objPHPExcel-&gt;disconnectWorksheets();\r\n\t\t<span style=\"color:blue\">unset</span>($objPHPExcel);\r\n</pre>\r\n<p>And here is the error message within the returned xls file:</p>\r\n<p><strong>Notice</strong>: ob_end_clean() [<a href=\"http://localhost/PPCGearbox/public/build/client-friendly-export/ref.outcontrol\">ref.outcontrol</a>]: failed to delete buffer. No buffer to delete. in\r\n<strong>C:\\xampplite\\htdocs\\PPCGearbox\\application\\controllers\\BuildController.php</strong> on line\r\n<strong>603</strong><br>\r\n<br>\r\n<strong>Fatal error</strong>: Uncaught exception 'Zend_Controller_Response_Exception' with message 'Cannot send headers; headers already sent in C:\\xampplite\\htdocs\\PPCGearbox\\application\\controllers\\BuildController.php, line 603' in C:\\xampplite\\htdocs\\PPCGearbox\\library\\Zend\\Controller\\Response\\Abstract.php:321\r\n Stack trace: #0 C:\\xampplite\\htdocs\\PPCGearbox\\library\\Zend\\Controller\\Response\\Abstract.php(339): Zend_Controller_Response_Abstract-&gt;canSendHeaders(true) #1 C:\\xampplite\\htdocs\\PPCGearbox\\library\\Zend\\Controller\\Response\\Abstract.php(766): Zend_Controller_Response_Abstract-&gt;sendHeaders()\r\n #2 C:\\xampplite\\htdocs\\PPCGearbox\\library\\Zend\\Controller\\Front.php(992): Zend_Controller_Response_Abstract-&gt;sendResponse() #3 C:\\xampplite\\htdocs\\PPCGearbox\\library\\Zend\\Application\\Bootstrap\\Bootstrap.php(97): Zend_Controller_Front-&gt;dispatch() #4 C:\\xampplite\\htdocs\\PPCGearbox\\library\\Zend\\Application.php(366):\r\n Zend_Application_Bootstrap_Bootstrap-&gt;run() #5 C:\\xampplite\\htdocs\\PPCGearbox\\public\\index.php(36): Zend_Application-&gt;run() #6 {main} in\r\n<strong>C:\\xampplite\\htdocs\\PPCGearbox\\library\\Zend\\Controller\\Response\\Abstract.php</strong> on line\r\n<strong>321</strong></p>\r\n<p>Sincerely appreciate the help,</p>\r\n<p>Sid.</p>\r\n<p><strong><br>\r\n</strong></p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre><br></pre>\r\n</div>\r\n",
    "PostedDate": "2011-04-12T08:28:26.703-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]