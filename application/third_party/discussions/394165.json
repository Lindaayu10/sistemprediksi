[
  {
    "Id": "907662",
    "ThreadId": "394165",
    "Html": "\r\n<p>Hello,</p>\r\n<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; I am using PHPExcel to generate a report(<strong>.xlsx</strong>) &nbsp;where i have to mention curreny in</p>\r\n<p>$1234.56 format. I didnt find any method by which i can set a column's dataType to currency.</p>\r\n<p><span style=\"text-decoration:underline\">Currently what i am doing</span></p>\r\n<p>I choose that column index and use below in foreach loop</p>\r\n<p><span style=\"white-space:pre\">&nbsp;</span></p>\r\n<pre>&lt;?php\n<p><span style=\"white-space:pre\">&nbsp;</span>foreach ($arr_report as $row){<span> </span></p><p><span>&nbsp;</span><span style=\"white-space:pre\"> <span style=\"white-space:pre\"> </span></span>&#43;&#43;$j; $c=0;&nbsp; &nbsp;</p><p><span style=\"white-space:pre\">&nbsp;</span><span style=\"white-space:pre\"> </span> foreach($row as $col){<span> </span></p><p><span>&nbsp;</span><span style=\"white-space:pre\"> <span style=\"white-space:pre\"> </span></span>$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimensionByColumn($c)-&gt;setWidth(strlen($col) &#43; 6); &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style=\"white-space:pre\"> </span>$colString = PHPExcel_Cell::stringFromColumnIndex($c);<span> </span></p><p><span>&nbsp;</span><span style=\"white-space:pre\"> </span>if($colString === 'U'){</p><p><span style=\"white-space:pre\">&nbsp;<span style=\"white-space:pre\">\t</span></span>$col = empty($col) ? '' : '$'.$col; // add prefix $</p><p><span style=\"white-space:pre\">&nbsp;<span style=\"white-space:pre\">\t</span></span>$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValueByColumnAndRow($c, $j, $col,PHPExcel_Cell_DataType::TYPE_NUMERIC);<span> </span></p><p><span>&nbsp;</span><span style=\"white-space:pre\"> </span>}<span> </span>else {<span> </span></p><p><span>&nbsp;</span><span style=\"white-space:pre\"> </span>$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValueByColumnAndRow($c, $j, $col);<span> </span>&nbsp;}<span> </span>$c&#43;&#43;;</p><p><span>&nbsp;</span><span style=\"white-space:pre\"> </span>}</p><p><span style=\"white-space:pre\">&nbsp;</span>}</p><p>}?&gt;</p></pre>\r\n<p>but when report generates, an error indicator on each cell of that column &nbsp;saying</p>\r\n<p>&nbsp;</p>\r\n<div>\r\n<div><strong><em>the number is this cell is formatted as text or preceded by an apostrophe</em></strong></div>\r\n<div>Is there any fine solution of this kind of error?</div>\r\n</div>\r\n<p>&nbsp;</p>\r\n<hr>\r\n<p>&nbsp;</p>\r\n<p>Here is your two discussion which i like to mention&nbsp;</p>\r\n<p><a href=\"http://phpexcel.codeplex.com/discussions/259512\" target=\"_blank\">in this discussion</a>&nbsp;you have mentioned below code</p>\r\n<pre>$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValueExplicitByColumnAndRow(17,$cont, $row[3], PHPExcel_Cell_DataType::TYPE_NUMERIC);</pre>\r\n<p>but this will set a specific cell not the complete column.</p>\r\n<p>&nbsp;</p>\r\n<p><a href=\"http://phpexcel.codeplex.com/discussions/241773\" target=\"_blank\">in other discussion&nbsp;</a>&nbsp;you have mentioned</p>\r\n<pre>$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span>'D1'</span>)-&gt;getNumberFormat()-&gt;setFormatCode(<span>&quot;#,##0 _&euro;&quot;</span>);</pre>\r\n<p>&nbsp;I have tried this but this not working too.</p>\r\n",
    "PostedDate": "2012-09-03T02:15:46.87-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "907709",
    "ThreadId": "394165",
    "Html": "\r\n<p>This block of code</p>\r\n<div style=\"background-color:white; color:black\">\r\n<pre>$col = <span style=\"color:blue\">empty</span>($col) ? <span style=\"color:#a31515\">''</span> : <span style=\"color:#a31515\">'$'</span>.$col; <span style=\"color:green\">// add prefix $</span>\r\n</pre>\r\n</div>\r\n<p>is modifying your numeric (currency) value to a string.</p>\r\n<p>&nbsp;</p>\r\n<p>A string is not a number, so your next line of code:</p>\r\n<div style=\"background-color:white; color:black\">\r\n<pre>$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValueByColumnAndRow($c, $j, $col,PHPExcel_Cell_DataType::TYPE_NUMERIC);\r\n</pre>\r\n</div>\r\n<p>is meaningless.</p>\r\n<p>&nbsp;</p>\r\n<p>In MS Excel, if you want a currency value in a cell, you set the cell value as the number, and apply a number format mask to display it as a currency value. This doesn't change the value in the cell (it's still a number) but simply changes the way it is\r\n displayed. PHPExcel does exactly the same.</p>\r\n<p>&nbsp;</p>\r\n<div style=\"background-color:white; color:black\">\r\n<pre>$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValueByColumnAndRow($c, $j, $col);\r\n<span style=\"color:blue\">if</span>($colString === <span style=\"color:#a31515\">'U'</span>){ \r\n    <span style=\"color:blue\">if</span> (!<span style=\"color:blue\">empty</span>($col)) {\r\n        $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle($colString.$j)\r\n            -&gt;getNumberFormat()\r\n            -&gt;setFormatCode(PHPExcel_Style_NumberFormat::FORMAT_CURRENCY_USD);\r\n    }\r\n}\r\n$c&#43;&#43;;\r\n</pre>\r\n</div>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n",
    "PostedDate": "2012-09-03T03:44:25.04-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]