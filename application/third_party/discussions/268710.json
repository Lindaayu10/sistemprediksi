[
  {
    "Id": "656550",
    "ThreadId": "268710",
    "Html": "\r\n<p>Hello,</p>\r\n<p>I was looking at the following section of code from <a href=\"http://phpexcel.codeplex.com/SourceControl/changeset/view/77805#1604444\">\r\nhttp://phpexcel.codeplex.com/SourceControl/changeset/view/77805#1604444</a>&nbsp;for conditional formatting for Excel 2007:</p>\r\n<p>&nbsp;</p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre><span style=\"color:blue\">private</span> <span style=\"color:blue\">function</span> _writeConditionalFormatting(PHPExcel_Shared_XMLWriter $objWriter = null, PHPExcel_Worksheet $pSheet = null)\r\n\t{\r\n\t\t<span style=\"color:green\">// Conditional id</span>\r\n\t\t$id = 1;\r\n\r\n\t\t<span style=\"color:green\">// Loop through styles in the current worksheet</span>\r\n\t\t<span style=\"color:blue\">foreach</span> ($pSheet-&gt;getConditionalStylesCollection() <span style=\"color:blue\">as</span> $cellCoordinate =&gt; $conditionalStyles) {\r\n\t\t\t<span style=\"color:blue\">foreach</span> ($conditionalStyles <span style=\"color:blue\">as</span> $conditional) {\r\n\t\t\t\t<span style=\"color:green\">// WHY was this again?</span>\r\n\t\t\t\t<span style=\"color:green\">// if ($this-&gt;getParentWriter()-&gt;getStylesConditionalHashTable()-&gt;getIndexForHashCode( $conditional-&gt;getHashCode() ) == '') {</span>\r\n\t\t\t\t<span style=\"color:green\">//\tcontinue;</span>\r\n\t\t\t\t<span style=\"color:green\">// }</span>\r\n\r\n\t\t\t\t<span style=\"color:blue\">if</span> ($conditional-&gt;getConditionType() != PHPExcel_Style_Conditional::CONDITION_NONE) {\r\n\t\t\t\t\t<span style=\"color:green\">// conditionalFormatting</span>\r\n\t\t\t\t\t$objWriter-&gt;startElement(<span style=\"color:#a31515\">'conditionalFormatting'</span>);\r\n\t\t\t\t\t$objWriter-&gt;writeAttribute(<span style=\"color:#a31515\">'sqref'</span>,\t$cellCoordinate);\r\n</pre>\r\n</div>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n<p>I believe that the&nbsp;</p>\r\n<p><span style=\"font-family:Consolas,'Courier New',Courier,monospace; white-space:pre\">$objWriter-&gt;startElement(<span>'conditionalFormatting'</span>);\r\n<br>\r\n</span><span style=\"font-family:Consolas,'Courier New',Courier,monospace; white-space:pre\">$objWriter-&gt;writeAttribute(<span>'sqref'</span>, $cellCoordinate);</span></p>\r\n<p>Should actually be before the&nbsp;<span style=\"font-family:Consolas,'Courier New',Courier,monospace; white-space:pre\"><span>foreach</span> ($conditionalStyles\r\n<span>as</span> $conditional) { </span>statement (and of course close the element correctly as well). Otherwise we take in XML code such as:</p>\r\n<p>&nbsp;</p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre><span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">conditionalFormatting</span> <span style=\"color:red\">sqref</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">A2</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">&gt;</span>\r\n<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">cfRule</span> <span style=\"color:red\">type</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">cellIs</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">dxfId</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">6</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">priority</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">4</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">operator</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">greaterThan</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">&gt;</span>\r\n<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">formula</span><span style=\"color:blue\">&gt;</span>1<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">formula</span><span style=\"color:blue\">&gt;</span>\r\n<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">cfRule</span><span style=\"color:blue\">&gt;</span>\r\n<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">cfRule</span> <span style=\"color:red\">type</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">cellIs</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">dxfId</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">5</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">priority</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">3</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">operator</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">lessThan</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">&gt;</span>\r\n<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">formula</span><span style=\"color:blue\">&gt;</span>2<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">formula</span><span style=\"color:blue\">&gt;</span>\r\n<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">cfRule</span><span style=\"color:blue\">&gt;</span>\r\n<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">conditionalFormatting</span><span style=\"color:blue\">&gt;</span>\r\n</pre>\r\n</div>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n<p>And output code as such:</p>\r\n<p></p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre><span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">conditionalFormatting</span> <span style=\"color:red\">sqref</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">A2</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">&gt;</span>\r\n<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">cfRule</span> <span style=\"color:red\">type</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">cellIs</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">dxfId</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">5</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">priority</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">3</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">operator</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">lessThan</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">&gt;</span>\r\n<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">formula</span><span style=\"color:blue\">&gt;</span>2<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">formula</span><span style=\"color:blue\">&gt;</span>\r\n<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">cfRule</span><span style=\"color:blue\">&gt;</span>\r\n<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">conditionalFormatting</span><span style=\"color:blue\">&gt;</span>\r\n<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">conditionalFormatting</span> <span style=\"color:red\">sqref</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">A2</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">&gt;</span>\r\n<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">cfRule</span> <span style=\"color:red\">type</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">cellIs</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">dxfId</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">6</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">priority</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">4</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">operator</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">greaterThan</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">&gt;</span>\r\n<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">formula</span><span style=\"color:blue\">&gt;</span>1<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">formula</span><span style=\"color:blue\">&gt;</span>\r\n<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">conditionalFormatting</span><span style=\"color:blue\">&gt;</span>\r\n</pre>\r\n</div>\r\n<p></p>\r\n<p>This does perhaps add empty conditional formatting without any rules, but overall it is likely to decrease the amount of XML.</p>\r\n",
    "PostedDate": "2011-08-11T07:05:38.83-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "656708",
    "ThreadId": "268710",
    "Html": "<p>I tried this out, and found out why it is not done this way. &nbsp;It is because an empty conditional formatting entry does not sit well with Excel!</p>",
    "PostedDate": "2011-08-11T10:16:13.46-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]