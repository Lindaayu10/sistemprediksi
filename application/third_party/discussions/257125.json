[
  {
    "Id": "610566",
    "ThreadId": "257125",
    "Html": "\r\n<p>would it be possible to add this to the PHPExcel_Writer_CSV?</p>\r\n<p></p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre>\r\n\t<span style=\"color:blue\">public</span> <span style=\"color:blue\">function</span> saveAllSheets($pFilename = null,$use_states=<span style=\"color:blue\">array</span>(<span style=\"color:#a31515\">'visible'</span>)) {\r\n\t\t$saveDebugLog = PHPExcel_Calculation::getInstance()-&gt;writeDebugLog;\r\n\t\tPHPExcel_Calculation::getInstance()-&gt;writeDebugLog = false;\r\n\t\t$saveArrayReturnType = PHPExcel_Calculation::getArrayReturnType();\r\n\t\tPHPExcel_Calculation::setArrayReturnType(PHPExcel_Calculation::RETURN_ARRAY_AS_VALUE);\r\n\r\n\t\t<span style=\"color:green\">// Open file</span>\r\n\t\t$fileHandle = fopen($pFilename, <span style=\"color:#a31515\">'wb&#43;'</span>);\r\n\t\t<span style=\"color:blue\">if</span> ($fileHandle === false) {\r\n\t\t\t<span style=\"color:blue\">throw</span> <span style=\"color:blue\">new</span> Exception(<span style=\"color:#a31515\">&quot;Could not open file $pFilename for writing.&quot;</span>);\r\n\t\t}\r\n\r\n\t\t<span style=\"color:blue\">if</span> ($this-&gt;_useBOM) {\r\n\t\t\t<span style=\"color:green\">// Write the UTF-8 BOM code</span>\r\n\t\t\tfwrite($fileHandle, <span style=\"color:#a31515\">&quot;\\xEF\\xBB\\xBF&quot;</span>);\r\n\t\t}\r\n\r\n\t\t<span style=\"color:blue\">foreach</span> ($this-&gt;_phpExcel-&gt;getWorksheetIterator() <span style=\"color:blue\">as</span> $i=&gt;$worksheet) {\r\n\t\t\t$wtitle = $worksheet-&gt;getTitle();\r\n\t\t\t<span style=\"color:green\">//echo $i.' - ' . $wtitle . &quot;\\n&lt;br/&gt;&quot;;</span>\r\n\t\t\t$wstate = $worksheet-&gt;getSheetState();\r\n\t\t\t<span style=\"color:green\">//echo '- ' . $wstate . &quot;\\n&lt;br/&gt;&quot;;</span>\r\n\t\t\t<span style=\"color:blue\">if</span>(in_array($wstate,$use_states)){\r\n\t\t\t\t<span style=\"color:green\">//echo &quot; - Processing\\n&lt;br/&gt;&quot;;</span>\r\n\r\n\t\t\t\t<span style=\"color:green\">// get the worksheet.</span>\r\n\t\t\t\t$sheet = $this-&gt;_phpExcel-&gt;getSheet($i);\r\n\t\t\t\t<span style=\"color:green\">// Convert sheet to array</span>\r\n\t\t\t\t$cellsArray = $sheet-&gt;toArray(<span style=\"color:#a31515\">''</span>, $this-&gt;_preCalculateFormulas);\r\n\t\t\t\t<span style=\"color:green\">//var_dump($cellsArray);</span>\r\n\r\n\t\t\t\t<span style=\"color:green\">// Write rows to file</span>\r\n\t\t\t\t<span style=\"color:blue\">foreach</span> ($cellsArray <span style=\"color:blue\">as</span> $row) {\r\n\t\t\t\t\t$this-&gt;_writeLine($fileHandle, $row);\r\n\t\t\t\t}\r\n\r\n\t\t\t} <span style=\"color:blue\">else</span> {\r\n\t\t\t\t<span style=\"color:green\">//echo &quot; - NOT using this sheet\\n&lt;br/&gt;&quot;;</span>\r\n\t\t\t}\r\n\t\t}\r\n\t\t<span style=\"color:green\">// Close file</span>\r\n\t\t<span style=\"color:blue\">fclose</span>($fileHandle);\r\n\r\n\t\tPHPExcel_Calculation::setArrayReturnType($saveArrayReturnType);\r\n\t\tPHPExcel_Calculation::getInstance()-&gt;writeDebugLog = $saveDebugLog;\r\n\t}\r\n\r\n</pre>\r\n</div>\r\n<p></p>\r\n",
    "PostedDate": "2011-05-10T14:13:04.05-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]