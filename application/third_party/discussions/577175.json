[
  {
    "Id": "1340074",
    "ThreadId": "577175",
    "Html": "Hello, and first of all, thanks for this. It's really an amazing work.\r<br />\n<br />\nI am very new with php and phpexcel, and I'm having some trouble creating a chart.\r<br />\nI have a function in one file that only creates the excel file, and then another function that reads the created file and then writes data from an array and creates a chart in the same excel file. I run all of them without any error but when I look at the sheet the chart it's created but it's empy though the data is in the table correctly.\r<br />\nI have another function that does all of it in the same file (practically the same code in both of them) and works perfectly.\r<br />\nNo idea what's the problem here. \r<br />\nWell, all the help is welcome.\r<br />\n<br />\n<br />\nI'll leave my code here below:<br />\n<pre><code>    $workbook = PHPExcel_IOFactory::createReader(&quot;Excel2007&quot;);\n    $workbook = PHPExcel_IOFactory::load('Excel.xlsx');\n\n\n        $sheet = $workbook-&gt;getActiveSheet();\n        $sheet = $workbook-&gt;setActiveSheetIndex();\n\n$sheet-&gt;fromArray($array, null, 'A4');\n\n$workbook -&gt;getActiveSheet()-&gt;getColumnDimension('A')-&gt;setAutoSize(true);\n$workbook -&gt;getActiveSheet()-&gt;getColumnDimension('B')-&gt;setAutoSize(true);\n$workbook -&gt;getActiveSheet()-&gt;getColumnDimension('C')-&gt;setAutoSize(true);\n\n$cell = count($array, COUNT_RECURSIVE);\n$cell = (($cell/3)-3);\necho (&quot;$cell \\n&quot;);\n$num = ceil($cell);\necho (&quot;$num \\n&quot;);\n\n\n\n/*-----------------------------Full Graph-------------------------------*/\n$labels = array(\n  new PHPExcel_Chart_DataSeriesValues('String', 'Worksheet!$B$4', null, 1),\n  new PHPExcel_Chart_DataSeriesValues('String', 'Worksheet!$C$4', null, 1),\n);\n$categories = array(\n  new PHPExcel_Chart_DataSeriesValues('String', 'Worksheet!$A$5:$A'.($num + 5), null, ($num - 1)),\n  new PHPExcel_Chart_DataSeriesValues('String', 'Worksheet!$A$5:$A'.($num + 5), null, ($num - 1)),\n);\n$values = array(\n  new PHPExcel_Chart_DataSeriesValues('Number', 'Worksheet!$B$5:$B'.($num + 5), null, ($num - 1)),\n  new PHPExcel_Chart_DataSeriesValues('Number', 'Worksheet!$C$5:$C'.($num + 5), null, ($num - 1)),\n);\n$series = new PHPExcel_Chart_DataSeries(\n  PHPExcel_Chart_DataSeries::TYPE_BARCHART,       // plotType\n  PHPExcel_Chart_DataSeries::GROUPING_CLUSTERED,  // plotGrouping\n  array(0, 1),                                    // plotOrder\n  $labels,                                        // plotLabel\n  $categories,                                    // plotCategory\n  $values                                         // plotValues\n);\n\n$title1 = new PHPExcel_Chart_Title('Total y ' .($dep));\n\n$series-&gt;setPlotDirection(PHPExcel_Chart_DataSeries::DIRECTION_COL);\n$plotarea = new PHPExcel_Chart_PlotArea(null, array($series));\n$legend = new PHPExcel_Chart_Legend(PHPExcel_Chart_Legend::POSITION_RIGHT, null, false);\n$chart = new PHPExcel_Chart(\n  'chart',                                       // name\n  $title1,                                           // title\n  $legend,                                        // legend\n  $plotarea,                                      // plotArea\n  true,                                           // plotVisibleOnly\n  0,                                              // displayBlanksAs\n  null,                                           // xAxisLabel\n  null                                            // yAxisLabel\n);\n\n\n\n/*-----------------------------Full Graph-------------------------------*/\n\n/*-----------------------------Small Graph-------------------------------*/\n$label = array(\n  new PHPExcel_Chart_DataSeriesValues('String', 'Worksheet!$B$4', null, 1),\n  \n);\n$category = array(\n  new PHPExcel_Chart_DataSeriesValues('String', 'Worksheet!$A$5:$A'.($num + 5), null, ($num - 1)),\n);\n$values2 = array(\n  new PHPExcel_Chart_DataSeriesValues('Number', 'Worksheet!$B$5:$B'.($num + 5), null, ($num - 1)),\n\n);\n$series2 = new PHPExcel_Chart_DataSeries(\n  PHPExcel_Chart_DataSeries::TYPE_BARCHART,       // plotType\n  PHPExcel_Chart_DataSeries::GROUPING_CLUSTERED,  // plotGrouping\n  array(0),                                    // plotOrder\n  $label,                                        // plotLabel\n  $category,                                    // plotCategory\n  $values2                                         // plotValues\n);\n\n$title2 = new PHPExcel_Chart_Title('Total  ' .($dep));\n\n$series2-&gt;setPlotDirection(PHPExcel_Chart_DataSeries::DIRECTION_COL);\n$plotarea2 = new PHPExcel_Chart_PlotArea(null, array($series2));\n$legend2 = new PHPExcel_Chart_Legend(PHPExcel_Chart_Legend::POSITION_RIGHT, null, false);\n$chart2 = new PHPExcel_Chart(\n  'chart2',                                       // name\n   $title2,                                           // title\n  $legend2,                                        // legend\n  $plotarea2,                                      // plotArea\n  true,                                           // plotVisibleOnly\n  0,                                              // displayBlanksAs\n  null,                                           // xAxisLabel\n  null                                            // yAxisLabel\n);\n\n\n\n\n/*-----------------------------Small Graph-------------------------------*/\n\n$chart-&gt;setTopLeftPosition('A'.($num+10));\n$chart2-&gt;setTopLeftPosition('K'.($num+10));\n$chart-&gt;setBottomRightPosition('I30');\n$chart2-&gt;setBottomRightPosition('W30');\n$sheet-&gt;addChart($chart);\n$sheet-&gt;addChart($chart2);\n$writer = PHPExcel_IOFactory::createWriter($workbook, 'Excel2007');\n$writer-&gt;setIncludeCharts(TRUE);\n$writer-&gt;save('Excel.xlsx');\n</code></pre>\n\n",
    "PostedDate": "2015-01-08T07:52:28.97-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]