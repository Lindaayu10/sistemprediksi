[
  {
    "Id": "1001003",
    "ThreadId": "433083",
    "Html": "I try to delete 1000 rows with something like <br />\n<pre><code>$curWorksheet-&gt;removeRow(12,1000)</code></pre>\n\nbut this takes 1 minute\r<br />\nand the formatting below is also removed (e.g. a formatting of a whole column)\r<br />\nIf I delete a complete sheet and it’s done as it were directly.\r<br />\n<br />\nis there a function in phpExcel which deletes a bunch of rows like you can do in excel \r<br />\nby selecting rows and choose 'delete rows'?\r<br />\nAll rows below the deleted rows will move up and it’s done in less than one second.\r<br />\nThis delete function don’t need any checks of formulas or other things cause all cells depending on each other will also be deleted.<br />\n",
    "PostedDate": "2013-02-14T00:47:48.263-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1001015",
    "ThreadId": "433083",
    "Html": "<blockquote>\nis there a function in phpExcel which deletes a bunch of rows like you can do in excel<br />\nby selecting rows and choose 'delete rows'? <br />\nAll rows below the deleted rows will move up and it’s done in less than one second. <br />\n</blockquote>\nI really don't understand what you're asking for. the removeRows() method allows you to select a starting row, and a number of rows to delete. All rows below the deleted rows move up.... that's pretty much what happens if you do it in Excel, though Excel does a few other things with formula references that you don't mention.... and PHPExcel also does those. And it certainly doesn't remove column formatting.\r<br />\n<br />\nAre you just asking us to make it faster so that it will run in less than a second?\r<br />\nThere's some changes I'm testing at the moment that will make inserting/deleting faster, but it still won't be instantaneous without any processing required at all.<br />\n<blockquote>\nThis delete function don’t need any checks of formulas or other things cause all cells depending on each other will also be deleted.<br />\n</blockquote>\nI just don't follow this logic.... so you want all cells that contain formula referencing the deleted rows to be automagically deleted as well? Excel's delete does formula checks and makes adjustments across the spreadsheet whenever you delete a row or column, PHPExcel does the same... you're saying you want what Excel does, but don't want it to work the same way?<br />\n",
    "PostedDate": "2013-02-14T01:12:15.343-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1001172",
    "ThreadId": "433083",
    "Html": "<blockquote>\nI really don't understand what you're asking for. the removeRows() method allows you to select a starting row, and a number of rows to delete. All rows below the deleted rows move up.... that's pretty much what happens if you do it in Excel, though Excel does a few other things with formula references that you don't mention.... and PHPExcel also does those. And it certainly doesn't remove column formatting.<br />\n</blockquote>\nok I deleted the last rows in sheet so only the formatting was removed and I thought the rows wouldn't move up.<br />\n<br />\nHere now a more exactly description:<br />\n<br />\nif you run this<br />\n<pre><code>$curWorksheet-&gt;getStyle(&quot;B:D&quot;)-&gt;getFill()\n-&gt;setFillType(PHPExcel_Style_Fill::FILL_SOLID)\n-&gt;getStartColor()-&gt;setARGB(&quot;FFFFFFA3&quot;);\n\nfor($row=1;$row&lt;6;$row++)\n{\n    for($col=65;$col&lt;85;$col++)\n    {\n        $curWorksheet-&gt;getCell(chr($col).$row)-&gt;setValue($row);\n    }\n}</code></pre>\n\nyou get somethin like this as result:<br />\n<img src=\"http://golf914.server4you.de/screens_phpexcel/no_delete.jpg\" alt=\"Image\" /><br />\n<br />\nnow you run this:<br />\n<pre><code>$curWorksheet-&gt;removeRow(4,2);</code></pre>\n\nand the excelsheet looks like this:<br />\n<img src=\"http://golf914.server4you.de/screens_phpexcel/delete_last_rows.jpg\" alt=\"Image\" /><br />\n<br />\nif you delete rows in the middle<br />\n<pre><code>$curWorksheet-&gt;removeRow(2,2);</code></pre>\n\nyou will get this:<br />\n<img src=\"http://golf914.server4you.de/screens_phpexcel/delete_middle_rows.jpg\" alt=\"Image\" /><br />\n<br />\nso theres in the rows 4 and 5 no formatting anymore.<br />\n<blockquote>\nAre you just asking us to make it faster so that it will run in less than a second?<br />\nThere's some changes I'm testing at the moment that will make inserting/deleting faster, but it still won't be instantaneous without any processing required at all.<br />\n</blockquote>\nThat's what i meant. I supposed that there are some checks, which take some time, before the code will delete the row. I don't know how the cells where stored internally. Also thought if they are stored in an array, why dont use something like array_splice. But could be that I'm thinking to easy at this point. Therefore I don't know the code good enough.<br />\n<blockquote>\n<blockquote>\nThis delete function don’t need any checks of formulas or other things cause all cells depending on each other will also be deleted.<br />\n</blockquote>\nI just don't follow this logic.... so you want all cells that contain formula referencing the deleted rows to be automagically deleted as well? Excel's delete does formula checks and makes adjustments across the spreadsheet whenever you delete a row or column, PHPExcel does the same... you're saying you want what Excel does, but don't want it to work the same way?<br />\n</blockquote>\nI didn't mean it like that. I tried just to explain, with my bad English knowledge, that I need a function which hasn't any need for checks and is just fast.<br />\n",
    "PostedDate": "2013-02-14T05:48:46.677-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]