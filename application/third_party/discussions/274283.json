[
  {
    "Id": "678251",
    "ThreadId": "274283",
    "Html": "<p>PHPExcel version:&nbsp;<span style=\"font-weight: bold;\">Release 1.7.6</span></p>\n<p>&nbsp;</p>\n<p>Hello Guys&iexcl;</p>\n<p>I have tried over and over to achieve this without sucess, so now i raise a flag for you to help me =(</p>\n<p>-I have a php web, and i want to extract some data from an xlsx file and show the content on my website, using an \"echo\", but heres my situation:</p>\n<p>I tried using this code, but is not doing anything:</p>\n<p>***********************************************************************************************</p>\n<p>&nbsp;</p>\n<div style=\"color: black; background-color: white;\">\n<pre><span style=\"color: green;\">/** Error reporting */</span>\nerror_reporting(E_ALL);\n\n<span style=\"color: green;\">/** Include path **/</span>\nini_set(<span style=\"color: #a31515;\">'include_path'</span>, ini_get(<span style=\"color: #a31515;\">'include_path'</span>).<span style=\"color: #a31515;\">';../Classes/'</span>); <span style=\"color: green;\">//Classes dir</span>\n\n<span style=\"color: green;\">/** PHPExcel_IOFactory */</span>\n<span style=\"color: blue;\">include</span> <span style=\"color: #a31515;\">'PHPExcel/IOFactory.php'</span>;\n\n$objReader = PHPExcel_IOFactory::createReader(<span style=\"color: #a31515;\">'Excel2007'</span>);<span style=\"color: green;\">//excel2007</span>\n$objPHPExcel = $objReader-&gt;load(<span style=\"color: #a31515;\">\"01simple.xlsx\"</span>); <span style=\"color: green;\">//ARCHIVE excel2007 dir</span>\n$val = ($objPHPExcel-&gt;getActiveSheet()-&gt;getCell(<span style=\"color: #a31515;\">'A1'</span>)); <span style=\"color: green;\">//CELL</span>\n$temp = $val-&gt;getvalue();<span style=\"color: green;\">//returns the value in the cell</span>\n</pre>\n<pre><span style=\"color: green;\">echo ($temp);</span></pre>\n</div>\n<p>&nbsp;</p>\n<p>***********************************************************************************************</p>\n<p>I got the previous code from a discussion on this forum, but it doesnt do anything, and if I look on the code, the</p>\n<p>issue starts on this line of code: &nbsp; &nbsp;<span style=\"font-family: Consolas,'Courier New',Courier,monospace; white-space: pre;\">$objPHPExcel = $objReader-&gt;load(<span style=\"color: #a31515;\">\"01simple.xlsx\"</span>);</span></p>\n<p><span style=\"font-family: Consolas,'Courier New',Courier,monospace; white-space: pre;\">BTW: That \"01simple.xlsx\" exists, and is stored on the root of the web server, so the issue is not because is not finding</span></p>\n<p><span style=\"font-family: Consolas,'Courier New',Courier,monospace; white-space: pre;\">the excel file, but something related with the $objPHPExcel or the $objReader</span></p>\n<p>&nbsp;</p>\n<p>Then, i tried with this other piece of code that i got from another discusion here on PHPExcel:</p>\n<p>***********************************************************************************************</p>\n<pre><span style=\"font-family: 'Segoe UI','Microsoft Sans Serif',Arial,Geneva,sans-serif;\"><span style=\"white-space: normal;\"><div style=\"color: black; background-color: white;\"><pre><span style=\"color: blue;\">require_once</span> <span style=\"color: #a31515;\">'PHPExcel/IOFactory.php'</span>; \n$objPHPExcel = PHPExcel_IOFactory::load(<span style=\"color: #a31515;\">\"01simple.xlsx\"</span>);\n    <span style=\"color: blue;\">foreach</span> ($objPHPExcel-&gt;getWorksheetIterator() <span style=\"color: blue;\">as</span> $worksheet) {\n    $worksheetTitle     = $worksheet-&gt;getTitle();\n    $highestRow         = $worksheet-&gt;getHighestRow();\n    $highestColumn      = $worksheet-&gt;getHighestColumn();\n    $highestColumnIndex = PHPExcel_Cell::columnIndexFromString($highestColumn);\n    $nrColumns = ord($highestColumn) - 64;\n    <span style=\"color: blue;\">for</span> ($row = 0; $row &lt;= $highestRow; ++ $row) {\n            <span style=\"color: blue;\">for</span> ($col = 0; $col &lt; $highestColumnIndex; ++ $col) {\n                $cell = $worksheet-&gt;getCellByColumnAndRow($col, $row);\n                $val = $cell-&gt;getValue();\n<span style=\"color: blue;\">echo</span> ($val);                \n                }\n        }\n    }</pre>\n</div>\n</span></span></pre>\n<p>***********************************************************************************************</p>\n<p>This time it prints something on my website&iexcl;&iexcl;&iexcl;&iexcl; But not something readable....</p>\n<p>If you go and open the <a href=\"http://www.codeplex.com/Download?ProjectName=PHPExcel&amp;DownloadId=94244\" target=\"_blank\"> \"</a><span style=\"font-family: Consolas,'Courier New',Courier,monospace; white-space: pre;\"><span><a href=\"http://www.codeplex.com/Download?ProjectName=PHPExcel&amp;DownloadId=94244\" target=\"_blank\">01simple.xlsx</a></span><span style=\"font-family: 'Segoe UI','Microsoft Sans Serif',Arial,Geneva,sans-serif; white-space: normal;\"><a href=\"http://www.codeplex.com/Download?ProjectName=PHPExcel&amp;DownloadId=94244\" target=\"_blank\">\"</a> file on the examples section on this website, you are going to find that it contains something like \"</span></span>Hello<span> </span>Hello<span> </span><span>&nbsp;</span>world!<span> </span>world!<span> </span>Miscellaneous glyphs<span> </span>&eacute;&agrave;&egrave;&ugrave;&acirc;&ecirc;&icirc;&ocirc;&ucirc;&euml;&iuml;&uuml;&yuml;&auml;&ouml;&uuml;&ccedil;\" but instead of that, what is being printed on my website is something like : \"PK\u0003\u0004\u0014\b\u0018Ax; &Ntilde;&frac12;b%B#+xyC\u0014\u0017B&euml;Ž&ordm;Oj&Yacute;&fnof;\u0012c&Aring;&mdash;&Yacute;&Eacute;&yen;}\u0003PK\u0003\u0004\u0014\b\u0018Ax;};x\u0007.\u001cW7_&amp;*7W\u001c&Oslash;&nbsp; \u0010W)\u0013 0Pm\"</p>\n<p>That makes me think that im missing something related to encoding, but since im new on phpExcel, and i already exahusted all the documentation without sucess, then i</p>\n<p>request your wisdom in order to help me oh lords of the php world&iexcl;</p>\n<p>if you can let me know what im doing wrong, or post a code example about how to extract the value of an xlsx spreadsheet cell and then paste it on a web using echo($cell); i will appreciate it forever.</p>\n<p>&nbsp;</p>\n<p>Waiting for your responses.</p>\n<p>&nbsp;</p>\n<p>Regards&iexcl;</p>",
    "PostedDate": "2011-09-29T09:31:54.97-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]