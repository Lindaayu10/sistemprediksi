[
  {
    "Id": "682245",
    "ThreadId": "275360",
    "Html": "\r\n<p>I am using the <code>removeRow </code>function to go through and trim up some unneeded rows in an Excel 2005 Spreadsheet (.xls). The only issue is that when a row is removed, it's contents are emptied, but the row is still counted as an existing row (easily\r\n demonstrated with file size). All of the cells remain initialized to blank values. This is also reflected with the\r\n<code>getHighestRow</code> function which still returns the original highest row of the spreadsheet, not the altered one, indicating all rows that were &quot;removed&quot; are still counted and stored.</p>\r\n<p>This is the code that deletes it:</p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre>$objReader = <span style=\"color:blue\">new</span> PHPExcel_Reader_Excel5();\r\n$objReader-&gt;setReadDataOnly(TRUE);\r\n$objReader-&gt;setLoadAllSheets();\r\n$objPHPExcel = $objReader-&gt;load($dest);\r\n\r\n$ranges_formatted = format_ranges($rows_to_delete);\r\n<span style=\"color:blue\">foreach</span> ($ranges_formatted <span style=\"color:blue\">as</span> $start_spot =&gt; $range)\r\n{\r\n\t$objPHPExcel-&gt;getActiveSheet()-&gt;removeRow($start_spot, $range[<span style=\"color:#a31515\">'range'</span>]);\r\n}\r\n$objWriter = <span style=\"color:blue\">new</span> PHPExcel_Writer_Excel5($objPHPExcel);\r\n$objWriter-&gt;save($dest);\r\n</pre>\r\n</div>\r\n<p>&nbsp;</p>\r\n<p><code>$dest</code> is a filepath and <code>format_ranges</code> is a function that returns an array of ranges and their start spots to delete, defined as so:</p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre><span style=\"color:blue\">function</span> format_ranges($ranges)\r\n{\r\n\t$prior = NULL;\r\n\t$all_ranges = <span style=\"color:blue\">array</span>();\r\n\t$start_spot = NULL;\r\n\t$this_range = 1;\r\n\t<span style=\"color:blue\">foreach</span> ($ranges <span style=\"color:blue\">as</span> $range)\r\n\t{\r\n\t\t<span style=\"color:blue\">if</span> ($prior === NULL)\r\n\t\t{\r\n\t\t\t$prior = $range;\r\n\t\t\t$start_spot = $range;\r\n\t\t}\r\n\t\t<span style=\"color:blue\">else</span> {\r\n\t\t\t<span style=\"color:blue\">if</span> (($prior &#43; 1) == $range)\r\n\t\t\t{\r\n\t\t\t\t$this_range &#43;= 1;\r\n\t\t\t\t$prior = $range;\r\n\t\t\t\t<span style=\"color:blue\">if</span> (!<span style=\"color:blue\">isset</span>($start_spot))\r\n\t\t\t\t{\r\n\t\t\t\t\t$start_spot = $prior;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t<span style=\"color:blue\">else</span> {\r\n\t\t\t\t$all_ranges[$start_spot][<span style=\"color:#a31515\">'range'</span>] = $this_range;\r\n\t\t\t\t$this_range = 1;\r\n\t\t\t\t$prior = $range;\r\n\t\t\t\t<span style=\"color:blue\">unset</span>($start_spot);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\t<span style=\"color:blue\">if</span> (<span style=\"color:blue\">isset</span>($start_spot))\r\n\t{\r\n\t\t$all_ranges[$start_spot][<span style=\"color:#a31515\">'range'</span>] = $this_range;\r\n\t}\r\n\t\r\n\t<span style=\"color:blue\">return</span> $all_ranges;\r\n}<br><br> <br></pre>\r\n</div>\r\n<div style=\"color:black; background-color:white\">As is, <code>format_ranges</code> seems to be working just fine and the correct rows are removed, they just remain blank, meaning the file is still rather large. As you can also see, I am also just reading the\r\n data. I did try this with reading everything, not just the data, and the end result was an even bigger file than just reading data.</div>\r\n<div style=\"color:black; background-color:white\">So, my question is: how do I delete these blank rows? Can I modify my code so\r\n<code>removeRow</code> does this?</div>\r\n<div style=\"color:black; background-color:white\"></div>\r\n<div style=\"color:black; background-color:white\">Thanks in advance, please tell me if I can provide more information.</div>\r\n",
    "PostedDate": "2011-10-10T12:56:39.28-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]