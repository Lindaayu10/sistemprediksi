[
  {
    "Id": "247279",
    "ThreadId": "72422",
    "Html": "<p><span style=\"font-size:12pt\"></span></p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre>How to set background color to colums: <strong><span style=\"color:#ff0000\">A1:Z1</span></strong> from an array, or as small source code as possible.</pre>\r\n<pre>&nbsp;</pre>\r\n<pre>I can do this when setting borders:</pre>\r\n<pre>&lt;?php</pre>\r\n<pre>$sharedStyleTitles = <span style=\"color:Blue\">new</span> PHPExcel_Style();\r\n$sharedStyleTitles-&gt;applyFromArray(\r\n\t<span style=\"color:Blue\">array</span>(<span style=\"color:#A31515\">'borders'</span> =&gt; <span style=\"color:Blue\">array</span>(\r\n\t\t<span style=\"color:#A31515\">'bottom'</span>=&gt; <span style=\"color:Blue\">array</span>(<span style=\"color:#A31515\">'style'</span> =&gt; PHPExcel_Style_Border::BORDER_THIN),\r\n\t\t<span style=\"color:#A31515\">'top'</span>\t=&gt; <span style=\"color:Blue\">array</span>(<span style=\"color:#A31515\">'style'</span> =&gt; PHPExcel_Style_Border::BORDER_THIN),\r\n\t\t<span style=\"color:#A31515\">'left'</span>\t=&gt; <span style=\"color:Blue\">array</span>(<span style=\"color:#A31515\">'style'</span> =&gt; PHPExcel_Style_Border::BORDER_THIN),\r\n\t\t<span style=\"color:#A31515\">'right'</span>\t=&gt; <span style=\"color:Blue\">array</span>(<span style=\"color:#A31515\">'style'</span> =&gt; PHPExcel_Style_Border::BORDER_THIN)\r\n\t\t)\r\n ));\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setSharedStyle($sharedStyleTitles, <span style=\"color:#A31515\">'A'</span>.$sk.<span style=\"color:#A31515\">':Z'</span>.$sk);\r\n?&gt;</pre>\r\n</div>\r\n<p>But I don't know how to also add not only borders but and a background colors.</p>\r\n<p>I know only the way when I add it one by one to each column, when I use the following code:</p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre>&lt;?php\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#A31515\">'A'</span>.$sk)-&gt;getFill()-&gt;applyFromArray(\r\n\t<span style=\"color:Blue\">array</span>(\r\n\t\t<span style=\"color:#A31515\">'type'</span>       =&gt; PHPExcel_Style_Fill::FILL_SOLID,\r\n\t\t<span style=\"color:#A31515\">'startcolor'</span> =&gt; <span style=\"color:Blue\">array</span>(<span style=\"color:#A31515\">'rgb'</span> =&gt; <span style=\"color:#A31515\">'E9E9E9'</span>),\r\n\t\t<span style=\"color:#A31515\">'endcolor'</span>   =&gt; <span style=\"color:Blue\">array</span>(<span style=\"color:#A31515\">'rgb'</span> =&gt; <span style=\"color:#A31515\">'E9E9E9'</span>)\r\n\t)\r\n);\r\n?&gt;\r\n</pre>\r\n</div>\r\n<p>&nbsp;Any suggestions solving this problem?</p>\r\n<p>PS. As I looked over reference, the Apply from array has the required functions:</p>\r\n<table border=1 cellspacing=0 cellpadding=0>\r\n<tbody>\r\n<tr>\r\n<td colspan=2 width=614 valign=top>\r\n<p><strong><span style=\"color:white\" lang=EN-US>PHPExcel_Style</span></strong></p>\r\n</td>\r\n</tr>\r\n<tr>\r\n<td width=307 valign=top>\r\n<p>Array key:</p>\r\n</td>\r\n<td width=307 valign=top>\r\n<p>Maps to property:</p>\r\n</td>\r\n</tr>\r\n<tr>\r\n<td width=307 valign=top>\r\n<p><span style=\"color:#ff0000\">f<strong>ill</strong></span></p>\r\n<p>font</p>\r\n<p>borders</p>\r\n<p>alignment</p>\r\n<p>numberformat</p>\r\n<p>protection<br><br></p>\r\n</td>\r\n<td width=307 valign=top>\r\n<p><span style=\"color:#ff0000\">g<strong>etFill()</strong></span><br>getFont()<br>getBorders()<br>getAlignment()<br>getNumberFormat()<br>getProtection()</p>\r\n</td>\r\n</tr>\r\n<tr>\r\n<td colspan=2 width=614 valign=top>\r\n<p><strong><span style=\"color:white\" lang=EN-US>PHPExcel_Style_Fill</span></strong></p>\r\n</td>\r\n</tr>\r\n<tr>\r\n<td width=307 valign=top>\r\n<p>Array key:</p>\r\n</td>\r\n<td width=307 valign=top>\r\n<p>Maps to property:</p>\r\n</td>\r\n</tr>\r\n<tr>\r\n<td width=307 valign=top>\r\n<p><strong><span style=\"color:#ff0000\">type</span></strong><br>rotation<br><strong><span style=\"color:#ff0000\">startcolor<br>endcolor</span></strong><br>color<br><br></p>\r\n</td>\r\n<td width=307 valign=top>\r\n<p><strong><span style=\"color:#ff0000\">setFillType()</span></strong><br>setRotation()<br><strong><span style=\"color:#ff0000\">getStartColor()</span></strong><br><strong><span style=\"color:#ff0000\">getEndColor()<br></span></strong>getStartColor()</p>\r\n</td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n<p>&nbsp;</p>\r\n<p>But&nbsp;what corrent&nbsp;the source code should be for it.</p>\r\n<p>Thanks!</p>",
    "PostedDate": "2009-10-19T07:17:34.773-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "247512",
    "ThreadId": "72422",
    "Html": "<p>Starting with PHPExcel 1.7.0 the recommended way to style a range of cells is like this:</p>\r\n<div style=\"color:black;background-color:white\">\r\n<pre>$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#a31515\">'A1:Z1'</span>)-&gt;getFill()-&gt;applyFromArray(<br>    <span style=\"color:blue\">array</span>(<br>        <span style=\"color:#a31515\">'type'</span>       =&gt; PHPExcel_Style_Fill::FILL_SOLID,<br>        <span style=\"color:#a31515\">'startcolor'</span> =&gt; <span style=\"color:blue\">array</span>(<span style=\"color:#a31515\">'rgb'</span> =&gt; <span style=\"color:#a31515\">'E9E9E9'</span>),<br>    )<br>);<br></pre>\r\n</div>\r\n<p>As you can see PHPExcel 1.7.0 has started to accept a cell range parameter for getStyle() method. The following metods are no longer recommended:</p>\r\n<div style=\"color:black;background-color:white\">\r\n<pre>duplicateStyle()<br>duplicateStyleArray()<br>setSharedStyle()<br></pre>\r\n</div>\r\n<p><br> All you need is <span style=\"font-family:Courier New\">getStyle()</span> and <span style=\"font-family:Courier New\">applyFromArray()</span>.</p>",
    "PostedDate": "2009-10-19T18:18:53.823-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]