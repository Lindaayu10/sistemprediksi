[
  {
    "Id": "1290255",
    "ThreadId": "561220",
    "Html": "Hi, i having a problem that cannot output the excel to client but is work if save to server. My code stated below: <br />\n<pre><code>Javascript:\n&lt;a href=&quot;javascript:void(0)&quot; class=&quot;icon-{!$button.params.icon!}&quot; onclick=&quot;doExport()&quot;&gt;&lt;/a&gt;\n\nfunction doExport(param, success, error){\n    $.messager.progress({text:'Processing. Please wait...'});\n        $.ajax({\n        url: 'index.php',\n        type: 'POST',\n        dataType: 'json',\n        jsonp: false,\n        data: {\n{!if isset($grid.searches)!}\n            aqfld: {\n{!foreach from=$grid.searches item=search name=search!}\n                {!$search.name!}: $('#{!$search.name!}').searchbox('getName')\n{!if !$smarty.foreach.search.last!},{!/if!}\n{!/foreach!}\n            },\n            aqtxt: {\n{!if isset($grid.options.params.aqtxt)!}\n{!foreach from=$grid.options.params.aqtxt key=key item=param name=param!}\n            {!$key!}: '{!$param!}',\n{!/foreach!}\n{!/if!}\n{!foreach from=$grid.searches item=search name=search!}\n                {!$search.name!}: $('#{!$search.name!}').searchbox('getValue')\n{!if !$smarty.foreach.search.last!},{!/if!}\n{!/foreach!}\n            },\n{!/if!}\n{!if isset($grid.filters)!}\n            aflt: {\n{!if isset($grid.options.params.aflt)!}\n{!foreach from=$grid.options.params.aflt key=key item=param name=param!}\n            {!$key!}: '{!$param!}',\n{!/foreach!}\n{!/if!}\n{!foreach from=$grid.filters item=filter name=filter!}\n                {!$filter.name!}: $('#{!$filter.name!}').combobox('getValue{!if isset($filter.params.multiple) &amp;&amp; $filter.params.multiple!}s{!/if!}')\n{!if !$smarty.foreach.filter.last!},{!/if!}\n{!/foreach!}\n            },\n{!/if!}\n{!if isset($grid.ranges)!}\n            aqrng: {\n{!foreach from=$grid.ranges item=range name=range!}\n                {!$range.name!}from: $('#{!$range.name!}From').datebox('getValue'),\n                {!$range.name!}to: $('#{!$range.name!}To').datebox('getValue')\n{!if !$smarty.foreach.range.last!},{!/if!}\n{!/foreach!}\n            },\n{!/if!}\n            ist: -1,\n            ilt: 0,\n            //sfld: sort,\n            //sodr: order,\n{!if isset($grid.options.params)!}\n{!foreach from=$grid.options.params key=key item=param name=param!}\n{!if !is_array($param) !}\n            {!$key!}: '{!$param!}',\n{!/if!}\n{!/foreach!}\n{!/if!}\n{!if isset($sid)!}\n            sid: {!$sid!},\n{!/if!}\n            iexport:'1',\n            mdl:'{!$grid.module!}',\n            action: 'excel'\n        },\n        success: function(data){\n            $.messager.progress('close');\n            console.log($('#{!$grid.id!}').datagrid('columns'));\n            console.log(data);\n        }\n    });\n}\n\nPHP:\n protected function doGetExcel($params){\n                //get parameters from doGetData\n        $data= $this-&gt;doGetData($params, true, false);\n\n        // Create new PHPExcel object\n        $objPHPExcel = new PHPExcel();\n\n        // Set properties\n        $objPHPExcel-&gt;getProperties()-&gt;setCreator(&quot;Maarten Balliauw&quot;);\n        $objPHPExcel-&gt;getProperties()-&gt;setLastModifiedBy(&quot;Maarten Balliauw&quot;);\n        $objPHPExcel-&gt;getProperties()-&gt;setTitle(&quot;Office 2007 XLSX Test Document&quot;);\n        $objPHPExcel-&gt;getProperties()-&gt;setSubject(&quot;Office 2007 XLSX Test Document&quot;);\n        $objPHPExcel-&gt;getProperties()-&gt;setDescription(&quot;Test document for Office 2007 XLSX, generated using PHP classes.&quot;);\n        // Rename sheet\n        $objPHPExcel-&gt;getActiveSheet()-&gt;setTitle('Member details');\n\n        // Add some data\n        $objPHPExcel-&gt;setActiveSheetIndex(0);\n        $objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue('A1', 'Account');\n        $objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue('B1', 'Full Name');\n        $objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue('C1', 'Channel');\n        $objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue('D1', 'Currency');\n        $objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue('E1', 'Main Wallet');\n        $objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue('F1', 'Deposit');\n        $objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue('G1', 'Withdrawal');\n        $objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue('H1', 'Tel. No');\n        $objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue('I1', 'Email');\n        $objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue('J1', 'Registered On');\n        $objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue('K1', 'Last Deposit');\n        $objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue('L1', 'Status');\n        $objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue('M1', 'IP Address');\n        $objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue('N1', 'Location');\n\n\n        foreach ($data['rows'] as $key =&gt; $value){\n            $rowID = $key + 2;\n            $columnID = 'A';\n            $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue($columnID++.$rowID, $value['code']);\n            $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue($columnID++.$rowID, $value['fullname']);\n            $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue($columnID++.$rowID, $value['channel']);\n            $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue($columnID++.$rowID, $value['crccode']);\n            $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue($columnID++.$rowID, $value['balance']);\n            $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue($columnID++.$rowID, $value['deposit']);\n            $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue($columnID++.$rowID, $value['withdrawal']);\n            $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue($columnID++.$rowID, $value['telephone']);\n            $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue($columnID++.$rowID, $value['email']);\n            $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue($columnID++.$rowID, $value['created']);\n            $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue($columnID++.$rowID, $value['lastdeposit']);\n            $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue($columnID++.$rowID, $value['status']);\n            $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue($columnID++.$rowID, $value['createdip']);\n            $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue($columnID++.$rowID, $value['location']);\n        }\n\n        // Auto resize the columns width\n        $objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension('A')-&gt;setAutoSize(true);\n        $objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension('B')-&gt;setAutoSize(true);\n        $objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension('C')-&gt;setAutoSize(true);\n        $objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension('D')-&gt;setAutoSize(true);\n        $objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension('E')-&gt;setAutoSize(true);\n        $objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension('F')-&gt;setAutoSize(true);\n        $objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension('G')-&gt;setAutoSize(true);\n        $objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension('H')-&gt;setAutoSize(true);\n        $objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension('I')-&gt;setAutoSize(true);\n        $objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension('J')-&gt;setAutoSize(true);\n        $objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension('K')-&gt;setAutoSize(true);\n        $objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension('L')-&gt;setAutoSize(true);\n        $objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension('M')-&gt;setAutoSize(true);\n        $objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension('N')-&gt;setAutoSize(true);\n\n        $objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, 'Excel2007');\n\n        ob_end_clean();\n\n        header('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');\n        header('Content-Disposition: attachment;filename=&quot;myfile.xlsx&quot;');\n        header('Cache-Control: max-age=0');\n\n        $objWriter-&gt;save('php://output');\n        $objPHPExcel-&gt;disconnectWorksheets();\n        unset($objPHPExcel);\n        }</code></pre>\n\nIs there any solution? Thanks alot!<br />\n",
    "PostedDate": "2014-08-14T21:13:20.823-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]