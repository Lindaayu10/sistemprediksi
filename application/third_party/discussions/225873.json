[
  {
    "Id": "488520",
    "ThreadId": "225873",
    "Html": "<p>Trying to write a spreadsheet that will have 28,000 rows or more.&nbsp; Getting an out of memory error.&nbsp; The &quot;largescale&quot; test works just fine and dumps more rows than that, so I don't know what the issue is.&nbsp; Can anyone see what below would cause this to crash?&nbsp; I am simply looping through SQL results and writing out the data.</p>\r\n<p>\r\n<div style=\"color:black;background-color:white\">\r\n<pre>$rownum = 1;\r\n$cummulative_donors = 0;\r\n\r\n$objPHPExcel = <span style=\"color:blue\">new</span> PHPExcel();\r\n$objPHPExcel-&gt;setActiveSheetIndex(0);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#a31515\">&quot;A$rownum&quot;</span>, <span style=\"color:#a31515\">'Zip Code'</span>);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#a31515\">&quot;B$rownum&quot;</span>, <span style=\"color:#a31515\">'State'</span>);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#a31515\">&quot;C$rownum&quot;</span>, <span style=\"color:#a31515\">'City'</span>);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#a31515\">&quot;D$rownum&quot;</span>, <span style=\"color:#a31515\">'Donors'</span>);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#a31515\">&quot;E$rownum&quot;</span>, <span style=\"color:#a31515\">'Residents'</span>);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#a31515\">&quot;F$rownum&quot;</span>, <span style=\"color:#a31515\">'Donations'</span>);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#a31515\">&quot;G$rownum&quot;</span>, <span style=\"color:#a31515\">'Total Revenue'</span>);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#a31515\">&quot;H$rownum&quot;</span>, <span style=\"color:#a31515\">'Predicted Donors'</span>);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#a31515\">&quot;I$rownum&quot;</span>, <span style=\"color:#a31515\">'Donors less Predicted'</span>);\r\n\r\n$this-&gt;positionFirst();\r\n\r\n<span style=\"color:blue\">while</span> ($row = $this-&gt;nextResult()){\r\n    $rownum += 1;\r\n    $newdata = $row;\r\n\r\n    $act_pred_diff = $newdata[<span style=\"color:#a31515\">'DONORS'</span>] - $newdata[<span style=\"color:#a31515\">'PROJDONOR'</span>];\r\n\r\n    $cummulative_donors += $newdata[<span style=\"color:#a31515\">'DONORS'</span>];\r\n\r\n    $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#a31515\">&quot;A$rownum&quot;</span>, $newdata[<span style=\"color:#a31515\">'ZIPCOD'</span>]);\r\n    $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#a31515\">&quot;B$rownum&quot;</span>, $newdata[<span style=\"color:#a31515\">'STATE'</span>]);\r\n    $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#a31515\">&quot;C$rownum&quot;</span>, $newdata[<span style=\"color:#a31515\">'CITY'</span>]);\r\n    $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#a31515\">&quot;D$rownum&quot;</span>, $newdata[<span style=\"color:#a31515\">'DONORS'</span>]);\r\n    $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#a31515\">&quot;E$rownum&quot;</span>, $newdata[<span style=\"color:#a31515\">'RESID'</span>]);\r\n    $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#a31515\">&quot;F$rownum&quot;</span>, $newdata[<span style=\"color:#a31515\">'DONATIONS'</span>]);\r\n    $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#a31515\">&quot;G$rownum&quot;</span>, $newdata[<span style=\"color:#a31515\">'AMOUNT'</span>]);\r\n    $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#a31515\">&quot;H$rownum&quot;</span>, $newdata[<span style=\"color:#a31515\">'AVERAGE'</span>]);\r\n    $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#a31515\">&quot;I$rownum&quot;</span>, $newdata[<span style=\"color:#a31515\">'PROJDONOR'</span>]);\r\n    $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#a31515\">&quot;J$rownum&quot;</span>, $act_pred_diff);\r\n    $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#a31515\">&quot;K$rownum&quot;</span>, $cummulative_donors);\r\n}\r\n\r\n$this-&gt;output(<span style=\"color:#a31515\">&quot;Writing to spreadsheet...&quot;</span>);\r\n$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, <span style=\"color:#a31515\">'Excel2007'</span>);\r\n$objWriter-&gt;save(str_replace(<span style=\"color:#a31515\">'.php'</span>, <span style=\"color:#a31515\">'.xlsx'</span>, <span style=\"color:blue\">__FILE__</span>));\r\n$this-&gt;output(<span style=\"color:#a31515\">&quot;Complete!&quot;</span>);\r\n</pre>\r\n</div>\r\n</p>",
    "PostedDate": "2010-09-02T14:44:23.443-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "488526",
    "ThreadId": "225873",
    "Html": "<p>I've written on this several times before:</p>\r\n<p>28,000 rows and 11 columns = 308,000 cells,&nbsp; with an average memory requirement of 1k/cell (dependent on string content), and double that figure when writing,&nbsp;plus a code footprint of 10MB-25MB, gives a memory requirement of 308MB * 2 +&nbsp;25 = 641MB.</p>\r\n<p>The 06largescale.php test has 5 columns/row: I don't know what you've increased it to, but the distributed version is 5,000 rows, giving 25,000 cells.... 25MB * 2 + 25 = 75MB.</p>\r\n<p>Try using cell caching, or increasing your memory, or both.</p>",
    "PostedDate": "2010-09-02T15:08:25.297-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]