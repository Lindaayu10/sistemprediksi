[
  {
    "Id": "1462700",
    "ThreadId": "651132",
    "Html": "Environment:\r<br />\nWindows 7\r<br />\nXAMPP 5.6.14\r<br />\nPhp 5.6.14\r<br />\nApache 2.4.17\r<br />\nphpExcel 1.8.0\r<br />\nmPDF 6.0\r<br />\nCodeigniter 3.0.3\r<br />\n<br />\nI can successfully read an excel spreadsheet, update some cells and save it to the server. However, creating a pdf appears to work, but when trying to open it I get ‘Failed to load pdf’\r<br />\nError ;\r<br />\n 'Adobe Reader could not open 'test.pdf' because it is either not a supported file type or because the file has been damaged'.\r<br />\n<br />\nI can create a new spreadsheet and the created pdf file can be opened.\r<br />\nThe problem appears to occur when reading an exist .xlsx file.\r<br />\n<br />\nWorking code:<br />\n<pre><code>          error_reporting(E_ALL);\n          date_default_timezone_set('Europe/London');\n    $curdir = $this-&gt;config-&gt;_config_paths[0];\n    require_once($curdir . 'third_party/Classes/PHPExcel/Settings.php');\n    $rendererLibrary = 'mpdf';\n    $rendererName = PHPExcel_Settings::PDF_RENDERER_MPDF;\n    $rendererLibraryPath = $curdir . 'third_party/mpdf';\n    if (!PHPExcel_Settings::setPdfRenderer(\n        $rendererName,\n        $rendererLibraryPath\n    ));\n           $objPHPExcel = new PHPExcel();\n           $objPHPExcel-&gt;getProperties()-&gt;setCreator(&quot;Maarten Balliauw&quot;)\n                         -&gt;setLastModifiedBy(&quot;Maarten Balliauw&quot;)\n                         -&gt;setTitle(&quot;PDF Test Document&quot;)\n                         -&gt;setSubject(&quot;PDF Test Document&quot;)\n                         -&gt;setDescription(&quot;Test document for PDF, generated using PHP classes.&quot;)\n                         -&gt;setKeywords(&quot;pdf php&quot;)\n                         -&gt;setCategory(&quot;Test result file&quot;);\n                   $objPHPExcel-&gt;setActiveSheetIndex(0)\n                                 -&gt;setCellValue('A1', 'Hello')\n                              -&gt;setCellValue('B2', 'world!')\n                         -&gt;setCellValue('C1', 'Hello')\n                           -&gt;setCellValue('D2', 'world!');\n\n                    $objPHPExcel-&gt;getActiveSheet()-&gt;setTitle('Simple');\n                 // Set active sheet index to the first sheet, so Excel opens this as the first sheet\n                   $objPHPExcel-&gt;setActiveSheetIndex(0);\n                  // Redirect output to a client’s web browser (Excel2007)\n                  header('Content-Type: application/pdf');\n                   header('Content-Disposition: attachment;filename=&quot;01simple.pdf&quot;');\n                 header('Cache-Control: max-age=0');\n                 $objWriter = \\PHPExcel_IOFactory::createWriter($objPHPExcel, 'PDF');\n                   $objWriter-&gt;save('php://output');\n</code></pre>\n\nNot working:<br />\n<pre><code>    $curdir = $this-&gt;config-&gt;_config_paths[0];\n    require_once($curdir . 'third_party/Classes/PHPExcel/Settings.php');\n    $rendererLibrary = 'mpdf';\n    $rendererName = PHPExcel_Settings::PDF_RENDERER_MPDF;\n    $rendererLibraryPath = $curdir . 'third_party/mpdf';\n    if (!PHPExcel_Settings::setPdfRenderer(\n        $rendererName,\n        $rendererLibraryPath\n    ));\n    $file = './assets/files/test2.xlsx';\n    //read file from path\n    $objPHPExcel = new PHPExcel();\n    $objPHPExcel = PHPExcel_IOFactory::load($file);\n    //get only the Cell Collection\n    $objPHPExcel-&gt;setActiveSheetIndex(0);\n    $cell_collection = $objPHPExcel-&gt;getActiveSheet()-&gt;getCellCollection();\n    $objPHPExcel-&gt;setActiveSheetIndex(0)\n                -&gt;setCellValue('A1', 'Hello')\n                -&gt;setCellValue('B2', 'world!')\n                -&gt;setCellValue('C1', 'Hello')\n                -&gt;setCellValue('D2', 'world!');\n    $objPHPExcel-&gt;setActiveSheetIndex(0);\n    // Redirect output to a client’s web browser (Excel2007)\n    header('Content-Type: application/pdf');\n    header('Content-Disposition: attachment;filename=&quot;01simple.pdf&quot;');\n    header('Cache-Control: max-age=0');\n    $objWriter = \\PHPExcel_IOFactory::createWriter($objPHPExcel, 'PDF');\n    $objWriter-&gt;save('php://output');\n\n</code></pre>\n\nUsing the following 2 lines will create the file on the server<br />\n<pre><code>$writer = \\PHPExcel_IOFactory::createWriter($myExcel, 'Excel2007');\n$writer-&gt;save(str_replace(__FILE__, 'assets/files/output.xlsx', __FILE__));\n</code></pre>\n\n",
    "PostedDate": "2016-02-10T07:21:39.543-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1462710",
    "ThreadId": "651132",
    "Html": "The problem was related to formatting in the original excel spreadsheet. I will need to  investigate further to address my formatting issues.<br />\n",
    "PostedDate": "2016-02-10T08:40:38.323-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": "2016-02-10T08:40:50.6-08:00"
  }
]