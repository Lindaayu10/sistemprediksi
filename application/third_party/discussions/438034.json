[
  {
    "Id": "1021244",
    "ThreadId": "438034",
    "Html": "Hi,<br />\n<br />\nI have a problem with saving an excel file on the server<br />\n<br />\nI try to modify the 01simple.php example :<br />\n<pre><code>&lt;?php\n/**\n * PHPExcel\n *\n * Copyright (C) 2006 - 2011 PHPExcel\n *\n * This library is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 2.1 of the License, or (at your option) any later version.\n *\n * This library is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public\n * License along with this library; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA\n *\n * @category   PHPExcel\n * @package    PHPExcel\n * @copyright  Copyright (c) 2006 - 2011 PHPExcel (http://www.codeplex.com/PHPExcel)\n * @license    http://www.gnu.org/licenses/old-licenses/lgpl-2.1.txt    LGPL\n * @version    ##VERSION##, ##DATE##\n */\n\n/** Error reporting */\nerror_reporting(E_ALL);\nini_set('display_errors', '1');\ndate_default_timezone_set('Europe/London');\n\n/** PHPExcel */\nrequire_once 'includes/outils/PHPExcel/Classes/PHPExcel.php';\n\n\n// Create new PHPExcel object\necho date('H:i:s') . &quot; Create new PHPExcel object\\n&quot;;\n$objPHPExcel = new PHPExcel();\n\n// Set properties\necho date('H:i:s') . &quot; Set properties\\n&quot;;\n$objPHPExcel-&gt;getProperties()-&gt;setCreator(&quot;Maarten Balliauw&quot;)\n                             -&gt;setLastModifiedBy(&quot;Maarten Balliauw&quot;)\n                             -&gt;setTitle(&quot;Office 2007 XLSX Test Document&quot;)\n                             -&gt;setSubject(&quot;Office 2007 XLSX Test Document&quot;)\n                             -&gt;setDescription(&quot;Test document for Office 2007 XLSX, generated using PHP classes.&quot;)\n                             -&gt;setKeywords(&quot;office 2007 openxml php&quot;)\n                             -&gt;setCategory(&quot;Test result file&quot;);\n\n\n// Add some data\necho date('H:i:s') . &quot; Add some data\\n&quot;;\n$objPHPExcel-&gt;setActiveSheetIndex(0)\n            -&gt;setCellValue('A1', 'Hello')\n            -&gt;setCellValue('B2', 'world!')\n            -&gt;setCellValue('C1', 'Hello')\n            -&gt;setCellValue('D2', 'world!');\n\n// Miscellaneous glyphs, UTF-8\n$objPHPExcel-&gt;setActiveSheetIndex(0)\n            -&gt;setCellValue('A4', 'Miscellaneous glyphs')\n            -&gt;setCellValue('A5', 'éàèùâêîôûëïüÿäöüç');\n\n// Rename sheet\necho date('H:i:s') . &quot; Rename sheet\\n&quot;;\n$objPHPExcel-&gt;getActiveSheet()-&gt;setTitle('Simple');\n\n\n// Set active sheet index to the first sheet, so Excel opens this as the first sheet\n$objPHPExcel-&gt;setActiveSheetIndex(0);\n\n\n// Save Excel 2007 file\necho date('H:i:s') . &quot; Write to Excel2007 format\\n&quot;;\n\n //!!!!!!!!!!!!!!!!!!!-------- I Change 'Excel2007' to 'Excel5' ------!!!!!!!!!!!!!!!!!!!!!!!!\n$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, 'Excel5');\n //!!!!!!!!!!!!!!!!!!!-------- I Change '.xlsx' to '.xls'              ------!!!!!!!!!!!!!!!!!!!!!!!!\n$objWriter-&gt;save(str_replace('.php', '.xls', __FILE__));\n\n\n// Echo memory peak usage\necho date('H:i:s') . &quot; Peak memory usage: &quot; . (memory_get_peak_usage(true) / 1024 / 1024) . &quot; MB\\r\\n&quot;;\n\n// Echo done\necho date('H:i:s') . &quot; Done writing file.\\r\\n&quot;;</code></pre>\n\nbut the created file is empty....<br />\n<br />\non my brower the result is :<br />\n<img src=\"http://img15.hostingpics.net/pics/233777Capture.png\" alt=\"Image\" /><br />\n<br />\nThe file was created :<br />\n<img src=\"http://img15.hostingpics.net/pics/630614capture2.png\" alt=\"Image\" /><br />\n<br />\nhave you an idea to resolve my problem ? <br />\n<br />\nThanks you in advance :)<br />\n",
    "PostedDate": "2013-03-26T07:25:19.467-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1021622",
    "ThreadId": "438034",
    "Html": "(I see the word 'Image' but not the images themselves)\r<br />\nThe unmodified example work? No error messages (in a logfile if nothing appears on the screen)?<br />\n",
    "PostedDate": "2013-03-27T01:53:09.673-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1021629",
    "ThreadId": "438034",
    "Html": "thx for your answer :)<br />\n<br />\n<strong>LWol wrote:</strong><br />\n<blockquote>\n(I see the word 'Image' but not the images themselves)<br />\n</blockquote>\nIn the first Image the result is :<br />\n<pre><code>08:47:34 Create new PHPExcel object 08:47:34 Set properties 08:47:34 Add some data 08:47:34 Rename sheet 08:47:34 Write to Excel2007 format ÐÏ\u0011à¡±\u001aá;\u0003þÿ \u0006\u0001\u000b\u0010þÿÿÿþÿÿÿ\fÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿ \b\u0010\u0006\u0005» Ì\u0007Ñ\u0001\u0006\u0004B\u0002°\u0004=\u0012Œ%r\u00158\u0001X\u0002&quot;\u00021\u001eÜ\b\u0001\u0007\u0001Calibrià\u0014õÿ À \u0004à\u0014õÿ À \u0004à\u0014õÿ À \u0004à\u0014õÿ À \u0004à\u0014õÿ À \u0004à\u0014õÿ À \u0004à\u0014õÿ À \u0004à\u0014õÿ À \u0004à\u0014õÿ À \u0004à\u0014õÿ À \u0004à\u0014õÿ À \u0004à\u0014õÿ À \u0004à\u0014õÿ À \u0004à\u0014õÿ À \u0004à\u0014õÿ À \u0004à\u0014\u0001 À \u0004“\u0002\u0004€ÿ’â8ÿÿÿÿÿÿÿÿÿÿÿÿ€€€€€€€€€ÀÀÀ€€€™™ÿ™3fÿÿÌÌÿÿffÿ€€fÌÌÌÿ€ÿÿÿÿÿÿ€€€€€ÿÌÿÌÿÿÌÿÌÿÿ™™Ìÿÿ™ÌÌ™ÿÿÌ™3fÿ3ÌÌ™ÌÿÌÿ™ÿfff™–––3f3™f333™3™3f33™333…\u0014U\u0003\u0006\u0001SimpleÁ\u0001\bÁ\u0001gæ\u0001®\u0001\u0004\u0001\u0001\u0004\u0017\b\u0001üO\u0005\u0003\u0005\u0001Hello\u0006\u0001world!\u0014\u0001Miscellaneous glyphs \b\u0010\u0006\u0010» Ì\u0007Ñ\u0001\u0006\u0004*\u0002+\u0002‚\u0002\u0001€\b\u0002Á\u0004\u0014\u0003\u0001\u0015\u0003\u0001ƒ\u0002„\u0002&amp;\bffffffæ?'\bffffffæ?(\bè?)\bè?¡&quot;\u0001d\u0001\u0001\u0001\u0002X\u0002X\u0002333333Ó?333333Ó?\u0001U\u0002\b}\f$ \u000f}\f\u0001\u0001$ \u000f}\f\u0002\u0002$ \u000f}\f\u0003\u0003$ \u000f}\f\u0004\u0004$ \u000f}\f\u0005\u0005$ \u000f}\f\u0006\u0006$ \u000f}\f\u0007\u0007$ \u000f}\f\b\b$ \u000f}\f $ \u000f}\f $ \u000f}\f\u000b\u000b$ \u000f}\f\f\f$ \u000f}\f $ \u000f}\f\u000e\u000e$ \u000f}\f\u000f\u000f$ \u000f}\f\u0010\u0010$ \u000f}\f\u0011\u0011$ \u000f}\f\u0012\u0012$ \u000f}\f\u0013\u0013$ \u000f}\f\u0014\u0014$ \u000f}\f\u0015\u0015$ \u000f}\f\u0016\u0016$ \u000f}\f\u0017\u0017$ \u000f}\f\u0018\u0018$ \u000f}\f\u0019\u0019$ \u000f}\f\u001a\u001a$ \u000f}\f\u001b\u001b$ \u000f}\f\u001c\u001c$ \u000f}\f\u001d\u001d$ \u000f}\f\u001e\u001e$ \u000f}\f\u001f\u001f$ \u000f}\f $ \u000f}\f!!$ \u000f}\f&quot;&quot;$ \u000f}\f##$ \u000f}\f$$$ \u000f}\f%%$ \u000f}\f&amp;&amp;$ \u000f}\f''$ \u000f}\f(($ \u000f}\f))$ \u000f}\f**$ \u000f}\f++$ \u000f}\f,,$ \u000f}\f--$ \u000f}\f..$ \u000f}\f//$ \u000f}\f00$ \u000f}\f11$ \u000f}\f22$ \u000f}\f33$ \u000f}\f44$ \u000f}\f55$ \u000f}\f66$ \u000f}\f77$ \u000f}\f88$ \u000f}\f99$ \u000f}\f::$ \u000f}\f;;$ \u000f}\f&lt;&lt;$ \u000f}\f==$ \u000f}\f&gt;&gt;$ \u000f}\f??$ \u000f}\f@@$ \u000f}\fAA$ \u000f}\fBB$ \u000f}\fCC$ \u000f}\fDD$ \u000f}\fEE$ \u000f}\fFF$ \u000f}\fGG$ \u000f}\fHH$ \u000f}\fII$ \u000f}\fJJ$ \u000f}\fKK$ \u000f}\fLL$ \u000f}\fMM$ \u000f}\fNN$ \u000f}\fOO$ \u000f}\fPP$ \u000f}\fQQ$ \u000f}\fRR$ \u000f}\fSS$ \u000f}\fTT$ \u000f}\fUU$ \u000f}\fVV$ \u000f}\fWW$ \u000f}\fXX$ \u000f}\fYY$ \u000f}\fZZ$ \u000f}\f[[$ \u000f}\f\\\\$ \u000f}\f]]$ \u000f}\f^^$ \u000f}\f__$ \u000f}\f``$ \u000f}\faa$ \u000f}\fbb$ \u000f}\fcc$ \u000f}\fdd$ \u000f}\fee$ \u000f}\fff$ \u000f}\fgg$ \u000f}\fhh$ \u000f}\fii$ \u000f}\fjj$ \u000f}\fkk$ \u000f}\fll$ \u000f}\fmm$ \u000f}\fnn$ \u000f}\foo$ \u000f}\fpp$ \u000f}\fqq$ \u000f}\frr$ \u000f}\fss$ \u000f}\ftt$ \u000f}\fuu$ \u000f}\fvv$ \u000f}\fww$ \u000f}\fxx$ \u000f}\fyy$ \u000f}\fzz$ \u000f}\f{{$ \u000f}\f||$ \u000f}\f}}$ \u000f}\f~~$ \u000f}\f$ \u000f}\f€€$ \u000f}\f$ \u000f}\f‚‚$ \u000f}\fƒƒ$ \u000f}\f„„$ \u000f}\f……$ \u000f}\f††$ \u000f}\f‡‡$ \u000f}\fˆˆ$ \u000f}\f‰‰$ \u000f}\fŠŠ$ \u000f}\f‹‹$ \u000f}\fŒŒ$ \u000f}\f$ \u000f}\fŽŽ$ \u000f}\f$ \u000f}\f$ \u000f}\f‘‘$ \u000f}\f’’$ \u000f}\f““$ \u000f}\f””$ \u000f}\f••$ \u000f}\f––$ \u000f}\f——$ \u000f}\f˜˜$ \u000f}\f™™$ \u000f}\fšš$ \u000f}\f››$ \u000f}\fœœ$ \u000f}\f$ \u000f}\fžž$ \u000f}\fŸŸ$ \u000f}\f  $ \u000f}\f¡¡$ \u000f}\f¢¢$ \u000f}\f££$ \u000f}\f€€$ \u000f}\f¥¥$ \u000f}\fŠŠ$ \u000f}\f§§$ \u000f}\fšš$ \u000f}\f©©$ \u000f}\fªª$ \u000f}\f««$ \u000f}\f¬¬$ \u000f}\f­­$ \u000f}\f®®$ \u000f}\f¯¯$ \u000f}\f°°$ \u000f}\f±±$ \u000f}\f²²$ \u000f}\f³³$ \u000f}\fŽŽ$ \u000f}\fµµ$ \u000f}\f¶¶$ \u000f}\f··$ \u000f}\fžž$ \u000f}\f¹¹$ \u000f}\fºº$ \u000f}\f»»$ \u000f}\fŒŒ$ \u000f}\fœœ$ \u000f}\fŸŸ$ \u000f}\f¿¿$ \u000f}\fÀÀ$ \u000f}\fÁÁ$ \u000f}\fÂÂ$ \u000f}\fÃÃ$ \u000f}\fÄÄ$ \u000f}\fÅÅ$ \u000f}\fÆÆ$ \u000f}\fÇÇ$ \u000f}\fÈÈ$ \u000f}\fÉÉ$ \u000f}\fÊÊ$ \u000f}\fËË$ \u000f}\fÌÌ$ \u000f}\fÍÍ$ \u000f}\fÎÎ$ \u000f}\fÏÏ$ \u000f}\fÐÐ$ \u000f}\fÑÑ$ \u000f}\fÒÒ$ \u000f}\fÓÓ$ \u000f}\fÔÔ$ \u000f}\fÕÕ$ \u000f}\fÖÖ$ \u000f}\f××$ \u000f}\fØØ$ \u000f}\fÙÙ$ \u000f}\fÚÚ$ \u000f}\fÛÛ$ \u000f}\fÜÜ$ \u000f}\fÝÝ$ \u000f}\fÞÞ$ \u000f}\fßß$ \u000f}\fàà$ \u000f}\fáá$ \u000f}\fââ$ \u000f}\fãã$ \u000f}\fää$ \u000f}\fåå$ \u000f}\fææ$ \u000f}\fçç$ \u000f}\fèè$ \u000f}\féé$ \u000f}\fêê$ \u000f}\fëë$ \u000f}\fìì$ \u000f}\fíí$ \u000f}\fîî$ \u000f}\fïï$ \u000f}\fðð$ \u000f}\fññ$ \u000f}\fòò$ \u000f}\fóó$ \u000f}\fôô$ \u000f}\fõõ$ \u000f}\föö$ \u000f}\f÷÷$ \u000f}\føø$ \u000f}\fùù$ \u000f}\fúú$ \u000f}\fûû$ \u000f}\füü$ \u000f}\fýý$ \u000f}\fþþ$ \u000f}\fÿÿ$ \u000f\u0002\u000e\u0006\u0004ý \u000fý \u0002\u000fý \u0001\u0001\u000f\u0001ý \u0001\u0003\u000f\u0001ý \u0003\u000f\u0002\u0001\u0002\u0006\u0004\u000f&gt;\u0002\u0012¶\u0006@\u001d\u000f\u0003\u0001g\b\u0017g\b\u0002\u0001ÿÿÿÿÿ Root Entry\u0016\u0005ÿÿÿÿÿÿÿÿ\u0001 \u0002ÀF€m&quot;ºÇ*Î\u0001€m&quot;ºÇ*Î\u0001Workbook\u0012\u0002ÿÿÿÿÿÿÿÿÿÿÿÿ \u0002ÀF­\u0014\u0001\u0002\u0003\u0004\u0005\u0006\u0007\b þÿÿÿþÿÿÿýÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿ08:47:35 Peak memory usage: 9 MB 08:47:35 Done writing file. </code></pre>\n\n<strong>LWol wrote:</strong><br />\n<blockquote>\nThe unmodified example work? No error messages (in a logfile if nothing appears on the screen)?<br />\n</blockquote>\nNo because there is a problem with Excel 2007 (library or whatever) but i think with 'Excel5' it does it works easy normaly (a lot of example on the internet with 'Excel5') but not with me -_-'<br />\n<br />\n<br />\nedit : the second image is just the result in Excel (error message at the opening file), and next the file is empty (0 ko...) <br />\n",
    "PostedDate": "2013-03-27T02:01:50.983-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1021861",
    "ThreadId": "438034",
    "Html": "You have it on the screen (browser) using exactly the example?\r<br />\nYour Excel file is not in a file, but on the screen!\r<br />\nCan you test by giving to the save method, a simple filename (test.xls) with an absolute path for which you can be sure that php has the right to write?\r<br />\nSubsidiary question, your version of php?<br />\n",
    "PostedDate": "2013-03-27T09:21:45.02-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1021893",
    "ThreadId": "438034",
    "Html": "<strong>LWol wrote:</strong><br />\n<blockquote>\nYou have it on the screen (browser) using exactly the example?<br />\n</blockquote>\nYes<br />\n<br />\n<strong>LWol wrote:</strong><br />\n<blockquote>\nYour Excel file is not in a file, but on the screen!<br />\n</blockquote>\nYes, this is my problem, the excel file appear as an echo on PHP and it's not wrote on the .xls<br />\n<br />\n<strong>LWol wrote:</strong><br />\n<blockquote>\nCan you test by giving to the save method, a simple filename (test.xls) with an absolute path for which you can be sure that php has the right to write?<br />\n</blockquote>\nsame result :/<br />\nI test with :<br />\n$objWriter-&gt;save('ddddd/toto.xls');<br />\n<br />\ntoto.xls is empty and i have the Excel file on my browser<br />\n<br />\n<strong>LWol wrote:</strong><br />\n<blockquote>\nSubsidiary question, your version of php?<br />\n</blockquote>\n5.2.9-1<br />\n",
    "PostedDate": "2013-03-27T10:00:51.743-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1022271",
    "ThreadId": "438034",
    "Html": "I found a temporary solution :<br />\n<pre><code>$objWriter = PHPExcel_IOFactory::createWriter($this, 'Excel5');\n$objWriter-&gt;save($tmpFilename);\nchmod($tmpFilename, 0777);\n$excelOutput = ob_get_clean();\n$fp = fopen($tmpFilename, 'w');\nfwrite($fp, $excelOutput);\nfclose($fp);        </code></pre>\n\nI wrote manually in the file.... :/<br />\n",
    "PostedDate": "2013-03-28T01:59:39.203-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]