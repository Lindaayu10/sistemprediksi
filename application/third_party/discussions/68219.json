[
  {
    "Id": "232021",
    "ThreadId": "68219",
    "Html": "<p>How to save file from mySQL? I got error message when dowload and save file as</p>\r\n<p><span style=\"color:#ff0000\">The converter failed to save the file</span></p>\r\n<p><span style=\"color:#000000\"><strong>Code</strong></span></p>\r\n<p>&lt;?php</p>\r\n<p>// database connection ...</p>\r\n<p>// 01simple.php -- Send output to client browser instead of saving to diskerror_reporting(E_ALL);<br>ini_set('display_errors', '1');<br>/** PHPExcel */<br>require_once '../phpexcel1.7.0/Classes/PHPExcel.php';</p>\r\n<p>/** PHPExcel_IOFactory */<br>require_once '../phpexcel1.7.0/Classes/PHPExcel/IOFactory.php';<br>/** PHPExcel_richText.php */<br>//require_once '../phpexcel1.7.0/Classes/PHPExcel/RichText.php';<br>// Create new PHPExcel object<br>$objPHPExcel = new PHPExcel();</p>\r\n<p>// Set properties<br>$objPHPExcel-&gt;getProperties()-&gt;setCreator(&quot;Maarten Balliauw&quot;)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -&gt;setLastModifiedBy(&quot;Maarten Balliauw&quot;)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -&gt;setTitle(&quot;Office 2007 XLSX Test Document&quot;)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -&gt;setSubject(&quot;Office 2007 XLSX Test Document&quot;)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -&gt;setDescription(&quot;Test document for Office 2007 XLSX, generated using PHP classes.&quot;)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -&gt;setKeywords(&quot;office 2007 openxml php&quot;)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -&gt;setCategory(&quot;Test result file&quot;);<br><span style=\"color:#ff0000\">// Add data for export sample from 01 that OK to save file<br></span>/*<br>$objPHPExcel-&gt;setActiveSheetIndex(0)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -&gt;setCellValue('A1', 'Hello')<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -&gt;setCellValue('B2', 'world!')<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -&gt;setCellValue('C1', 'Hello2')<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -&gt;setCellValue('D2', 'world2!');<br>*/</p>\r\n<p><span style=\"color:#ff0000\">//&nbsp;Add data for export sample from MySQL that failed to save the file</span></p>\r\n<p>$query = $db-&gt;query(&quot;select * from category where reID=0 order by ID&quot;);&nbsp; // <br>&nbsp;&nbsp;&nbsp; $i=1;<br>&nbsp;&nbsp;&nbsp; while($row = $db-&gt;fetch_array($query)){ //category&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp; $objPHPExcel-&gt;setActiveSheetIndex(0)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -&gt;setCellValue('ID'.$i, $row[ID])<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -&gt;setCellValue('type'.$i, $row[type])<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -&gt;setCellValue('title'.$i, $row[title])<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -&gt;setCellValue('regDate'.$i, $row[regDate]);&nbsp;&nbsp; <br>&nbsp;&nbsp;&nbsp;&nbsp; $i++;&nbsp; <br>&nbsp;}</p>\r\n<p>// Rename sheet<br>$objPHPExcel-&gt;getActiveSheet()-&gt;setTitle('Simple');</p>\r\n<p>// Set active sheet index to the first sheet, so Excel opens this as the first sheet<br>$objPHPExcel-&gt;setActiveSheetIndex(0);</p>\r\n<p>// Save Excel 2007 file<br>header('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');<br>header('Content-Disposition: attachment;filename=&quot;mysql_export.xlsx&quot;');<br>header('Cache-Control: max-age=0');</p>\r\n<p>$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, 'Excel2007');<br>$objWriter-&gt;save('php://output');<br>exit;</p>\r\n<p>?&gt;</p>",
    "PostedDate": "2009-09-07T19:49:18.48-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "232024",
    "ThreadId": "68219",
    "Html": "<p>This looks like an error:<br> <br>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre>-&gt;setCellValue(<span style=\"color:#A31515\">'ID'</span>.$i, $row[ID])\r\n-&gt;setCellValue(<span style=\"color:#A31515\">'type'</span>.$i, $row[type])\r\n-&gt;setCellValue(<span style=\"color:#A31515\">'title'</span>.$i, $row[title])\r\n-&gt;setCellValue(<span style=\"color:#A31515\">'regDate'</span>.$i, $row[regDate]);  \r\n\r\n</pre>\r\n</div>\r\n<br> Should it not be this?<br> <br>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre>-&gt;setCellValue(<span style=\"color:#A31515\">'A'</span>.$i, $row[ID])\r\n-&gt;setCellValue(<span style=\"color:#A31515\">'B'</span>.$i, $row[type])\r\n-&gt;setCellValue(<span style=\"color:#A31515\">'C'</span>.$i, $row[title])\r\n-&gt;setCellValue(<span style=\"color:#A31515\">'D'</span>.$i, $row[regDate]);   \r\n</pre>\r\n</div>\r\n</p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2009-09-07T20:05:54.15-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "232066",
    "ThreadId": "68219",
    "Html": "<p>And just for luck, associative indexes should be quoted:</p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre>-&gt;setCellValue(<span style=\"color:#A31515\">'A'</span>.$i, $row[<span style=\"color:#A31515\">'ID'</span>])\r\n-&gt;setCellValue(<span style=\"color:#A31515\">'B'</span>.$i, $row[<span style=\"color:#A31515\">'type'</span>])\r\n-&gt;setCellValue(<span style=\"color:#A31515\">'C'</span>.$i, $row[<span style=\"color:#A31515\">'title'</span>])\r\n-&gt;setCellValue(<span style=\"color:#A31515\">'D'</span>.$i, $row[<span style=\"color:#A31515\">'regDate'</span>]); \r\n</pre>\r\n</div>",
    "PostedDate": "2009-09-08T00:28:34.5-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "232463",
    "ThreadId": "68219",
    "Html": "<div>Thanks lots koyama & MarkBaker,</div>\r\n<div> </div>\r\n<div>------------- Now all work<br>$objPHPExcel-&gt;setActiveSheetIndex(0) //title<br>            -&gt;setCellValue('A1', 'ID')<br>            -&gt;setCellValue('B1', 'type')<br>            -&gt;setCellValue('C1', 'title')<br>\r\n            -&gt;setCellValue('D1', 'regDate');<br>   <br>$query = $db-&gt;query(&quot;select * from category where reID=0 order by ID&quot;);  //data<br>    $i=2;<br>    while($row = $db-&gt;fetch_array($query)){ //category <br>\r\n     $objPHPExcel-&gt;setActiveSheetIndex(0)<br>            -&gt;setCellValue('A'.$i, $row[ID])<br>            -&gt;setCellValue('B'.$i, $row[type])<br>            -&gt;setCellValue('C'.$i, $row[title])<br>\r\n            -&gt;setCellValue('D'.$i, $row[regDate]);   <br>     $i++;  <br> }<br></div>\r\n<div>On Tue, Sep 8, 2009 at 5:28 PM, MarkBaker <span dir=ltr>&lt;<a href=\"mailto:notifications@codeplex.com\">notifications@codeplex.com</a>&gt;</span> wrote:<br>\r\n<blockquote style=\"border-left:#ccc 1px solid;margin:0px 0px 0px 0.8ex;padding-left:1ex\">\r\n<div>\r\n<p>From: MarkBaker</p>\r\n<div>\r\n<p>And just for luck, associative indexes should be quoted:</p>\r\n<div>\r\n<div style=\"background-color:white;color:black\"><pre>-&gt;setCellValue(<span style=\"color:#a31515\">'A'</span>.$i, $row[<span style=\"color:#a31515\">'ID'</span>])\r\n-&gt;setCellValue(<span style=\"color:#a31515\">'B'</span>.$i, $row[<span style=\"color:#a31515\">'type'</span>])\r\n-&gt;setCellValue(<span style=\"color:#a31515\">'C'</span>.$i, $row[<span style=\"color:#a31515\">'title'</span>])\r\n-&gt;setCellValue(<span style=\"color:#a31515\">'D'</span>.$i, $row[<span style=\"color:#a31515\">'regDate'</span>]); \r\n</pre></div></div></div>\r\n<div>\r\n<div>\r\n<p>Read the <a href=\"http://phpexcel.codeplex.com/Thread/View.aspx?ThreadId=68219&ANCHOR#Post232066\">full discussion online</a>.</p>\r\n<p>To add a post to this discussion, reply to this email (<a href=\"mailto:PHPExcel@discussions.codeplex.com?subject=[PHPExcel:68219]\">PHPExcel@discussions.codeplex.com</a>)</p>\r\n<p>To start a new discussion for this project, email <a href=\"mailto:PHPExcel@discussions.codeplex.com\">PHPExcel@discussions.codeplex.com</a></p>\r\n<p>You are receiving this email because you subscribed to this discussion on CodePlex. You can <a href=\"http://www.codeplex.com/site/discussions/thread/unsubscribe/68219\">unsubscribe</a> on codePlex.com.</p>\r\n\r\n<p>Please note: Images and attachments will be removed from emails. Any posts to this discussion will also be available online at <a href=\"http://codeplex.com/\">codeplex.com</a></p></div></div></div></blockquote>\r\n</div><br>",
    "PostedDate": "2009-09-08T18:41:38.833-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]