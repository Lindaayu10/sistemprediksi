[
  {
    "Id": "290462",
    "ThreadId": "85265",
    "Html": "<p>Hi</p>\r\n<p>I created a php file that exports data from mysql table and writes it into an excel file, it works grteat but I have a problem with the following characters:</p>\r\n<p>&auml;&ouml;&euml;&eacute;&egrave;</p>\r\n<p>My field I create is below:</p>\r\n<p>$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('G'.$xlsRow, $row_Recordset1['School']);</p>\r\n<p>The out put would be as follows:</p>\r\n<p>MySQL field data is (Ho&euml;rskool Rynfield), the once it has written the excel file it displays only (Ho)</p>\r\n<p>my colation is st to utf8_unicode_ci</p>\r\n<p>Any help would be appreciated</p>\r\n<p>&nbsp;</p>\r\n<p>Thanks</p>",
    "PostedDate": "2010-02-13T07:52:17.9-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "290524",
    "ThreadId": "85265",
    "Html": "<p>Ensure that you're using UTF-8 for the PHP MySQL Connection:</p>\r\n<p>In <span>php</span> versions 5.2 and later, use</p>\r\n<pre><span><div style=\"color:Black;background-color:White\"><pre>mysql_set_charset(<span style=\"color:#A31515\">'utf8'</span>,$conn); \r\n</pre>\r\n</div>\r\n</span></pre>",
    "PostedDate": "2010-02-13T13:49:43.02-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "290791",
    "ThreadId": "85265",
    "Html": "<p>Hello,</p>\r\n<p>I'm having a similar problem (see my post <a href=\"http://phpexcel.codeplex.com/Thread/View.aspx?ThreadId=83263\">http://phpexcel.codeplex.com/Thread/View.aspx?ThreadId=83263</a>)</p>\r\n<p>I'm reading in utf-8 xml and entering it into cells and getting the same result as you.</p>\r\n<p>&nbsp;</p>\r\n<p>If you find a solution I'd love to hear from you.</p>\r\n<p>&nbsp;</p>\r\n<p>Thanks</p>\r\n<p>&nbsp;</p>\r\n<p>Peter</p>",
    "PostedDate": "2010-02-15T03:56:54.34-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "290796",
    "ThreadId": "85265",
    "Html": "<p>Hi Mark</p>\r\n<p>The mysql_set_charset definitely solved my problem,</p>\r\n<p>Thanks</p>\r\n<p>&nbsp;</p>\r\n<p>See my full code below:</p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre>&lt;?php <span style=\"color:Blue\">require_once</span>(<span style=\"color:#A31515\">'../Connections/CMS.php'</span>); ?&gt;\r\n&lt;?php\r\n<span style=\"color:Blue\">if</span> (!function_exists(<span style=\"color:#A31515\">&quot;GetSQLValueString&quot;</span>)) {\r\n<span style=\"color:Blue\">function</span> GetSQLValueString($theValue, $theType, $theDefinedValue = <span style=\"color:#A31515\">&quot;&quot;</span>, $theNotDefinedValue = <span style=\"color:#A31515\">&quot;&quot;</span>) \r\n{\r\n  $theValue = get_magic_quotes_gpc() ? stripslashes($theValue) : $theValue;\r\n\r\n  $theValue = function_exists(<span style=\"color:#A31515\">&quot;mysql_real_escape_string&quot;</span>) ? mysql_real_escape_string($theValue) : mysql_escape_string($theValue);\r\n\r\n  <span style=\"color:Blue\">switch</span> ($theType) {\r\n    <span style=\"color:Blue\">case</span> <span style=\"color:#A31515\">&quot;text&quot;</span>:\r\n      $theValue = ($theValue != <span style=\"color:#A31515\">&quot;&quot;</span>) ? <span style=\"color:#A31515\">&quot;'&quot;</span> . $theValue . <span style=\"color:#A31515\">&quot;'&quot;</span> : <span style=\"color:#A31515\">&quot;NULL&quot;</span>;\r\n      <span style=\"color:Blue\">break</span>;    \r\n    <span style=\"color:Blue\">case</span> <span style=\"color:#A31515\">&quot;long&quot;</span>:\r\n    <span style=\"color:Blue\">case</span> <span style=\"color:#A31515\">&quot;int&quot;</span>:\r\n      $theValue = ($theValue != <span style=\"color:#A31515\">&quot;&quot;</span>) ? intval($theValue) : <span style=\"color:#A31515\">&quot;NULL&quot;</span>;\r\n      <span style=\"color:Blue\">break</span>;\r\n    <span style=\"color:Blue\">case</span> <span style=\"color:#A31515\">&quot;double&quot;</span>:\r\n      $theValue = ($theValue != <span style=\"color:#A31515\">&quot;&quot;</span>) ? <span style=\"color:#A31515\">&quot;'&quot;</span> . doubleval($theValue) . <span style=\"color:#A31515\">&quot;'&quot;</span> : <span style=\"color:#A31515\">&quot;NULL&quot;</span>;\r\n      <span style=\"color:Blue\">break</span>;\r\n    <span style=\"color:Blue\">case</span> <span style=\"color:#A31515\">&quot;date&quot;</span>:\r\n      $theValue = ($theValue != <span style=\"color:#A31515\">&quot;&quot;</span>) ? <span style=\"color:#A31515\">&quot;'&quot;</span> . $theValue . <span style=\"color:#A31515\">&quot;'&quot;</span> : <span style=\"color:#A31515\">&quot;NULL&quot;</span>;\r\n      <span style=\"color:Blue\">break</span>;\r\n    <span style=\"color:Blue\">case</span> <span style=\"color:#A31515\">&quot;defined&quot;</span>:\r\n      $theValue = ($theValue != <span style=\"color:#A31515\">&quot;&quot;</span>) ? $theDefinedValue : $theNotDefinedValue;\r\n      <span style=\"color:Blue\">break</span>;\r\n  }\r\n  <span style=\"color:Blue\">return</span> $theValue;\r\n}\r\n}\r\n\r\n$colname_Recordset1 = <span style=\"color:#A31515\">&quot;-1&quot;</span>;\r\n<span style=\"color:Blue\">if</span> (<span style=\"color:Blue\">isset</span>($_GET[<span style=\"color:#A31515\">'id'</span>])) {\r\n  $colname_Recordset1 = (get_magic_quotes_gpc()) ? $_GET[<span style=\"color:#A31515\">'id'</span>] : addslashes($_GET[<span style=\"color:#A31515\">'id'</span>]);\r\n}\r\n\r\n\r\nmysql_select_db($database_CMS, $CMS);\r\nmysql_set_charset(<span style=\"color:#A31515\">'utf8'</span>,$CMS); \r\n$query_Recordset1 = sprintf(&quot;SELECT a.intEvent <span style=\"color:Blue\">as</span> <span style=\"color:#A31515\">'eID'</span>, b.intRider <span style=\"color:Blue\">as</span> <span style=\"color:#A31515\">'rID'</span>, b.intHID <span style=\"color:Blue\">as</span> <span style=\"color:#A31515\">'hID'</span>,d.strRegion <span style=\"color:Blue\">as</span> Province,\r\ne.strRegion <span style=\"color:Blue\">as</span> Region, i.strSchool <span style=\"color:Blue\">as</span> <span style=\"color:#A31515\">'School'</span>, i.id <span style=\"color:Blue\">as</span> sID , h.strType <span style=\"color:Blue\">as</span> Discipline, b.strClass <span style=\"color:Blue\">as</span> Class,\r\nb.intLevel <span style=\"color:Blue\">as</span> Level ,CONCAT(f.strName,<span style=\"color:#A31515\">' '</span>,strLast) <span style=\"color:Blue\">as</span> Rider, g.strHorse <span style=\"color:Blue\">as</span> Horse, c.strSchool <span style=\"color:Blue\">as</span> <span style=\"color:#A31515\">'SchoolType'</span> ,\r\ni.id <span style=\"color:Blue\">as</span> sID , b.intType , b.intJType, b.intTest,b.intLevel, j.strType <span style=\"color:Blue\">as</span> JType, b.id <span style=\"color:Blue\">as</span> <span style=\"color:#A31515\">'EntryID'</span>,b.decFee1 <span style=\"color:Blue\">as</span> <span style=\"color:#A31515\">'Entry Fee'</span>, b.decFee2 <span style=\"color:Blue\">as</span> <span style=\"color:#A31515\">'Grading'</span>,\r\nb.decFee3 <span style=\"color:Blue\">as</span> <span style=\"color:#A31515\">'Stabling'</span>\r\nFROM ss_entry a left join ss_enterh b on b.intEvent = a.intEvent\r\nleft join ss_dates c on c.id = a.intEvent\r\nleft join ss_region d on c.intRegion = d.id\r\nleft join ss_subregion e on c.intSubR = e.id\r\nleft join ss_rider f on f.id = b.intRider\r\nleft join ss_horse g on g.id = b.intHID\r\nleft join ss_classtype h on h.id = b.intType\r\nleft join ss_schools i on i.id = f.intSchool\r\nleft join cr_jumpingtype j on j.id = b.intJType\r\nWHERE a.intEvent = %s GROUP BY b.id ORDER BY h.strType ASC, b.strClass ASC; <span style=\"color:#A31515\">&quot;, GetSQLValueString($colname_Recordset1, &quot;</span>int&quot;));\r\n$Recordset1 = mysql_query($query_Recordset1, $CMS) <span style=\"color:Blue\">or</span> <span style=\"color:Blue\">die</span>(mysql_error());\r\n$row_Recordset1 = mysql_fetch_assoc($Recordset1);\r\n$totalRows_Recordset1 = mysql_num_rows($Recordset1);\r\n\r\n\r\n$colname_Recordset2 = <span style=\"color:#A31515\">&quot;-1&quot;</span>;\r\n<span style=\"color:Blue\">if</span> (<span style=\"color:Blue\">isset</span>($_GET[<span style=\"color:#A31515\">'id'</span>])) {\r\n  $colname_Recordset2 = (get_magic_quotes_gpc()) ? $_GET[<span style=\"color:#A31515\">'id'</span>] : addslashes($_GET[<span style=\"color:#A31515\">'id'</span>]);\r\n}\r\nmysql_select_db($database_CMS, $CMS);\r\n$query_Recordset2 = sprintf(<span style=\"color:#A31515\">&quot;SELECT b.strRegion as Province, c.strRegion as Region FROM ss_dates a left join ss_region b on a.intRegion = b.id left join ss_subregion c on a.intSubR = c.id WHERE a.id = %s&quot;</span>, GetSQLValueString($colname_Recordset2, <span style=\"color:#A31515\">&quot;int&quot;</span>));\r\n$Recordset2 = mysql_query($query_Recordset2, $CMS) <span style=\"color:Blue\">or</span> <span style=\"color:Blue\">die</span>(mysql_error());\r\n$row_Recordset2 = mysql_fetch_assoc($Recordset2);\r\n$totalRows_Recordset2 = mysql_num_rows($Recordset2);\r\n\r\n$colname_dateID = <span style=\"color:#A31515\">&quot;-1&quot;</span>;\r\n<span style=\"color:Blue\">if</span> (<span style=\"color:Blue\">isset</span>($_GET[<span style=\"color:#A31515\">'id'</span>])) {\r\n  $colname_dateID = (get_magic_quotes_gpc()) ? $_GET[<span style=\"color:#A31515\">'id'</span>] : addslashes($_GET[<span style=\"color:#A31515\">'id'</span>]);\r\n}\r\nmysql_select_db($database_CMS, $CMS);\r\n$query_dateID = sprintf(<span style=\"color:#A31515\">&quot;SELECT * FROM ss_dates WHERE id = %s&quot;</span>, GetSQLValueString($colname_dateID, <span style=\"color:#A31515\">&quot;int&quot;</span>));\r\n$dateID = mysql_query($query_dateID, $CMS) <span style=\"color:Blue\">or</span> <span style=\"color:Blue\">die</span>(mysql_error());\r\n$row_dateID = mysql_fetch_assoc($dateID);\r\n$totalRows_dateID = mysql_num_rows($dateID);\r\n\r\n\r\n$vClass = $row_Recordset1[<span style=\"color:#A31515\">'Class'</span>];\r\n$vLevel = $row_Recordset1[<span style=\"color:#A31515\">'intLevel'</span>];\r\n$vQualifier = trim($row_dateID[<span style=\"color:#A31515\">'strQ'</span>]);\r\n$vRegion = trim($row_Recordset2[<span style=\"color:#A31515\">'Province'</span>]).<span style=\"color:#A31515\">&quot; &quot;</span>.trim($row_Recordset2[<span style=\"color:#A31515\">'Region'</span>]);\r\n$vSchoolType = $row_Recordset1[<span style=\"color:#A31515\">'School Type'</span>];\r\n<span style=\"color:Green\">//$vJumpType = $row_Recordset1['JType'];</span>\r\n\r\n\r\n\r\n<span style=\"color:Green\">/**\r\n * PHPExcel\r\n *\r\n * Copyright (C) 2006 - 2009 PHPExcel\r\n *\r\n * This library is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU Lesser General Public\r\n * License as published by the Free Software Foundation; either\r\n * version 2.1 of the License, or (at your option) any later version.\r\n * \r\n * This library is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\r\n * Lesser General Public License for more details.\r\n * \r\n * You should have received a copy of the GNU Lesser General Public\r\n * License along with this library; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA\r\n *\r\n * @category   PHPExcel\r\n * @package    PHPExcel\r\n * @copyright  Copyright (c) 2006 - 2009 PHPExcel (http://www.codeplex.com/PHPExcel)\r\n * @license    http://www.gnu.org/licenses/old-licenses/lgpl-2.1.txt\tLGPL\r\n * @version    1.7.1, 2009-11-02\r\n */</span>\r\n\r\n<span style=\"color:Green\">/** Error reporting */</span>\r\nerror_reporting(E_ALL);\r\n\r\n<span style=\"color:Green\">/** PHPExcel */</span>\r\n<span style=\"color:Blue\">require_once</span> <span style=\"color:#A31515\">'../Classes/PHPExcel.php'</span>;\r\n\r\n<span style=\"color:Blue\">require_once</span> <span style=\"color:#A31515\">'../Classes/PHPExcel/Cell/AdvancedValueBinder.php'</span>;\r\n\r\n<span style=\"color:Green\">/** PHPExcel_IOFactory */</span>\r\n<span style=\"color:Blue\">require_once</span> <span style=\"color:#A31515\">'../Classes/PHPExcel/IOFactory.php'</span>;\r\n\r\n<span style=\"color:Green\">/** PHPExcel_RichText */</span>\r\n<span style=\"color:Blue\">require_once</span> <span style=\"color:#A31515\">'../Classes/PHPExcel/RichText.php'</span>;\r\n\r\n\r\n<span style=\"color:Green\">// Create new PHPExcel object</span>\r\n$objPHPExcel = <span style=\"color:Blue\">new</span> PHPExcel();\r\n\r\n<span style=\"color:Green\">// Set properties</span>\r\n$objPHPExcel-&gt;getProperties()-&gt;setCreator(<span style=\"color:#A31515\">&quot;c-Roach designs&quot;</span>)\r\n\t\t\t\t\t\t\t -&gt;setLastModifiedBy(<span style=\"color:#A31515\">&quot;Roche De Kock&quot;</span>)\r\n\t\t\t\t\t\t\t -&gt;setTitle(<span style=\"color:#A31515\">&quot;SANEF Schools Export&quot;</span>)\r\n\t\t\t\t\t\t\t -&gt;setSubject(<span style=\"color:#A31515\">&quot;Running Order&quot;</span>)\r\n\t\t\t\t\t\t\t -&gt;setDescription(<span style=\"color:#A31515\">&quot;Running Order Export&quot;</span>)\r\n\t\t\t\t\t\t\t -&gt;setKeywords(<span style=\"color:#A31515\">&quot;office 2003 openxml php&quot;</span>)\r\n\t\t\t\t\t\t\t -&gt;setCategory(<span style=\"color:#A31515\">&quot;Results&quot;</span>);\r\n\r\n\r\n$styleThinBlackBorderOutline = <span style=\"color:Blue\">array</span>(\r\n\t<span style=\"color:#A31515\">'borders'</span> =&gt; <span style=\"color:Blue\">array</span>(\r\n\t\t<span style=\"color:#A31515\">'outline'</span> =&gt; <span style=\"color:Blue\">array</span>(\r\n\t\t\t<span style=\"color:#A31515\">'style'</span> =&gt; PHPExcel_Style_Border::BORDER_THIN,\r\n\t\t\t<span style=\"color:#A31515\">'color'</span> =&gt; <span style=\"color:Blue\">array</span>(<span style=\"color:#A31515\">'argb'</span> =&gt; <span style=\"color:#A31515\">'FF000000'</span>),\r\n\t\t),\r\n\t),\r\n);\r\n\r\n$styleThickBlackBorderOutline = <span style=\"color:Blue\">array</span>(\r\n\t<span style=\"color:#A31515\">'borders'</span> =&gt; <span style=\"color:Blue\">array</span>(\r\n\t\t<span style=\"color:#A31515\">'outline'</span> =&gt; <span style=\"color:Blue\">array</span>(\r\n\t\t\t<span style=\"color:#A31515\">'style'</span> =&gt; PHPExcel_Style_Border::BORDER_THICK,\r\n\t\t\t<span style=\"color:#A31515\">'color'</span> =&gt; <span style=\"color:Blue\">array</span>(<span style=\"color:#A31515\">'argb'</span> =&gt; <span style=\"color:#A31515\">'FF000000'</span>),\r\n\t\t),\r\n\t),\r\n);\r\n\r\n<span style=\"color:Green\">// Add some data</span>\r\n$objPHPExcel-&gt;setActiveSheetIndex(0);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#A31515\">'A1'</span>, <span style=\"color:#A31515\">'Running Order'</span>);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#A31515\">'B1'</span>, <span style=\"color:#A31515\">'Entry ID'</span>);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#A31515\">'C1'</span>, <span style=\"color:#A31515\">'Discipline'</span>);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#A31515\">'D1'</span>, <span style=\"color:#A31515\">'Class'</span>);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#A31515\">'E1'</span>, <span style=\"color:#A31515\">'Level'</span>);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#A31515\">'F1'</span>, <span style=\"color:#A31515\">'Rider ID'</span>);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#A31515\">'G1'</span>, <span style=\"color:#A31515\">'Rider'</span>);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#A31515\">'H1'</span>, <span style=\"color:#A31515\">'Horse ID'</span>);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#A31515\">'I1'</span>, <span style=\"color:#A31515\">'Horse'</span>);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#A31515\">'J1'</span>, <span style=\"color:#A31515\">'School ID'</span>);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#A31515\">'K1'</span>, <span style=\"color:#A31515\">'School'</span>);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#A31515\">'L1'</span>, <span style=\"color:#A31515\">'Entry Fee'</span>);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#A31515\">'M1'</span>, <span style=\"color:#A31515\">'Grading'</span>);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#A31515\">'N1'</span>, <span style=\"color:#A31515\">'Stabling'</span>);\r\n\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#A31515\">'A1'</span>)-&gt;getFont()-&gt;setBold(true);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#A31515\">'B1'</span>)-&gt;getFont()-&gt;setBold(true);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#A31515\">'C1'</span>)-&gt;getFont()-&gt;setBold(true);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#A31515\">'D1'</span>)-&gt;getFont()-&gt;setBold(true);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#A31515\">'E1'</span>)-&gt;getFont()-&gt;setBold(true);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#A31515\">'F1'</span>)-&gt;getFont()-&gt;setBold(true);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#A31515\">'G1'</span>)-&gt;getFont()-&gt;setBold(true);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#A31515\">'H1'</span>)-&gt;getFont()-&gt;setBold(true);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#A31515\">'I1'</span>)-&gt;getFont()-&gt;setBold(true);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#A31515\">'J1'</span>)-&gt;getFont()-&gt;setBold(true);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#A31515\">'K1'</span>)-&gt;getFont()-&gt;setBold(true);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#A31515\">'L1'</span>)-&gt;getFont()-&gt;setBold(true);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#A31515\">'M1'</span>)-&gt;getFont()-&gt;setBold(true);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#A31515\">'N1'</span>)-&gt;getFont()-&gt;setBold(true);\r\n\r\n$xlsRow = 2;\r\n$xlsNr = 1;\r\n\r\n<span style=\"color:Blue\">do</span> {\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#A31515\">'A'</span>.$xlsRow, $xlsNr);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#A31515\">'B'</span>.$xlsRow, $row_Recordset1[<span style=\"color:#A31515\">'EntryID'</span>]);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#A31515\">'C'</span>.$xlsRow, $row_Recordset1[<span style=\"color:#A31515\">'Discipline'</span>]);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#A31515\">'D'</span>.$xlsRow, $row_Recordset1[<span style=\"color:#A31515\">'Class'</span>]);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#A31515\">'E'</span>.$xlsRow, $row_Recordset1[<span style=\"color:#A31515\">'Level'</span>]);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#A31515\">'F'</span>.$xlsRow, $row_Recordset1[<span style=\"color:#A31515\">'rID'</span>]);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#A31515\">'G'</span>.$xlsRow, $row_Recordset1[<span style=\"color:#A31515\">'Rider'</span>]);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#A31515\">'H'</span>.$xlsRow, $row_Recordset1[<span style=\"color:#A31515\">'hID'</span>]);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#A31515\">'I'</span>.$xlsRow, $row_Recordset1[<span style=\"color:#A31515\">'Horse'</span>]);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#A31515\">'J'</span>.$xlsRow, $row_Recordset1[<span style=\"color:#A31515\">'sID'</span>]);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#A31515\">'K'</span>.$xlsRow, $row_Recordset1[<span style=\"color:#A31515\">'School'</span>]);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#A31515\">'L'</span>.$xlsRow, $row_Recordset1[<span style=\"color:#A31515\">'Entry Fee'</span>]);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#A31515\">'M'</span>.$xlsRow, $row_Recordset1[<span style=\"color:#A31515\">'Grading'</span>]);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#A31515\">'N'</span>.$xlsRow, $row_Recordset1[<span style=\"color:#A31515\">'Stabling'</span>]);\r\n\r\n\r\n$xlsRow++;\r\n$xlsNr++;\r\n\r\n} <span style=\"color:Blue\">while</span> ($row_Recordset1 = mysql_fetch_assoc($Recordset1));\r\n \r\n\r\n<span style=\"color:Green\">// Rename sheet</span>\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setTitle(<span style=\"color:#A31515\">'Dressage'</span>);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getPageSetup()-&gt;setOrientation(PHPExcel_Worksheet_PageSetup::ORIENTATION_LANDSCAPE);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getPageSetup()-&gt;setPaperSize(PHPExcel_Worksheet_PageSetup::PAPERSIZE_A4);\r\n\r\n<span style=\"color:Green\">// Set active sheet index to the first sheet, so Excel opens this as the first sheet</span>\r\n$objPHPExcel-&gt;setActiveSheetIndex(0);\r\n\r\n\r\n<span style=\"color:Green\">// Redirect output to a client&rsquo;s web browser (Excel5)</span>\r\nheader(<span style=\"color:#A31515\">'Content-Type: application/vnd.ms-excel'</span>);\r\nheader(<span style=\"color:#A31515\">'Content-Disposition: attachment;filename=&quot;'</span>.$vQualifier.<span style=\"color:#A31515\">'&quot;RunningOrder.xls&quot;'</span>);\r\nheader(<span style=\"color:#A31515\">'Cache-Control: max-age=0'</span>);\r\n\r\n$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, <span style=\"color:#A31515\">'Excel5'</span>);\r\n$objWriter-&gt;save(<span style=\"color:#A31515\">'php://output'</span>); \r\n<span style=\"color:Blue\">exit</span>;\r\n\r\n\r\nmysql_free_result($Recordset1);\r\n\r\nmysql_free_result($Recordset2);\r\n\r\nmysql_free_result($dateID);\r\n?&gt;\r\n</pre>\r\n</div>",
    "PostedDate": "2010-02-15T04:31:42.607-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "634638",
    "ThreadId": "85265",
    "Html": "<p>Hi,</p>\r\n<p>I am also encountering the same proble. But I am using mssql. Does anyone know of a fix for it?</p>",
    "PostedDate": "2011-06-29T02:29:55.267-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]