[
  {
    "Id": "446658",
    "ThreadId": "213643",
    "Html": "<p>I'm on</p>\r\n<p>phpExcel 1.7.3</p>\r\n<p>Mysql 5.0.90</p>\r\n<p>Php 5.2.10</p>\r\n<p>Apache 2.0</p>\r\n<p>&nbsp;</p>\r\n<p>I'm opening an xlsx spreadsheet which is &quot;nicely&quot; coloured. After closing the file and downloading it. Every sheet comes out black and the fixed cell coordinates apear elsewhere.</p>\r\n<p>&nbsp;</p>\r\n<p>I'd appreciate If someone can help me with this.</p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2010-05-24T07:59:59.467-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "447480",
    "ThreadId": "213643",
    "Html": "<p>What version of Excel are you using to open the xlsx file? If you're using Excel2003 with the compatibility pack, but the style is using too many &quot;custom colours&quot;, then they may appear black</p>",
    "PostedDate": "2010-05-26T01:19:45.843-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "447938",
    "ThreadId": "213643",
    "Html": "<p>The file was created on office 2007 and saved as extension xlsx.</p>",
    "PostedDate": "2010-05-26T19:52:52.043-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "448018",
    "ThreadId": "213643",
    "Html": "<p>So after you've downloaded it, you're opening it again using Excel2007.</p>\r\n<p>I've never come across that before: do the test scripts in the /Tests directory work, or do they appear black as well?</p>",
    "PostedDate": "2010-05-27T00:38:55.593-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "448204",
    "ThreadId": "213643",
    "Html": "Tests scripts came out fine.<br><br>Do you want me to send you the file?<br><br><br>",
    "PostedDate": "2010-05-27T08:08:29.433-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "448414",
    "ThreadId": "213643",
    "Html": "<blockquote style=\"border:solid .1em #ccc;font-style:italic;margin:.25em 1em 0 1em;padding:0 .25em 0 .25em\"><strong>DiegoG wrote:</strong><br>Do you want me to send you the file?<br><br></blockquote>\r\n<p>&nbsp;If you can... I'll run a few tests to see if I can identify what's happening.</p>",
    "PostedDate": "2010-05-27T14:59:39.547-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "448614",
    "ThreadId": "213643",
    "Html": "the file is uploaded here<br><a href=\"http://phpexcel.codeplex.com/Project/Download/AttachmentDownload.ashx?ProjectName=PHPExcel&WorkItemId=13374&FileAttachmentId=4484\">http://phpexcel.codeplex.com/Project/Download/AttachmentDownload.ashx?ProjectName=PHPExcel&WorkItemId=13374&FileAttachmentId=4484</a><br>\r\n\r\n<br>under the name ventas.xlsx<br><br>regards<br>Diego G./<br>",
    "PostedDate": "2010-05-28T04:39:29.097-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "521399",
    "ThreadId": "213643",
    "Html": "\r\n<p>Any resolution to this?&nbsp; I am suffering the same problem.</p>\r\n<p>Thanks,</p>\r\n<p>Mark</p>\r\n",
    "PostedDate": "2010-11-12T22:28:39.93-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "521459",
    "ThreadId": "213643",
    "Html": "\r\n<p>At this point, I have no solution. I can't consistently replicate the problem. Most times it seems to work perfectly correctly, at other times I do get the black background (but only very rarely) -- which makes diagnosis very hard.</p>\r\n",
    "PostedDate": "2010-11-13T04:25:34.133-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "524744",
    "ThreadId": "213643",
    "Html": "\r\n<p>Hi,</p>\r\n<p>If I may add my thoughts - I can also replicate this consistently (happens with all my files created in Excel 2007 before loading them into PHPExcel).</p>\r\n<p>Are any of the files in /Tests created using Excel proper or are they all generated from scratch?</p>\r\n<p>I believe that is what the problem is, the files are created by the Excel application rather than PHPExcel.</p>\r\n<p>Thanks,<br>\r\n-Will&nbsp;</p>\r\n",
    "PostedDate": "2010-11-20T09:31:36.13-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "524765",
    "ThreadId": "213643",
    "Html": "\r\n<blockquote style=\"border:solid .1em #ccc; font-style:italic; margin:.25em 1em 0 1em; padding:0 .25em 0 .25em\">\r\n<strong>seuj wrote:</strong><br>\r\n<p>Hi,</p>\r\n<p>Are any of the files in /Tests created using Excel proper or are they all generated from scratch?</p>\r\n<p>I believe that is what the problem is, the files are created by the Excel application rather than PHPExcel.</p>\r\n</blockquote>\r\n<p>The files in /Tests are all generated by PHPExcel itself, but I use other test files on a regular basis that are generated in various versions of Excel (95, 97, 2003, 2007 and 2010) that sometimes display this issue, other times not.</p>\r\n",
    "PostedDate": "2010-11-20T11:52:04.723-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "524813",
    "ThreadId": "213643",
    "Html": "\r\n<p>Thanks for the clarification Mark. Is there anything we can help you with to diagnose?&nbsp;</p>\r\n<p>E.g. perhaps the version of Windows/Office in our environment as my setup using XP/Excel 2007 and Windows 7/Excel 2010 creates this issue without fail every time.</p>\r\n<p>Anything we can do to help nail this down - let me know!</p>\r\n<p>&nbsp;</p>\r\n<p><strong>Edit: </strong>and I forgot to mention that I've tried explicitly setting a background on the cells I modify, e.g. white. When I do this, these filled cells no longer exhibit the problem, but those I haven't explicitly filled do, i.e. on editing\r\n the cells they appear black but on editing the cell with a white background, the background remains white.</p>\r\n<p>Is there a command that PHPExcel can issue to reset a background to 'no fill' (or whatever the parlance is in Excel terminology) once it has been filled?</p>\r\n",
    "PostedDate": "2010-11-20T15:13:28.133-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "549640",
    "ThreadId": "213643",
    "Html": "\r\n<p>Hello,</p>\r\n<p>I also have this problem. For all cells with the background color defined on &quot;no fill&quot;, there is no problem. But when I fill a cell, it turns to black after the generation.</p>\r\n",
    "PostedDate": "2011-01-14T14:33:12.763-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "549643",
    "ThreadId": "213643",
    "Html": "\r\n<p>@Zick</p>\r\n<p>Is this when you're reading a file and then saving it again, or simply when creating a workbook from a new PHPExcel object.</p>\r\n<p>If when reading a file, then could you try this with the latest code from the SVN repository, accessible from the &quot;Source Code&quot; tab here on phpexcel.net. This should have been fixed since the 1.7.5 release.</p>\r\n<p>If when creating a new workbook, then a solidfill cell only uses the StartColor. If this is still a problem, can you show me the code that you're using?</p>\r\n",
    "PostedDate": "2011-01-14T14:42:40.097-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "574927",
    "ThreadId": "213643",
    "Html": "<p>Hello, I'm having this same problem, I think. Here's what happens:</p>\r\n<ul>\r\n<li>I open a template.xlsx (some cells have background colors).</li>\r\n<li>I insert some data using setCellValueByColumnAndRow()</li>\r\n<li>I write it as a new .xlsx file.</li>\r\n</ul>\r\n<p>Result:</p>\r\n<p>On the new xslx file&nbsp;all background colors get changed to black.</p>\r\n<p>&nbsp;</p>\r\n<p>I'm on</p>\r\n<p>phpExcel 1.7.5</p>\r\n<p>Php 5.3.5</p>\r\n<p>&nbsp;</p>\r\n<p>Any idea why?</p>",
    "PostedDate": "2011-03-03T03:48:11.347-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "574931",
    "ThreadId": "213643",
    "Html": "This issue is solved in next version or on the repository\r\n<hr>\r\n<div><b>From: </b>&quot;agucho&quot; &lt;notifications@codeplex.com&gt; </div>\r\n<div><b>Date: </b>3 Mar 2011 03:48:19 -0800</div>\r\n<div><b>To: </b>&lt;diegoguidobono@gmail.com&gt;</div>\r\n<div><b>ReplyTo: </b>PHPExcel@discussions.codeplex.com </div>\r\n<div><b>Subject: </b>Re: Cells background turn black [PHPExcel:213643]</div>\r\n<div><br>\r\n</div>\r\n<p>From: agucho</p>\r\n<div id=\"x_x_ThreadNotificationPostBody\">\r\n<p>Hello, I'm having this same problem, I think. Here's what happens:</p>\r\n<ul>\r\n<li>I open a template.xlsx (some cells have background colors). </li><li>I insert some data using setCellValueByColumnAndRow() </li><li>I write it as a new .xlsx file. </li></ul>\r\n<p>Result:</p>\r\n<p>On the new xslx file all background colors get changed to black.</p>\r\n<p></p>\r\n<p>I'm on</p>\r\n<p>phpExcel 1.7.5</p>\r\n<p>Php 5.3.5</p>\r\n<p></p>\r\n<p>Any idea why?</p>\r\n</div>\r\n",
    "PostedDate": "2011-03-03T03:54:38.997-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "574945",
    "ThreadId": "213643",
    "Html": "<p>Yes, that worked. Thanks.</p>",
    "PostedDate": "2011-03-03T04:31:11.107-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "575089",
    "ThreadId": "213643",
    "Html": "<p>Good to hear!&nbsp;Can you clarify - since the OP was using 1.7.5 does \"solved in the next version\" mean 1.7.6 or just the current repository?</p>\r\n<p>Many thanks.</p>",
    "PostedDate": "2011-03-03T07:58:47.013-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "575092",
    "ThreadId": "213643",
    "Html": "It was fixed for version 1.7.6. (Current one)\r\n<hr>\r\n<div><b>From: </b>&quot;seuj&quot; &lt;notifications@codeplex.com&gt; </div>\r\n<div><b>Date: </b>3 Mar 2011 07:58:49 -0800</div>\r\n<div><b>To: </b>&lt;diegoguidobono@gmail.com&gt;</div>\r\n<div><b>ReplyTo: </b>PHPExcel@discussions.codeplex.com </div>\r\n<div><b>Subject: </b>Re: Cells background turn black [PHPExcel:213643]</div>\r\n<div><br>\r\n</div>\r\n<p>From: seuj</p>\r\n<div id=\"x_x_ThreadNotificationPostBody\">\r\n<p>Good to hear! Can you clarify - since the OP was using 1.7.5 does &quot;solved in the next version&quot; mean 1.7.6 or just the current repository?</p>\r\n<p>Many thanks.</p>\r\n</div>\r\n",
    "PostedDate": "2011-03-03T08:01:59.213-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "575093",
    "ThreadId": "213643",
    "Html": "<p>For me, repository version solved the issue. Checked out 2hs ago.</p>\r\n<p>Agustin.</p>",
    "PostedDate": "2011-03-03T08:02:40.953-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "575096",
    "ThreadId": "213643",
    "Html": "<p>Thanks for the confirmation guys. 1.7.6 doesn't fix my issue; I might be seeing something different then - can others confirm?</p>\n<p>My cells aren't coloured black but rather when you go to edit the contents of the cells in Excel, the entire edit block is black and the text unreadable as it is also black.</p>\n<p>For an example please see: <a href=\"http://files.seuj.net/browse/screens/phpexcel.png\"> files.seuj.net/browse/screens/phpexcel.png</a> - top is before and bottom is during a cell edit in Excel. If it matters, the gridlines are off in my template spreadsheet but the cells have no background fill.</p>\n<p>If this is the same issue I will fiddle with the repository copy to check.</p>\n<p>Thanks all.</p>",
    "PostedDate": "2011-03-03T08:14:37.063-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "575570",
    "ThreadId": "213643",
    "Html": "<p>same problem here - in both 1.7.4 and 1.7.6</p>\r\n<p>&nbsp;</p>\r\n<p>and seuj yes that is similar</p>",
    "PostedDate": "2011-03-04T07:01:26.173-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "575704",
    "ThreadId": "213643",
    "Html": "<p>Can confirm that this unfortunately hasn't fixed my issue - either 1.7.6 or repository checkout as of 5 minute ago.</p>\r\n<p>In my template (pre-PHPExcel) if I look at the formatting properties of my cell (right click, 'Format cells...'), the 'Background color' is specifically set to 'No color' and 'Pattern color' is 'Automatic'.</p>\r\n<p>After my file has run through PHPExcel however, the same formatting properties of the cell don't seem to be applied any more. Specifically, the cell has no 'Background color' set at all but 'Pattern colour' is still set as 'Automatic'.</p>\r\n<p>Choosing 'No colour' as the 'Background color' in Excel then restores the intended behaviour for the selected cells.</p>\r\n<p>It's worth noting that the 'Automatic' 'Pattern colour' is black, which is most likely the problem, given that the black is showing through as the cell has lost its 'Background color' setting.</p>",
    "PostedDate": "2011-03-04T10:44:14.577-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "576559",
    "ThreadId": "213643",
    "Html": "<p>as a way round this bug, i'm now at the end of the file re-formatting my cells with a background colour of white. which seems to work</p>",
    "PostedDate": "2011-03-07T03:41:25.98-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "576563",
    "ThreadId": "213643",
    "Html": "<p>I've been using a similar method all along until this is fixed. If it helps (as I am using a template), I pre-fill my entire worksheet with white backgrounds in the template before running it through PHPExcel - saves memory and time on every file creation. I'm also not using gridlines so this looks quite natural anyway.</p>",
    "PostedDate": "2011-03-07T03:46:27.233-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "582141",
    "ThreadId": "213643",
    "Html": "<p>oh and btw....not using templates and creating excel from scratch</p>",
    "PostedDate": "2011-03-17T08:32:27.407-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "669160",
    "ThreadId": "213643",
    "Html": "<p>I have got the same problem with PHPExcel 1.7.6. I use Office 2007. Then I open a Excel 2007 file :</p>\r\n<p>&nbsp;</p>\r\n<div style=\"color: black; background-color: white;\">\r\n<pre>        $vReader = <span style=\"color: blue;\">new</span> PHPExcel_Reader_Excel2007();\r\n        <span style=\"color: blue;\">if</span>(file_exists($pFileSourcePath)) {\r\n            <span style=\"color: blue;\">if</span>($vReader-&gt;canRead($pFileSourcePath)) {\r\n                $objPHPExcel = $vReader-&gt;load($pFileSourcePath);\r\n            }\r\n        }\r\n\r\n\r\n        $objPHPExcel-&gt;setActiveSheetIndex(0);\r\n        $pFileName = <span style=\"color: #a31515;\">'test.xlsx'</span>;\r\n        header(<span style=\"color: #a31515;\">'Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'</span>);\r\n        header(<span style=\"color: #a31515;\">'Content-Disposition: attachment;filename=\"'</span>.$pFileName.<span style=\"color: #a31515;\">'\"'</span>);\r\n        header(<span style=\"color: #a31515;\">'Cache-Control: max-age=0'</span>);\r\n   \r\n        $objWriter = PHPExcel_IOFactory::createWriter($pObjPHPExcel, <span style=\"color: #a31515;\">'Excel2007'</span>);\r\n        $objWriter-&gt;save(<span style=\"color: #a31515;\">'php://output'</span>);\r\n</pre>\r\n</div>\r\n<p>The cells background color turns to black while I type caracters in it. Once the cell loses the focus, the back ground turns to the original color.</p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2011-09-08T08:30:16.403-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "673702",
    "ThreadId": "213643",
    "Html": "<p>Same problem here (1.7.6)</p>\r\n<p>Happens every time i load a xlsx template and write in it.</p>\r\n<p><br />I made a Workaround with fake excel grid while a wait for a fix:</p>\r\n<p>\r\n<div style=\"color: black; background-color: white;\">\r\n<pre>$highestRow = $objPHPExcel-&gt;getActiveSheet()-&gt;getHighestRow();\r\n$highestColumn = $objPHPExcel-&gt;getActiveSheet()-&gt;getHighestColumn();\r\n$starting_row = 6;\r\n\r\n<span style=\"color: blue;\">&nbsp;</span>$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color: #a31515;\">\"A\"</span>.$starting_row.<span style=\"color: #a31515;\">\":\"</span>.$highestColumn.$highestRow)-&gt;getFill()-&gt;setFillType(PHPExcel_Style_Fill::FILL_SOLID)-&gt;getStartColor()-&gt;setARGB(PHPExcel_Style_Color::COLOR_WHITE);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color: #a31515;\">\"A\"</span>.$starting_row.<span style=\"color: #a31515;\">\":\"</span>.$highestColumn.$highestRow)-&gt;getBorders()-&gt;getAllBorders()-&gt;setBorderStyle(PHPExcel_Style_Border::BORDER_THIN);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color: #a31515;\">\"A\"</span>.$starting_row.<span style=\"color: #a31515;\">\":\"</span>.$highestColumn.$highestRow)-&gt;getBorders()-&gt;getAllBorders()-&gt;getColor()-&gt;setARGB(<span style=\"color: #a31515;\">\"FFd0d7e5\"</span>);\r\n</pre>\r\n</div>\r\n</p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2011-09-19T08:08:40.71-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "679720",
    "ThreadId": "213643",
    "Html": "<p>Same problem (1.7.6)</p>\r\n<p>I've got a Fix :</p>\r\n<p>in PHPExcel/Reader/Excel2007.php, just comment the line 1609 =&gt;</p>\r\n<p>\r\n<div style=\"color: black; background-color: white;\">\r\n<pre><span style=\"color: blue;\">if</span> ($style-&gt;fill-&gt;patternFill-&gt;fgColor) {\r\n\t$docStyle-&gt;getFill()-&gt;getStartColor()-&gt;setARGB(self::_readColor($style-&gt;fill-&gt;patternFill-&gt;fgColor,true));\r\n} <span style=\"color: blue;\">else</span> {\r\n\t<span style=\"color: green;\">//Comment line 1609  $docStyle-&gt;getFill()-&gt;getStartColor()-&gt;setARGB('FF000000');</span>\r\n}\r\n</pre>\r\n</div>\r\n</p>",
    "PostedDate": "2011-10-04T03:41:21.41-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "681180",
    "ThreadId": "213643",
    "Html": "<p>Thanks quaki.</p>\r\n<p>Another solution is to fill the background color in white :&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;</p>\r\n<pre>$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle($cellRange)-&gt;getFill()-&gt;setFillType(PHPExcel_Style_Fill::FILL_NONE);&nbsp; &nbsp;&nbsp;&nbsp; </pre>\r\n<pre>$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle($cellRange)-&gt;getFill()-&gt;getStartColor()-&gt;setARGB('FFFFFFFF');<br /></pre>",
    "PostedDate": "2011-10-07T00:52:06.96-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "727987",
    "ThreadId": "213643",
    "Html": "<blockquote style=\"border: solid .1em #ccc; font-style: italic; margin: .25em 1em 0 1em; padding: 0 .25em 0 .25em;\"><strong>quaki wrote:</strong>&nbsp;\t<span style=\"color: green;\">//Comment line 1609  $docStyle-&gt;getFill()-&gt;getStartColor()-&gt;setARGB('FF000000');</span> }\r\n<div style=\"color: black; background-color: white;\"></div>\r\n</blockquote>\r\n<p>&nbsp;</p>\r\n<p>Thanks Quaki. That fixed it for me.&nbsp; Will this fix be put into the next revision or does it break something else?</p>",
    "PostedDate": "2012-01-19T23:43:18.093-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1235602",
    "ThreadId": "213643",
    "Html": "I'm using version 1.7.7 and I'm facing this issue. @quaki's fix still works, though now it's on line 1813. I second the request to put this change into a future release.<br />\n",
    "PostedDate": "2014-04-18T18:58:29.193-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]