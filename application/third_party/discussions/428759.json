[
  {
    "Id": "983729",
    "ThreadId": "428759",
    "Html": "\r\n<p>Good day! Having a problem during reading .xls file (size ~21Mb).</p>\r\n<p>I`we already tried to increase memory limit up to 64Mb.</p>\r\n<p>Tried to use</p>\r\n<p>&nbsp;</p>\r\n<pre>PHPExcel_CachedObjectStorageFactory::cache_to_phpTemp;</pre>\r\n<p>&nbsp;</p>\r\n<p>and<span lang=\"EN-GB\" style=\"font-size:10.0pt; font-family:\">&nbsp;</span></p>\r\n<pre>PHPExcel_CachedObjectStorageFactory::cache_to_discISAM; </pre>\r\n<p>&nbsp;</p>\r\n<p>but I still get the same error. (not sure that I`we use`d that method correctly in my script...)</p>\r\n<p>Tried to use $chunk.</p>\r\n<p>My script is</p>\r\n<p></p>\r\n<pre>&lt;!--?php\r\n\r\nerror_reporting(E_ALL);\r\nset_time_limit(0);\r\n\r\ndate_default_timezone_set('Europe/London');\r\n\r\n\r\n\r\n?--&gt;\r\n\r\n\r\n\r\n\r\nPHPExcel Reader Example #12\r\n\r\n\r\n\r\n\r\n<h1>PHPExcel Reader Example #12</h1>\r\n<h2>Reading a Workbook in &quot;Chunks&quot; Using a Configurable Read Filter (Version 2)</h2>\r\n&lt;!--?php\r\n\r\n/**  Set Include path to point at the PHPExcel Classes folder  **/\r\nset_include_path(get_include_path() . PATH_SEPARATOR . '../../../Classes/');\r\n\r\n/**  Include PHPExcel_IOFactory  **/\r\ninclude 'PHPExcel/IOFactory.php';\r\n\r\n\r\n\r\n$inputFileType = 'Excel5';\r\n//\t$inputFileType = 'Excel2007';\r\n//\t$inputFileType = 'Excel2003XML';\r\n//\t$inputFileType = 'OOCalc';\r\n//\t$inputFileType = 'Gnumeric';\r\n$inputFileName = './sampleData/brain.xls';\r\n\r\n\r\n/**  Define a Read Filter class implementing PHPExcel_Reader_IReadFilter  */\r\nclass chunkReadFilter implements PHPExcel_Reader_IReadFilter\r\n{\r\n\tprivate $_startRow = 0;\r\n\r\n\tprivate $_endRow = 0;\r\n\r\n\t/**  Set the list of rows that we want to read  */\r\n\tpublic function setRows($startRow, $chunkSize) {\r\n\t\t$this- --&gt;_startRow\t= $startRow;\r\n\t\t$this-&gt;_endRow\t\t= $startRow &#43; $chunkSize;\r\n\t}\r\n\t\r\n\tpublic function readCell($column, $row, $worksheetName = '') {\r\n\t\t//  Only read the heading row, and the rows that are configured in $this-&gt;_startRow and $this-&gt;_endRow\r\n\t\tif (($row == 1) || ($row &gt;= $this-&gt;_startRow && $row &lt; $this-&gt;_endRow)) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n}\r\n\r\n\r\n\r\necho 'Loading file ',pathinfo($inputFileName,PATHINFO_BASENAME),' using IOFactory with a defined reader type of ',$inputFileType,'<br>';\r\n/**  Create a new Reader of the type defined in $inputFileType  **/\r\n$objReader = PHPExcel_IOFactory::createReader($inputFileType);\r\n\r\n/*\r\n$cacheMethod = PHPExcel_CachedObjectStorageFactory:: cache_to_discISAM;\r\n$cacheSettings = array( 'dir'  =&gt; '/usr/local/tmp'\r\n                      );\r\nPHPExcel_Settings::setCacheStorageMethod($cacheMethod, $cacheSettings);\r\n*/\r\n\r\n$cacheMethod = PHPExcel_CachedObjectStorageFactory:: cache_to_phpTemp;\r\n$cacheSettings = array( 'memoryCacheSize'  =&gt; '2000MB'\r\n                      );\r\nPHPExcel_Settings::setCacheStorageMethod($cacheMethod, $cacheSettings);\r\n\r\n\r\n\r\n\r\necho '<hr>';\r\n\r\n\r\n/**  Define how many rows we want to read for each &quot;chunk&quot;  **/\r\n$chunkSize = 1;\r\n/**  Create a new Instance of our Read Filter  **/\r\n$chunkFilter = new chunkReadFilter();\r\n\r\n/**  Tell the Reader that we want to use the Read Filter that we've Instantiated  **/\r\n$objReader-&gt;setReadFilter($chunkFilter);\r\n\r\n/**  Loop to read our worksheet in &quot;chunk size&quot; blocks  **/\r\nfor ($startRow = 2; $startRow &lt;= 2; $startRow &#43;= $chunkSize) {\r\n\techo 'Loading WorkSheet using configurable filter for headings row 1 and for rows ',$startRow,' to ',($startRow&#43;$chunkSize-1),'<br>';\r\n\t/**  Tell the Read Filter, the limits on which rows we want to read this iteration  **/\r\n\t$chunkFilter-&gt;setRows($startRow,$chunkSize);\r\n\t/**  Load only the rows that match our filter from $inputFileName to a PHPExcel Object  **/\r\n\t$objPHPExcel = $objReader-&gt;load($inputFileName);\r\n\r\n\t//\tDo some processing here\r\n\r\n\t$sheetData = $objPHPExcel-&gt;getActiveSheet()-&gt;toArray(null,true,true,true);\r\n\tvar_dump($sheetData);\r\n\techo '<br><br>';\r\n}\r\n/*\r\n$objPHPExcel-&gt;disconnectWorksheets();\r\nunset($objPHPExcel);\r\n*/\r\n?&gt;\r\n\r\n</pre>\r\nmodified exampleReader12.php :)\r\n<p></p>\r\n<div id=\"_mcePaste\" style=\"left:-10000px; top:0px; width:1px; height:1px; overflow-x:hidden; overflow-y:hidden\">\r\n<h3 style=\"margin-left:0cm; text-indent:0cm\"><a name=\"_Toc331795359\"><span lang=\"EN-GB\" style=\"\"><span style=\"\">1.1.1.<span style=\"font:7.0pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n</span></span></span><span lang=\"EN-GB\" style=\"\">Cell Caching</span></a></h3>\r\n</div>\r\n",
    "PostedDate": "2013-01-07T05:12:59.817-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]