[
  {
    "Id": "677406",
    "ThreadId": "274044",
    "Html": "<p>Hello,</p>\n<p>I have a short function that converts a local excel document (2003) into HTML, see below:&nbsp;</p>\n<div style=\"color: black; background-color: white;\">\n<pre>\t\t<span style=\"color: green;\">/*\n\t\t*\tConvert a local Excel file to HTML and return HTML:\n\t\t*/</span>\n\t\t<span style=\"color: blue;\">public</span> <span style=\"color: blue;\">static</span> <span style=\"color: blue;\">function</span> getConvertExcelToHTML($filename) {\n\n\t\t\t<span style=\"color: green;\">//Needs IO Factory</span>\n\t\t\t<span style=\"color: blue;\">require_once</span> <span style=\"color: #a31515;\">'PHPExcel/IOFactory.php'</span>;\n\n\t\t\t<span style=\"color: green;\">//Check to make sure file exists</span>\n\t\t\t<span style=\"color: blue;\">if</span> (!file_exists($filename)) {\n\t\t\t\tappCore::error(<span style=\"color: #a31515;\">\"Cannot find $filename\"</span>);\n\t\t\t}\n\n\t\t\t<span style=\"color: green;\">//Load File</span>\n\t\t\t$objPHPExcel = PHPExcel_IOFactory::load($filename);\n\n\t\t\t<span style=\"color: green;\">//WRite the sheet to file</span>\n\t\t\t$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, <span style=\"color: #a31515;\">'HTML'</span>);\n\n\t\t\t<span style=\"color: green;\">//Display Settings:</span>\n\t\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;setShowGridlines(false);\n\n\t\t\t<span style=\"color: green;\">//Get the active sheet</span>\n\t\t\t$objWorksheet = $objPHPExcel-&gt;getActiveSheet();\n\n\t\t\t<span style=\"color: green;\">//Set writer to active sheet:</span>\n\t\t\t$objWriter-&gt;setSheetIndex($objPHPExcel-&gt;getIndex($objWorksheet));\n\n\t\t\t$filename = str_replace(<span style=\"color: #a31515;\">'.xlsx'</span>, <span style=\"color: #a31515;\">'.htm'</span>, $filename);\n\t\t\t$filename = str_replace(<span style=\"color: #a31515;\">'.xls'</span>, <span style=\"color: #a31515;\">'.htm'</span>, $filename);\n\t\t\t$objWriter-&gt;save($filename);\n\n\t\t\t<span style=\"color: green;\">//Return the Cached file:</span>\n\t\t\t<span style=\"color: blue;\">return</span> file_get_contents($filename);\n\t\t}\n</pre>\n</div>\n<p>But for cells with a date format (i.e. \"6 meses adelante\" &nbsp;(mmmm yyyy)) the PHPExcel garbles the output, please see image here with the excel VS PhpExcel (<a href=\"http://i54.tinypic.com/2wf21qw.jpg\">http://i54.tinypic.com/2wf21qw.jpg</a>)</p>\n<p>The excel document is here:&nbsp;<a href=\"http://www.bcentral.cl/estadisticas-economicas/operadores-financieros/xls/EOFResultado13092011.xls\">http://www.bcentral.cl/estadisticas-economicas/operadores-financieros/xls/EOFResultado13092011.xls</a></p>\n<p>My host is running PHP Version 5.2.17,&nbsp;Linux</p>\n<p>Is this a bug or am I loading it wrong?</p>\n<p>Thank you</p>\n<p>Jared&nbsp;</p>",
    "PostedDate": "2011-09-27T14:52:51.043-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]