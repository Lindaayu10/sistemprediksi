[
  {
    "Id": "443512",
    "ThreadId": "212809",
    "Html": "<p>Hello respectfully.</p>\r\n<p>I have some problem trying to generate XLS file with full dimention of ~1900 rows to 5 columns and final filesize about 180 Kb.<br>XLS file generated, but from 40 to 80 sec on different servers. Used ver. 5.16 and 5.22 of PHP.<br><br>Some style formatting applyed only for cells in two last columns, may be about 3000 cells, by follow code</p>\r\n<div style=\"color:black;background-color:white\">\r\n<pre>$sheet -&gt; setActiveSheetIndex(0) -&gt; getStyle($letters[(3+$localCounter)].($currentRow+$i)) -&gt; getFont() -&gt; getColor() -&gt; setRGB($prow[<span style=\"color:#a31515\">'color1'</span>]);<br>$sheet -&gt; setActiveSheetIndex(0) -&gt; getStyle($letters[(3+$localCounter)].($currentRow+$i)) -&gt; getFill() -&gt; setFillType(PHPExcel_Style_Fill::FILL_SOLID) -&gt; getStartColor() -&gt; setARGB($prow[<span style=\"color:#a31515\">'color2'</span>]);<br>$sheet -&gt; setActiveSheetIndex(0) -&gt; getStyle($letters[(3+$localCounter)].($currentRow+$i)) -&gt; getFont() -&gt; setSize($prow[<span style=\"color:#a31515\">'font_size1_3'</span>]);<br></pre>\r\n</div>\r\n<p>&nbsp;and some vertically merged cells (about 300-400) with code</p>\r\n<div style=\"color:black;background-color:white\">\r\n<pre>$sheet -&gt; getActiveSheet() -&gt; getStyle(<span style=\"color:#a31515\">'A'</span>.$currentRow+$i) -&gt; getAlignment() -&gt; setVertical(PHPExcel_Style_Alignment::VERTICAL_CENTER);  <br></pre>\r\n</div>\r\n<p>It not my code and I still not refactor it, sorry. Code is not simple, so I not to prowide whole code  here.<br><br>I was try to profile my script. <br>This is part of log of <strong>PHPEd IDE</strong> profiler. It provide count of every code line calls, that line min &amp; max exec time and overall time spent to exec that line.<br><br><span style=\"color:#008000\">PHPExcel_Style_Color::getHashCode()</span><br><span style=\"color:#008000\">PHPExcel\\Style\\Color.php, line 398, count 2141154 times, min line exec time 0,002 ms, max line exec time 33,73 ms, total 6,5 sec</span><br><span style=\"color:#008000\">PHPExcel\\Style\\Color.php, line 401, count 2141154 times, min line exec time 0,009 ms, max line exec time 60,23 ms, total 31,1 sec</span><br><br><span style=\"color:#008000\">PHPExcel_Style_Border::getHashCode()</span><br><span style=\"color:#008000\">PHPExcel\\Style\\Border.php, line 374, count 1338205 times, min line exec time 0,002 ms, max line exec time 25,13 ms, total 3,9 sec</span><br><span style=\"color:#008000\">PHPExcel\\Style\\Border.php, line 377, count 1338205 times, min line exec time 0,006 ms, max line exec time 115,5 ms, total 10,5 sec</span><br><br>and below follow some calls of getHashCode() from different PHPExcel_Style parts...<br><br>There was also a code in my script</p>\r\n<div style=\"color:black;background-color:white\">\r\n<pre>$s = <span style=\"color:blue\">array</span>(<br>        <span style=\"color:#a31515\">'alignment'</span> =&gt; <span style=\"color:blue\">array</span>(<br>            <span style=\"color:#a31515\">'vertical'</span> =&gt; PHPExcel_Style_Alignment::VERTICAL_CENTER,<br>            <span style=\"color:#a31515\">'wrap'</span> =&gt; true,<br>        ),<br>);<br>$sheet -&gt; getActiveSheet() -&gt; getStyle(<span style=\"color:#a31515\">'A1:L100'</span>) -&gt; applyFromArray($s);<br></pre>\r\n</div>\r\n<p>and when I disable it, counts and total exec time of <span style=\"color:#800080\">PHPExcel_Style_Color::getHashCode()</span> and etc now get smaller twice, <br><br><span style=\"color:#008000\">PHPExcel_Style_Color::getHashCode()</span><br><span style=\"color:#008000\">PHPExcel\\Style\\Color.php, line 398, count 1112781 times, min line exec time 0,002 ms, max line exec time 32,95 ms, total 3,5 sec</span><br><span style=\"color:#008000\">PHPExcel\\Style\\Color.php, line 401, count 1112781 times, min line exec time 0,009 ms, max line exec time 68,57 ms, total 17,5 sec</span><br><br>But it seems owerloaded too...<br><br>I has not work with that class before and not to familiar with it. But I think that a lot of millions of getHashCode() method calls an current whole script exec time is not good and expected behavior, so what wrong with class or with my mind or hands?</p>\r\n<p>I found similar topic <a title=here href=\"http://phpexcel.codeplex.com/Thread/View.aspx?ThreadId=36895\">here</a>, but it not give me any good idea...</p>\r\n<p>Thanks at advance, Greeesha</p>",
    "PostedDate": "2010-05-16T13:34:44.517-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "443525",
    "ThreadId": "212809",
    "Html": "<p>In addition about perfomance. Its small better than I describe.</p>\r\n<p>Generating 1900 rows to 7 cols with 4 of cols styled (~6000-7000 cells) on dedicated server - 40 sec..</p>\r\n<p>And also change lines in whole script</p>\r\n<pre>$sheet -&gt; setActiveSheetIndex(0) -&gt; getStyle</pre>\r\n<p>to</p>\r\n<pre>$sheet -&gt; getActiveSheet() -&gt; getStyle<br></pre>\r\n<p>not make visible effect</p>",
    "PostedDate": "2010-05-16T14:33:05.71-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "443547",
    "ThreadId": "212809",
    "Html": "<p><span style=\"color:#ff0000\"><strong>Finally resolved.</strong></span></p>\r\n<p>I replace all parts of code</p>\r\n<div style=\"color:black;background-color:white\">\r\n<pre><pre>$sheet -&gt; getActiveSheet() -&gt; getStyle($letters[(3+$localCounter)].($currentRow+$i)) -&gt; getFont() -&gt; getColor() -&gt; setRGB($prow[<span style=\"color:#a31515\">'color1'</span>]);<br>$sheet -&gt; getActiveSheet() -&gt; getStyle($letters[(3+$localCounter)].($currentRow+$i)) -&gt; getFill() -&gt; setFillType(PHPExcel_Style_Fill::FILL_SOLID) -&gt; getStartColor() -&gt; setARGB($prow[<span style=\"color:#a31515\">'color2'</span>]);<br>$sheet -&gt; getActiveSheet() -&gt; getStyle($letters[(3+$localCounter)].($currentRow+$i)) -&gt; getFont() -&gt; setSize($prow[<span style=\"color:#a31515\">'font_size1_3'</span>]);</pre>\r\n</pre>\r\n</div>\r\n<p>(there was 4 types of cell style, 4 blocks kind of this different by values)</p>\r\n<p>with that</p>\r\n<div style=\"color:black;background-color:white\">\r\n<pre>$sheet-&gt;getActiveSheet()-&gt;getStyle($curr_cell)-&gt;applyFromArray($styles[<span style=\"color:#a31515\">'s1'</span>]);</pre>\r\n</div>\r\n<p>where&nbsp;</p>\r\n<pre>$styles[<span style=\"color:#a31515\">'s1'</span>] =<span style=\"color:blue\"> array</span>(\r\n            <span style=\"color:#a31515\">'fill'</span> =&gt; <span style=\"color:blue\">array</span>(\r\n                <span style=\"color:#a31515\">'type'</span> =&gt; PHPExcel_Style_Fill::FILL_SOLID,\r\n                <span style=\"color:#a31515\">'color'</span> =&gt; <span style=\"color:blue\">array</span>(\r\n                    <span style=\"color:#a31515\">'argb'</span> =&gt; <span style=\"color:#a31515\">'777777'</span>,\r\n                )\r\n            <span style=\"color:#a31515\">'font'</span> =&gt; <span style=\"color:blue\">array</span>(\r\n                <span style=\"color:#a31515\">'color'</span> =&gt; <span style=\"color:blue\">array</span>(\r\n                    <span style=\"color:#a31515\">'argb'</span> =&gt; <span style=\"color:#a31515\">'99FF33'</span>,\r\n                ),\r\n                <span style=\"color:#a31515\">'size'</span> =&gt; 22,\r\n                 )\r\n            )         \r\n        )\r\n<br>and script exec time now 1 sec, not 40! It's a victory.<br><br>But so strange that font &quot;size&quot; is ignored now, because in Documentation Appendix A that key explaned...<br>Will be try further.</pre>",
    "PostedDate": "2010-05-16T16:16:00.817-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]