[
  {
    "Id": "1140508",
    "ThreadId": "476795",
    "Html": "I just using composer install phpExcel in Laravel and follow its example, however,the first sample 01simple-download-xlsx will caused MS Excel 2010 error message &quot;<strong>Excel cannot open the file myfile.xlsx because the file format or file extension is not valid</strong>&quot; when open in Laravel View while the download file could be read flawless.\r<br />\nHere is my setup: \r<br />\ncontroller:<br />\n<pre><code>return View::make('simpleDownloadXlsx');</code></pre>\n\nView:<br />\n<pre><code>&lt;?php\n/** Error reporting */\nob_start();\nerror_reporting(E_ALL);\nini_set('display_errors', TRUE);\nini_set('display_startup_errors', TRUE);\ndate_default_timezone_set('Asia/Taipei');\n\nif (PHP_SAPI == 'cli')\n    die('This example should only be run from a Web Browser');\n\n/** Include PHPExcel */\n$pRoot=dirname(dirname(dirname(__FILE__))).'/vendor';\nrequire_once $pRoot.'/phpoffice/phpexcel/Classes/PHPExcel.php';\n\n\n// Create new PHPExcel object\n$objPHPExcel = new PHPExcel();\n\n// Set document properties\n$objPHPExcel-&gt;getProperties()-&gt;setCreator(&quot;Maarten Balliauw&quot;)\n                             -&gt;setLastModifiedBy(&quot;Maarten Balliauw&quot;)\n                             -&gt;setTitle(&quot;Office 2007 XLSX Test Document&quot;)\n                             -&gt;setSubject(&quot;Office 2007 XLSX Test Document&quot;)\n                             -&gt;setDescription(&quot;Test document for Office 2007 XLSX, generated using PHP classes.&quot;)\n                             -&gt;setKeywords(&quot;office 2007 openxml php&quot;)\n                             -&gt;setCategory(&quot;Test result file&quot;);\n\n\n// Add some data\n$objPHPExcel-&gt;setActiveSheetIndex(0)\n            -&gt;setCellValue('A1', 'Hello')\n            -&gt;setCellValue('B2', 'world!')\n            -&gt;setCellValue('C1', 'Hello')\n            -&gt;setCellValue('D2', 'world!');\n\n// Miscellaneous glyphs, UTF-8\n$objPHPExcel-&gt;setActiveSheetIndex(0)\n            -&gt;setCellValue('A4', 'Miscellaneous glyphs')\n            -&gt;setCellValue('A5', 'TW');\n\n// Rename worksheet\n$objPHPExcel-&gt;getActiveSheet()-&gt;setTitle('Simple');\n\n\n// Set active sheet index to the first sheet, so Excel opens this as the first sheet\n$objPHPExcel-&gt;setActiveSheetIndex(0);\n\n\n// Redirect output to a clientâ€™s web browser (Excel2007)\n\n//$file = &quot;myfile.xlsx&quot;;\nheader('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');\nheader('Content-Disposition: attachment;filename=&quot;01simple.xlsx&quot;');\nheader('Cache-Control: max-age=0');\nob_clean();\nflush();\n//readfile($file);\n$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, 'Excel2007');\n$objWriter-&gt;save('d:/l4/test/01simple.xlsx');\nob_end();\nexit;</code></pre>\n\nA user has exactly same issue and fixed by adding:<br />\n<pre><code>ob_clean()\nflush()</code></pre>\n\nBut no lucky in Laravel.\r<br />\nAny help/guide would be appreciated.<br />\n",
    "PostedDate": "2013-12-21T01:32:37.243-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]