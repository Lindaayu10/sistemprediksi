[
  {
    "Id": "908431",
    "ThreadId": "394404",
    "Html": "\r\n<p>Hi guys, i'm currently working with a project that need to export data to excel with drawing in it. I'm using PHPExcel 1.7.7 and PHP 5.3.8 on Window XP SP3<br>\r\n<br>\r\nAfter export to xlsx, the content of file look just fine in the normal view, but when i print preview, width and height of the drawing has change<br>\r\n<br>\r\nHere is the code snippet i used:<br>\r\n<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $file_path = dirname(__FILE__) . '\\template.xlsx';<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $objReader = new PHPExcel_Reader_Excel2007();<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $objPHPExcel = $objReader-&gt;load($file_path);<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $objPHPExcel-&gt;setActiveSheetIndex(0);<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $objDrawing = new PHPExcel_Worksheet_Drawing();<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $objDrawing-&gt;setPath('C:/Documents and Settings/All Users/Documents/My Pictures/Sample Pictures/Sunset.jpg');<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $objDrawing-&gt;setWidthAndHeight(360, 252);<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $objDrawing-&gt;setCoordinates('B3');<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $objDrawing-&gt;setWorksheet($objPHPExcel-&gt;getActiveSheet());<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $objWriter = new PHPExcel_Writer_Excel2007($objPHPExcel);<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $objWriter-&gt;save('C:/test.xlsx');</p>\r\n<p>&nbsp;</p>\r\n<p>Template file: http://www.mediafire.com/view/?cq24o5ma20kesgf<br>\r\n<br>\r\nResult file: http://www.mediafire.com/view/?x8c50bpdteywx20</p>\r\n",
    "PostedDate": "2012-09-04T19:09:18.813-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "908871",
    "ThreadId": "394404",
    "Html": "<p>I can see the image in the result file but not in the template. Can you upload the files to <a href=\"http://phpexcel.codeplex.com/workitem/10749?ProjectName=phpexcel\">http://phpexcel.codeplex.com/workitem/10749?ProjectName=phpexcel</a></p>",
    "PostedDate": "2012-09-05T14:15:11.993-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "908930",
    "ThreadId": "394404",
    "Html": "\r\n<p>there is no image in the template file, all i do is read the template, add the drawing and save to result file. In normal mode view, the drawing fit perfectly in the border that i make, but in print preview mode, the drawing has been scaled and if you go\r\n to Size and Properties of the drawing, change the option in object positioning at properties tab, the drawing will display properly in print preview mode. Can you point out what is wrong with the drawing?</p>\r\n<p>Link to the file: http://phpexcel.codeplex.com/workitem/18596</p>\r\n<p>&nbsp;</p>\r\n",
    "PostedDate": "2012-09-05T18:04:51.853-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "909043",
    "ThreadId": "394404",
    "Html": "\r\n<p>I tried to create an excel file with a image that look perfectly in normal view and print preview and use it as a template. In code, i loaded the template then save it without changing anything, and the result file still have the bug as i describe above.\r\n You can take a look at my templateWithImage.xlsx in http://phpexcel.codeplex.com/workitem/18596<br>\r\n<br>\r\nCode snippet:<br>\r\n<br>\r\n&nbsp; &nbsp; &nbsp; &nbsp; $filename = dirname(__FILE__).'\\template.xlsx';<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $objReader = new PHPExcel_Reader_Excel2007();<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $objPHPExcel = $objReader-&gt;load($filename);</p>\r\n<p>&nbsp; &nbsp; &nbsp;&nbsp;&nbsp; $objWriter = new PHPExcel_Writer_Excel2007($objPHPExcel);<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $objWriter-&gt;save('C:/test.xlsx');</p>\r\n",
    "PostedDate": "2012-09-06T02:23:59.103-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "909389",
    "ThreadId": "394404",
    "Html": "<p>I had the same problem. Every time I have to open the generated excel file, and change the properties of the image object to 'Move and size with cells' to solve the issue. It's really inconvenient. I am glad to know a better solution here.</p>",
    "PostedDate": "2012-09-06T16:01:27.673-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "910691",
    "ThreadId": "394404",
    "Html": "\r\n<p>does anyone have any ideas to solve this problem?</p>\r\n<p>I found the solution, changed the source code of Drawing.php under Writer/Excel2007 folder (start from line 176 and end at line 204, hope this will help you with your project<br>\r\n<br>\r\n$objWriter-&gt;startElement('xdr:twoCellAnchor');<br>\r\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; // Image location<br>\r\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $aCoordinates &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; = PHPExcel_Cell::coordinateFromString($pDrawing-&gt;getCoordinates());<br>\r\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $aCoordinates[0] &nbsp;&nbsp;&nbsp; = PHPExcel_Cell::columnIndexFromString($aCoordinates[0]);<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $aCoordinatesTO&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = PHPExcel_Cell::coordinateFromString($pDrawing-&gt;getCoordinatesTO());<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $aCoordinatesTO[0]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = PHPExcel_Cell::columnIndexFromString($aCoordinatesTO[0]);<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n<br>\r\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; // xdr:from<br>\r\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $objWriter-&gt;startElement('xdr:from');<br>\r\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $objWriter-&gt;writeElement('xdr:col', $aCoordinates[0] - 1);<br>\r\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $objWriter-&gt;writeElement('xdr:colOff', PHPExcel_Shared_Drawing::pixelsToEMU($pDrawing-&gt;getOffsetX()));<br>\r\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $objWriter-&gt;writeElement('xdr:row', $aCoordinates[1] - 1);<br>\r\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $objWriter-&gt;writeElement('xdr:rowOff', PHPExcel_Shared_Drawing::pixelsToEMU($pDrawing-&gt;getOffsetY()));<br>\r\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $objWriter-&gt;endElement();<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // xdr:to<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $objWriter-&gt;startElement('xdr:to');<br>\r\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $objWriter-&gt;writeElement('xdr:col', $aCoordinatesTO[0] - 1);<br>\r\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $objWriter-&gt;writeElement('xdr:colOff', PHPExcel_Shared_Drawing::pixelsToEMU($pDrawing-&gt;getOffsetX() * -1));<br>\r\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $objWriter-&gt;writeElement('xdr:row', $aCoordinatesTO[1] - 1);<br>\r\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $objWriter-&gt;writeElement('xdr:rowOff', PHPExcel_Shared_Drawing::pixelsToEMU($pDrawing-&gt;getOffsetY() * -1));<br>\r\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $objWriter-&gt;endElement();<br>\r\n<br>\r\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; // xdr:ext<br>\r\n//&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $objWriter-&gt;startElement('xdr:ext');<br>\r\n//&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $objWriter-&gt;writeAttribute('cx', PHPExcel_Shared_Drawing::pixelsToEMU($pDrawing-&gt;getWidth()));<br>\r\n//&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $objWriter-&gt;writeAttribute('cy', PHPExcel_Shared_Drawing::pixelsToEMU($pDrawing-&gt;getHeight()));<br>\r\n//&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $objWriter-&gt;endElement();<br>\r\n<br>\r\n</p>\r\n",
    "PostedDate": "2012-09-10T18:24:00.633-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1045368",
    "ThreadId": "394404",
    "Html": "@trongcuong1710\r<br />\n<br />\nThe move to the the twoCellAnchor certainly looks like a move in the right direction.  The image degradation I have seen in my tests are accompanied by by a change from a twoCellAnchor in the template document to a oneCellAnchor in the document persisted by the 2007 writer.\r<br />\n<br />\nLooks to me like your solution must be accompanied by additional supporting code in the drawing hierarchy not posted above.  In particular I don't see an implementation of $pDrawing-&gt;getCoordinatesTO() in PHPExcel 1.7.8, 1.7.7 or 1.7.3 ... I stopped looking assuming you created those.\r<br />\n<br />\nThe getCoordinateTO() implementation would be greatly appreciated.<br />\n",
    "PostedDate": "2013-05-17T17:20:37.217-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1045371",
    "ThreadId": "394404",
    "Html": "never mind ...\r<br />\n<br />\nadded some minimal hacks to persist the 'TO' coordinate in a new base drawing member to get your code to run.  While the result is somewhat better than what I got out of the box, the simple negation on colOff and rowOff in the xdr:to element are bogus.  Seems to me this would only work on extremely well placed images - those offset equidistantly from the 'from' and 'to' coordinates.<br />\n",
    "PostedDate": "2013-05-17T18:17:04.103-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1416394",
    "ThreadId": "394404",
    "Html": "This is helpfull patch for PHPExcel 1.8.0. The problem resolved in it:<br />\n<pre><code>diff -rub PHPExcel_1.8.0.orig/Classes/PHPExcel/Reader/Excel2007.php phpexcel/Classes/PHPExcel/Reader/Excel2007.php\n--- PHPExcel_1.8.0.orig/Classes/PHPExcel/Reader/Excel2007.php   2015-04-21 18:14:03.542709000 +0400\n+++ phpexcel/Classes/PHPExcel/Reader/Excel2007.php  2015-04-21 18:29:53.707014100 +0400\n@@ -1502,10 +1502,20 @@\n                                                    $objDrawing-&gt;setCoordinates(PHPExcel_Cell::stringFromColumnIndex((string) $twoCellAnchor-&gt;from-&gt;col) . ($twoCellAnchor-&gt;from-&gt;row + 1));\n                                                    $objDrawing-&gt;setOffsetX(PHPExcel_Shared_Drawing::EMUToPixels($twoCellAnchor-&gt;from-&gt;colOff));\n                                                    $objDrawing-&gt;setOffsetY(PHPExcel_Shared_Drawing::EMUToPixels($twoCellAnchor-&gt;from-&gt;rowOff));\n+\n+                                                   $objDrawing-&gt;setToCoordinates(PHPExcel_Cell::stringFromColumnIndex((string) $twoCellAnchor-&gt;to-&gt;col) . ($twoCellAnchor-&gt;to-&gt;row + 1));\n+                                                   $objDrawing-&gt;setToOffsetX(PHPExcel_Shared_Drawing::EMUToPixels($twoCellAnchor-&gt;to-&gt;colOff));\n+                                                   $objDrawing-&gt;setToOffsetY(PHPExcel_Shared_Drawing::EMUToPixels($twoCellAnchor-&gt;to-&gt;rowOff));\n+\n                                                    $objDrawing-&gt;setResizeProportional(false);\n \n-                                                   $objDrawing-&gt;setWidth(PHPExcel_Shared_Drawing::EMUToPixels(self::array_item($xfrm-&gt;ext-&gt;attributes(), &quot;cx&quot;)));\n-                                                   $objDrawing-&gt;setHeight(PHPExcel_Shared_Drawing::EMUToPixels(self::array_item($xfrm-&gt;ext-&gt;attributes(), &quot;cy&quot;)));\n+//                                                 if ($xfrm-&gt;ext) {\n+//                                                     $objDrawing-&gt;setWidth(PHPExcel_Shared_Drawing::EMUToPixels(self::array_item($xfrm-&gt;ext-&gt;attributes(), &quot;cx&quot;)));\n+//                                                     $objDrawing-&gt;setHeight(PHPExcel_Shared_Drawing::EMUToPixels(self::array_item($xfrm-&gt;ext-&gt;attributes(), &quot;cy&quot;)));\n+//                                                 }\n+\n+                                                   $objDrawing-&gt;setWidth(PHPExcel_Shared_Drawing::EMUToPixels(self::array_item($twoCellAnchor-&gt;ext-&gt;attributes(), &quot;cx&quot;)));\n+                                                   $objDrawing-&gt;setHeight(PHPExcel_Shared_Drawing::EMUToPixels(self::array_item($twoCellAnchor-&gt;ext-&gt;attributes(), &quot;cy&quot;)));\n \n                                                    if ($xfrm) {\n                                                        $objDrawing-&gt;setRotation(PHPExcel_Shared_Drawing::angleToDegrees(self::array_item($xfrm-&gt;attributes(), &quot;rot&quot;)));\ndiff -rub PHPExcel_1.8.0.orig/Classes/PHPExcel/Worksheet/BaseDrawing.php phpexcel/Classes/PHPExcel/Worksheet/BaseDrawing.php\n--- PHPExcel_1.8.0.orig/Classes/PHPExcel/Worksheet/BaseDrawing.php  2015-04-21 18:14:04.212710000 +0400\n+++ phpexcel/Classes/PHPExcel/Worksheet/BaseDrawing.php 2015-04-21 17:57:39.647282800 +0400\n@@ -253,6 +253,22 @@\n     }\n \n     /**\n+    * Coordinates\n+    *\n+    * @var string\n+    */\n+   private $_toCoordinates;\n+\n+    /**\n+     * Get &quot;TO&quot; Coordinates\n+     *\n+     * @return string\n+     */\n+    public function getToCoordinates() {\n+       return $this-&gt;_toCoordinates;\n+    }\n+\n+    /**\n      * Set Coordinates\n      *\n      * @param string $pValue\n@@ -264,6 +280,17 @@\n     }\n \n     /**\n+     * Set &quot;TO&quot; Coordinates\n+     *\n+     * @param string $pValue\n+     * @return PHPExcel_Worksheet_BaseDrawing\n+     */\n+    public function setToCoordinates($pValue = 'A1') {\n+       $this-&gt;_toCoordinates = $pValue;\n+       return $this;\n+    }\n+\n+    /**\n      * Get OffsetX\n      *\n      * @return int\n@@ -284,6 +311,47 @@\n     }\n \n     /**\n+    * @var int\n+    */\n+   private $_toOffsetX;\n+   /**\n+    * @var int\n+    */\n+   private $_toOffsetY;\n+\n+    /**\n+     * @return int\n+     */\n+    public function getToOffsetX() {\n+       return $this-&gt;_toOffsetX;\n+    }\n+\n+    /**\n+     * @param int $pValue\n+     * @return PHPExcel_Worksheet_BaseDrawing\n+     */\n+    public function setToOffsetX($pValue = 0) {\n+       $this-&gt;_toOffsetX = $pValue;\n+       return $this;\n+    }\n+\n+    /**\n+     * @return int\n+     */\n+    public function getToOffsetY() {\n+       return $this-&gt;_toOffsetY;\n+    }\n+\n+    /**\n+     * @param int $pValue\n+     * @return PHPExcel_Worksheet_BaseDrawing\n+     */\n+    public function setToOffsetY($pValue = 0) {\n+       $this-&gt;_toOffsetY = $pValue;\n+       return $this;\n+    }\n+\n+    /**\n      * Get OffsetY\n      *\n      * @return int\ndiff -rub PHPExcel_1.8.0.orig/Classes/PHPExcel/Writer/Excel2007/Drawing.php phpexcel/Classes/PHPExcel/Writer/Excel2007/Drawing.php\n--- PHPExcel_1.8.0.orig/Classes/PHPExcel/Writer/Excel2007/Drawing.php   2015-04-21 18:14:04.392710200 +0400\n+++ phpexcel/Classes/PHPExcel/Writer/Excel2007/Drawing.php  2015-04-21 20:02:13.711107600 +0400\n@@ -172,6 +172,32 @@\n    public function _writeDrawing(PHPExcel_Shared_XMLWriter $objWriter = null, PHPExcel_Worksheet_BaseDrawing $pDrawing = null, $pRelationId = -1)\n    {\n        if ($pRelationId &gt;= 0) {\n+           if ($pDrawing-&gt;getToCoordinates()) {\n+                $objWriter-&gt;startElement('xdr:twoCellAnchor');\n+                // Image location\n+                $aCoordinates         = PHPExcel_Cell::coordinateFromString($pDrawing-&gt;getCoordinates());\n+                $aCoordinates[0]     = PHPExcel_Cell::columnIndexFromString($aCoordinates[0]);\n+\n+                $aCoordinatesTO         = PHPExcel_Cell::coordinateFromString($pDrawing-&gt;getToCoordinates());\n+                $aCoordinatesTO[0]      = PHPExcel_Cell::columnIndexFromString($aCoordinatesTO[0]);\n+\n+                // xdr:from\n+                $objWriter-&gt;startElement('xdr:from');\n+                    $objWriter-&gt;writeElement('xdr:col', $aCoordinates[0] - 1);\n+                    $objWriter-&gt;writeElement('xdr:colOff', PHPExcel_Shared_Drawing::pixelsToEMU($pDrawing-&gt;getOffsetX()));\n+                    $objWriter-&gt;writeElement('xdr:row', $aCoordinates[1] - 1);\n+                    $objWriter-&gt;writeElement('xdr:rowOff', PHPExcel_Shared_Drawing::pixelsToEMU($pDrawing-&gt;getOffsetY()));\n+                $objWriter-&gt;endElement();\n+\n+                // xdr:to\n+                $objWriter-&gt;startElement('xdr:to');\n+                    $objWriter-&gt;writeElement('xdr:col', $aCoordinatesTO[0] - 1);\n+                    $objWriter-&gt;writeElement('xdr:colOff', PHPExcel_Shared_Drawing::pixelsToEMU($pDrawing-&gt;getToOffsetX()));\n+                    $objWriter-&gt;writeElement('xdr:row', $aCoordinatesTO[1] - 1);\n+                    $objWriter-&gt;writeElement('xdr:rowOff', PHPExcel_Shared_Drawing::pixelsToEMU($pDrawing-&gt;getToOffsetY()));\n+                $objWriter-&gt;endElement();\n+           }\n+           else {\n            // xdr:oneCellAnchor\n            $objWriter-&gt;startElement('xdr:oneCellAnchor');\n                // Image location\n@@ -191,6 +217,7 @@\n                    $objWriter-&gt;writeAttribute('cx', PHPExcel_Shared_Drawing::pixelsToEMU($pDrawing-&gt;getWidth()));\n                    $objWriter-&gt;writeAttribute('cy', PHPExcel_Shared_Drawing::pixelsToEMU($pDrawing-&gt;getHeight()));\n                $objWriter-&gt;endElement();\n+           }\n \n                // xdr:pic\n                $objWriter-&gt;startElement('xdr:pic');\n</code></pre>\n\n",
    "PostedDate": "2015-04-21T09:23:39.103-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]