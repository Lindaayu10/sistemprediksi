[
  {
    "Id": "912598",
    "ThreadId": "395522",
    "Html": "\r\n<p>Hi,</p>\r\n<p>I have an XLSX file with a special cell and i want to convert it to HTML. In this cell i have some text with special format, i have line return (ALT &#43; Enter), i have bold, underline and italic...</p>\r\n<p>How can i convert this cell with PHPExcel ?</p>\r\n<p>I tried something like this :</p>\r\n<p>&nbsp;</p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre>$objRichText = <span style=\"color:blue\">new</span> PHPExcel_RichText($objWorksheet-&gt;getCellByColumnAndRow(1, $l));\r\n\t\t\t$elements = $objRichText-&gt;getRichTextElements();\r\n\t\t\t$s = <span style=\"color:#a31515\">&quot;&quot;</span>;\r\n\r\n\t\t\t<span style=\"color:blue\">foreach</span> ($elements <span style=\"color:blue\">as</span> $elt) {\r\n\t\t\t\r\n\t\t\t\t<span style=\"color:blue\">if</span> ($elt-&gt;getText() != <span style=\"color:#a31515\">&quot;&quot;</span>){\r\n\t\t\t\t\t$txt = $elt-&gt;getText();\r\n\t\t\t\t\t<span style=\"color:blue\">if</span> ($elt-&gt;getFont()-&gt;getBold()){\r\n\t\t\t\t\t\t$txt = <span style=\"color:#a31515\">&quot;&lt;strong&gt;&quot;</span> . $txt . <span style=\"color:#a31515\">&quot;&lt;/strong&gt;&quot;</span>;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t<span style=\"color:blue\">if</span> ($elt-&gt;getFont()-&gt;getItalic()){\r\n\t\t\t\t\t\t$txt = <span style=\"color:#a31515\">&quot;&lt;i&gt;&quot;</span> . $txt . <span style=\"color:#a31515\">&quot;&lt;/i&gt;&quot;</span>;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t<span style=\"color:blue\">if</span> ($elt-&gt;getFont()-&gt;getUnderline()){\r\n\t\t\t\t\t\t$txt = <span style=\"color:#a31515\">&quot;&lt;u&gt;&quot;</span> . $txt . <span style=\"color:#a31515\">&quot;&lt;/u&gt;&quot;</span>;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t$s .= $txt;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t$s = str_replace(<span style=\"color:#a31515\">&quot;\\r\\n&quot;</span>,<span style=\"color:#a31515\">&quot;&lt;br/&gt;&quot;</span>, $s);\r\n</pre>\r\n</div>\r\n<p>&nbsp;</p>\r\n<p>But it's doesn't work very well :</p>\r\n<p></p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre><span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">u</span><span style=\"color:blue\">&gt;</span><span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">strong</span><span style=\"color:blue\">&gt;</span>bold\r\niltalic\r\nunderline<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">strong</span><span style=\"color:blue\">&gt;</span><span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">u</span><span style=\"color:blue\">&gt;</span>\r\n<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">u</span><span style=\"color:blue\">&gt;</span><span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">strong</span><span style=\"color:blue\">&gt;</span>bold\r\niltalic\r\nunderline<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">strong</span><span style=\"color:blue\">&gt;</span><span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">u</span><span style=\"color:blue\">&gt;</span>\r\n</pre>\r\n</div>\r\n<p></p>\r\n<p>Looks like my cell is not splitted into 3 elements...</p>\r\n<p>It's my code or it's not working ?</p>\r\n<p>&nbsp;</p>\r\n<p>Thanks</p>\r\n<p>Guldil</p>\r\n",
    "PostedDate": "2012-09-14T04:04:23.533-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]