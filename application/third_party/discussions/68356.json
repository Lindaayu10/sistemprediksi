[
  {
    "Id": "232501",
    "ThreadId": "68356",
    "Html": "<p>Hi,</p>\r\n<p>I created a script that will write a new pdf file if it exceed the record limit.. since i upgraded phpexcel i encountered this problem.. Can anyone help me thanks ;)</p>\r\n<p>&nbsp;</p>\r\n<p>&lt;div style=&quot;border:1px solid #990000;padding-left:20px;margin:0 0 10px 0;&quot;&gt;<br><br>&lt;h4&gt;A PHP Error was encountered&lt;/h4&gt;<br><br>&lt;p&gt;Severity: Notice&lt;/p&gt;<br>&lt;p&gt;Message:&nbsp; Undefined offset:&nbsp; 7&lt;/p&gt;<br>&lt;p&gt;Filename: libraries/PHPExcel.php&lt;/p&gt;<br>&lt;p&gt;Line Number: 555&lt;/p&gt;<br><br>&lt;/div&gt;&lt;div style=&quot;border:1px solid #990000;padding-left:20px;margin:0 0 10px 0;&quot;&gt;<br><br>&lt;h4&gt;A PHP Error was encountered&lt;/h4&gt;<br><br>&lt;p&gt;Severity: Warning&lt;/p&gt;<br>&lt;p&gt;Message:&nbsp; __clone method called on non-object&lt;/p&gt;<br>&lt;p&gt;Filename: PHPExcel/Style.php&lt;/p&gt;<br>&lt;p&gt;Line Number: 504&lt;/p&gt;<br><br>&lt;/div&gt;&lt;br /&gt;<br>&lt;b&gt;Fatal error&lt;/b&gt;:&nbsp; Call to a member function applyFromArray() on a non-object in &lt;b&gt;/var/www/rex/mcs/system/application/libraries/PHPExcel/Style.php&lt;/b&gt; on line &lt;b&gt;505&lt;/b&gt;&lt;br /&gt;</p>",
    "PostedDate": "2009-09-08T20:38:58.147-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "232510",
    "ThreadId": "68356",
    "Html": "<p>I'm afraid we will have to see your full script. So far I have no idea what is causing this. Can you post it?</p>",
    "PostedDate": "2009-09-08T20:53:39.393-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "232530",
    "ThreadId": "68356",
    "Html": "<p>&nbsp;Here's the code. I noticed that the errors were caused by style. I removed all style and it worked.&nbsp; I cant figure out whats or where the&nbsp; error is. Some style (setbold) works. but when i use it again it doesnt. I am confused and i dont have any idea how to debug it.&nbsp; Please help me.... thank you</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $this-&gt;excel-&gt;workbook-&gt;setActiveSheetIndex(0);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$this-&gt;excel-&gt;workbook-&gt;getActiveSheet()-&gt;getColumnDimension('A')-&gt;setWidth(22);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$this-&gt;excel-&gt;workbook-&gt;getActiveSheet()-&gt;getColumnDimension('B')-&gt;setWidth(30);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$this-&gt;excel-&gt;workbook-&gt;getActiveSheet()-&gt;getColumnDimension('C')-&gt;setWidth(25);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$this-&gt;excel-&gt;workbook-&gt;getActiveSheet()-&gt;getColumnDimension('D')-&gt;setWidth(25);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$this-&gt;excel-&gt;workbook-&gt;getActiveSheet()-&gt;getColumnDimension('E')-&gt;setWidth(20);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$this-&gt;excel-&gt;workbook-&gt;getActiveSheet()-&gt;getColumnDimension('F')-&gt;setWidth(30);</p>\r\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $this-&gt;excel-&gt;workbook-&gt;getActiveSheet()-&gt;SetCellValue('A3', 'CUST AC NO');<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$this-&gt;excel-&gt;workbook-&gt;getActiveSheet()-&gt;SetCellValue('B3', 'MOBTEL');<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$this-&gt;excel-&gt;workbook-&gt;getActiveSheet()-&gt;SetCellValue('C3', 'MSF');<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$this-&gt;excel-&gt;workbook-&gt;getActiveSheet()-&gt;SetCellValue('D3', 'AUR');<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$this-&gt;excel-&gt;workbook-&gt;getActiveSheet()-&gt;SetCellValue('E3', 'IDD');<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$this-&gt;excel-&gt;workbook-&gt;getActiveSheet()-&gt;SetCellValue('F3', 'NDD');</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; foreach ($query-&gt;result() as $row)<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;{</p>\r\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if($limit_records == $recperpage)<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; //start new file<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; $currfile++;<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; $filename = $corp_id.&quot;_Report_&quot;.$filenameCtr.$fextension;<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp; $this-&gt;excel-&gt;write($filename,$rtype,$targetFolder);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; &nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; exec('touch '.$targetFolder.$filename);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $this-&gt;zip-&gt;read_file($targetFolder.$filename);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp; <br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;</p>\r\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $this-&gt;excel-&gt;workbook-&gt;setActiveSheetIndex(0);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; $this-&gt;excel-&gt;workbook-&gt;getActiveSheet()-&gt;getColumnDimension('A')-&gt;setWidth(22);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $this-&gt;excel-&gt;workbook-&gt;getActiveSheet()-&gt;getColumnDimension('B')-&gt;setWidth(30);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $this-&gt;excel-&gt;workbook-&gt;getActiveSheet()-&gt;getColumnDimension('C')-&gt;setWidth(25);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $this-&gt;excel-&gt;workbook-&gt;getActiveSheet()-&gt;getColumnDimension('D')-&gt;setWidth(25);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $this-&gt;excel-&gt;workbook-&gt;getActiveSheet()-&gt;getColumnDimension('E')-&gt;setWidth(20);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $this-&gt;excel-&gt;workbook-&gt;getActiveSheet()-&gt;getColumnDimension('F')-&gt;setWidth(30);</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; $this-&gt;excel-&gt;workbook-&gt;getActiveSheet()-&gt;getStyle('A2')-&gt;getFont()-&gt;setBold(true);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; $this-&gt;excel-&gt;workbook-&gt;getActiveSheet()-&gt;getStyle('A2')-&gt;getFont()-&gt;setSize('7');<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$this-&gt;excel-&gt;workbook-&gt;getActiveSheet()-&gt;mergeCells('A2:Q2');<br><br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; $this-&gt;excel-&gt;workbook-&gt;getActiveSheet()-&gt;getStyle('A3')-&gt;getFont()-&gt;getColor()-&gt;setARGB(PHPExcel_Style_Color::COLOR_WHITE);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; $this-&gt;excel-&gt;workbook-&gt;getActiveSheet()-&gt;getStyle('A3')-&gt;getFont()-&gt;setSize('7');<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$this-&gt;excel-&gt;workbook-&gt;getActiveSheet()-&gt;getStyle('A3')-&gt;getFill()-&gt;setFillType(PHPExcel_Style_Fill::FILL_SOLID);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$this-&gt;excel-&gt;workbook-&gt;getActiveSheet()-&gt;getStyle('A3')-&gt;getFill()-&gt;getStartColor()-&gt;setARGB('FF54687C');<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$this-&gt;excel-&gt;workbook-&gt;getActiveSheet()-&gt;getStyle('A3')-&gt;getAlignment()-&gt;setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_CENTER);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$this-&gt;excel-&gt;workbook-&gt;getActiveSheet()-&gt;duplicateStyle( $this-&gt;excel-&gt;workbook-&gt;getActiveSheet()-&gt;getStyle('A3'), 'B3:Q3' );</p>\r\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $this-&gt;excel-&gt;workbook-&gt;getActiveSheet()-&gt;SetCellValue('A3', 'CUST AC NO');<br> &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $this-&gt;excel-&gt;workbook-&gt;getActiveSheet()-&gt;SetCellValue('B3', 'MOBTEL');<br> &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $this-&gt;excel-&gt;workbook-&gt;getActiveSheet()-&gt;SetCellValue('C3', 'MSF');<br> &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $this-&gt;excel-&gt;workbook-&gt;getActiveSheet()-&gt;SetCellValue('D3', 'AUR');<br> &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; $this-&gt;excel-&gt;workbook-&gt;getActiveSheet()-&gt;SetCellValue('E3', 'IDD');<br> &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $this-&gt;excel-&gt;workbook-&gt;getActiveSheet()-&gt;SetCellValue('F3', 'NDD');</p>\r\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }//end if</p>\r\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }//end foreach</p>\r\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //save to pdf</p>\r\n<p>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; $filename = $corp_id.&quot;_Report_&quot;.$filenameCtr.$fextension;<br> &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp; $this-&gt;excel-&gt;write($filename,$rtype,$targetFolder);<br> &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; &nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; exec('touch '.$targetFolder.$filename);<br> &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $this-&gt;zip-&gt;read_file($targetFolder.$filename);</p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2009-09-08T22:16:46.87-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "232640",
    "ThreadId": "68356",
    "Html": "<p>Hmm... I cannot see anything wrong here. Not sure what how your read_file and write methods are working?</p>\r\n<p>What we will need is really a script so we can reporduce the error ourselves. Can you try to narrow down the problem by removing as much code as possible until you have the smallest script that still produces the error? That will perhaps give us a pointer whether there is a bug in PHPExcel or not.</p>",
    "PostedDate": "2009-09-09T05:22:57.963-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "232655",
    "ThreadId": "68356",
    "Html": "<p><strong>here's the read and write script. I am using code igniter and i made a library for phpexcel.</strong></p>\r\n<p>&nbsp;</p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre><span style=\"color:Blue\">class</span> Excel\r\n{\r\n    <span style=\"color:Blue\">var</span> $workbook;\r\n    <span style=\"color:Blue\">var</span> $reader;\r\n    <span style=\"color:Blue\">var</span> $writer;\r\n\r\n    <span style=\"color:Blue\">function</span> __construct()\r\n    {\r\n        set_include_path(get_include_path() . PATH_SEPARATOR . realpath(dirname(<span style=\"color:Blue\">__FILE__</span>)) );\r\n\r\n        <span style=\"color:Blue\">require_once</span>(<span style=\"color:#A31515\">'PHPExcel.php'</span>);\r\n        <span style=\"color:Blue\">require_once</span>(<span style=\"color:#A31515\">'PHPExcel/IOFactory.php'</span>);\r\n\r\n        $this-&gt;workbook = <span style=\"color:Blue\">new</span> PHPExcel();\r\n    }\r\n\r\n    <span style=\"color:Blue\">function</span> read($filename)\r\n    {\r\n        $this-&gt;reader = PHPExcel_IOFactory::createReader(<span style=\"color:#A31515\">'Excel5'</span>);\r\n        $this-&gt;workbook = $this-&gt;reader-&gt;load($filename);\r\n    }\r\n\r\n    <span style=\"color:Blue\">function</span> write($filename, $format = <span style=\"color:#A31515\">'Excel5'</span>, $targerDir = <span style=\"color:#A31515\">'/tmp/'</span>)\r\n    {\r\n        $this-&gt;writer = PHPExcel_IOFactory::createWriter($this-&gt;workbook, $format);\r\n        $this-&gt;writer-&gt;save($targerDir . $filename);\r\n    }\r\n }\r\n</pre>\r\n</div>\r\n<p>&nbsp;</p>\r\n<p><strong>Before i added style, i was working on &quot;multiple file generation&quot;. it limits the data stored in pdf file and writes the remaining data into a new so that it wont use too much memory.. The script already works perfectly without style. I didnt noticed that when i added style the &quot;multiple file generation&quot; script didnt work.</strong></p>\r\n<p>&nbsp;</p>\r\n<p><strong>here's a simplier script:</strong></p>\r\n<p>&nbsp;</p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre>    <span style=\"color:Green\">//start page</span>\r\n\r\n                        $this-&gt;excel-&gt;workbook-&gt;setActiveSheetIndex(0);\r\n                        $this-&gt;excel-&gt;workbook-&gt;getActiveSheet()-&gt;SetCellValue(<span style=\"color:#A31515\">'A1'</span>, <span style=\"color:#A31515\">'MONTHLY'</span> .$month.<span style=\"color:#A31515\">&quot;/&quot;</span>.$year);\r\n                        $this-&gt;excel-&gt;workbook-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#A31515\">'A1'</span>)-&gt;getFont()-&gt;setBold(true);\r\n                        $this-&gt;excel-&gt;workbook-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#A31515\">'A1'</span>)-&gt;getFont()-&gt;setSize(<span style=\"color:#A31515\">'14'</span>);\r\n                        $this-&gt;excel-&gt;workbook-&gt;getActiveSheet()-&gt;duplicateStyle( $this-&gt;excel-&gt;workbook-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#A31515\">'A1'</span>), <span style=\"color:#A31515\">'B1:K1'</span>);\r\n                         $this-&gt;excel-&gt;workbook-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#A31515\">'A1'</span>)-&gt;getFont()-&gt;getColor()-&gt;setARGB(PHPExcel_Style_Color::COLOR_WHITE);\r\n                            $this-&gt;excel-&gt;workbook-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#A31515\">'A1'</span>)-&gt;getFont()-&gt;setSize(<span style=\"color:#A31515\">'9'</span>);\r\n                            $this-&gt;excel-&gt;workbook-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#A31515\">'A1'</span>)-&gt;getFill()-&gt;setFillType(PHPExcel_Style_Fill::FILL_SOLID);\r\n                            $this-&gt;excel-&gt;workbook-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#A31515\">'A1'</span>)-&gt;getFill()-&gt;getStartColor()-&gt;setARGB(<span style=\"color:#A31515\">'FF54687C'</span>);\r\n\r\n                       $this-&gt;excel-&gt;write(<span style=\"color:#A31515\">'filename'</span>,<span style=\"color:#A31515\">'pdf'</span>,<span style=\"color:#A31515\">'var/www/test/'</span>);\r\n\r\n         <span style=\"color:Green\">/*\r\n            //start page / file again\r\n            // this is where the problem occurr.\r\n            // It wont accept style..\r\n       */</span>\r\n\r\n<br>                        $this-&gt;excel-&gt;workbook-&gt;setActiveSheetIndex(0);\r\n                        $this-&gt;excel-&gt;workbook-&gt;getActiveSheet()-&gt;SetCellValue(<span style=\"color:#A31515\">'A1'</span>, <span style=\"color:#A31515\">'MONTHLY'</span> .$month.<span style=\"color:#A31515\">&quot;/&quot;</span>.$year);\r\n                        $this-&gt;excel-&gt;workbook-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#A31515\">'A1'</span>)-&gt;getFont()-&gt;setBold(true);\r\n                        $this-&gt;excel-&gt;workbook-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#A31515\">'A1'</span>)-&gt;getFont()-&gt;setSize(<span style=\"color:#A31515\">'14'</span>);\r\n                        $this-&gt;excel-&gt;workbook-&gt;getActiveSheet()-&gt;duplicateStyle( $this-&gt;excel-&gt;workbook-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#A31515\">'A1'</span>), <span style=\"color:#A31515\">'B1:K1'</span>);\r\n                         $this-&gt;excel-&gt;workbook-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#A31515\">'A1'</span>)-&gt;getFont()-&gt;getColor()-&gt;setARGB(PHPExcel_Style_Color::COLOR_WHITE);\r\n                            $this-&gt;excel-&gt;workbook-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#A31515\">'A1'</span>)-&gt;getFont()-&gt;setSize(<span style=\"color:#A31515\">'9'</span>);\r\n                            $this-&gt;excel-&gt;workbook-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#A31515\">'A1'</span>)-&gt;getFill()-&gt;setFillType(PHPExcel_Style_Fill::FILL_SOLID);\r\n                            $this-&gt;excel-&gt;workbook-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#A31515\">'A1'</span>)-&gt;getFill()-&gt;getStartColor()-&gt;setARGB(<span style=\"color:#A31515\">'FF54687C'</span>);\r\n\r\n                        $this-&gt;excel-&gt;write(<span style=\"color:#A31515\">'filename'</span>,<span style=\"color:#A31515\">'pdf'</span>,<span style=\"color:#A31515\">'var/www/test/'</span>);\r\n<br><br><strong>is there a proper way to start a new page again?</strong> <strong><br>If you have any debugging technique can you please share it. thanks</strong></pre>\r\n</div>\r\n<p>&nbsp;</p>\r\n<p><br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp; <br>&nbsp; <br></p>",
    "PostedDate": "2009-09-09T06:11:56.08-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "232672",
    "ThreadId": "68356",
    "Html": "<p>Hi vile, I have tried various tests, but failed to reproduce the error. I realize it will be difficult to find the error by inspecting code here in the forum.</p>\r\n<p>If you can give me temporary FTP access to some test site this can probably be resolved quickly. We have done that before. Please send message to: (erik at phpexcel dot net)</p>",
    "PostedDate": "2009-09-09T07:00:16.207-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "232922",
    "ThreadId": "68356",
    "Html": "<p>good day!</p>\r\n<p>i found where the problem is. I made few testing script.. Since i am using the same object and im just overwriting the contents of it, I noticed that cell style cannot be overwrite. <br>In the first file i already added styles, these styles were also used in the 2nd file, even though i didn't add style in file 2. I'm guessing that it automatically use the cell style in file 1. This might cause some problem if the contents in file 2 is different from file 1, styles may vary in contents.. can you please verify if i am right...&nbsp; thanks!!</p>",
    "PostedDate": "2009-09-09T20:37:30.783-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "232926",
    "ThreadId": "68356",
    "Html": "<p>I think you may have a point although I'm not sure what the exact cause is.<br> <br>Try to avoid using <span style=\"font-family:Courier New\">duplicateStyle()</span>. Perhaps it is giving problems.<br> <br> Instead of this:<br> <br>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre>$this-&gt;excel-&gt;workbook-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#A31515\">'A1'</span>)-&gt;getFont()-&gt;setBold(true);\r\n$this-&gt;excel-&gt;workbook-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#A31515\">'A1'</span>)-&gt;getFont()-&gt;setSize(<span style=\"color:#A31515\">'14'</span>);\r\n$this-&gt;excel-&gt;workbook-&gt;getActiveSheet()-&gt;duplicateStyle( $this-&gt;excel-&gt;workbook-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#A31515\">'A1'</span>), <span style=\"color:#A31515\">'B1:K1'</span>);\r\n</pre>\r\n</div>\r\n<br> Do like this:<br>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre>\r\n$this-&gt;excel-&gt;workbook-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#A31515\">'A1:K1'</span>)-&gt;getFont()-&gt;setBold(true);\r\n$this-&gt;excel-&gt;workbook-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#A31515\">'A1:K1'</span>)-&gt;getFont()-&gt;setSize(<span style=\"color:#A31515\">'14'</span>);\r\n</pre>\r\n</div>\r\n<br> That is safer, and is the recommended way to style a cell range in PHPExcel 1.7.0.<br> <br> Can you test and see if the error goes away?</p>",
    "PostedDate": "2009-09-09T21:12:08.353-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "232956",
    "ThreadId": "68356",
    "Html": "<p>ok i changed all duplicatestyle but still not working is there a function to reset all cell format?</p>",
    "PostedDate": "2009-09-09T23:18:31.847-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "232982",
    "ThreadId": "68356",
    "Html": "<p>its all ok now. sorry for the commotion. i just made another phpexcel object. ;)</p>",
    "PostedDate": "2009-09-10T00:52:43.487-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "233132",
    "ThreadId": "68356",
    "Html": "<p>Thanks to your last comments I am finally able to reproduce this. Work item created:</p>\r\n<p><a href=\"http://phpexcel.codeplex.com/WorkItem/View.aspx?WorkItemId=10617\">http://phpexcel.codeplex.com/WorkItem/View.aspx?WorkItemId=10617</a></p>\r\n<p>I will try to see if I can get this fixed at the end of this week.</p>",
    "PostedDate": "2009-09-10T08:06:09.86-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]