[
  {
    "Id": "704688",
    "ThreadId": "281163",
    "Html": "\r\n<p>First of all, thanks you for your work, is perfect. <br>\r\nI'm trying to test the example of 01simple-download-xls.php, and it work's but when I try to include the configuration file of the database that it has the server user and password, the example doesn't work because the output .xls file is corrupt.<br>\r\nI will be very glad if someone can help me.<br>\r\nThank you</p>\r\n<p></p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre>&lt;?php\r\n\r\n<span style=\"color:green\">// I have only added this line</span>\r\n<span style=\"color:blue\">require</span> <span style=\"color:#a31515\">'conf/configBD.inc'</span>;\r\n\r\n\r\n<span style=\"color:green\">/** Error reporting */</span>\r\nerror_reporting(E_ALL);\r\n\r\ndate_default_timezone_set(<span style=\"color:#a31515\">'Europe/London'</span>);\r\n\r\n<span style=\"color:green\">/** PHPExcel */</span>\r\n<span style=\"color:blue\">require_once</span> <span style=\"color:#a31515\">'../Classes/PHPExcel.php'</span>;\r\n\r\n\r\n<span style=\"color:green\">// Create new PHPExcel object</span>\r\n$objPHPExcel = <span style=\"color:blue\">new</span> PHPExcel();\r\n\r\n<span style=\"color:green\">// Set properties</span>\r\n$objPHPExcel-&gt;getProperties()-&gt;setCreator(<span style=\"color:#a31515\">&quot;Maarten Balliauw&quot;</span>)\r\n\t\t\t\t\t\t\t -&gt;setLastModifiedBy(<span style=\"color:#a31515\">&quot;Maarten Balliauw&quot;</span>)\r\n\t\t\t\t\t\t\t -&gt;setTitle(<span style=\"color:#a31515\">&quot;Office 2007 XLSX Test Document&quot;</span>)\r\n\t\t\t\t\t\t\t -&gt;setSubject(<span style=\"color:#a31515\">&quot;Office 2007 XLSX Test Document&quot;</span>)\r\n\t\t\t\t\t\t\t -&gt;setDescription(<span style=\"color:#a31515\">&quot;Test document for Office 2007 XLSX, generated using PHP classes.&quot;</span>)\r\n\t\t\t\t\t\t\t -&gt;setKeywords(<span style=\"color:#a31515\">&quot;office 2007 openxml php&quot;</span>)\r\n\t\t\t\t\t\t\t -&gt;setCategory(<span style=\"color:#a31515\">&quot;Test result file&quot;</span>);\r\n\r\n\r\n<span style=\"color:green\">// Add some data</span>\r\n$objPHPExcel-&gt;setActiveSheetIndex(0)\r\n            -&gt;setCellValue(<span style=\"color:#a31515\">'A1'</span>, <span style=\"color:#a31515\">'Hello'</span>)\r\n            -&gt;setCellValue(<span style=\"color:#a31515\">'B2'</span>, <span style=\"color:#a31515\">'world!'</span>)\r\n            -&gt;setCellValue(<span style=\"color:#a31515\">'C1'</span>, <span style=\"color:#a31515\">'Hello'</span>)\r\n            -&gt;setCellValue(<span style=\"color:#a31515\">'D2'</span>, <span style=\"color:#a31515\">'world!'</span>);\r\n\r\n<span style=\"color:green\">// Miscellaneous glyphs, UTF-8</span>\r\n$objPHPExcel-&gt;setActiveSheetIndex(0)\r\n            -&gt;setCellValue(<span style=\"color:#a31515\">'A4'</span>, <span style=\"color:#a31515\">'Miscellaneous glyphs'</span>)\r\n            -&gt;setCellValue(<span style=\"color:#a31515\">'A5'</span>, <span style=\"color:#a31515\">'�����������������'</span>);\r\n\r\n<span style=\"color:green\">// Rename sheet</span>\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setTitle(<span style=\"color:#a31515\">'Simple'</span>);\r\n\r\n\r\n<span style=\"color:green\">// Set active sheet index to the first sheet, so Excel opens this as the first sheet</span>\r\n$objPHPExcel-&gt;setActiveSheetIndex(0);\r\n\r\n\r\n<span style=\"color:green\">// Redirect output to a client�s web browser (Excel5)</span>\r\nheader(<span style=\"color:#a31515\">'Content-Type: application/vnd.ms-excel'</span>);\r\nheader(<span style=\"color:#a31515\">'Content-Disposition: attachment;filename=&quot;01simple.xls&quot;'</span>);\r\nheader(<span style=\"color:#a31515\">'Cache-Control: max-age=0'</span>);\r\n\r\n$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, <span style=\"color:#a31515\">'Excel5'</span>);\r\n$objWriter-&gt;save(<span style=\"color:#a31515\">'php://output'</span>);\r\n<span style=\"color:blue\">exit</span>;\r\n</pre>\r\n</div>\r\n<p></p>\r\n<p>I have only added this line:</p>\r\n<pre><span style=\"color:blue\">require</span> <span style=\"color:#a31515\">'conf/configBD.inc'</span>;<br><br>That file has this information<br><div style=\"color:black; background-color:white\"><pre>&lt;?php\r\n  \tdefine ( <span style=\"color:#a31515\">'serverName'</span>, <span style=\"color:#a31515\">'192.xx.x.xx\\cco'</span> );\r\n\tdefine ( <span style=\"color:#a31515\">'serverUser'</span>, <span style=\"color:#a31515\">'user'</span> );\r\n\tdefine ( <span style=\"color:#a31515\">'serverPassword'</span>, <span style=\"color:#a31515\">'password'</span> );\r\n\tdefine ( <span style=\"color:#a31515\">'Database'</span>, <span style=\"color:#a31515\">'database'</span> );\r\n\r\n?&gt; \r\n</pre>\r\n</div>\r\n</pre>\r\n",
    "PostedDate": "2011-11-29T03:58:20.913-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "704704",
    "ThreadId": "281163",
    "Html": "<p>Hi,</p>\r\n<p>&nbsp;</p>\r\n<p>i'm guessing that either yoru have some white space in your db config, or perhaps a notice somewhere, caused by the error reporting.</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2011-11-29T04:58:07.813-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "704712",
    "ThreadId": "281163",
    "Html": "<blockquote style=\"border: solid .1em #ccc; font-style: italic; margin: .25em 1em 0 1em; padding: 0 .25em 0 .25em;\"><strong>borft wrote:</strong><br />\r\n<p>Hi,</p>\r\n<p>&nbsp;</p>\r\n<p>i'm guessing that either yoru have some white space in your db config, or perhaps a notice somewhere, caused by the error reporting.</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n</blockquote>\r\n<p>Hi borft</p>\r\n<p>Thank you for your response. I did that you say, I deleted the white space and deleted the error reporthing and doesn't work :( . How i can know if error reporting is writing some notice?<br /><br /></p>",
    "PostedDate": "2011-11-29T05:18:25.877-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "704724",
    "ThreadId": "281163",
    "Html": "<p>try unzipping the generated .xlsx file. If that doesn't work, try opening the .xlsx file in a text editor and look for notices.</p>\r\n<p>&nbsp;</p>\r\n<p>Another option is to save the output to a different file (for example /tmp/test.xlsx in stead of php://stdout). That way the notices/warnings/errors will be sent to stdout, but the xlsx output will be written to file.</p>",
    "PostedDate": "2011-11-29T05:35:04.177-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "704739",
    "ThreadId": "281163",
    "Html": "<blockquote style=\"border: solid .1em #ccc; font-style: italic; margin: .25em 1em 0 1em; padding: 0 .25em 0 .25em;\"><strong>borft wrote:</strong><br />\r\n<p>try unzipping the generated .xlsx file. If that doesn't work, try opening the .xlsx file in a text editor and look for notices.</p>\r\n<p>&nbsp;</p>\r\n<p>Another option is to save the output to a different file (for example /tmp/test.xlsx in stead of php://stdout). That way the notices/warnings/errors will be sent to stdout, but the xlsx output will be written to file.</p>\r\n</blockquote>\r\n<p>I tried to find some notice in the file an didn&acute;t find, so I change this:</p>\r\n<p>\r\n<div style=\"color: black; background-color: white;\">\r\n<pre>$objWriter-&gt;save(<span style=\"color: #a31515;\">'php://output'</span>);\r\n</pre>\r\n</div>\r\n</p>\r\n<p>For this:</p>\r\n<p>\r\n<div style=\"color: black; background-color: white;\">\r\n<pre>$objWriter-&gt;save(<span style=\"color: #a31515;\">'php://stdout'</span>);\r\n</pre>\r\n</div>\r\n</p>\r\n<p>And the output .xls are empty.</p>\r\n<p>Then I changed for this:</p>\r\n<p>\r\n<div style=\"color: black; background-color: white;\">\r\n<pre>$objWriter-&gt;save(<span style=\"color: #a31515;\">'/tmp/test.xlsx'</span>);\r\n</pre>\r\n</div>\r\n</p>\r\n<p>And the output .xls has this notice:</p>\r\n<p>&lt;b&gt;Fatal error&lt;/b&gt;:&nbsp; Uncaught exception 'Exception' with message 'Can't open /tmp/test.xlsx. It may be in use or protected.' in C:\\Guarita\\LoginPrincipal\\servicios\\1.7.6\\Classes\\PHPExcel\\Shared\\OLE\\PPS\\Root.php:91</p>\r\n<p>Stack trace:</p>\r\n<p>#0 C:\\Guarita\\LoginPrincipal\\servicios\\1.7.6\\Classes\\PHPExcel\\Writer\\Excel5.php(185): PHPExcel_Shared_OLE_PPS_Root-&amp;gt;save('/tmp/test.xlsx')</p>\r\n<p>#1 C:\\Guarita\\LoginPrincipal\\gerarRelatorioVeiculos.php(55): PHPExcel_Writer_Excel5-&amp;gt;save('/tmp/test.xlsx')</p>\r\n<p>#2 {main}</p>\r\n<p>&nbsp; thrown in &lt;b&gt;C:\\Guarita\\LoginPrincipal\\servicios\\1.7.6\\Classes\\PHPExcel\\Shared\\OLE\\PPS\\Root.php&lt;/b&gt; on line &lt;b&gt;91&lt;/b&gt;&lt;br /&gt;</p>\r\n<p>&nbsp;</p>\r\n<p>Thank you for your responses</p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2011-11-29T06:02:31.633-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]