[
  {
    "Id": "276333",
    "ThreadId": "80599",
    "Html": "<p>This looks like a fantastic tool! I've been through a couple of the test scripts but do not see the ability to directly output an HTML table to an Excel (XLS or XLSX) file. Am I correct in assuming that I will need to iterate through the table, extract data and formatting and create a PHPExcel object as I go? Do you have an example of such a script? How will various colspans be handled?</p>",
    "PostedDate": "2010-01-12T11:29:39.52-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "276686",
    "ThreadId": "80599",
    "Html": "<p>I think I have this figured out using ByColumnAndRow and mergeCells. Will check back in if I need more assistance.&nbsp; Thanks!</p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre><br></pre>\r\n</div>",
    "PostedDate": "2010-01-13T07:13:15.397-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "276915",
    "ThreadId": "80599",
    "Html": "<p>We unfortunately don't have the ability to read HTML tables using PHPExcel. Perhaps we should start looking into creating PHPExcel_Reader_HTML. There have been a couple of requests.</p>",
    "PostedDate": "2010-01-13T16:46:44.14-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "277418",
    "ThreadId": "80599",
    "Html": "<p>Ok, so here's my dilemna... I have figured out how to dynamically create my XLS spreadsheet using PHPExcel with the following code:</p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre>          $objML-&gt;setActiveSheetIndex(0);\r\n          <span style=\"color:Green\">// set default spreadsheet layout options</span>\r\n          $objML-&gt;getDefaultStyle()-&gt;getFont()-&gt;setName(<span style=\"color:#A31515\">'Calibri'</span>);\r\n          $objML-&gt;getDefaultStyle()-&gt;getFont()-&gt;setSize(11);\r\n          $objML-&gt;getActiveSheet()-&gt;getPageMargins()-&gt;setTop(1);\r\n          $objML-&gt;getActiveSheet()-&gt;getHeaderFooter()-&gt;setOddHeader(<span style=\"color:#A31515\">&quot;&amp;C&amp;B&amp;36MATERIAL LIST&quot;</span>);\r\n          $objLogo = <span style=\"color:Blue\">new</span> PHPExcel_Worksheet_HeaderFooterDrawing();\r\n          $objLogo-&gt;setName(<span style=\"color:#A31515\">'MASTEC logo'</span>);\r\n          $objLogo-&gt;setPath(<span style=\"color:#A31515\">'images/ml_logo.jpg'</span>);\r\n          $objLogo-&gt;setHeight(76);\r\n          $objML-&gt;getActiveSheet()-&gt;getHeaderFooter()-&gt;addImage($objLogo, PHPExcel_Worksheet_HeaderFooter::IMAGE_HEADER_CENTER);\r\n\r\n          <span style=\"color:Green\">// set the top of every page that repeats</span>\r\n          $objML-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#A31515\">&quot;A1&quot;</span>,<span style=\"color:#A31515\">&quot;CUSTOMER ORDER NO:&quot;</span>)\r\n                                        -&gt;setCellValue(<span style=\"color:#A31515\">&quot;E1&quot;</span>,$row[<span style=\"color:#A31515\">'teo'</span>])\r\n                                        -&gt;setCellValue(<span style=\"color:#A31515\">&quot;F1&quot;</span>,<span style=\"color:#A31515\">&quot;MASTEC ORD NO:&quot;</span>)\r\n                                        -&gt;setCellValue(<span style=\"color:#A31515\">&quot;G1&quot;</span>,$row[<span style=\"color:#A31515\">'proj_num'</span>])\r\n                                        -&gt;setCellValue(<span style=\"color:#A31515\">&quot;H1&quot;</span>,<span style=\"color:#A31515\">&quot;DATE:&quot;</span>)\r\n                                        -&gt;setCellValue(<span style=\"color:#A31515\">&quot;I1&quot;</span>,$row[<span style=\"color:#A31515\">'completed'</span>])\r\n                                        -&gt;mergeCells(<span style=\"color:#A31515\">&quot;A1:D1&quot;</span>)\r\n                                        -&gt;setCellValue(<span style=\"color:#A31515\">&quot;A2&quot;</span>,<span style=\"color:#A31515\">&quot;CLLI:&quot;</span>)\r\n                                        -&gt;setCellValue(<span style=\"color:#A31515\">&quot;E2&quot;</span>,$row[<span style=\"color:#A31515\">'clli'</span>])\r\n                                        -&gt;setCellValue(<span style=\"color:#A31515\">&quot;F2&quot;</span>,<span style=\"color:#A31515\">&quot;CITY, STATE:&quot;</span>)\r\n                                        -&gt;setCellValue(<span style=\"color:#A31515\">&quot;G2&quot;</span>,<span style=\"color:#A31515\">&quot;$citystate&quot;</span>)\r\n                                        -&gt;setCellValue(<span style=\"color:#A31515\">&quot;H2&quot;</span>,<span style=\"color:#A31515\">&quot;APPX:&quot;</span>)\r\n                                        -&gt;setCellValue(<span style=\"color:#A31515\">&quot;I2&quot;</span>,$row[<span style=\"color:#A31515\">'appx'</span>])\r\n                                        -&gt;mergeCells(<span style=\"color:#A31515\">&quot;A2:D2&quot;</span>)\r\n                                        -&gt;setCellValue(<span style=\"color:#A31515\">&quot;A3&quot;</span>,<span style=\"color:#A31515\">&quot;OP&quot;</span>)\r\n                                        -&gt;setCellValue(<span style=\"color:#A31515\">&quot;B3&quot;</span>,<span style=\"color:#A31515\">&quot;ITEM&quot;</span>)\r\n                                        -&gt;setCellValue(<span style=\"color:#A31515\">&quot;C3&quot;</span>,<span style=\"color:#A31515\">&quot;NOTE&quot;</span>)\r\n                                        -&gt;setCellValue(<span style=\"color:#A31515\">&quot;D3&quot;</span>,<span style=\"color:#A31515\">&quot;QTY&quot;</span>)\r\n                                        -&gt;setCellValue(<span style=\"color:#A31515\">&quot;E3&quot;</span>,<span style=\"color:#A31515\">&quot;MATERIAL ID&quot;</span>)\r\n                                        -&gt;setCellValue(<span style=\"color:#A31515\">&quot;F3&quot;</span>,<span style=\"color:#A31515\">&quot;MATERIAL DESCRIPTION&quot;</span>)\r\n                                        -&gt;setCellValue(<span style=\"color:#A31515\">&quot;H3&quot;</span>,<span style=\"color:#A31515\">&quot;NOTES&quot;</span>);\r\n          $objML-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#A31515\">'I2'</span>)-&gt;getNumberFormat()-&gt;setFormatCode(<span style=\"color:#A31515\">&quot;00&quot;</span>);\r\n          $objML-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#A31515\">'B4:B9999'</span>)-&gt;getNumberFormat()-&gt;setFormatCode(<span style=\"color:#A31515\">&quot;00&quot;</span>);\r\n          $objML-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#A31515\">&quot;A1:H1&quot;</span>)-&gt;getAlignment()-&gt;setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_RIGHT);\r\n          $objML-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#A31515\">&quot;A2:H2&quot;</span>)-&gt;getAlignment()-&gt;setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_RIGHT);\r\n          $objML-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#A31515\">&quot;E1&quot;</span>)-&gt;getAlignment()-&gt;setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_LEFT);\r\n          $objML-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#A31515\">&quot;G1&quot;</span>)-&gt;getAlignment()-&gt;setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_LEFT);\r\n          $objML-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#A31515\">&quot;I1&quot;</span>)-&gt;getAlignment()-&gt;setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_LEFT);\r\n          $objML-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#A31515\">&quot;E2&quot;</span>)-&gt;getAlignment()-&gt;setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_LEFT);\r\n          $objML-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#A31515\">&quot;G2&quot;</span>)-&gt;getAlignment()-&gt;setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_LEFT);\r\n          $objML-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#A31515\">&quot;I2&quot;</span>)-&gt;getAlignment()-&gt;setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_CENTER);\r\n          $objML-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#A31515\">&quot;A3:I3&quot;</span>)-&gt;getAlignment()-&gt;setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_CENTER);\r\n          $objML-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#A31515\">&quot;E3&quot;</span>)-&gt;getAlignment()-&gt;setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_LEFT);\r\n          $objML-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#A31515\">&quot;A1:I3&quot;</span>)-&gt;getFont()-&gt;setBold(true);\r\n          $objML-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#A31515\">&quot;A1:I22&quot;</span>)-&gt;getBorders()-&gt;getAllBorders()-&gt;setBorderStyle(PHPExcel_Style_Border::BORDER_THIN);\r\n          $objML-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#A31515\">&quot;A3:I3&quot;</span>)-&gt;getBorders()-&gt;getBottom()-&gt;setBorderStyle(PHPExcel_Style_Border::BORDER_THICK);\r\n          $objML-&gt;getActiveSheet()-&gt;mergeCells(<span style=\"color:#A31515\">&quot;F3:G3&quot;</span>);\r\n          $objML-&gt;getActiveSheet()-&gt;mergeCells(<span style=\"color:#A31515\">&quot;H3:I3&quot;</span>);\r\n          $objML-&gt;getActiveSheet()-&gt;getColumnDimension(<span style=\"color:#A31515\">&quot;A&quot;</span>)-&gt;setWidth(6);\r\n          $objML-&gt;getActiveSheet()-&gt;getColumnDimension(<span style=\"color:#A31515\">&quot;B&quot;</span>)-&gt;setWidth(6);\r\n          $objML-&gt;getActiveSheet()-&gt;getColumnDimension(<span style=\"color:#A31515\">&quot;C&quot;</span>)-&gt;setWidth(6);\r\n          $objML-&gt;getActiveSheet()-&gt;getColumnDimension(<span style=\"color:#A31515\">&quot;D&quot;</span>)-&gt;setWidth(6);\r\n          $objML-&gt;getActiveSheet()-&gt;getColumnDimension(<span style=\"color:#A31515\">&quot;E&quot;</span>)-&gt;setWidth(26);\r\n          $objML-&gt;getActiveSheet()-&gt;getColumnDimension(<span style=\"color:#A31515\">&quot;F&quot;</span>)-&gt;setWidth(17);\r\n          $objML-&gt;getActiveSheet()-&gt;getColumnDimension(<span style=\"color:#A31515\">&quot;G&quot;</span>)-&gt;setWidth(33);\r\n          $objML-&gt;getActiveSheet()-&gt;getColumnDimension(<span style=\"color:#A31515\">&quot;H&quot;</span>)-&gt;setWidth(6);\r\n          $objML-&gt;getActiveSheet()-&gt;getColumnDimension(<span style=\"color:#A31515\">&quot;I&quot;</span>)-&gt;setWidth(17);\r\n          $objML-&gt;getActiveSheet()-&gt;getPageSetup()-&gt;setRowsToRepeatAtTopByStartAndEnd(1,3);\r\n          <span style=\"color:Green\">// setup some default styling for the worksheet</span>\r\n          $objML-&gt;getActiveSheet()-&gt;setBreak(<span style=\"color:#A31515\">&quot;J3&quot;</span>,PHPExcel_Worksheet::BREAK_COLUMN);\r\n          $objML-&gt;getActiveSheet()-&gt;getPageSetup()-&gt;setOrientation(PHPExcel_Worksheet_PageSetup::ORIENTATION_LANDSCAPE);\r\n          $objML-&gt;getActiveSheet()-&gt;getPageSetup()-&gt;setPaperSize(PHPExcel_Worksheet_PageSetup::PAPERSIZE_LETTER);\r\n          $objML-&gt;getActiveSheet()-&gt;getPageSetup()-&gt;setFitToWidth(1);\r\n          $objML-&gt;getActiveSheet()-&gt;getPageSetup()-&gt;setFitToHeight(0);\r\n          $objML-&gt;getActiveSheet()-&gt;getSheetView()-&gt;setZoomScale(105);\r\n          $i = 0;\r\n          $page = 1;\r\n          $rowMLSheet = 3;\r\n          $total_cost = 0;\r\n          $contents = <span style=\"color:#A31515\">&quot;&lt;table id=\\&quot;ml_table\\&quot; class=\\&quot;ml_table\\&quot;&gt;&quot;</span>;\r\n          $q = <span style=\"color:#A31515\">&quot;select c.quantity as qty, c.notes, m.*, l.teo as teo, q.clli as clli, l.material_dollars as dollars, l.proj_num as proj_num, l.city as city, l.state as state,&quot;</span>;\r\n          $q .= <span style=\"color:#A31515\">&quot; l.appx as appx, date_format(l.completed,'%m/%d/%Y') as completed from materials m JOIN ml_contents c ON c.contained_item = m.id&quot;</span>;\r\n          $q .= <span style=\"color:#A31515\">&quot; JOIN material_lists l ON l.id = c.ml_id JOIN clli_info as q ON q.id = l.clli&quot;</span>;\r\n          $q .= <span style=\"color:#A31515\">&quot; where c.ml_id = '&quot;</span>.$ml_id.<span style=\"color:#A31515\">&quot;'&quot;</span>;\r\n          $r = $db-&gt;select($q);\r\n          <span style=\"color:Blue\">while</span> ($row=$db-&gt;get_row($r,<span style=\"color:#A31515\">'MYSQL_ASSOC'</span>)) {\r\n            $i++;\r\n            $rowMLSheet++;\r\n            <span style=\"color:Blue\">if</span> (($i == 1) || ($i % 19 == 0)) {\r\n              <span style=\"color:Blue\">if</span> ($i !== 1) {\r\n                mlFooterPg();\r\n                $objML-&gt;getActiveSheet()-&gt;setCellValueByColumnAndRow(1,$rowMLSheet,<span style=\"color:#A31515\">&quot;RESTRICED - PROPIETARY\\nNot for use or disclosure outside of AT&amp;T except under written agreement.&quot;</span>);\r\n                $objML-&gt;getActiveSheet()-&gt;setCellValueByColumnAndRow(8,$rowMLSheet,<span style=\"color:#A31515\">&quot;PAGE: $page&quot;</span>);\r\n                $rowMLSheet++;\r\n                $objML-&gt;getActiveSheet()-&gt;setBreak(<span style=\"color:#A31515\">&quot;I$rowMLSheet&quot;</span>,PHPExcel_Worksheet::BREAK_ROW);\r\n              }\r\n              mlHeaderPg();\r\n            }\r\n            $contents .= <span style=\"color:#A31515\">&quot;&lt;tr&gt;&quot;</span>;\r\n            $contents .= <span style=\"color:#A31515\">&quot;&lt;td class=\\&quot;op\\&quot;&gt;A&lt;/td&gt;&quot;</span>;\r\n            $objML-&gt;getActiveSheet()-&gt;setCellValueByColumnAndRow(1,$rowMLSheet,<span style=\"color:#A31515\">&quot;A&quot;</span>);\r\n            <span style=\"color:Blue\">if</span> ($i &lt; 10) { $n = <span style=\"color:#A31515\">&quot;0&quot;</span>.$i; } <span style=\"color:Blue\">else</span> { $n = $i; }\r\n            $contents .= <span style=\"color:#A31515\">&quot;&lt;td class=\\&quot;item\\&quot;&gt;&quot;</span>.$n.<span style=\"color:#A31515\">&quot;&lt;/td&gt;&quot;</span>;\r\n            $objML-&gt;getActiveSheet()-&gt;setCellValueByColumnAndRow(2,$rowMLSheet,$n);\r\n            $contents .= <span style=\"color:#A31515\">&quot;&lt;td class=\\&quot;note\\&quot;&gt; &lt;/td&gt;&quot;</span>;\r\n            $objML-&gt;getActiveSheet()-&gt;setCellValueByColumnAndRow(3,$rowMLSheet,<span style=\"color:#A31515\">&quot;   &quot;</span>);\r\n            $contents .= <span style=\"color:#A31515\">&quot;&lt;td class=\\&quot;qty\\&quot;&gt;&quot;</span>.$row[<span style=\"color:#A31515\">'qty'</span>].<span style=\"color:#A31515\">&quot;&lt;/td&gt;&quot;</span>;\r\n            $objML-&gt;getActiveSheet()-&gt;setCellValueByColumnAndRow(4,$rowMLSheet,$row[<span style=\"color:#A31515\">'qty'</span>]);\r\n            $contents .= <span style=\"color:#A31515\">&quot;&lt;td class=\\&quot;material_id\\&quot;&gt;&quot;</span>.$row[<span style=\"color:#A31515\">'mastec_partno'</span>].<span style=\"color:#A31515\">&quot;&lt;/td&gt;&quot;</span>;\r\n            $objML-&gt;getActiveSheet()-&gt;setCellValueByColumnAndRow(5,$rowMLSheet,$row[<span style=\"color:#A31515\">'mastec_partno'</span>]);\r\n            $desc = trim(addslashes($row[<span style=\"color:#A31515\">'description'</span>]));\r\n            $contents .= <span style=\"color:#A31515\">&quot;&lt;td colspan=\\&quot;2\\&quot; class=\\&quot;material_desc\\&quot; colpsan=\\&quot;2\\&quot;&gt;&quot;</span>.$desc.<span style=\"color:#A31515\">&quot;&lt;/td&gt;&quot;</span>;\r\n            $objML-&gt;getActiveSheet()-&gt;setCellValueByColumnAndRow(6,$rowMLSheet,$desc)\r\n                                    -&gt;mergeCells(<span style=\"color:#A31515\">&quot;F&quot;</span>.$rowMLSheet.<span style=\"color:#A31515\">&quot;:G&quot;</span>.$rowMLSheet);\r\n            $contents .= <span style=\"color:#A31515\">&quot;&lt;td colspan=\\&quot;2\\&quot; class=\\&quot;notes\\&quot; colspan=\\&quot;2\\&quot;&gt;&quot;</span>.$row[<span style=\"color:#A31515\">'notes'</span>].<span style=\"color:#A31515\">&quot;&lt;/td&gt;&quot;</span>;\r\n            $objML-&gt;getActiveSheet()-&gt;setCellValueByColumnAndRow(6,$rowMLSheet,$row[<span style=\"color:#A31515\">'notes'</span>])\r\n                                    -&gt;mergeCells(<span style=\"color:#A31515\">&quot;H&quot;</span>.$rowMLSheet.<span style=\"color:#A31515\">&quot;:I&quot;</span>.$rowMLSheet);\r\n            $contents .= <span style=\"color:#A31515\">&quot;&lt;/tr&gt;&quot;</span>;\r\n            $total_cost += $row[<span style=\"color:#A31515\">'cost'</span>] * $row[<span style=\"color:#A31515\">'qty'</span>];\r\n            $dollars = $row[<span style=\"color:#A31515\">'dollars'</span>];\r\n            $teo = $row[<span style=\"color:#A31515\">'teo'</span>];\r\n            $clli = $row[<span style=\"color:#A31515\">'clli'</span>];\r\n            <span style=\"color:Blue\">if</span> ($row[<span style=\"color:#A31515\">'appx'</span>] == <span style=\"color:#A31515\">&quot;0&quot;</span>) {\r\n              $appendix = <span style=\"color:#A31515\">&quot;&quot;</span>;\r\n            } <span style=\"color:Blue\">else</span> {\r\n              $appendix = $row[<span style=\"color:#A31515\">'appx'</span>];\r\n            }\r\n            $mlWindow = <span style=\"color:#A31515\">&quot;ML&quot;</span>.$appendix.<span style=\"color:#A31515\">&quot;_&quot;</span>.$teo.<span style=\"color:#A31515\">&quot;_&quot;</span>.$clli;\r\n          }\r\n          mlFooterPg();\r\n          $contents .= <span style=\"color:#A31515\">&quot;&lt;/table&gt;&quot;</span>;\r\n          $p_l = $dollars - $total_cost;\r\n          $objML-&gt;getProperties()-&gt;setCreator(<span style=\"color:#A31515\">&quot;Material List Generator&quot;</span>)\r\n\t\t\t\t\t\t\t -&gt;setLastModifiedBy(<span style=\"color:#A31515\">&quot;Material List Generator&quot;</span>)\r\n\t\t\t\t\t\t\t -&gt;setTitle($title)\r\n\t\t\t\t\t\t\t -&gt;setSubject($title)\r\n\t\t\t\t\t\t\t -&gt;setDescription(<span style=\"color:#A31515\">&quot;Material list for &quot;</span>.$teo)\r\n\t\t\t\t\t\t\t -&gt;setKeywords(<span style=\"color:#A31515\">&quot;office 2007 openxml php&quot;</span>)\r\n\t\t\t\t\t\t\t -&gt;setCategory(<span style=\"color:#A31515\">&quot;Material List&quot;</span>);\r\n</pre>\r\n</div>\r\n<p>&nbsp;</p>\r\n<p>But I am unable to pass this sheet to another PHP page to get it to print! $objML is defined as global. Here's the code I am using to pass it:</p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre>          <span style=\"color:Blue\">echo</span> <span style=\"color:#A31515\">&quot;&lt;form action=\\&quot;sendXLS.php\\&quot; method=\\&quot;get\\&quot; name=\\&quot;testexport\\&quot; id=\\&quot;testexport\\&quot;&gt;\\n&quot;</span>;\r\n          <span style=\"color:Blue\">echo</span> <span style=\"color:#A31515\">&quot;&lt;input type=\\&quot;hidden\\&quot; name=\\&quot;title\\&quot; id=\\&quot;title\\&quot; value=\\&quot;&quot;</span>.$mlWindow.<span style=\"color:#A31515\">&quot;\\&quot; /&gt;\\n&quot;</span>;\r\n          <span style=\"color:Blue\">echo</span> <span style=\"color:#A31515\">&quot;&lt;input type=\\&quot;submit\\&quot; name=\\&quot;exportit\\&quot; id=\\&quot;exportit\\&quot; value=\\&quot;EXPORT TO EXCEL\\&quot; /&gt;\\n&quot;</span>;\r\n          <span style=\"color:Blue\">echo</span> <span style=\"color:#A31515\">&quot;&lt;/form&gt;\\n&quot;</span>;\r\n</pre>\r\n</div>\r\n<p>And here is the sendXLS.php script:</p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre>&lt;?\r\n<span style=\"color:Blue\">require_once</span>(<span style=\"color:#A31515\">'Classes/PHPExcel.php'</span>);\r\n<span style=\"color:Blue\">require_once</span>(<span style=\"color:#A31515\">'Classes/PHPExcel/IOFactory.php'</span>);\r\nerror_reporting(E_ALL);\r\nini_set(<span style=\"color:#A31515\">&quot;display_errors&quot;</span>, 1);\r\nheader(<span style=\"color:#A31515\">'Content-Type: application/vnd.ms-excel'</span>);\r\nheader(<span style=\"color:#A31515\">'Content-Disposition: attachment;filename=&quot;'</span>.$title.<span style=\"color:#A31515\">'.xls&quot;'</span>);\r\nheader(<span style=\"color:#A31515\">'Cache-Control: max-age=0'</span>);\r\n$objWriter = PHPExcel_IOFactory::createWriter($objML, <span style=\"color:#A31515\">'Excel5'</span>);\r\n$objWriter-&gt;save(<span style=\"color:#A31515\">'php://output'</span>);\r\n?&gt;\r\n</pre>\r\n</div>\r\n<p>I am really racking my brain on this one and could desperately use some assistance!!!!!!!</p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2010-01-14T18:23:31.207-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "277494",
    "ThreadId": "80599",
    "Html": "<p>Pass $objML as a session variable, or write the workbook to a temporary file and then pass the filename via your form, or only generate the workbook when sendXLS.php is called.</p>",
    "PostedDate": "2010-01-15T01:03:32.033-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "277700",
    "ThreadId": "80599",
    "Html": "<p>Thanks, Mark. I decided that all the work could be done in the sendXLS.php script by only<br>passing a single variable to name the record of the ml (ml_id) that I am going to generate.<br>While the script itself seems to be working just fine (NO ERRORS, NOTICES or WARNINGS - and the<br>QUERY is perfect), I am getting complete GARBAGE on the resulting worksheet.<br>Here's my new script (sendXLS.php):</p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre>&lt;?\r\n<span style=\"color:Blue\">require_once</span>(<span style=\"color:#A31515\">&quot;db/db.class.php&quot;</span>);\r\n$db = <span style=\"color:Blue\">new</span> db_class;\r\n<span style=\"color:Blue\">require_once</span>(<span style=\"color:#A31515\">&quot;Classes/PHPExcel.php&quot;</span>);\r\n<span style=\"color:Blue\">require_once</span>(<span style=\"color:#A31515\">&quot;Classes/PHPExcel/IOFactory.php&quot;</span>);\r\nerror_reporting(E_ALL);\r\nini_set(<span style=\"color:#A31515\">&quot;display_errors&quot;</span>, 1);\r\n<span style=\"color:Green\">// create the new instance</span>\r\n$objML = <span style=\"color:Blue\">new</span> PHPExcel();\r\n<span style=\"color:Green\">// and make it the active sheet</span>\r\n$objML-&gt;setActiveSheetIndex(0);\r\n<span style=\"color:Green\">// set default spreadsheet layout options</span>\r\n$objML-&gt;getDefaultStyle()-&gt;getFont()-&gt;setName(<span style=\"color:#A31515\">'Calibri'</span>);\r\n$objML-&gt;getDefaultStyle()-&gt;getFont()-&gt;setSize(11);\r\n$objML-&gt;getActiveSheet()-&gt;getPageMargins()-&gt;setTop(1);\r\n$objML-&gt;getActiveSheet()-&gt;getHeaderFooter()-&gt;setOddHeader(<span style=\"color:#A31515\">&quot;&amp;C&amp;B&amp;36MATERIAL LIST&quot;</span>);\r\n<span style=\"color:Green\">// $objLogo = new PHPExcel_Worksheet_HeaderFooterDrawing();</span>\r\n<span style=\"color:Green\">// $objLogo-&gt;setName('MASTEC logo');</span>\r\n<span style=\"color:Green\">// $objLogo-&gt;setPath('images/ml_logo.jpg');</span>\r\n<span style=\"color:Green\">// $objLogo-&gt;setHeight(76);</span>\r\n<span style=\"color:Green\">// $objML-&gt;getActiveSheet()-&gt;getHeaderFooter()-&gt;addImage($objLogo, PHPExcel_Worksheet_HeaderFooter::IMAGE_HEADER_CENTER);</span>\r\n<span style=\"color:Green\">// set the top of every page that repeats</span>\r\n<span style=\"color:Blue\">if</span> (!$db-&gt;connect()) {\r\n  $db-&gt;print_last_error(); }\r\n<span style=\"color:Blue\">else</span> {\r\n  $q = <span style=\"color:#A31515\">&quot;select l.teo, l.proj_num, l.city, l.state, q.clli as clli,&quot;</span>;\r\n  $q .= <span style=\"color:#A31515\">&quot; l.appx, date_format(l.completed,'%m/%d/%Y') AS completed FROM material_lists l&quot;</span>;\r\n  $q .= <span style=\"color:#A31515\">&quot; JOIN clli_info q ON q.id = l.clli&quot;</span>;\r\n  $q .= <span style=\"color:#A31515\">&quot; WHERE l.id = '&quot;</span>.$ml_id.<span style=\"color:#A31515\">&quot;' LIMIT 1&quot;</span>;\r\n  <span style=\"color:Green\">// echo $q.&quot;&lt;br /&gt;&quot;;</span>\r\n  $r = $db-&gt;select($q);\r\n  <span style=\"color:Blue\">while</span> ($row = $db-&gt;get_row($r,<span style=\"color:#A31515\">'MYSQL_ASSOC'</span>)) {\r\n    <span style=\"color:Green\">// print_r($row).&quot;&lt;br /&gt;&quot;;</span>\r\n    <span style=\"color:Green\">// exit;</span>\r\n    <span style=\"color:Blue\">if</span> ($row[<span style=\"color:#A31515\">'appx'</span>] == <span style=\"color:#A31515\">&quot;0&quot;</span>) {\r\n      $appendix = <span style=\"color:#A31515\">&quot;&quot;</span>;\r\n    } <span style=\"color:Blue\">else</span> {\r\n      $appendix = $row[<span style=\"color:#A31515\">'appx'</span>];\r\n    }\r\n    $citystate = strtoupper($row[<span style=\"color:#A31515\">'city'</span>]).<span style=\"color:#A31515\">&quot;, &quot;</span>.strtoupper($row[<span style=\"color:#A31515\">'state'</span>]);\r\n    $teo = $row[<span style=\"color:#A31515\">'teo'</span>];\r\n    $projno = $row[<span style=\"color:#A31515\">'proj_num'</span>];\r\n    $completed = $row[<span style=\"color:#A31515\">'completed'</span>];\r\n    $clli = $row[<span style=\"color:#A31515\">'clli'</span>];\r\n    $appx = $row[<span style=\"color:#A31515\">'appx'</span>];\r\n    $mlName = <span style=\"color:#A31515\">&quot;ML&quot;</span>.$appendix.<span style=\"color:#A31515\">&quot;_&quot;</span>.$teo.<span style=\"color:#A31515\">&quot;_&quot;</span>.$clli;\r\n    $objML-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#A31515\">&quot;A1&quot;</span>,<span style=\"color:#A31515\">&quot;CUSTOMER ORDER NO:&quot;</span>)\r\n                                  -&gt;setCellValue(<span style=\"color:#A31515\">&quot;E1&quot;</span>,<span style=\"color:#A31515\">&quot;$teo&quot;</span>)\r\n                                  -&gt;setCellValue(<span style=\"color:#A31515\">&quot;F1&quot;</span>,<span style=\"color:#A31515\">&quot;MASTEC ORD NO:&quot;</span>)\r\n                                  -&gt;setCellValue(<span style=\"color:#A31515\">&quot;G1&quot;</span>,<span style=\"color:#A31515\">&quot;$projno&quot;</span>)\r\n                                  -&gt;setCellValue(<span style=\"color:#A31515\">&quot;H1&quot;</span>,<span style=\"color:#A31515\">&quot;DATE:&quot;</span>)\r\n                                  -&gt;setCellValue(<span style=\"color:#A31515\">&quot;I1&quot;</span>,<span style=\"color:#A31515\">&quot;$completed&quot;</span>)\r\n                                  -&gt;mergeCells(<span style=\"color:#A31515\">&quot;A1:D1&quot;</span>)\r\n                                  -&gt;setCellValue(<span style=\"color:#A31515\">&quot;A2&quot;</span>,<span style=\"color:#A31515\">&quot;CLLI:&quot;</span>)\r\n                                  -&gt;setCellValue(<span style=\"color:#A31515\">&quot;E2&quot;</span>,<span style=\"color:#A31515\">&quot;$clli&quot;</span>)\r\n                                  -&gt;setCellValue(<span style=\"color:#A31515\">&quot;F2&quot;</span>,<span style=\"color:#A31515\">&quot;CITY, STATE:&quot;</span>)\r\n                                  -&gt;setCellValue(<span style=\"color:#A31515\">&quot;G2&quot;</span>,<span style=\"color:#A31515\">&quot;$citystate&quot;</span>)\r\n                                  -&gt;setCellValue(<span style=\"color:#A31515\">&quot;H2&quot;</span>,<span style=\"color:#A31515\">&quot;APPX:&quot;</span>)\r\n                                  -&gt;setCellValue(<span style=\"color:#A31515\">&quot;I2&quot;</span>,<span style=\"color:#A31515\">&quot;$appx&quot;</span>)\r\n                                  -&gt;mergeCells(<span style=\"color:#A31515\">&quot;A2:D2&quot;</span>)\r\n                                  -&gt;setCellValue(<span style=\"color:#A31515\">&quot;A3&quot;</span>,<span style=\"color:#A31515\">&quot;OP&quot;</span>)\r\n                                  -&gt;setCellValue(<span style=\"color:#A31515\">&quot;B3&quot;</span>,<span style=\"color:#A31515\">&quot;ITEM&quot;</span>)\r\n                                  -&gt;setCellValue(<span style=\"color:#A31515\">&quot;C3&quot;</span>,<span style=\"color:#A31515\">&quot;NOTE&quot;</span>)\r\n                                  -&gt;setCellValue(<span style=\"color:#A31515\">&quot;D3&quot;</span>,<span style=\"color:#A31515\">&quot;QTY&quot;</span>)\r\n                                  -&gt;setCellValue(<span style=\"color:#A31515\">&quot;E3&quot;</span>,<span style=\"color:#A31515\">&quot;MATERIAL ID&quot;</span>)\r\n                                  -&gt;setCellValue(<span style=\"color:#A31515\">&quot;F3&quot;</span>,<span style=\"color:#A31515\">&quot;MATERIAL DESCRIPTION&quot;</span>)\r\n                                  -&gt;setCellValue(<span style=\"color:#A31515\">&quot;H3&quot;</span>,<span style=\"color:#A31515\">&quot;NOTES&quot;</span>);\r\n  }\r\n  $objML-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#A31515\">'I2'</span>)-&gt;getNumberFormat()-&gt;setFormatCode(<span style=\"color:#A31515\">&quot;00&quot;</span>);\r\n  $objML-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#A31515\">&quot;A1:H1&quot;</span>)-&gt;getAlignment()-&gt;setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_RIGHT);\r\n  $objML-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#A31515\">&quot;A2:H2&quot;</span>)-&gt;getAlignment()-&gt;setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_RIGHT);\r\n  $objML-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#A31515\">&quot;E1&quot;</span>)-&gt;getAlignment()-&gt;setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_LEFT);\r\n  $objML-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#A31515\">&quot;G1&quot;</span>)-&gt;getAlignment()-&gt;setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_LEFT);\r\n  $objML-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#A31515\">&quot;I1&quot;</span>)-&gt;getAlignment()-&gt;setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_LEFT);\r\n  $objML-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#A31515\">&quot;E2&quot;</span>)-&gt;getAlignment()-&gt;setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_LEFT);\r\n  $objML-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#A31515\">&quot;G2&quot;</span>)-&gt;getAlignment()-&gt;setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_LEFT);\r\n  $objML-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#A31515\">&quot;I2&quot;</span>)-&gt;getAlignment()-&gt;setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_CENTER);\r\n  $objML-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#A31515\">&quot;A3:I3&quot;</span>)-&gt;getAlignment()-&gt;setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_CENTER);\r\n  $objML-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#A31515\">&quot;E3&quot;</span>)-&gt;getAlignment()-&gt;setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_LEFT);\r\n  $objML-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#A31515\">&quot;A1:I3&quot;</span>)-&gt;getFont()-&gt;setBold(true);\r\n  $objML-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#A31515\">&quot;A1:I22&quot;</span>)-&gt;getBorders()-&gt;getAllBorders()-&gt;setBorderStyle(PHPExcel_Style_Border::BORDER_THIN);\r\n  $objML-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#A31515\">&quot;A3:I3&quot;</span>)-&gt;getBorders()-&gt;getBottom()-&gt;setBorderStyle(PHPExcel_Style_Border::BORDER_THICK);\r\n  $objML-&gt;getActiveSheet()-&gt;mergeCells(<span style=\"color:#A31515\">&quot;F3:G3&quot;</span>);\r\n  $objML-&gt;getActiveSheet()-&gt;mergeCells(<span style=\"color:#A31515\">&quot;H3:I3&quot;</span>);\r\n  $objML-&gt;getActiveSheet()-&gt;getColumnDimension(<span style=\"color:#A31515\">&quot;A&quot;</span>)-&gt;setWidth(6);\r\n  $objML-&gt;getActiveSheet()-&gt;getColumnDimension(<span style=\"color:#A31515\">&quot;B&quot;</span>)-&gt;setWidth(6);\r\n  $objML-&gt;getActiveSheet()-&gt;getColumnDimension(<span style=\"color:#A31515\">&quot;C&quot;</span>)-&gt;setWidth(6);\r\n  $objML-&gt;getActiveSheet()-&gt;getColumnDimension(<span style=\"color:#A31515\">&quot;D&quot;</span>)-&gt;setWidth(6);\r\n  $objML-&gt;getActiveSheet()-&gt;getColumnDimension(<span style=\"color:#A31515\">&quot;E&quot;</span>)-&gt;setWidth(26);\r\n  $objML-&gt;getActiveSheet()-&gt;getColumnDimension(<span style=\"color:#A31515\">&quot;F&quot;</span>)-&gt;setWidth(17);\r\n  $objML-&gt;getActiveSheet()-&gt;getColumnDimension(<span style=\"color:#A31515\">&quot;G&quot;</span>)-&gt;setWidth(33);\r\n  $objML-&gt;getActiveSheet()-&gt;getColumnDimension(<span style=\"color:#A31515\">&quot;H&quot;</span>)-&gt;setWidth(6);\r\n  $objML-&gt;getActiveSheet()-&gt;getColumnDimension(<span style=\"color:#A31515\">&quot;I&quot;</span>)-&gt;setWidth(17);\r\n  $objML-&gt;getActiveSheet()-&gt;getPageSetup()-&gt;setRowsToRepeatAtTopByStartAndEnd(1,3);\r\n  <span style=\"color:Green\">// setup some default styling for the worksheet</span>\r\n  $objML-&gt;getActiveSheet()-&gt;setBreak(<span style=\"color:#A31515\">&quot;J3&quot;</span>,PHPExcel_Worksheet::BREAK_COLUMN);\r\n  $objML-&gt;getActiveSheet()-&gt;getPageSetup()-&gt;setOrientation(PHPExcel_Worksheet_PageSetup::ORIENTATION_LANDSCAPE);\r\n  $objML-&gt;getActiveSheet()-&gt;getPageSetup()-&gt;setPaperSize(PHPExcel_Worksheet_PageSetup::PAPERSIZE_LETTER);\r\n  $objML-&gt;getActiveSheet()-&gt;getPageSetup()-&gt;setFitToWidth(1);\r\n  $objML-&gt;getActiveSheet()-&gt;getPageSetup()-&gt;setFitToHeight(0);\r\n  $objML-&gt;getActiveSheet()-&gt;getSheetView()-&gt;setZoomScale(105);\r\n}\r\n<span style=\"color:Green\">// creating the contents of the sheet</span>\r\n<span style=\"color:Blue\">if</span> (!$db-&gt;connect()) {\r\n  $db-&gt;print_last_error(); }\r\n<span style=\"color:Blue\">else</span> {\r\n  $i = 0;\r\n  $page = 1;\r\n  $rowMLSheet = 3;\r\n  $total_cost = 0;\r\n  $q = <span style=\"color:#A31515\">&quot;select c.quantity as qty, c.notes, m.*, l.teo as teo, q.clli as clli, l.material_dollars as dollars, l.proj_num as proj_num, l.city as city, l.state as state,&quot;</span>;\r\n  $q .= <span style=\"color:#A31515\">&quot; l.appx as appx, date_format(l.completed,'%m/%d/%Y') as completed from materials m JOIN ml_contents c ON c.contained_item = m.id&quot;</span>;\r\n  $q .= <span style=\"color:#A31515\">&quot; JOIN material_lists l ON l.id = c.ml_id JOIN clli_info as q ON q.id = l.clli&quot;</span>;\r\n  $q .= <span style=\"color:#A31515\">&quot; where c.ml_id = '&quot;</span>.$ml_id.<span style=\"color:#A31515\">&quot;'&quot;</span>;\r\n  $r = $db-&gt;select($q);\r\n  <span style=\"color:Blue\">while</span> ($row=$db-&gt;get_row($r,<span style=\"color:#A31515\">'MYSQL_ASSOC'</span>)) {\r\n    $i++;\r\n    $rowMLSheet++;\r\n    <span style=\"color:Blue\">if</span> ($i % 19 == 0) {\r\n      $objML-&gt;getActiveSheet()-&gt;setCellValueByColumnAndRow(1,$rowMLSheet,<span style=\"color:#A31515\">&quot;RESTRICED - PROPIETARY\\nNot for use or disclosure outside of AT&amp;T except under written agreement.&quot;</span>);\r\n      $objML-&gt;getActiveSheet()-&gt;setCellValueByColumnAndRow(8,$rowMLSheet,<span style=\"color:#A31515\">&quot;PAGE: $page&quot;</span>);\r\n      $objML-&gt;getActiveSheet()-&gt;getRowDimension($rowMLSheet)-&gt;setRowHeight(32);\r\n      $rowMLSheet++;\r\n      $temp = <span style=\"color:#A31515\">&quot;J&quot;</span>.$rowMLSheet;\r\n      $objML-&gt;getActiveSheet()-&gt;setBreak(<span style=\"color:#A31515\">&quot;$temp&quot;</span>,PHPExcel_Worksheet::BREAK_ROW);\r\n    }\r\n    $objML-&gt;getActiveSheet()-&gt;setCellValueByColumnAndRow(1,$rowMLSheet,<span style=\"color:#A31515\">&quot;A&quot;</span>);\r\n    $objML-&gt;getActiveSheet()-&gt;setCellValueByColumnAndRow(2,$rowMLSheet,<span style=\"color:#A31515\">&quot;$i&quot;</span>);\r\n    $objML-&gt;getActiveSheet()-&gt;setCellValueByColumnAndRow(3,$rowMLSheet,<span style=\"color:#A31515\">&quot;   &quot;</span>);\r\n    $qty = $row[<span style=\"color:#A31515\">'qty'</span>];\r\n    $objML-&gt;getActiveSheet()-&gt;setCellValueByColumnAndRow(4,$rowMLSheet,<span style=\"color:#A31515\">&quot;$qty&quot;</span>);\r\n    $partno = $row[<span style=\"color:#A31515\">'mastec_partno'</span>];\r\n    $objML-&gt;getActiveSheet()-&gt;setCellValueByColumnAndRow(5,$rowMLSheet,<span style=\"color:#A31515\">&quot;$partno&quot;</span>);\r\n    $desc = trim(stripslashes($row[<span style=\"color:#A31515\">'description'</span>]));\r\n    $temp = <span style=\"color:#A31515\">&quot;F&quot;</span>.$rowMLSheet.<span style=\"color:#A31515\">&quot;:G&quot;</span>.$rowMLSheet;\r\n    $objML-&gt;getActiveSheet()-&gt;setCellValueByColumnAndRow(6,$rowMLSheet,<span style=\"color:#A31515\">&quot;$desc&quot;</span>)\r\n                            -&gt;mergeCells(<span style=\"color:#A31515\">&quot;$temp&quot;</span>);\r\n    $temp = <span style=\"color:#A31515\">&quot;H&quot;</span>.$rowMLSheet.<span style=\"color:#A31515\">&quot;:I&quot;</span>.$rowMLSheet;\r\n    $notes = $row[<span style=\"color:#A31515\">'notes'</span>];\r\n    $objML-&gt;getActiveSheet()-&gt;setCellValueByColumnAndRow(6,$rowMLSheet,<span style=\"color:#A31515\">&quot;$notes&quot;</span>)\r\n                            -&gt;mergeCells(<span style=\"color:#A31515\">&quot;$temp&quot;</span>);\r\n  }\r\n}\r\n$temp = <span style=\"color:#A31515\">&quot;B4:B&quot;</span>.$i;\r\n$objML-&gt;getActiveSheet()-&gt;getStyle($temp)-&gt;getNumberFormat()-&gt;setFormatCode(<span style=\"color:#A31515\">&quot;00&quot;</span>);\r\n<span style=\"color:Green\">// set some default sheet properties</span>\r\n$objML-&gt;getProperties()-&gt;setCreator(<span style=\"color:#A31515\">&quot;Material List Generator&quot;</span>)\r\n\t\t -&gt;setLastModifiedBy(<span style=\"color:#A31515\">&quot;Material List Generator&quot;</span>)\r\n\t\t -&gt;setTitle(<span style=\"color:#A31515\">&quot;Material List&quot;</span>)\r\n\t\t -&gt;setSubject($mlName)\r\n\t\t -&gt;setDescription(<span style=\"color:#A31515\">&quot;Material list for &quot;</span>.$teo)\r\n\t\t -&gt;setKeywords(<span style=\"color:#A31515\">&quot;office 2007 openxml php&quot;</span>)\r\n\t\t -&gt;setCategory(<span style=\"color:#A31515\">&quot;Material List&quot;</span>);\r\n<span style=\"color:Green\">// print_r($objML);</span>\r\nheader(<span style=\"color:#A31515\">'Content-Type: application/vnd.ms-excel'</span>);\r\n<span style=\"color:Green\">// header('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');</span>\r\nheader(<span style=\"color:#A31515\">'Content-Disposition: attachment;filename=&quot;'</span>.$mlName.<span style=\"color:#A31515\">'.xls&quot;'</span>);\r\nheader(<span style=\"color:#A31515\">'Cache-Control: max-age=0'</span>);\r\n$objWriter = PHPExcel_IOFactory::createWriter($objML, <span style=\"color:#A31515\">'Excel5'</span>);\r\n<span style=\"color:Green\">// $objWriter = PHPExcel_IOFactory::createWriter($objML, 'Excel2007');</span>\r\n$objWriter-&gt;save(<span style=\"color:#A31515\">'php://output'</span>);\r\n?&gt;\r\n</pre>\r\n</div>\r\n<p>I get an error that the resulting file is &quot;in a different format than specified by the file extension&quot;<br>and the resulting sheet is utter GARBAGE!</p>",
    "PostedDate": "2010-01-15T12:13:04.56-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "278080",
    "ThreadId": "80599",
    "Html": "<blockquote style=\"border:0.1em solid #cccccc;margin:0.25em 1em 0pt;padding:0pt 0.25em;font-style:italic\"><strong>DevlshOne wrote:</strong><br>\r\n<p>I get an error that the resulting file is &quot;in a different format than specified by the file extension&quot;<br>and the resulting sheet is utter GARBAGE!</p>\r\n</blockquote>\r\n<p>In the file you uploaded: <a href=\"http://phpexcel.codeplex.com/Project/Download/AttachmentDownload.ashx?ProjectName=PHPExcel&WorkItemId=10749&FileAttachmentId=3702\">ML_78899000_PACEFLPV.xls</a></p>\r\n<p>I find some whitespace at the top: a <strong>space</strong> and a <strong>newline</strong>, see screenshot:</p>\r\n<p><a href=\"http://img33.imageshack.us/img33/3923/ss20100117062142.png\"><img src=\"http://img33.imageshack.us/img33/3923/ss20100117062142.th.png\" border=0 alt=\"\"></a></p>\r\n<p>Those stray characters should not be there. This is the reason why the file opens as corrupt in Excel. Try to delete them and it will open fine.</p>\r\n<p>The stray characters come from somewhere in your script. Probably before your opening <span style=\"font-family:Courier New\">&lt;?php</span> or after your closing <span style=\"font-family:Courier New\">?&gt;</span> in some included script. Remove them and the error should go away.</p>",
    "PostedDate": "2010-01-16T21:29:10.08-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "278113",
    "ThreadId": "80599",
    "Html": "<blockquote style=\"border:0.1em solid #cccccc;margin:0.25em 1em 0pt;padding:0pt 0.25em;font-style:italic\"><strong>DevlshOne wrote:</strong><br> is related to &quot;Export from existing HTML Table?&quot; (http://phpexcel.codeplex.com/Thread/View.aspx?ThreadId=80599) I'm sorry, but I don't see any place where whitespace or a newline marker could possible exist in this script...</blockquote>\r\n<p>There is no whitespace problem in your sendXLS.php script. So it must be in &quot;db/db.class.php&quot;.</p>\r\n<p>Look for whitespace in that script before <span style=\"font-family:Courier New\">&lt;?php</span> or after <span style=\"font-family:Courier New\">?&gt;</span>. If that script includes other scripts, also look there.</p>",
    "PostedDate": "2010-01-17T02:04:08.077-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "278249",
    "ThreadId": "80599",
    "Html": "<p>You are a genius. There was a single blank line at the end of the db.class.php script. It's now working perfectly!!! I would still love to see &quot;PHPExcel_Reader_HTML&quot;. Thanks again for your kind attention and assistance. I'll be sending in a donation shortly.</p>",
    "PostedDate": "2010-01-17T14:13:01.667-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "278584",
    "ThreadId": "80599",
    "Html": "<p>One more question... how do I get an &quot;ALT-ENTER&quot; to be part of the text in one of my cell values?</p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2010-01-18T10:18:15.913-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "278638",
    "ThreadId": "80599",
    "Html": "<blockquote style=\"border:solid .1em #ccc;font-style:italic;margin:.25em 1em 0 1em;padding:0 .25em 0 .25em\"><strong>DevlshOne wrote:</strong><br>\r\n<p>One more question... how do I get an &quot;ALT-ENTER&quot; to be part of the text in one of my cell values?</p>\r\n</blockquote>\r\n<p>&nbsp;Try a &quot;\\n&quot;</p>",
    "PostedDate": "2010-01-18T13:29:26.463-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "278689",
    "ThreadId": "80599",
    "Html": "<p>Nope.. just that gives me a bogus character in the middle of text.</p>",
    "PostedDate": "2010-01-18T16:49:16.033-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "278791",
    "ThreadId": "80599",
    "Html": "<blockquote style=\"border:0.1em solid #cccccc;margin:0.25em 1em 0pt;padding:0pt 0.25em;font-style:italic\"><strong>DevlshOne wrote:</strong><br>\r\n<p>Nope.. just that gives me a bogus character in the middle of text.</p>\r\n</blockquote>\r\n<p>Your question is a common one so I have updated the &quot;PHPExcel developer documentation&quot; for next release.</p>\r\n<p>Also adding feature in AdvancedValueBinder.php to facilitate easier insertion of ALT+&quot;Enter&quot;.</p>\r\n<p><a href=\"http://phpexcel.codeplex.com/WorkItem/View.aspx?WorkItemId=11550\">http://phpexcel.codeplex.com/WorkItem/View.aspx?WorkItemId=11550</a></p>\r\n<p>Added this in the documentation:</p>\r\n<blockquote style=\"border:1px solid black;padding:0pt 0.25em\">\r\n<p><strong>Write a newline character &quot;\\n&quot; in a cell like ALT+&quot;Enter&quot; in Excel</strong><br><br>In Microsoft Office Excel you get a line break in a cell when you use ALT+&quot;Enter&quot;. When you do this it automatically turns on &quot;wrap text&quot; for the cell.<br><br>Here is how an example to achieve this in PHPExcel:<br><span style=\"font-family:Courier New\">$objPHPExcel-&gt;getActiveSheet()-&gt;getCell('A1')-&gt;setValue(&quot;hello\\nworld&quot;);</span><br><span style=\"font-family:Courier New\">$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('A1')-&gt;getAlignment()-&gt;setWrapText(true);</span><br><br>Read more about formatting cells using <span style=\"font-family:Courier New\">getStyle()</span> elsewhere.<br><br>If you use AdvancedValuebinder.php it will automatically turn on &quot;wrap text&quot; for the cell.<br><br><span style=\"font-family:Courier New\">require_once 'PHPExcel/Cell/AdvancedValueBinder.php';</span><br><span style=\"font-family:Courier New\">PHPExcel_Cell::setValueBinder( new PHPExcel_Cell_AdvancedValueBinder() );</span><br><br><span style=\"font-family:Courier New\">$objPHPExcel-&gt;getActiveSheet()-&gt;getCell('A1')-&gt;setValue(&quot;hello\\nworld&quot;);</span><br><br>Read more about <span style=\"font-family:Courier New\">AdvancedValueBinder.php</span> elsewhere.</p>\r\n</blockquote>",
    "PostedDate": "2010-01-18T23:28:20.04-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "418576",
    "ThreadId": "80599",
    "Html": "<p>Hi,</p>\r\n<p>I am new to all kinds of programming. So excuse me if you find any thing too basic.</p>\r\n<p>I have a drop-down menu for making queries. The selection from this pafe are sent forr processing into another page (post.php). If I add the following code taken from 01simple-download-xls.php (in tests folder of PHPExcel) in post.php then a dialogue appears asking me to save the Excel file instead of displaying the results in Firefox. The Excel file is fine except some garbage at the end.</p>\r\n<p>error_reporting(E_ALL);<br>require_once(&quot;C:\\wamp\\www\\Classes\\PHPExcel.php&quot;);<br>require_once(&quot;C:\\wamp\\www\\Classes\\PHPExcel\\IOFactory.php&quot;);<br>$objPHPExcel = new PHPExcel();<br>$objPHPExcel-&gt;getProperties()-&gt;setCreator(&quot;Maarten Balliauw&quot;)<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;-&gt;setLastModifiedBy(&quot;Maarten Balliauw&quot;)<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;-&gt;setTitle(&quot;Office 2007 XLSX Test Document&quot;)<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;-&gt;setSubject(&quot;Office 2007 XLSX Test Document&quot;)<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;-&gt;setDescription(&quot;Test document for Office 2007 XLSX, generated using PHP classes.&quot;)<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;-&gt;setKeywords(&quot;office 2007 openxml php&quot;)<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;-&gt;setCategory(&quot;Test result file&quot;);<br>header('Content-Type: application/vnd.ms-excel');<br>header('Content-Disposition: attachment;filename=&quot;01simple.xls&quot;');<br>header('Cache-Control: max-age=0');<br>$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, 'Excel5');<br>$objWriter-&gt;save('php://output'); <br>exit;</p>\r\n<p>Now I want to just add a button below the MySQL results for exporting the results to Excel. I added the following code in post.php:</p>\r\n<p>&lt;form action=&quot;post2.php&quot; method=&quot;post&quot;&gt;&lt;br&gt;<br>&lt;button type=&quot;submit&quot;&gt;Export to Excel&lt;/button&gt;&lt;/form&gt;&lt;/div&gt;&lt;br&gt;</p>\r\n<p>Moreover, I pasted the PHPExcel code (mentioned previously) into post2.php. This leads to a blank Excel file as I dont know how to pass the results to post2.php.</p>\r\n<p>Any help is welcome.</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2010-03-16T01:08:49.17-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "418609",
    "ThreadId": "80599",
    "Html": "<p>@kashif79:</p>\r\n<p>Avoid sending all the MySQL data to post2.php. Instead do something like this:</p>\r\n<p>&nbsp;</p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre><span style=\"color:Green\">/* post2.php */</span>\r\n&lt;?php\r\nerror_reporting(E_ALL);\r\n<span style=\"color:Blue\">require_once</span>(<span style=\"color:#A31515\">&quot;C:\\wamp\\www\\Classes\\PHPExcel.php&quot;</span>);\r\n<span style=\"color:Blue\">require_once</span>(<span style=\"color:#A31515\">&quot;C:\\wamp\\www\\Classes\\PHPExcel\\IOFactory.php&quot;</span>);\r\n$objPHPExcel = <span style=\"color:Blue\">new</span> PHPExcel();\r\n$objPHPExcel-&gt;getProperties()-&gt;setCreator(<span style=\"color:#A31515\">&quot;Maarten Balliauw&quot;</span>)\r\n                             -&gt;setLastModifiedBy(<span style=\"color:#A31515\">&quot;Maarten Balliauw&quot;</span>)\r\n                             -&gt;setTitle(<span style=\"color:#A31515\">&quot;Office 2007 XLSX Test Document&quot;</span>)\r\n                             -&gt;setSubject(<span style=\"color:#A31515\">&quot;Office 2007 XLSX Test Document&quot;</span>)\r\n                             -&gt;setDescription(<span style=\"color:#A31515\">&quot;Test document for Office 2007 XLSX, generated using PHP classes.&quot;</span>)\r\n                             -&gt;setKeywords(<span style=\"color:#A31515\">&quot;office 2007 openxml php&quot;</span>)\r\n                             -&gt;setCategory(<span style=\"color:#A31515\">&quot;Test result file&quot;</span>);\r\n\r\n$worksheet = $objPHPExcel-&gt;getActiveSheet();\r\n\r\n<span style=\"color:Green\">// fetch the relevant data from database</span>\r\nmysql_connect(bla bla...);\r\n...\r\n$result = mysql_query(<span style=\"color:#A31515\">&quot;SELECT bla bla...&quot;</span>)\r\n;\r\n$i = 1;\r\n<span style=\"color:Blue\">while</span> ($row = mysql_fetch_array($result)) {\r\n    $worksheet-&gt;getCell(<span style=\"color:#A31515\">&quot;A$i&quot;</span>)-&gt;setValue($row[0]);\r\n    $worksheet-&gt;getCell(<span style=\"color:#A31515\">&quot;B$i&quot;</span>)-&gt;setValue($row[1]);\r\n    $i++;\r\n}\r\n\r\nheader(<span style=\"color:#A31515\">'Content-Type: application/vnd.ms-excel'</span>);\r\nheader(<span style=\"color:#A31515\">'Content-Disposition: attachment;filename=&quot;01simple.xls&quot;'</span>);\r\nheader(<span style=\"color:#A31515\">'Cache-Control: max-age=0'</span>);\r\n$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, <span style=\"color:#A31515\">'Excel5'</span>);\r\n$objWriter-&gt;save(<span style=\"color:#A31515\">'php://output'</span>);\r\n<span style=\"color:Blue\">exit</span>;\r\n?&gt;\r\n\r\n\r\n</pre>\r\n</div>\r\n<p>You need to be fill out the details above, but it will maybe get you on the track.</p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2010-03-16T02:53:48.017-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "418630",
    "ThreadId": "80599",
    "Html": "<p>Dear Koyama,</p>\r\n<p>Thank you for your reply.</p>\r\n<p>You recommend adding the query with PHPExcel code.&nbsp; My query goes like this:</p>\r\n<p>$name = $_POST['indicator'];<br> $str_name = '';<br> for( $i = 0; $i&lt;count($name);$i++)<br> {<br> &nbsp;$str_name .= $name[$i].&quot;,&quot;;<br> }<br> $query= &quot;SELECT&nbsp; &quot;.substr($str_name,0,strlen($str_name)-1).&quot; FROM data&quot;;<br> $result = mysql_query($query) or die ('Error in query: $query. ' . mysql_error());</p>\r\n<p>However, using your code by adding this query in the post2.php results in an errror in the following command:</p>\r\n<p>$name = $_POST['indicator'];</p>\r\n<p>The 'indicator' is what is sent by dropdown.php to post.php. An error occurs, I think, because now I am pressing a submit button to get the data displayed in Excel. I think $_POST needs to be adjusted now.&nbsp; In your code $i = 1 is used while in my part of the code $i = 0 is used. Is this problematic too?</p>\r\n<p>Your code works fine if I include it in the post.php (the file which processes the items selected by the user in dropdown.php) though it does not show the headers or column names.</p>",
    "PostedDate": "2010-03-16T04:16:32.297-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "419015",
    "ThreadId": "80599",
    "Html": "<p>@kashif79: It looks like you are on the right track sending just the value of 'indicator'.</p>\r\n<p>1) Yes, $i = 1 is correct if data should start at the first row in the Excel file.</p>\r\n<p>2) To get the headers / column names, modify like this:</p>\r\n<p>&nbsp;</p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre>$worksheet-&gt;getCell(<span style=\"color:#A31515\">&quot;A1&quot;</span>)-&gt;setValue(<span style=\"color:#A31515\">'some header for column A'</span>);\r\n$worksheet-&gt;getCell(<span style=\"color:#A31515\">&quot;B1&quot;</span>)-&gt;setValue(<span style=\"color:#A31515\">'some header for column B'</span>);\r\n\r\n$i = 2;\r\n<span style=\"color:Blue\">while</span> ($row = mysql_fetch_array($result)) {\r\n    $worksheet-&gt;getCell(<span style=\"color:#A31515\">&quot;A$i&quot;</span>)-&gt;setValue($row[0]);\r\n    $worksheet-&gt;getCell(<span style=\"color:#A31515\">&quot;B$i&quot;</span>)-&gt;setValue($row[1]);\r\n    $i++;\r\n}\r\n\r\n\r\n</pre>\r\n</div>\r\n<p>&nbsp;</p>",
    "PostedDate": "2010-03-16T21:55:21.967-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "419317",
    "ThreadId": "80599",
    "Html": "<p>Dear Koyama,<br><br>Thank you for your continued help.</p>\r\n<p>I did not check the code provided by you earlier carefully. Using it results only one field from database to be shown in Excel even if I made multiple selections in the drop-down menu. Moreover, your new code, unfortunately did not help, as headers are hard-coded here. I got the solution for it from an example on net (http://www.weberdev.com/get_example-4249.html) after the query. Now multiple selections in drop-down menu were being shown in the Excel file and column names were there too but still there was some garbage at the end of the file. After some trial and error I found that removing the follwing line from your code produced neat results:</p>\r\n<pre>$objWriter-&gt;save(<span style=\"color:#a31515\">'php://output'</span>);<br></pre>\r\n<p>though I don't understand why it is so. Nevertheless, one part of the problem is solved, thanks to your input.&nbsp;</p>\r\n<p>All the above engineering was done in post.php instead of post2.php. However that results in a dialogue box asking for saving the Excel file instead of displaying the results. I want to display the results in a html page first and then the user would have option to export the data to Excel. So my post.php page would be:</p>\r\n<p>&lt;?php</p>\r\n<p>// database connection details</p>\r\n<p>...</p>\r\n<p><br>//Selection from drop-down menu</p>\r\n<p>$name = $_POST['indicator'];<br>$str_name = '';<br>for( $i = 0; $i&lt;count($name);$i++)<br>{<br>&nbsp;$str_name .= $name[$i].&quot;,&quot;;<br>}<br>// Query</p>\r\n<p>$query= &quot;SELECT&nbsp; Year,&quot;.substr($str_name,0,strlen($str_name)-1).&quot; FROM data&quot;;<br><br>$result = mysql_query($query) or die ('Error in query: $query. ' . mysql_error());<br><br>//following code is from http://www.weberdev.com/get_example-4249.html<br>if (($result)||(mysql_errno == 0))<br>{<br>&nbsp; echo &quot;&lt;table width='100%'&gt;&lt;tr&gt;&quot;;<br>&nbsp; if (mysql_num_rows($result)&gt;0)<br>&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //loop thru the field names to print the correct headers<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $i = 0;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; while ($i &lt; mysql_num_fields($result))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; echo &quot;&lt;th&gt;&quot;. mysql_field_name($result, $i) . &quot;&lt;/th&gt;&quot;;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $i++;<br>&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp; echo &quot;&lt;/tr&gt;&quot;;<br>&nbsp; &nbsp;<br>&nbsp;&nbsp;&nbsp; //display the data<br>&nbsp;&nbsp;&nbsp; while ($rows = mysql_fetch_array($result,MYSQL_ASSOC))<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; echo &quot;&lt;tr&gt;&quot;;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; foreach ($rows as $data)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; echo &quot;&lt;td align='center'&gt;&quot;. $data . &quot;&lt;/td&gt;&quot;;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp; }<br>&nbsp; }else{<br>&nbsp;&nbsp;&nbsp; echo &quot;&lt;tr&gt;&lt;td colspan='&quot; . ($i+1) . &quot;'&gt;No Results found!&lt;/td&gt;&lt;/tr&gt;&quot;;<br>&nbsp; }<br>&nbsp; echo &quot;&lt;/table&gt;&quot;;<br>}<br>else{<br>&nbsp; echo &quot;Error in running query :&quot;. mysql_error();</p>\r\n<p>}</p>\r\n<p>?&gt;<br>&lt;form action=&quot;post2.php&quot; method=&quot;post&quot;&gt;<br>&lt;button type=&quot;submit&quot;&gt;Export to Excel&lt;/button&gt;&lt;/div&gt;&lt;br&gt;</p>\r\n<p>Your code for exporting to Excel would be there in post2.php alongside whole of post.php code but I don't know how to pass selection form the drop-down menu again (without making the selection again). Using this button code would not pass the value of 'indicator' . Please help with the code.</p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2010-03-17T10:12:14.44-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "420050",
    "ThreadId": "80599",
    "Html": "<blockquote style=\"border:solid .1em #ccc;font-style:italic;margin:.25em 1em 0 1em;padding:0 .25em 0 .25em\"><strong>kashif79 wrote:</strong><br>\r\n<p>Your code for exporting to Excel would be there in post2.php alongside whole of post.php code but I don't know how to pass selection form the drop-down menu again (without making the selection again). Using this button code would not pass the value of 'indicator' . Please help with the code.</p>\r\n<p>&nbsp;</p>\r\n</blockquote>\r\n<p>How about passing it as a hidden field:</p>\r\n<p>&nbsp;</p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre><span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">form</span> <span style=\"color:Red\">action</span><span style=\"color:Blue\">=</span><span style=\"color:Blue\">&quot;post2.php&quot;</span> <span style=\"color:Red\">method</span><span style=\"color:Blue\">=</span><span style=\"color:Blue\">&quot;post&quot;</span><span style=\"color:Blue\">&gt;</span>\r\n<span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">input</span> <span style=\"color:Red\">type</span><span style=\"color:Blue\">=</span><span style=\"color:Blue\">&quot;hidden&quot;</span> <span style=\"color:Red\">name</span><span style=\"color:Blue\">=</span><span style=\"color:Blue\">&quot;indicator&quot;</span> <span style=\"color:Red\">value</span><span style=\"color:Blue\">=</span><span style=\"color:Blue\">&quot;&lt;?php echo $_POST['indicator']; ?&gt;&quot;</span><span style=\"color:Blue\">&gt;</span>\r\n<span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">button</span> <span style=\"color:Red\">type</span><span style=\"color:Blue\">=</span><span style=\"color:Blue\">&quot;submit&quot;</span><span style=\"color:Blue\">&gt;</span>Export to Excel<span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">button</span><span style=\"color:Blue\">&gt;</span>\r\n<span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">form</span><span style=\"color:Blue\">&gt;</span>\r\n\r\n</pre>\r\n</div>",
    "PostedDate": "2010-03-18T17:10:47.853-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]