[
  {
    "Id": "871059",
    "ThreadId": "371418",
    "Html": "\r\n<p>I need to convert xls or xlsx file to csv.</p>\r\n<p>this xls/xlsx file given by different supplier in different format. I need to&nbsp;retrieve&nbsp;the data in a column which contains date. Some supplier format this column as &quot;date&quot;... some supplier leave date column format as &quot;general&quot;. Date format is also\r\n different.Like could be 01/01/2012</p>\r\n<p>1 january 2012, 01, jan 12&nbsp;</p>\r\n<p>So i am developing an interface for another team who will use this software to convert excel to csv. Same supplier always same format of data. So I am using a table to store suppliers excel data format.&nbsp;</p>\r\n<p>I have to retrieve 3 more columns which content is place, rate etc.</p>\r\n<p>&nbsp;</p>\r\n<p>Now, I am reading all the cells using getFormattedValue()</p>\r\n<p>But whenever I use this command it will format cell which is not even similar as excel cell.</p>\r\n<p>in the excel cell got value like 12-12-2012</p>\r\n<p>but phpexcel give me value 12-12-12 some times it give me just a number</p>\r\n<p>I need date in 12/12/2012 format. Input could be any format(defined by the user\r\n</p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre>$date_format=<span style=\"color:#a31515\">'d-m-Y'</span>;<span style=\"color:green\">// it come from database</span>\r\n$objReader = PHPExcel_IOFactory::createReader($inputFileType);\r\n\r\n$filterSubset = <span style=\"color:blue\">new</span> MyReadFilter($begin,$finish,range($lowest_col,$heighest_col)); \r\n<span style=\"color:blue\">echo</span> <span style=\"color:#a31515\">'Loading Sheet using filter'</span>; \r\n$objPHPExcel = <span style=\"color:blue\">new</span> PHPExcel();\r\n$objReader-&gt;setReadFilter($filterSubset); \r\n\r\n$objPHPExcel = $objReader-&gt;load($target_path);\r\n\r\n$dail_code= <span style=\"color:blue\">array</span>();\r\n$destination= <span style=\"color:blue\">array</span>();\r\n$rate=<span style=\"color:blue\">array</span>();\r\n$e_date=<span style=\"color:blue\">array</span>();\r\n\r\n\t     $objWorksheet = $objPHPExcel-&gt;setActiveSheetIndex(0); \r\n\t\t  $d=$objWorksheet-&gt;getCell($dial_col.$start1)-&gt;getFormattedValue(); \r\n\t\t   $e=$objWorksheet-&gt;getCell($dest_col.$start2)-&gt;getFormattedValue();  \r\n\t\t   $f=$objWorksheet-&gt;getCell( $rate_col.$start3)-&gt;getFormattedValue();  \r\n        \t $p=$objWorksheet-&gt;getCell($date_col.$start4)-&gt;getFormattedValue();  \r\n        \r\n$date = DateTime::createFromFormat($date_format,$p);\r\n        \r\n$g=$date-&gt;format(<span style=\"color:#a31515\">'d/m/Y'</span>);\r\n\t\t  \r\n\t\t  \r\nThis code is not working properly because in excel cell value was like 12-12-2012</pre>\r\n<pre>phpexcel make it as 12-12-12;</pre>\r\n<pre>and createFormFormat('d-m-Y',12-12-12<span style=\"background-color:white\">) can not work...because format is missing...so i need whatever inside the cell should read properly...</span></pre>\r\n<pre><span style=\"background-color:white\">Is there any one who can help me????</span></pre>\r\n<pre><span style=\"background-color:white\">\t  </span></pre>\r\n</div>\r\n<p></p>\r\n<p></p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre> \r\n</pre>\r\n</div>\r\n<p></p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n",
    "PostedDate": "2012-07-17T13:03:47.86-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "871294",
    "ThreadId": "371418",
    "Html": "<p>If the date value in the cell is an actual Excel date value (rather than a string), then use PHP's built in date handling functions to convert it directly to a PHP date/time value or DateTime object. If it's a string, then you don't need to use getFormattedValue(), simply use getValue() to read the raw string.</p>",
    "PostedDate": "2012-07-17T14:37:24.293-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]