[
  {
    "Id": "433243",
    "ThreadId": "209932",
    "Html": "<p>ï»¿I am having problems trying to load and read a complex Excel 5 spreadsheet. This file is generated by an <span id=\"result_box\"><span style=\"background-color:#ffffff\" title=contabilidad>accounting software and it has some form fields and macros to send data to a server. I'm not sure if this might be the cause or perhaps PHPExcel has a limitation I have not heard of...</span></span></p>\r\n<p><span><span style=\"background-color:#ffffff\" title=contabilidad>I am not trying to modify the macros or nothing weird... I just need to insert some data on a table and download the modified file, that's all.</span></span></p>\r\n<p>I'm using Symfony PHP Framework and when trying to generate the file using Excel5 as reader, I get the following error:</p>\r\n<p>&nbsp;</p>\r\n<table dir=ltr border=1 cellspacing=0 cellpadding=1>\r\n<tbody>\r\n<tr>\r\n<th colspan=5 align=left><span style=\"background-color:#cc0000;color:#fce94f;font-size:x-large\">( ! )</span> Notice: Undefined offset:  1 in /.../Excel5.php on line <em>4221</em></th>\r\n</tr>\r\n<tr>\r\n<th colspan=5 align=left>Call Stack</th>\r\n</tr>\r\n<tr>\r\n<th align=center>#</th><th align=left>Time</th><th align=left>Memory</th><th align=left>Function</th><th align=left>Location</th>\r\n</tr>\r\n<tr>\r\n<td align=center bgcolor=\"#eeeeec\">1</td>\r\n<td align=center bgcolor=\"#eeeeec\">0.0001</td>\r\n<td align=right bgcolor=\"#eeeeec\">52336</td>\r\n<td bgcolor=\"#eeeeec\">{main}(  )</td>\r\n<td title=\"/home/jchavez/workspace/tnl/web/backend_dev.php\" bgcolor=\"#eeeeec\">../backend_dev.php<strong>:</strong>0</td>\r\n</tr>\r\n<tr>\r\n<td align=center bgcolor=\"#eeeeec\">2</td>\r\n<td align=center bgcolor=\"#eeeeec\">0.3583</td>\r\n<td align=right bgcolor=\"#eeeeec\">4665412</td>\r\n<td bgcolor=\"#eeeeec\">sfContext-&gt;dispatch(  )</td>\r\n<td title=\"/home/jchavez/workspace/tnl/web/backend_dev.php\" bgcolor=\"#eeeeec\">../backend_dev.php<strong>:</strong>13</td>\r\n</tr>\r\n<tr>\r\n<td align=center bgcolor=\"#eeeeec\">3</td>\r\n<td align=center bgcolor=\"#eeeeec\">0.3583</td>\r\n<td align=right bgcolor=\"#eeeeec\">4665412</td>\r\n<td bgcolor=\"#eeeeec\">sfFrontWebController-&gt;dispatch(  )</td>\r\n<td title=\"/home/jchavez/workspace/tnl/lib/vendor/symfony/lib/util/sfContext.class.php\" bgcolor=\"#eeeeec\">../sfContext.class.php<strong>:</strong>159</td>\r\n</tr>\r\n<tr>\r\n<td align=center bgcolor=\"#eeeeec\">4</td>\r\n<td align=center bgcolor=\"#eeeeec\">0.3584</td>\r\n<td align=right bgcolor=\"#eeeeec\">4671032</td>\r\n<td bgcolor=\"#eeeeec\">sfController-&gt;forward(  )</td>\r\n<td title=\"/home/jchavez/workspace/tnl/lib/vendor/symfony/lib/controller/sfFrontWebController.class.php\" bgcolor=\"#eeeeec\">../sfFrontWebController.class.php<strong>:</strong>48</td>\r\n</tr>\r\n<tr>\r\n<td align=center bgcolor=\"#eeeeec\">5</td>\r\n<td align=center bgcolor=\"#eeeeec\">0.3644</td>\r\n<td align=right bgcolor=\"#eeeeec\">4848488</td>\r\n<td bgcolor=\"#eeeeec\">sfFilterChain-&gt;execute(  )</td>\r\n<td title=\"/home/jchavez/workspace/tnl/lib/vendor/symfony/lib/controller/sfController.class.php\" bgcolor=\"#eeeeec\">../sfController.class.php<strong>:</strong>245</td>\r\n</tr>\r\n<tr>\r\n<td align=center bgcolor=\"#eeeeec\">6</td>\r\n<td align=center bgcolor=\"#eeeeec\">0.3653</td>\r\n<td align=right bgcolor=\"#eeeeec\">4862324</td>\r\n<td bgcolor=\"#eeeeec\">sfRenderingFilter-&gt;execute(  )</td>\r\n<td title=\"/home/jchavez/workspace/tnl/lib/vendor/symfony/lib/filter/sfFilterChain.class.php\" bgcolor=\"#eeeeec\">../sfFilterChain.class.php<strong>:</strong>53</td>\r\n</tr>\r\n<tr>\r\n<td align=center bgcolor=\"#eeeeec\">7</td>\r\n<td align=center bgcolor=\"#eeeeec\">0.3653</td>\r\n<td align=right bgcolor=\"#eeeeec\">4862324</td>\r\n<td bgcolor=\"#eeeeec\">sfFilterChain-&gt;execute(  )</td>\r\n<td title=\"/home/jchavez/workspace/tnl/lib/vendor/symfony/lib/filter/sfRenderingFilter.class.php\" bgcolor=\"#eeeeec\">../sfRenderingFilter.class.php<strong>:</strong>33</td>\r\n</tr>\r\n<tr>\r\n<td align=center bgcolor=\"#eeeeec\">8</td>\r\n<td align=center bgcolor=\"#eeeeec\">0.3665</td>\r\n<td align=right bgcolor=\"#eeeeec\">4868312</td>\r\n<td bgcolor=\"#eeeeec\">sfBasicSecurityFilter-&gt;execute(  )</td>\r\n<td title=\"/home/jchavez/workspace/tnl/lib/vendor/symfony/lib/filter/sfFilterChain.class.php\" bgcolor=\"#eeeeec\">../sfFilterChain.class.php<strong>:</strong>53</td>\r\n</tr>\r\n<tr>\r\n<td align=center bgcolor=\"#eeeeec\">9</td>\r\n<td align=center bgcolor=\"#eeeeec\">0.3781</td>\r\n<td align=right bgcolor=\"#eeeeec\">5127188</td>\r\n<td bgcolor=\"#eeeeec\">sfFilterChain-&gt;execute(  )</td>\r\n<td title=\"/home/jchavez/workspace/tnl/lib/vendor/symfony/lib/filter/sfBasicSecurityFilter.class.php\" bgcolor=\"#eeeeec\">../sfBasicSecurityFilter.class.php<strong>:</strong>62</td>\r\n</tr>\r\n<tr>\r\n<td align=center bgcolor=\"#eeeeec\">10</td>\r\n<td align=center bgcolor=\"#eeeeec\">0.3791</td>\r\n<td align=right bgcolor=\"#eeeeec\">5129076</td>\r\n<td bgcolor=\"#eeeeec\">sfCommonFilter-&gt;execute(  )</td>\r\n<td title=\"/home/jchavez/workspace/tnl/lib/vendor/symfony/lib/filter/sfFilterChain.class.php\" bgcolor=\"#eeeeec\">../sfFilterChain.class.php<strong>:</strong>53</td>\r\n</tr>\r\n<tr>\r\n<td align=center bgcolor=\"#eeeeec\">11</td>\r\n<td align=center bgcolor=\"#eeeeec\">0.3791</td>\r\n<td align=right bgcolor=\"#eeeeec\">5129076</td>\r\n<td bgcolor=\"#eeeeec\">sfFilterChain-&gt;execute(  )</td>\r\n<td title=\"/home/jchavez/workspace/tnl/lib/vendor/symfony/lib/filter/sfCommonFilter.class.php\" bgcolor=\"#eeeeec\">../sfCommonFilter.class.php<strong>:</strong>29</td>\r\n</tr>\r\n<tr>\r\n<td align=center bgcolor=\"#eeeeec\">12</td>\r\n<td align=center bgcolor=\"#eeeeec\">0.3801</td>\r\n<td align=right bgcolor=\"#eeeeec\">5132652</td>\r\n<td bgcolor=\"#eeeeec\">sfExecutionFilter-&gt;execute(  )</td>\r\n<td title=\"/home/jchavez/workspace/tnl/lib/vendor/symfony/lib/filter/sfFilterChain.class.php\" bgcolor=\"#eeeeec\">../sfFilterChain.class.php<strong>:</strong>53</td>\r\n</tr>\r\n<tr>\r\n<td align=center bgcolor=\"#eeeeec\">13</td>\r\n<td align=center bgcolor=\"#eeeeec\">0.3802</td>\r\n<td align=right bgcolor=\"#eeeeec\">5132916</td>\r\n<td bgcolor=\"#eeeeec\">sfExecutionFilter-&gt;handleAction(  )</td>\r\n<td title=\"/home/jchavez/workspace/tnl/lib/vendor/symfony/lib/filter/sfExecutionFilter.class.php\" bgcolor=\"#eeeeec\">../sfExecutionFilter.class.php<strong>:</strong>42</td>\r\n</tr>\r\n<tr>\r\n<td align=center bgcolor=\"#eeeeec\">14</td>\r\n<td align=center bgcolor=\"#eeeeec\">0.3803</td>\r\n<td align=right bgcolor=\"#eeeeec\">5132916</td>\r\n<td bgcolor=\"#eeeeec\">sfExecutionFilter-&gt;executeAction(  )</td>\r\n<td title=\"/home/jchavez/workspace/tnl/lib/vendor/symfony/lib/filter/sfExecutionFilter.class.php\" bgcolor=\"#eeeeec\">../sfExecutionFilter.class.php<strong>:</strong>76</td>\r\n</tr>\r\n<tr>\r\n<td align=center bgcolor=\"#eeeeec\">15</td>\r\n<td align=center bgcolor=\"#eeeeec\">0.4164</td>\r\n<td align=right bgcolor=\"#eeeeec\">5388296</td>\r\n<td bgcolor=\"#eeeeec\">sfActions-&gt;execute(  )</td>\r\n<td title=\"/home/jchavez/workspace/tnl/lib/vendor/symfony/lib/filter/sfExecutionFilter.class.php\" bgcolor=\"#eeeeec\">../sfExecutionFilter.class.php<strong>:</strong>90</td>\r\n</tr>\r\n<tr>\r\n<td align=center bgcolor=\"#eeeeec\">16</td>\r\n<td align=center bgcolor=\"#eeeeec\">0.4176</td>\r\n<td align=right bgcolor=\"#eeeeec\">5393912</td>\r\n<td bgcolor=\"#eeeeec\">expenseActions-&gt;executeListContpaqExport(  )</td>\r\n<td title=\"/home/jchavez/workspace/tnl/lib/vendor/symfony/lib/action/sfActions.class.php\" bgcolor=\"#eeeeec\">../sfActions.class.php<strong>:</strong>60</td>\r\n</tr>\r\n<tr>\r\n<td align=center bgcolor=\"#eeeeec\">17</td>\r\n<td align=center bgcolor=\"#eeeeec\">1.8576</td>\r\n<td align=right bgcolor=\"#eeeeec\">19527020</td>\r\n<td bgcolor=\"#eeeeec\">PHPExcel_Reader_Excel5-&gt;load(  )</td>\r\n<td title=\"/home/jchavez/workspace/tnl/apps/backend/modules/expense/actions/actions.class.php\" bgcolor=\"#eeeeec\">../actions.class.php<strong>:</strong>324</td>\r\n</tr>\r\n<tr>\r\n<td align=center bgcolor=\"#eeeeec\">18</td>\r\n<td align=center bgcolor=\"#eeeeec\">2.7440</td>\r\n<td align=right bgcolor=\"#eeeeec\">23685496</td>\r\n<td bgcolor=\"#eeeeec\">PHPExcel_Reader_Excel5-&gt;_readDefinedName(  )</td>\r\n<td title=\"/home/jchavez/workspace/tnl/lib/vendor/PHPExcel/Classes/PHPExcel/Reader/Excel5.php\" bgcolor=\"#eeeeec\">../Excel5.php<strong>:</strong>586</td>\r\n</tr>\r\n<tr>\r\n<td align=center bgcolor=\"#eeeeec\">19</td>\r\n<td align=center bgcolor=\"#eeeeec\">2.7442</td>\r\n<td align=right bgcolor=\"#eeeeec\">23685496</td>\r\n<td bgcolor=\"#eeeeec\">PHPExcel_Reader_Excel5-&gt;_getFormulaFromStructure(  )</td>\r\n<td title=\"/home/jchavez/workspace/tnl/lib/vendor/PHPExcel/Classes/PHPExcel/Reader/Excel5.php\" bgcolor=\"#eeeeec\">../Excel5.php<strong>:</strong>1792</td>\r\n</tr>\r\n<tr>\r\n<td align=center bgcolor=\"#eeeeec\">20</td>\r\n<td align=center bgcolor=\"#eeeeec\">2.7443</td>\r\n<td align=right bgcolor=\"#eeeeec\">23685496</td>\r\n<td bgcolor=\"#eeeeec\">PHPExcel_Reader_Excel5-&gt;_getFormulaFromData(  )</td>\r\n<td title=\"/home/jchavez/workspace/tnl/lib/vendor/PHPExcel/Classes/PHPExcel/Reader/Excel5.php\" bgcolor=\"#eeeeec\">../Excel5.php<strong>:</strong>3613</td>\r\n</tr>\r\n<tr>\r\n<td align=center bgcolor=\"#eeeeec\">21</td>\r\n<td align=center bgcolor=\"#eeeeec\">2.7443</td>\r\n<td align=right bgcolor=\"#eeeeec\">23685496</td>\r\n<td bgcolor=\"#eeeeec\">PHPExcel_Reader_Excel5-&gt;_getNextToken(  )</td>\r\n<td title=\"/home/jchavez/workspace/tnl/lib/vendor/PHPExcel/Classes/PHPExcel/Reader/Excel5.php\" bgcolor=\"#eeeeec\">../Excel5.php<strong>:</strong>3629</td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n<p>I hope someone can help understanding this issue and possible find a workaround or solution.</p>\r\n<p>My dev environment is composed by:</p>\r\n<table width=554 height=88>\r\n<tbody>\r\n<tr>\r\n<th>PHPExcel Version:</th>\r\n<td>1.7.0</td>\r\n</tr>\r\n<tr>\r\n<th>PHP Version:</th>\r\n<td>PHP 5.2.6-2ubuntu4.6 with Suhosin-Patch 0.9.6.2</td>\r\n</tr>\r\n<tr>\r\n<th>SO:</th>\r\n<td>\r\n<p>Kubuntu 8.10</p>\r\n</td>\r\n</tr>\r\n<tr>\r\n<th>Symfony Version:</th>\r\n<td>\r\n<p>1.2.8</p>\r\n</td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n<p>Best regards and thanks in advance!</p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2010-04-20T09:22:15.253-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "433338",
    "ThreadId": "209932",
    "Html": "<p>It would be useful to have a copy of the file, if that's possible, in order to determine exactly what is causing this problem; although the most obvious cause would be a user-defined function used&nbsp;within the workbook.</p>",
    "PostedDate": "2010-04-20T13:26:06.167-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]