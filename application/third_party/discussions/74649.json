[
  {
    "Id": "255482",
    "ThreadId": "74649",
    "Html": "<p>Hello,</p>\r\n<p>first... Thanks for this library!</p>\r\n<p>Here is the problem now. I want store long text in cell but as I've found out Excel only displays about 1024 chars. But if we add line break \\n it also display next line of chars. I hope you understand me :))</p>\r\n<p>So I wrote this function. It isn't the best optimized one but could be helpful for someone. Also not tested very well.</p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre><span style=\"color:Green\"><br>/**<br> *\tIf the text is longer than 1024 characters, add \\n after certain width of the line.<br> *\tIt's only working for Arial font now.<br> *\t<br> *\t@param\tstring\tText to break.<br> *\t@param\tint\tWidth of text block in pixels.<br> *\t@param\tint\tFont size in points.<br> *\t@return\tstring\t <br> **/</span><br><span style=\"color:Blue\">public</span> <span style=\"color:Blue\">function</span> breakLongText($txt, $width, $font_size = 9)<br>\t{<br>\t\t<span style=\"color:Blue\">if</span> (strlen($txt) &gt; 1024)\t<span style=\"color:Green\">// needs to break</span><br>\t\t{<br>\t\t\t<span style=\"color:Green\">// correct path has to be defined here</span><br>\t\t\t$font_path = <span style=\"color:#A31515\">'./arial</span><span style=\"color:#A31515\">.ttf'</span>;<br>  \t\t\t<br>\t\t\t$breaked = <span style=\"color:#A31515\">''</span>;<br>\t\t\t$words = explode(<span style=\"color:#A31515\">' '</span>, $txt);<br>\t\t\t<br>\t\t\t$pos = 1;<br>\t\t\t<span style=\"color:Blue\">while</span> (!<span style=\"color:Blue\">empty</span>($words))<br>\t\t\t{<br>\t\t\t\t<span style=\"color:Blue\">if</span> ($pos == count($words))<br>\t\t\t\t\t<span style=\"color:Blue\">break</span>;<br>\t\t\t\t<br>\t\t\t\t$line = implode(<span style=\"color:#A31515\">' '</span>, array_slice($words, 0, $pos));<br>\t\t\t\t$box_points = imagettfbbox($font_size, 0, $font_path, $line);<br>\t\t\t\t$textwidth = $box_points[2]-$box_points[0];<br>\t\t\t\t<br>\t\t\t\t<span style=\"color:Blue\">if</span> ($textwidth &gt; $width)<br>\t\t\t\t{<br>\t\t\t\t\t$breaked .= (<span style=\"color:Blue\">empty</span>($breaked) ? <span style=\"color:#A31515\">''</span> : <span style=\"color:#A31515\">&quot;\\n&quot;</span>). implode(<span style=\"color:#A31515\">' '</span>, array_slice($words, 0, $pos-1));<br>\t\t\t\t\t$words = array_slice($words, $pos-1);<br>\t\t\t\t\t$pos = 0;<br>\t\t\t\t}<br>\t\t\t\t<br>\t\t\t\t$pos++;<br>\t\t\t}<br>\t\t\t<span style=\"color:Blue\">if</span> (!<span style=\"color:Blue\">empty</span>($words))<br>\t\t\t\t$breaked .= (<span style=\"color:Blue\">empty</span>($breaked) ? <span style=\"color:#A31515\">''</span> : <span style=\"color:#A31515\">&quot;\\n&quot;</span>). implode(<span style=\"color:#A31515\">' '</span>, $words);<br>\t\t\t<br>\t\t\t$txt = $breaked;<br>\t\t}<br>\t\t<br>\t\t<span style=\"color:Blue\">return</span> $txt;<br>\t}<br></pre>\r\n</div>\r\n<p>&nbsp;</p>",
    "PostedDate": "2009-11-10T05:25:42.093-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "255783",
    "ThreadId": "74649",
    "Html": "<p>I was not aware of such trick! Thanks for posting your code.</p>\r\n<p>Reference for others about the 1,024 character limit:</p>\r\n<p><a href=\"http://support.microsoft.com/kb/211580\">http://support.microsoft.com/kb/211580</a></p>\r\n<p>My only concern about using that method is when the user makes the column narrower after the Excel file has been generated. Then the added line breaks may be an inconvenience since the text may not wrap that nicely anymore, but I guess it depends on the situation. Perhaps your method can be enhanced to instead set the correct row height which should also make characters above 1024 visible. We should perhaps look into this at some later point!</p>",
    "PostedDate": "2009-11-10T17:54:09.933-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "255843",
    "ThreadId": "74649",
    "Html": "<p>No, set height won't help. That was my first solution. But chars after 1024 wasn't displayed just empty space. But if you want I could post you function to get count of rows depending on the text. It's somethink like:</p>\r\n<p>1. remove &quot;\\n&quot; from text.</p>\r\n<p>2. pass text to imagettfbbox function and get width</p>\r\n<p>3. number of rows = width/line_width</p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2009-11-10T22:59:14.667-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "256175",
    "ThreadId": "74649",
    "Html": "<blockquote style=\"border:0.1em solid #cccccc;margin:0.25em 1em 0pt;padding:0pt 0.25em;font-style:italic\"><strong>waky wrote:</strong><br>\r\n<p>No, set height won't help. That was my first solution. But chars after 1024 wasn't displayed just empty space.</p>\r\n</blockquote>\r\n<p>Can you try to run this example:</p>\r\n<p style=\"font-family:Courier New\">$excel = new PHPExcel();<br>$worksheet = $excel-&gt;getActiveSheet();<br><br>$text = &lt;&lt;&lt;TEXT<br>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed ante velit, dictum eu laoreet bibendum, sagittis eu dolor. Nunc elementum arcu et risus porta eget fermentum metus egestas. Vestibulum dictum accumsan lacinia. Ut congue ornare blandit. Nam mattis tincidunt lectus ut elementum. Praesent rhoncus sapien sit amet lacus elementum aliquam. Vivamus nunc neque, adipiscing ac adipiscing quis, ullamcorper nec lectus. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Suspendisse hendrerit magna varius tortor lacinia ut euismod ipsum posuere. Curabitur feugiat vehicula mattis. Morbi nec odio at nibh cursus porta vitae non nibh. Suspendisse potenti. Fusce id neque tristique arcu gravida lacinia sed eget ipsum. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vestibulum vitae nisi id nunc fringilla ultricies. Nullam libero sapien, luctus ut porta id, pulvinar a neque.<br><br>Vestibulum blandit orci in diam feugiat quis ullamcorper metus iaculis. Duis sed bibendum dolor. Donec blandit facilisis magna, et bibendum magna consectetur quis. Vestibulum vitae dolor velit, in porttitor sem. Sed pellentesque, purus dictum tristique laoreet, felis nisi accumsan ligula, a suscipit orci eros porttitor tellus. Nunc vel libero in lectus iaculis tempor vitae at sem. Suspendisse posuere nibh ut mauris ornare aliquam. Integer vel dui quis magna consequat rutrum. Nullam porta vulputate lectus nec cursus. Donec porttitor sem suscipit libero suscipit consectetur. Quisque ipsum nisl, euismod sed mattis sed, luctus et lectus. Donec vel tristique enim. Donec lacus arcu, tempor ac vehicula at, scelerisque posuere ipsum. Aenean pellentesque odio sit amet nisi convallis faucibus. Donec quis dui arcu. Nullam ultricies, libero ultrices tempor mollis, enim orci egestas risus, in malesuada leo nisl at enim.<br><br>Integer porta pellentesque quam, id tristique purus consectetur sit amet. Mauris vestibulum orci nibh, vitae semper magna. Phasellus condimentum varius iaculis. Ut eleifend nulla nec mi facilisis vitae condimentum augue vestibulum. Curabitur tristique euismod fringilla. Duis eu leo elementum ante consectetur consectetur vitae in dui. Aliquam pharetra cursus mi, in suscipit augue fermentum ac. Vivamus euismod mattis luctus. Aliquam erat volutpat. Quisque adipiscing consectetur risus quis viverra. Donec id tellus et velit fringilla convallis ac sit amet turpis. Nullam sodales arcu at risus blandit tristique. Aenean bibendum varius nisl, sed volutpat odio viverra vitae. Nulla at nulla ac ipsum ultricies eleifend. Nullam in sem vel eros aliquet dapibus. Aliquam fermentum pellentesque enim et feugiat. Etiam tincidunt risus vitae metus congue pharetra.<br><br>Donec et ipsum felis, sit amet mollis turpis. Cras sit amet elit sapien. Ut sapien est, sagittis in egestas rhoncus, pellentesque nec ipsum. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nullam in lacus urna. Nam ornare scelerisque nunc, id tempus turpis luctus sit amet. Duis convallis scelerisque tellus vitae euismod. Suspendisse et sem eget erat pellentesque euismod ac vel eros. Aliquam erat volutpat. Nunc bibendum fringilla odio eget interdum. Etiam nunc velit, fringilla non volutpat id, sollicitudin quis magna. Pellentesque tincidunt, massa ut pulvinar ornare, libero enim imperdiet enim, scelerisque ornare erat arcu a dui.<br><br>Curabitur fermentum fermentum nisi, et suscipit elit elementum sed. Integer eget volutpat est. Proin vel lorem dui, volutpat tristique sapien. Integer mollis suscipit pharetra. Maecenas ut est est, in tempor nisi. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nullam aliquet egestas consequat. Suspendisse velit augue, condimentum non vulputate at, semper at augue. Donec non est vitae sem malesuada pulvinar eget ac tortor. Aliquam erat volutpat. Vivamus sodales nisi at arcu aliquam bibendum. Nullam at erat vitae ligula porta facilisis molestie id magna. Suspendisse tincidunt varius tellus, nec placerat arcu imperdiet ac. Curabitur nisl quam, bibendum eu suscipit at, scelerisque mollis justo. Donec tristique felis id erat accumsan id suscipit velit condimentum. <br>TEXT;</p>\r\n<p style=\"font-family:Courier New\">$worksheet-&gt;getCell('A1')-&gt;setValue($text);<br>$worksheet-&gt;getStyle('A1')-&gt;getAlignment()-&gt;setWrapText(true);<br><br>$worksheet-&gt;getRowDimension(1)-&gt;setRowHeight('350');<br>$worksheet-&gt;getColumnDimension('A')-&gt;setWidth('120');<br><br>$writer = PHPExcel_IOFactory::createWriter($excel, 'Excel2007');<br>$writer-&gt;save('write.xlsx');</p>\r\n<p>Look, I can see more than 1024 characters:</p>\r\n<p><a href=\"http://img697.imageshack.us/img697/9256/ss20091112020942.png\"><img src=\"http://img697.imageshack.us/img697/9256/ss20091112020942.th.png\" border=0 alt=\"\"></a></p>\r\n<p>Here is the file:</p>\r\n<p><a href=\"http://phpexcel.codeplex.com/Project/Download/AttachmentDownload.ashx?ProjectName=PHPExcel&WorkItemId=10749&FileAttachmentId=3532\">write-1024-limit.xlsx</a></p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2009-11-11T17:12:04.897-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]