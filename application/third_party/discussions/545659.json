[
  {
    "Id": "1246451",
    "ThreadId": "545659",
    "Html": "Hi All,\r<br />\nI have been banging my head against a wall here for the last few days and thought I should just come and ask and see if any one could help me before I send my computer out the window. \r<br />\nBasically I am running a pretty complicated excel sheet and now it needs to move into an online system. There are two values that get collected from the sheet. The first works perfectly but the second one always comes out with a #value! error. If I save the sheet through php excel and then open it in excel, it calculates my value fine. If I save this file and then reload it php excel it still gives the same value error.\r<br />\nThis is a dump from the &quot;testformula&quot; function I found in response to someone else who had similar errors:\r<br />\n14:07:19 Create new PHPExcel object\r<br />\nFormula Value is=(D8-VLOOKUP(D8,$H$15:$J$129,2))/(VLOOKUP(D8,$H$15:$J$129,3)-VLOOKUP(D8,$H$15:$J$129,2))*(M23-M22)+M22 Expected Value is 0 Parser Stack :- Array ( [0] =&gt; Array ( [type] =&gt; Cell Reference [value] =&gt; D8 [reference] =&gt; D8 ) [1] =&gt; Array ( [type] =&gt; Cell Reference [value] =&gt; D8 [reference] =&gt; D8 ) [2] =&gt; Array ( [type] =&gt; Cell Reference [value] =&gt; $H$15 [reference] =&gt; $H$15 ) [3] =&gt; Array ( [type] =&gt; Cell Reference [value] =&gt; $J$129 [reference] =&gt; $J$129 ) [4] =&gt; Array ( [type] =&gt; Binary Operator [value] =&gt; : [reference] =&gt; ) [5] =&gt; Array ( [type] =&gt; Value [value] =&gt; 2 [reference] =&gt; ) [6] =&gt; Array ( [type] =&gt; Operand Count for Function VLOOKUP() [value] =&gt; 3 [reference] =&gt; ) [7] =&gt; Array ( [type] =&gt; Function [value] =&gt; VLOOKUP( [reference] =&gt; ) [8] =&gt; Array ( [type] =&gt; Binary Operator [value] =&gt; - [reference] =&gt; ) [9] =&gt; Array ( [type] =&gt; Cell Reference [value] =&gt; D8 [reference] =&gt; D8 ) [10] =&gt; Array ( [type] =&gt; Cell Reference [value] =&gt; $H$15 [reference] =&gt; $H$15 ) [11] =&gt; Array ( [type] =&gt; Cell Reference [value] =&gt; $J$129 [reference] =&gt; $J$129 ) [12] =&gt; Array ( [type] =&gt; Binary Operator [value] =&gt; : [reference] =&gt; ) [13] =&gt; Array ( [type] =&gt; Value [value] =&gt; 3 [reference] =&gt; ) [14] =&gt; Array ( [type] =&gt; Operand Count for Function VLOOKUP() [value] =&gt; 3 [reference] =&gt; ) [15] =&gt; Array ( [type] =&gt; Function [value] =&gt; VLOOKUP( [reference] =&gt; ) [16] =&gt; Array ( [type] =&gt; Cell Reference [value] =&gt; D8 [reference] =&gt; D8 ) [17] =&gt; Array ( [type] =&gt; Cell Reference [value] =&gt; $H$15 [reference] =&gt; $H$15 ) [18] =&gt; Array ( [type] =&gt; Cell Reference [value] =&gt; $J$129 [reference] =&gt; $J$129 ) [19] =&gt; Array ( [type] =&gt; Binary Operator [value] =&gt; : [reference] =&gt; ) [20] =&gt; Array ( [type] =&gt; Value [value] =&gt; 2 [reference] =&gt; ) [21] =&gt; Array ( [type] =&gt; Operand Count for Function VLOOKUP() [value] =&gt; 3 [reference] =&gt; ) [22] =&gt; Array ( [type] =&gt; Function [value] =&gt; VLOOKUP( [reference] =&gt; ) [23] =&gt; Array ( [type] =&gt; Binary Operator [value] =&gt; - [reference] =&gt; ) [24] =&gt; Array ( [type] =&gt; Binary Operator [value] =&gt; / [reference] =&gt; ) [25] =&gt; Array ( [type] =&gt; Cell Reference [value] =&gt; M23 [reference] =&gt; M23 ) [26] =&gt; Array ( [type] =&gt; Cell Reference [value] =&gt; M22 [reference] =&gt; M22 ) [27] =&gt; Array ( [type] =&gt; Binary Operator [value] =&gt; - [reference] =&gt; ) [28] =&gt; Array ( [type] =&gt; Binary Operator [value] =&gt; * [reference] =&gt; ) [29] =&gt; Array ( [type] =&gt; Cell Reference [value] =&gt; M22 [reference] =&gt; M22 ) [30] =&gt; Array ( [type] =&gt; Binary Operator [value] =&gt; + [reference] =&gt; ) ) Calculated Value is #VALUE! Evaluation Log: \r<br />\nFatal error: Cannot access private property PHPExcel_Calculation::$debugLog in XXX<br />\n",
    "PostedDate": "2014-05-17T06:24:38.43-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1246841",
    "ThreadId": "545659",
    "Html": "I have further narrowed down the problem to one of the lookups that the formula does. Specifically this one:\r<br />\nVLOOKUP(D13,Loadings!$I$12:$K$201,2,FALSE)\r<br />\n<br />\nBasically that is looking up another value on a separate sheet. any ideas why that lookup might not work? Cell D13 is a string, the value that's being returned should be an integer.\r<br />\nAs I say excel (and open office ) do this lookup fine, so I'm guessing this is a quirk of the phpexcel code that maybe others know about? <br />\n",
    "PostedDate": "2014-05-19T01:21:14.62-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]