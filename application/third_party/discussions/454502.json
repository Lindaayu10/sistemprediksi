[
  {
    "Id": "1084781",
    "ThreadId": "454502",
    "Html": "Hello,<br />\n<br />\nI have the following fonction on a drupal V7 environment:<br />\n<br />\nunction RSE_Export_export_stuff() {<br />\nerror_reporting(E_ALL);<br />\nini_set('display_errors', TRUE);<br />\nini_set('display_startup_errors', TRUE);<br />\ndate_default_timezone_set('Europe/London');<br />\nrequire_once(&quot;sites/all/libraries/PHPExcel/Classes/PHPExcel.php&quot;);<br />\nrequire_once(&quot;sites/all/libraries/PHPExcel/Classes/PHPExcel/IOFactory.php&quot;);<br />\n<br />\n //module_load_include('inc', 'phpexcel');<br />\n$data = array();<br />\n$headers = array();<br />\n<br />\n// First worksheet<br />\n<br />\nglobal $user;<br />\n$userId = $user-&gt;name;<br />\n<br />\n...<br />\n<br />\n<br />\n// Freeze pane so that the heading line won't scroll<br />\n$objPHPExcel-&gt;getActiveSheet()-&gt;freezePane('A2');<br />\n<br />\n// Save as an Excel BIFF (xls) file<br />\n<br />\n$objWriter = new PHPExcel_Writer_Excel2007($objPHPExcel);<br />\nheader('Content-type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');<br />\nheader('Content-Disposition:inline;filename=contacts.xlsx');<br />\nob_clean();<br />\nif ( headers_sent() ) die(&quot;**Error: headers sent&quot;);<br />\n$objWriter-&gt;save('php://output');<br />\n<br />\nexit;<br />\n<br />\n<br />\n} <br />\n<br />\nIt works fine on the development environment.<br />\n<br />\nOn the test environment, I have the following message:<br />\n<br />\nPHPExcel_Writer_Exception : Could not close zip file php://output. dans PHPExcel_Writer_Excel2007-&gt;save() (ligne 348 dans /home/site1394/www/sites/all/libraries/PHPExcel/Classes/PHPExcel/Writer/Excel2007.php).<br />\n<br />\nI have checked the rights on site/default/files and they are the same than on the development.<br />\n<br />\nThe goal is to generate an excel file and to download it on the PC.<br />\n<br />\nDo you have an idea??<br />\n<br />\nThanks<br />\n<br />\nDidier<br />\n",
    "PostedDate": "2013-08-25T23:01:49.213-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]