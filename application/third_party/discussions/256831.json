[
  {
    "Id": "609294",
    "ThreadId": "256831",
    "Html": "\r\n<p>I have an xlsx spreadsheet (Excel 2007) with A1 = &quot;Practice Header Id&quot;, B1 = &quot;Adviser Id&quot;, C1 = &quot;Agent Id&quot; etc.</p>\r\n<p>I am trying to check these exist and use the following coe:-</p>\r\n<p>&nbsp;&nbsp;&nbsp; require_once '../../includes/phpexcel/Classes/PHPExcel/IOFactory.php';<br>\r\n&nbsp;&nbsp;&nbsp; <br>\r\n&nbsp;&nbsp;&nbsp; $inputFileName = $fl; // $fl does contain the correct xlsx file<br>\r\n&nbsp;&nbsp;&nbsp; <br>\r\n&nbsp;&nbsp;&nbsp; //&nbsp; Define a Read Filter class implementing PHPExcel_Reader_IReadFilter&nbsp;\r\n<br>\r\n&nbsp;&nbsp;&nbsp; class MyReadFilter implements PHPExcel_Reader_IReadFilter <br>\r\n&nbsp;&nbsp;&nbsp; { <br>\r\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; public function readCell($column, $row, $worksheetName = 'Client List') {\r\n<br>\r\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; //&nbsp; Exclude row 1 and columns greater than Y<br>\r\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; //if ($row &gt; 1) { <br>\r\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; if (in_array($column,range('A','AL'))) {\r\n<br>\r\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; return true;\r\n<br>\r\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; } <br>\r\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; //} <br>\r\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; return false; <br>\r\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; } <br>\r\n&nbsp;&nbsp;&nbsp; }<br>\r\n&nbsp;&nbsp;&nbsp; <br>\r\n&nbsp;&nbsp;&nbsp; //&nbsp; Create an Instance of our Read Filter&nbsp; <br>\r\n&nbsp;&nbsp;&nbsp; $filterSubset = new MyReadFilter(); <br>\r\n&nbsp;&nbsp;&nbsp; <br>\r\n&nbsp;&nbsp;&nbsp; <br>\r\n&nbsp;&nbsp;&nbsp; $objReader = PHPExcel_IOFactory::createReader('Excel2007');<br>\r\n&nbsp;&nbsp;&nbsp; $objReader-&gt;setReadDataOnly(true);&nbsp;&nbsp;&nbsp; <br>\r\n&nbsp;&nbsp;&nbsp; //&nbsp; Tell the Reader that we want to use the Read Filter&nbsp;\r\n<br>\r\n&nbsp;&nbsp;&nbsp; $objReader-&gt;setReadFilter($filterSubset); <br>\r\n&nbsp;&nbsp;&nbsp; //&nbsp; Load only the rows and columns that match our filter to PHPExcel&nbsp;\r\n<br>\r\n&nbsp;&nbsp;&nbsp; try {<br>\r\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; // Load $inputFileName to a PHPExcel Object\r\n<br>\r\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $objPHPExcel = $objReader-&gt;load($fl); <br>\r\n&nbsp;&nbsp;&nbsp; } catch(Exception $e) {<br>\r\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; die('Error loading file: '.$e-&gt;getMessage());<br>\r\n&nbsp;&nbsp;&nbsp; }<br>\r\n&nbsp;&nbsp;&nbsp; <br>\r\n&nbsp;&nbsp;&nbsp; // check headings are correct<br>\r\n&nbsp;&nbsp;&nbsp; $ok = 'Y';<br>\r\n&nbsp;&nbsp;&nbsp; $sheet = $objPHPExcel-&gt;getActiveSheet();<br>\r\n&nbsp;&nbsp;&nbsp; $colA = $sheet-&gt;getCell('A1')-&gt;getValue();<br>\r\n&nbsp;&nbsp;&nbsp; if (strtoupper($colA) != strtoupper('Practice Header Id')) {<br>\r\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $ok = 'N';<br>\r\n&nbsp;&nbsp;&nbsp; }<br>\r\n&nbsp;&nbsp;&nbsp; echo ' 1 '.$colA.'&nbsp; '.$ok;<br>\r\n&nbsp;&nbsp;&nbsp; <br>\r\n&nbsp;&nbsp;&nbsp; $colB = $sheet-&gt;getCell('B1')-&gt;getValue();<br>\r\n&nbsp;&nbsp;&nbsp; if (strtoupper($colB) != strtoupper('Adviser Id')) {<br>\r\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $ok = 'N';<br>\r\n&nbsp;&nbsp;&nbsp; }<br>\r\n&nbsp;&nbsp;&nbsp; echo ' 2 '.$colB.'&nbsp; '.$ok;<br>\r\n<br>\r\n&nbsp;&nbsp;&nbsp; $colC = $sheet-&gt;getCell('C1')-&gt;getValue();<br>\r\n&nbsp;&nbsp;&nbsp; if (strtoupper($colC) != strtoupper('Agent Id')) {<br>\r\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $ok = 'N';<br>\r\n&nbsp;&nbsp;&nbsp; }<br>\r\n&nbsp;&nbsp;&nbsp; echo ' 3 '.$colC.'&nbsp; '.$ok;</p>\r\n<p>&nbsp;</p>\r\n<p>I get this returned:-</p>\r\n<p>1 Practice Header Id Y 2 N 3 N</p>\r\n<p>For some reason I do not understand it does not seem to be reading the value of cells B1 and C1.</p>\r\n<p>&nbsp;</p>\r\n<p>Any ideas please.</p>\r\n",
    "PostedDate": "2011-05-08T18:06:42.247-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "609358",
    "ThreadId": "256831",
    "Html": "<p>range('A','AL') isn't giving you what you expect....</p>\r\n<p>When using&nbsp;non-numeric values&nbsp;with range, character incrementing doesn't apply in the same way as if you use $x = 'A', $x++; so you can't use range() to specify a span of columns from a single character reference to a two character reference. range('A','M') will work because it's a single character range; range('A','AL') won't work (and will only give you 'A'). You'll need to define your array of valid columns slightly differently.</p>\r\n<div style=\"color: black; background-color: white;\">\r\n<pre><span style=\"color: blue;\">if</span> (in_array(PHPExcel_Cell::columnIndexFromString($column),</pre>\r\n<pre>             range(PHPExcel_Cell::columnIndexFromString(<span style=\"color: #a31515;\">'A'</span>),</pre>\r\n<pre>                   PHPExcel_Cell::columnIndexFromString(<span style=\"color: #a31515;\">'AL'</span>)))) { \r\n</pre>\r\n</div>",
    "PostedDate": "2011-05-08T23:32:54.683-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "609373",
    "ThreadId": "256831",
    "Html": "<p>Thanks for the prompt reply. Unfortunately I must be missing something. Neither of the 2 bits of code for the class work:-</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;&nbsp;&nbsp; //&nbsp; Define a Read Filter class implementing PHPExcel_Reader_IReadFilter&nbsp; <br />&nbsp;&nbsp;&nbsp; class MyReadFilter implements PHPExcel_Reader_IReadFilter <br />&nbsp;&nbsp;&nbsp; { <br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; public function readCell($column, $row, $worksheetName = 'Client List') { <br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; if (in_array(PHPExcel_Cell::columnIndexFromString($column),<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;range(PHPExcel_Cell::columnIndexFromString('A'),<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;PHPExcel_Cell::columnIndexFromString('AL')))) { <br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; return true;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; } else {<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; return false; <br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; } <br />&nbsp;&nbsp;&nbsp; }<br />This gives nothing<br /><br />&nbsp;&nbsp;&nbsp; //&nbsp; Define a Read Filter class implementing PHPExcel_Reader_IReadFilter&nbsp; <br />&nbsp;&nbsp;&nbsp; class MyReadFilter implements PHPExcel_Reader_IReadFilter <br />&nbsp;&nbsp;&nbsp; { <br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; public function readCell($column, $row, $worksheetName = 'Client List') { <br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; if (in_array($column,range(1,38))) { <br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; return true; <br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; } else {<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; return false; <br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; } <br />&nbsp;&nbsp;&nbsp; }</p>\r\n<p>This gives</p>\r\n<p>1   N 2   N 3   N</p>\r\n<p>What have I got wrong please?</p>",
    "PostedDate": "2011-05-09T00:15:53.57-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]