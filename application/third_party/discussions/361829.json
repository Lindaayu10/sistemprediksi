[
  {
    "Id": "856835",
    "ThreadId": "361829",
    "Html": "\r\n<p><span style=\"font-size:10pt\">Greetings!</span><span style=\"font-size:10pt\">&nbsp;</span></p>\r\n<p><span style=\"font-size:10pt\">- PHP5</span></p>\r\n<p><span style=\"font-size:10pt\">- Zend Framework 1.11</span></p>\r\n<p><span style=\"font-size:10pt\">- WAMP (php_zip is enabled)</span></p>\r\n<p><span style=\"font-size:10pt\">- PHPExcel_1.7.7</span></p>\r\n<p><span style=\"font-size:10pt\">&nbsp;</span></p>\r\n<p><span style=\"font-size:10pt\">I&rsquo;m attempting to convert xls and xlsx files uploaded by a user to csv files, and then save them on my server.</span></p>\r\n<p>&nbsp;</p>\r\n<p><span style=\"font-size:10pt\">The actual conversion process works the like a charm, the file appears in the proper directory in the proper format (csv). However, running it produces a mountain of inclusion warnings (I've only shown the first of each set since\r\n I assume the problems all stem from the same mistake). I&rsquo;ve used &ldquo;die()&rdquo; to narrow down where these errors are coming from.\r\n</span></p>\r\n<p><span style=\"font-size:10pt\">&nbsp;</span></p>\r\n<p><span style=\"font-size:10pt\">Code:</span></p>\r\n<p><strong><span style=\"font-size:10pt\">:: upload.php ::</span></strong></p>\r\n<p><span style=\"font-size:10pt\">&lt;?php </span></p>\r\n<p><span style=\"font-size:10pt\">&hellip;</span></p>\r\n<p><span style=\"font-size:10pt\">$convertedFilePath = $uploadDirectory . $fileData['filename']['name'] . '.csv';</span></p>\r\n<p><span style=\"font-size:10pt\">if (isset($_FILES['filename']['name']) &amp;&amp; $_FILES['filename']['name'] != '') {</span></p>\r\n<p><span style=\"font-size:10pt\"><span style=\"white-space:pre\">&nbsp;</span>$fileNameArray = explode(&quot;.&quot;, $_FILES['filename']['name']);</span></p>\r\n<p><span style=\"font-size:10pt\">&nbsp; &nbsp; &nbsp; &nbsp; $fileExtension = end($fileNameArray);</span></p>\r\n<p><span style=\"font-size:10pt\">if (strcmp(strtolower($fileExtension), &quot;csv&quot;) != 0) {</span></p>\r\n<p><span style=\"font-size:10pt\">&nbsp;</span></p>\r\n<p><strong><span style=\"font-size:6.5pt; color:#003366\">Warning: include_once(PHPExcel\\Shared\\ZipStreamWrapper.php) [</span></strong><a href=\"http://localhost/Upload105h/checkdata/function.include-once\"><strong><span style=\"font-size:6.5pt; color:#26689e\">function.include-once</span></strong></a><strong><span style=\"font-size:6.5pt; color:#003366\">]:\r\n failed to open stream: No such file or directory in ...\\trunk\\library\\Zend\\Loader.php on line<span>&nbsp;</span></span></strong><strong><em><span style=\"font-size:6.5pt; color:#003366\">146</span></em></strong></p>\r\n<p><span style=\"font-size:10pt\">&nbsp;</span></p>\r\n<p><span style=\"font-size:10pt\">require &lsquo;&hellip;\\trunk\\application\\controllers\\helpers\\xlsConverter.php';</span></p>\r\n<p><span style=\"font-size:10pt\">&nbsp; &nbsp; &nbsp; &nbsp; <span style=\"white-space:pre\">\r\n</span>converter($filePath, $convertedFilePath);</span></p>\r\n<p><span style=\"font-size:10pt\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $filePath = $convertedFilePath;</span></p>\r\n<p><span style=\"font-size:10pt\">}</span></p>\r\n<p><span style=\"font-size:10pt\">}</span></p>\r\n<p><span style=\"font-size:10pt\">&hellip;</span></p>\r\n<p><span style=\"font-size:10pt\">?&gt;</span></p>\r\n<p><strong><span style=\"font-size:10pt\">:: xlsConverter.php ::</span></strong></p>\r\n<p><span style=\"font-size:10pt\">&lt;?php</span></p>\r\n<p><span style=\"font-size:10pt\">require_once &lsquo;&hellip;\\trunk\\public\\libraries\\PHPExcel_1.7.7\\Classes\\PHPExcel\\IOFactory.php';</span></p>\r\n<p><span style=\"font-size:10pt\">function converter($sourceFilePath,$destinationFilePath) {&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p>\r\n<p><span style=\"font-size:10pt\">$excel = PHPExcel_IOFactory::load($sourceFilePath);</span></p>\r\n<p><span style=\"font-size:10pt\">&nbsp;</span></p>\r\n<p><strong><span style=\"font-size:6.5pt; color:#003366\">Warning: include_once(PHPExcel\\Reader\\Excel5.php) [</span></strong><a href=\"http://localhost/Upload105h/checkdata/function.include-once\"><strong><span style=\"font-size:6.5pt; color:#26689e\">function.include-once</span></strong></a><strong><span style=\"font-size:6.5pt; color:#003366\">]:\r\n failed to open stream: No such file or directory in ...\\trunk\\library\\Zend\\Loader.php on line<span>&nbsp;</span></span></strong><strong><em><span style=\"font-size:6.5pt; color:#003366\">146</span></em></strong></p>\r\n<p><span style=\"font-size:10pt\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;\r\n</span></p>\r\n<p><span style=\"font-size:10pt\">$writer = PHPExcel_IOFactory::createWriter($excel, 'CSV');</span></p>\r\n<p><span style=\"font-size:10pt\">&nbsp; &nbsp; &nbsp; &nbsp; $writer-&gt;setDelimiter(&quot;,&quot;);</span></p>\r\n<p><span style=\"font-size:10pt\">&nbsp; &nbsp; &nbsp; &nbsp; $writer-&gt;setEnclosure(&quot;&quot;);</span></p>\r\n<p><span style=\"font-size:10pt\">&nbsp; &nbsp; &nbsp; &nbsp; $writer-&gt;save($destinationFilePath);</span></p>\r\n<p><span style=\"font-size:10pt\">&nbsp;</span></p>\r\n<p><strong><span style=\"font-size:6.5pt; color:#003366\">Warning: include_once(PHPExcel\\Writer\\CSV.php) [</span></strong><a href=\"http://localhost/Upload105h/checkdata/function.include-once\"><strong><span style=\"font-size:6.5pt; color:#26689e\">function.include-once</span></strong></a><strong><span style=\"font-size:6.5pt; color:#003366\">]:\r\n failed to open stream: No such file or directory in ...\\trunk\\library\\Zend\\Loader.php on line<span>&nbsp;</span></span></strong><strong><em><span style=\"font-size:6.5pt; color:#003366\">146</span></em></strong><span style=\"font-size:10pt\">}</span></p>\r\n<p><span style=\"font-size:10pt\">?&gt;</span></p>\r\n<p>Any help and explanation of the problem would be appreciated!</p>\r\n<p>Best,</p>\r\n<p>lost</p>\r\n",
    "PostedDate": "2012-07-03T07:44:25.387-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "899954",
    "ThreadId": "361829",
    "Html": "<p>I am having similar problems :(</p>",
    "PostedDate": "2012-08-16T08:11:32.807-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "899989",
    "ThreadId": "361829",
    "Html": "<p>If the problem is integration into Zend Framework:</p>\r\n<p>&nbsp;</p>\r\n<p>Place the PHPExcel library into the /library folder, like this:</p>\r\n<pre class=\"lang-php prettyprint\"><code><span class=\"str\">/application \r\n... \r\n/</span><span class=\"pln\">library \r\n    </span><span class=\"pun\">/</span><span class=\"typ\">PHPExcel</span><span class=\"pln\"> \r\n    </span><span class=\"pun\">/</span><span class=\"typ\">PHPExcel</span><span class=\"pun\">.</span><span class=\"pln\">php \r\n</span></code></pre>\r\n<p>In your application.ini config file, add the following:</p>\r\n<pre class=\"lang-php prettyprint\"><code><span class=\"pln\">autoloaderNamespaces</span><span class=\"pun\">[]</span><span class=\"pln\"> </span><span class=\"pun\">=</span><span class=\"pln\"> </span><span class=\"str\">\"PHPExcel_\"</span><span class=\"pln\"> \r\nautoloaderNamespaces</span><span class=\"pun\">[]</span><span class=\"pln\"> </span><span class=\"pun\">=</span><span class=\"pln\"> </span><span class=\"str\">\"PHPExcel\"</span><span class=\"pln\"> \r\n</span></code></pre>",
    "PostedDate": "2012-08-16T09:47:25.697-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]