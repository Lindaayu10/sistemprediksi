[
  {
    "Id": "175381",
    "ThreadId": "52215",
    "Html": "I used the Hello World function provided here on the website (01simple.xlsx) and it works perfectly when I run the PHP from the command line -- the file write and I am able to open/read it.  However, when I put this <span style=\"font-weight:bold\">exact same code</span> in a function and run it from a webpage, the file is created yet I get a dialog box stating &quot;Converter failed to open the file.&quot; when I try to open it.<div><br></div><div>How could the same exact code work perfectly when inline and not work when in a function/called from the web?  Below is the code:<br><br></div><div><div>function test() {</div><div>error_reporting(E_ALL);</div><div> </div><div>/** Include path **/</div><div><span style=\"white-space:pre\">\t</span>set_include_path(get_include_path() . PATH_SEPARATOR . 'D:\\\\ASO-APPS\\\\PROD\\\\TTR\\\\db\\\\Classes\\\\');</div><div><span style=\"white-space:pre\">\t\t</span>error_reporting(E_ALL);</div><div>include(&quot;db\\Classes\\PHPExcel.php&quot;);</div><div>include(&quot;db\\Classes\\PHPExcel\\Writer\\Excel2007.php&quot;);</div><div> </div><div>// Create new PHPExcel object</div><div>echo date('H:i:s') . &quot; Create new PHPExcel object\\n&quot;;</div><div>$objPHPExcel = new PHPExcel();</div><div> </div><div>// Set properties</div><div>echo date('H:i:s') . &quot; Set properties\\n&quot;;</div><div>$objPHPExcel-&gt;getProperties()-&gt;setCreator(&quot;Maarten Balliauw&quot;);</div><div>$objPHPExcel-&gt;getProperties()-&gt;setLastModifiedBy(&quot;Maarten Balliauw&quot;);</div><div>$objPHPExcel-&gt;getProperties()-&gt;setTitle(&quot;Office 2007 XLSX Test Document&quot;);</div><div>$objPHPExcel-&gt;getProperties()-&gt;setSubject(&quot;Office 2007 XLSX Test Document&quot;);</div><div>$objPHPExcel-&gt;getProperties()-&gt;setDescription(&quot;Test document for Office 2007 XLSX, generated using PHP classes.&quot;);</div><div> </div><div> </div><div>// Add some data</div><div>echo date('H:i:s') . &quot; Add some data\\n&quot;;</div><div>$objPHPExcel-&gt;setActiveSheetIndex(0);</div><div>$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue('A1', 'Hello');</div><div>$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue('B2', 'world!');</div><div>$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue('C1', 'Hello');</div><div>$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue('D2', 'world!');</div><div> </div><div>// Rename sheet</div><div>echo date('H:i:s') . &quot; Rename sheet\\n&quot;;</div><div>$objPHPExcel-&gt;getActiveSheet()-&gt;setTitle('Simple');</div><div> </div><div><span style=\"white-space:pre\">\t\t</span></div><div>// Save Excel 2007 file</div><div>echo date('H:i:s') . &quot; Write to Excel2007 format\\n&quot;;</div><div>$objWriter = new PHPExcel_Writer_Excel2007($objPHPExcel);</div><div>$objWriter-&gt;save(&quot;db\\blahs.xlsx&quot;);</div><div> </div><div>// Echo done</div><div>echo date('H:i:s') . &quot; Done writing file.\\r\\n&quot;;</div><div>}</div></div>",
    "PostedDate": "2009-04-03T11:04:42.587-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "175384",
    "ThreadId": "52215",
    "Html": "This indeed sounds strange. You are running the scripts on the same server? I would try to compare the two files in a HEX editor to see how they differ. They are really supposed to be identical.<br>\r\n<br>\r\n",
    "PostedDate": "2009-04-03T11:12:59.11-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "175390",
    "ThreadId": "52215",
    "Html": "Yes, same exact server, run from the same exact directory.  Has anyone tried to use these classes from the web?  Any issues?\r\n",
    "PostedDate": "2009-04-03T11:19:42.913-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "175395",
    "ThreadId": "52215",
    "Html": "Not sure what you mean by running from the web. If you send me the two files, I will take a look [erik at phpexcel dot net].<br>\r\n<br>\r\n",
    "PostedDate": "2009-04-03T11:24:50.073-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "175415",
    "ThreadId": "52215",
    "Html": "Erik:<br>\r\n<br>\r\nI sent you those files.  Thanks for taking a look !\r\n",
    "PostedDate": "2009-04-03T12:10:49.163-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "175427",
    "ThreadId": "52215",
    "Html": "One file is a corrupt zip file while the other is ok as one notices if one changes file extension from xlsx to zip and tries to unzip them.<br>\r\n<br>\r\nThis looks like a defect zip extension as we have seen previously on Windows. Are you running this on Windows? If so, check <a href=\"http://phpexcel.codeplex.com/Wiki/View.aspx?title=FAQ&referringTitle=Home\">FAQ</a> section<br>\r\n&quot;Excel 2007 can not open the file generated by PHPExcelWriter2007 on Windows&quot;<br>\r\n<br>\r\nIf this turns out to be the problem I still have no explanation why not both xlsx files are corrupt.<br>\r\n<br>\r\n",
    "PostedDate": "2009-04-03T12:46:28.653-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "175429",
    "ThreadId": "52215",
    "Html": "<div dir=ltr style=\"text-align:left\"><span>Interesting.  Yes, I am using a Windows server.Windows 2003 Server R2 SP2 64-bit.  I have the latest PHP (5.2.8) -- couldit be an issue with 64-bit?</span></div><div dir=ltr style=\"text-align:left\"><span></span> </div><div dir=ltr style=\"text-align:left\"><span>You are correct though -- the from_queries.zip does notextract properly.  Any other ideas?</span></div><div> </div><div style=\"text-align:left\"><div style=\"text-align:left\"><br></div></div><div> </div><br><div lang=en-us dir=ltr style=\"text-align:left\"><hr><strong>From:</strong> koyama <br><br><strong>Subject:</strong> Re: Converter failed to open the file.[PHPExcel:52215]<br><br></div><div></div><p>From: koyama</p><div id=ThreadNotificationPostBody>One file is a corrupt zip file while theother is ok as one notices if one changes file extension from xlsx to zip andtries to unzip them.<br><br>This looks like a defect zip extension as we haveseen previously on Windows. Are you running this on Windows? If so, check <a href=\"http://phpexcel.codeplex.com/Wiki/View.aspx?title=FAQ&referringTitle=Home\">FAQ</a>section<br>&quot;Excel 2007 can not open the file generated by PHPExcelWriter2007 onWindows&quot;<br><br>If this turns out to be the problem I still have no explanationwhy not both xlsx files are corrupt.<br><br></div>",
    "PostedDate": "2009-04-03T12:53:28.47-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "175432",
    "ThreadId": "52215",
    "Html": "<div dir=ltr style=\"text-align:left\"><span>Interesting. Yes, I am using a Windows server. Windows 2003 Server R2 SP2 64-bit. I have the latest PHP (5.2.8), however I'm running the x86 version of PHP.  Could it be an issue with the 64-bit OS?  I don't know why one world work and not the other.  Very strange.</span></div>\r\n<div dir=ltr style=\"text-align:left\"><span></span></div>\r\n<div dir=ltr style=\"text-align:left\"><span><br>\r\nYou are correct though -- the from_queries.zip does not extract properly.  Any other ideas?</span></div>\r\n",
    "PostedDate": "2009-04-03T12:57:21.92-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "175437",
    "ThreadId": "52215",
    "Html": "We have seen this bug on PHP 5.2.8 while 5.2.6 was apparently ok. I think it is fixed in PHP 5.2.9. Don't think it has anything to do with 64-bit. Upgrading to PHP 5.2.9 may be the best solution.<br>\r\n<br>\r\n",
    "PostedDate": "2009-04-03T13:06:38.29-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "175444",
    "ThreadId": "52215",
    "Html": "\r\n<div dir=ltr align=left><span class=546491420-03042009>I wonder if it's an issue with permissory rights or \r\npathing?  One main difference that I see between running the script via the \r\nCLI and from the webserver is which user is running the php call.  When I \r\nrun it from the CLI, it is my user with its own pathing.  When it is run \r\nfrom my webserver, it is Apache's user (SYSTEM) running the script.  Do you \r\nthink that has something to do with it?</span></div>\r\n<div dir=ltr align=left><span class=546491420-03042009></span> </div>\r\n<div dir=ltr align=left><span class=546491420-03042009>Are there specific permissions/pathing \r\nissues?</span></div>",
    "PostedDate": "2009-04-03T13:17:18.407-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "175451",
    "ThreadId": "52215",
    "Html": "I have absolutely no idea whether this could be an explanation, others here might? But there must be some explanation!<br>\r\n<br>\r\n",
    "PostedDate": "2009-04-03T13:27:34.573-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "175463",
    "ThreadId": "52215",
    "Html": "\r\n<div dir=ltr align=left><span class=312035120-03042009>FYI -- I have installed PHP 5.2.9-1 on my development \r\nserver and the file is opened just fine!  I'll confirm on Monday if they \r\nsame workaround works on my production server.</span></div><br>\r\n<div class=OutlookMessageHeader lang=en-us dir=ltr align=left>\r\n<hr>\r\n<b>From:</b> koyama [mailto:notifications@codeplex.com] \r\n<br><b>Subject:</b> Re: Converter failed to open the file. \r\n[PHPExcel:52215]<br><br></div>\r\n<div></div>\r\n\r\n\r\n<p>From: koyama</p>\r\n<div id=ThreadNotificationPostBody>I have absolutely no idea whether this could \r\nbe an explanation, others here might? But there must be some \r\nexplanation!<br><br></div>\r\n",
    "PostedDate": "2009-04-03T13:51:58.51-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "176741",
    "ThreadId": "52215",
    "Html": "\r\n<div dir=ltr align=left><span class=640244618-07042009>I found this issue to be resolved when upgrading to PHP \r\n5.2.9-1 AND trim()'ing my INT fields.  Thx for the \r\nhelp.</span></div>",
    "PostedDate": "2009-04-07T11:47:38.387-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]