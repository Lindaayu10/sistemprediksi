[
  {
    "Id": "925515",
    "ThreadId": "399034",
    "Html": "\r\n<p>Hi,</p>\r\n<p>I have a strange problem with the exemple PHPExcel's files and a specific excel's file.</p>\r\n<p>&nbsp;</p>\r\n<p>It return this error :&nbsp;</p>\r\n<p>- - - - - - - - - - - - - - - - - - - - - - -&nbsp;- - - - - - - - - - - - - - - - - - - - - - -</p>\r\n<h1>PHPExcel Reader Example #04</h1>\r\n<h2>Simple File Reader using the PHPExcel_IOFactory to Identify a Reader to Use</h2>\r\n<p>File NewStock.xls has been identified as an Excel5 file<br>\r\nLoading file NewStock.xls using IOFactory with the identified reader type</p>\r\n<hr>\r\n<p><br>\r\n<strong>Fatal error</strong>: Call to a member function setTime() on a non-object in\r\n<strong>/Applications/MAMP/htdocs/soapmagento/Classes/PHPExcel/Shared/Date.php</strong> on line\r\n<strong>158</strong></p>\r\n<p>- - - - - - - - - - - - - - - - - - - - - - -&nbsp;- - - - - - - - - - - - - - - - - - - - - - -</p>\r\n<p>&nbsp;</p>\r\n<p>This xls file has some macros, but i have deleting the macros and save, but no success... I was trying with Openoffice and Excel...</p>\r\n<p>If i test with some others xls' files i cant' repeat the problem... I really don't understand and i can't use a other xls' file because it come from my&nbsp;wholesaler...</p>\r\n<p>&nbsp;</p>\r\n<p>Do you have any idea or solution ?</p>\r\n<p>&nbsp;</p>\r\n<p>Thank you so much !</p>\r\n",
    "PostedDate": "2012-10-11T14:07:58.183-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "925527",
    "ThreadId": "399034",
    "Html": "<p>I have more information...&nbsp;</p>\r\n<p>I found that the problem come from a column... The cells' column's values start with an&nbsp;apostrophe. If i delete this colmun there isn't any problem...</p>\r\n<p>How can i do ? Because i don't want to lost time each day to download the file and delete the column before update my db...</p>\r\n<p>&nbsp;</p>\r\n<p>Thanks!&nbsp;</p>",
    "PostedDate": "2012-10-11T14:33:33.957-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "925941",
    "ThreadId": "399034",
    "Html": "<p>The apostrophe indicates that the cell's value is a string.</p>\r\n<p>If you are using the getValue() method to retrieve the cell's content then try using getFormattedValue() instead. That might sidestep the issue although it doesn't really solve it.</p>\r\n<p>- Christopher Mullins</p>",
    "PostedDate": "2012-10-12T11:10:12.953-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "926811",
    "ThreadId": "399034",
    "Html": "<p>Thanks for your answer.</p>\r\n<p>&nbsp;</p>\r\n<p>But it's not working...</p>\r\n<p>&nbsp;</p>\r\n<p>Here is my code :</p>\r\n<p>\r\n<div style=\"color: black; background-color: white;\">\r\n<pre>&lt;?php\r\n\r\nerror_reporting(E_ALL);\r\nset_time_limit(0);\r\n\r\ndate_default_timezone_set(<span style=\"color: #a31515;\">'Europe/London'</span>);\r\n\r\n?&gt;\r\n&lt;html&gt;\r\n&lt;head&gt;\r\n&lt;meta http-equiv=<span style=\"color: #a31515;\">\"Content-Type\"</span> content=<span style=\"color: #a31515;\">\"text/html; charset=UTF-8\"</span> /&gt;\r\n\r\n&lt;title&gt;PHPExcel Reader Example <span style=\"color: green;\">#01&lt;/title&gt;</span>\r\n\r\n&lt;/head&gt;\r\n&lt;body&gt;\r\n\r\n&lt;h1&gt;PHPExcel Reader Example <span style=\"color: green;\">#01&lt;/h1&gt;</span>\r\n&lt;h2&gt;Simple File Reader using PHPExcel_IOFactory::load()&lt;/h2&gt;\r\n&lt;?php\r\n\r\n<span style=\"color: green;\">/** Include path **/</span>\r\nset_include_path(get_include_path() . PATH_SEPARATOR . <span style=\"color: #a31515;\">'../../../Classes/'</span>);\r\n\r\n<span style=\"color: green;\">/** PHPExcel_IOFactory */</span>\r\n<span style=\"color: blue;\">include</span> <span style=\"color: #a31515;\">'PHPExcel/IOFactory.php'</span>;\r\n\r\n\r\n\r\n<span style=\"color: green;\">//var_dump($sheetData);</span>\r\n\r\n\r\n<span style=\"color: blue;\">class</span> MyReadFilter <span style=\"color: blue;\">implements</span> PHPExcel_Reader_IReadFilter\r\n{\r\n\r\n\t<span style=\"color: blue;\">public</span> <span style=\"color: blue;\">function</span> readCell($column, $row, $worksheetName = <span style=\"color: #a31515;\">''</span>) {\r\n\t\t\r\n\t\t<span style=\"color: green;\">// Read title row and rows 20 - 30</span>\r\n\t\t<span style=\"color: blue;\">if</span> ($row &gt; 1) {\r\n\t\t\t<span style=\"color: blue;\">return</span> true;\r\n\t\t}\r\n\t\t\t<span style=\"color: blue;\">return</span> false;\r\n\t}\r\n}\r\n\r\n$objReader = <span style=\"color: blue;\">new</span> PHPExcel_Reader_Excel5();\r\n$objReader-&gt;setReadFilter( <span style=\"color: blue;\">new</span> MyReadFilter() );\r\n$objPHPExcel = $objReader-&gt;load(<span style=\"color: #a31515;\">\"../../../NewStock.xls\"</span>);\r\n$sheetData = $objPHPExcel-&gt;getActiveSheet()-&gt;toArray(null,true,true,true);\r\n\r\n<span style=\"color: green;\">//var_dump($sheetData);</span>\r\n\r\n?&gt;\r\n\r\n&lt;?php\r\n$objReader = <span style=\"color: blue;\">new</span> PHPExcel_Reader_Excel5();\r\n$objReader-&gt;setReadDataOnly(true);\r\n\r\n$objPHPExcel = $objReader-&gt;load(<span style=\"color: #a31515;\">\"sampleData/example1.xls\"</span>);\r\n$objWorksheet = $objPHPExcel-&gt;getActiveSheet();\r\n\r\n<span style=\"color: blue;\">echo</span> <span style=\"color: #a31515;\">'&lt;table&gt;'</span> . <span style=\"color: #a31515;\">\"\\n\"</span>;\r\n<span style=\"color: blue;\">foreach</span> ($objWorksheet-&gt;getRowIterator() <span style=\"color: blue;\">as</span> $row) {\r\n  <span style=\"color: blue;\">echo</span> <span style=\"color: #a31515;\">'&lt;tr&gt;'</span> . <span style=\"color: #a31515;\">\"\\n\"</span>;\r\n\t\t\r\n  $cellIterator = $row-&gt;getCellIterator();\r\n  $cellIterator-&gt;setIterateOnlyExistingCells(false); <span style=\"color: green;\">// This loops all cells,</span>\r\n                                                     <span style=\"color: green;\">// even if it is not set.</span>\r\n                                                     <span style=\"color: green;\">// By default, only cells</span>\r\n                                                     <span style=\"color: green;\">// that are set will be</span>\r\n                                                     <span style=\"color: green;\">// iterated.</span>\r\n  <span style=\"color: blue;\">foreach</span> ($cellIterator <span style=\"color: blue;\">as</span> $cell) {\r\n    <span style=\"color: blue;\">echo</span> <span style=\"color: #a31515;\">'&lt;td&gt;'</span> . $cell-&gt;getFormattedValue() . <span style=\"color: #a31515;\">'&lt;/td&gt;'</span> . <span style=\"color: #a31515;\">\"\\n\"</span>;\r\n  }\r\n  \r\n  <span style=\"color: blue;\">echo</span> <span style=\"color: #a31515;\">'&lt;/tr&gt;'</span> . <span style=\"color: #a31515;\">\"\\n\"</span>;\r\n}\r\n<span style=\"color: blue;\">echo</span> <span style=\"color: #a31515;\">'&lt;/table&gt;'</span> . <span style=\"color: #a31515;\">\"\\n\"</span>;\r\n\r\n<span style=\"color: green;\">//var_dump($objWorksheet);</span>\r\n<span style=\"color: green;\">//echo \"test\".$cell();</span>\r\n<span style=\"color: green;\">//var_dump($cell-&gt;getFormattedValue(2));</span>\r\n?&gt;\r\n\r\n&lt;body&gt;\r\n&lt;/html&gt;\r\n</pre>\r\n</div>\r\n</p>\r\n<p>&nbsp;</p>\r\n<p>What i did wrong ?</p>\r\n<p>&nbsp;</p>\r\n<p>Thanks !</p>",
    "PostedDate": "2012-10-15T09:20:46.81-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]