[
  {
    "Id": "898890",
    "ThreadId": "391403",
    "Html": "\r\n<p></p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre>this is my cod i want a CSV file whith  Only the first two column.</pre>\r\n<pre>But in the CSV i have all the row until number 65536.</pre>\r\n<pre>can i send my xls file? and my CSV file</pre>\r\n<pre>please help me</pre>\r\n<pre>\r\n&lt;?php\r\n\r\nerror_reporting(E_ALL);\r\nset_time_limit(0);\r\n\r\ndate_default_timezone_set(<span style=\"color:#a31515\">'Europe/London'</span>);\r\n\r\n<span style=\"color:green\">/** Include path **/</span>\r\nset_include_path(get_include_path() . PATH_SEPARATOR . <span style=\"color:#a31515\">'../../../Classes/'</span>);\r\n\r\n<span style=\"color:green\">/** PHPExcel_IOFactory */</span>\r\n<span style=\"color:blue\">include</span> <span style=\"color:#a31515\">'PHPExcel/IOFactory.php'</span>;\r\n $fileName1 = <span style=\"color:#a31515\">'./sampleData/prodotti1.xls'</span>;\r\n$objPHPExcel = PHPExcel_IOFactory::load($fileName1);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;removeColumn(<span style=\"color:#a31515\">'C'</span>,20);\r\n\r\n$objWriter = <span style=\"color:blue\">new</span> PHPExcel_Writer_CSV($objPHPExcel);\r\n$objWriter-&gt;save(<span style=\"color:#a31515\">'./sampleData/elimina11.csv'</span>);\r\n?&gt;\r\n</pre>\r\n</div>\r\n<p></p>\r\n",
    "PostedDate": "2012-08-13T12:23:17.767-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "899467",
    "ThreadId": "391403",
    "Html": "<p>If your Excel file has cells defined (even empty cells) in row 65536, then so will your CSV file.</p>\r\n<p>Load the workbook. Test to see the last row that contains actual cell data using the worksheet's $this-&gt;getHighestDataRow() method. Reload the workbook using a read filter to load only to that row. Then save that as csv.</p>",
    "PostedDate": "2012-08-15T04:29:27.117-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "903092",
    "ThreadId": "391403",
    "Html": "\r\n<p>&nbsp;</p>\r\n<p>the issue is also important for the columns.</p>\r\n<p>I try in this way:</p>\r\n<p>&nbsp;</p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre>&lt;?php\n\nerror_reporting(E_ALL);\nset_time_limit(0);\n\ndate_default_timezone_set(<span style=\"color:#a31515\">'Europe/London'</span>);\n\n?&gt;\n&lt;html&gt;\n&lt;head&gt;\n&lt;meta http-equiv=<span style=\"color:#a31515\">&quot;Content-Type&quot;</span> content=<span style=\"color:#a31515\">&quot;text/html; charset=UTF-8&quot;</span> /&gt;\n\n&lt;title&gt;PHPExcel Reader Raffa &lt;/title&gt;\n\n&lt;/head&gt;\n&lt;body&gt;\n\n&lt;h1&gt;PHPExcel Reader Raffa &lt;/h1&gt;\n&lt;h2&gt;Simple File Reader Using a Configurable Read Filter&lt;/h2&gt;\n&lt;?php\n\n<span style=\"color:green\">/** Include path **/</span>\nset_include_path(get_include_path() . PATH_SEPARATOR . <span style=\"color:#a31515\">'../../../Classes/'</span>);\n\n<span style=\"color:green\">/** PHPExcel_IOFactory */</span>\n<span style=\"color:blue\">include</span> <span style=\"color:#a31515\">'PHPExcel/IOFactory.php'</span>;\n\n\n$inputFileType = <span style=\"color:#a31515\">'Excel5'</span>;\n<span style=\"color:green\">//\t$inputFileType = 'Excel2007';</span>\n<span style=\"color:green\">//\t$inputFileType = 'Excel2003XML';</span>\n<span style=\"color:green\">//\t$inputFileType = 'OOCalc';</span>\n<span style=\"color:green\">//\t$inputFileType = 'Gnumeric';</span>\n$inputFileName = <span style=\"color:#a31515\">'./sampleData/prodotti.xls'</span>;\n$sheetname = <span style=\"color:#a31515\">'Foglio 01'</span>;\n\n$objReader = PHPExcel_IOFactory::createReader(<span style=\"color:#a31515\">'Excel5'</span>);\n$objReader-&gt;setReadDataOnly(true);\n\n$objPHPExcel = $objReader-&gt;load($inputFileName);\n\n$objPHPExcel-&gt;getActiveSheet()-&gt;removeColumn( <span style=\"color:#a31515\">'B'</span>,2);\n\n\n$objWorksheet = $objPHPExcel-&gt;setActiveSheetIndex(0);\n$highestRow = $objWorksheet-&gt;getHighestRow();\n$highestColumn = $objWorksheet-&gt;getHighestColumn();\n\n$headingsArray = $objWorksheet-&gt;rangeToArray(<span style=\"color:#a31515\">'A1:'</span>.$highestColumn.<span style=\"color:#a31515\">'1'</span>,null, true, true, true);\n$headingsArray = $headingsArray[1];\n\n$r = -1;\n$namedDataArray = <span style=\"color:blue\">array</span>();\n<span style=\"color:blue\">for</span> ($row = 2; $row &lt;= $highestRow; &#43;&#43;$row) {\n    $dataRow = $objWorksheet-&gt;rangeToArray(<span style=\"color:#a31515\">'A'</span>.$row.<span style=\"color:#a31515\">':'</span>.$highestColumn.$row,null, true, true, true);\n    <span style=\"color:blue\">if</span> ((<span style=\"color:blue\">isset</span>($dataRow[$row][<span style=\"color:#a31515\">'A'</span>])) &amp;&amp; ($dataRow[$row][<span style=\"color:#a31515\">'A'</span>] &gt; <span style=\"color:#a31515\">''</span>)) {\n        &#43;&#43;$r;\n        <span style=\"color:blue\">foreach</span>($headingsArray <span style=\"color:blue\">as</span> $columnKey =&gt; $columnHeading) {\n            $namedDataArray[$r][$columnHeading] = $dataRow[$row][$columnKey];\n        }\n    }\n}\n$objWriter = <span style=\"color:blue\">new</span> PHPExcel_Writer_Excel5($objPHPExcel);\n$objWriter-&gt;save(<span style=\"color:#a31515\">'./sampleData/cazzone.xls'</span>);\n$objWriter = <span style=\"color:blue\">new</span> PHPExcel_Writer_CSV($objPHPExcel);\n$objWriter-&gt;save(<span style=\"color:#a31515\">'./sampleData/cazzone.csv'</span>);\n<span style=\"color:blue\">echo</span> <span style=\"color:#a31515\">'&lt;pre&gt;'</span>;\nvar_dump($namedDataArray);\n<span style=\"color:blue\">echo</span> <span style=\"color:#a31515\">'&lt;/pre&gt;&lt;hr /&gt;'</span>;\n\n\n\n$inputFileType = <span style=\"color:#a31515\">'Excel5'</span>;\n$inputFileName1 = <span style=\"color:#a31515\">'./sampleData/cazzone.xls'</span>;\n$sheetname1 = <span style=\"color:#a31515\">'Foglio 01'</span>;\n\n$objReader1 = PHPExcel_IOFactory::createReader(<span style=\"color:#a31515\">'Excel5'</span>);\n$objReader1-&gt;setReadDataOnly(true);\n\n$objPHPExcel1 = $objReader1-&gt;load($inputFileName1);\n\n\n\n\n$objWorksheet1 = $objPHPExcel1-&gt;setActiveSheetIndex(0);\n$highestRow1 = $objWorksheet1-&gt;getHighestRow();\n$highestColumn1 = $objWorksheet1-&gt;getHighestColumn();\n\n$headingsArray1 = $objWorksheet1-&gt;rangeToArray(<span style=\"color:#a31515\">'A1:'</span>.$highestColumn1.<span style=\"color:#a31515\">'1'</span>,null, true, true, true);\n$headingsArray1 = $headingsArray1[1];\n$objPHPExcel1-&gt;getActiveSheet()-&gt;removeColumn( <span style=\"color:#a31515\">'C'</span>,20);\n$r = -1;\n$namedDataArray1 = <span style=\"color:blue\">array</span>();\n<span style=\"color:blue\">for</span> ($row = 2; $row &lt;= $highestRow1; &#43;&#43;$row) {\n    $dataRow1 = $objWorksheet1-&gt;rangeToArray(<span style=\"color:#a31515\">'A'</span>.$row.<span style=\"color:#a31515\">':'</span>.$highestColumn1.$row,null, true, true, true);\n    <span style=\"color:blue\">if</span> ((<span style=\"color:blue\">isset</span>($dataRow1[$row][<span style=\"color:#a31515\">'A'</span>])) &amp;&amp; ($dataRow1[$row][<span style=\"color:#a31515\">'A'</span>] &gt; <span style=\"color:#a31515\">''</span>)) {\n        &#43;&#43;$r;\n        <span style=\"color:blue\">foreach</span>($headingsArray1 <span style=\"color:blue\">as</span> $columnKey =&gt; $columnHeading) {\n            $namedDataArray1[$r][$columnHeading] = $dataRow1[$row][$columnKey];\n        }\n    }\n}\n$objWriter1 = <span style=\"color:blue\">new</span> PHPExcel_Writer_CSV($objPHPExcel1);\n$objWriter1-&gt;save(<span style=\"color:#a31515\">'./sampleData/cazzone1.csv'</span>);\n\n<span style=\"color:blue\">echo</span> <span style=\"color:#a31515\">'&lt;pre&gt;'</span>;\nvar_dump($namedDataArray1);\n<span style=\"color:blue\">echo</span> <span style=\"color:#a31515\">'&lt;/pre&gt;&lt;hr /&gt;'</span>;\n</pre>\r\n</div>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n<p>But when i remove the column C,20 &nbsp;I find the last row with all columns and therefore saves me 20 columns in csv file,&nbsp;I'm going to go crazy</p>\r\n<p>I just have to take a xls file column A and column D, and then save it in CSV</p>\r\n",
    "PostedDate": "2012-08-23T08:40:17.517-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]