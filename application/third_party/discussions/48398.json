[
  {
    "Id": "161553",
    "ThreadId": "48398",
    "Html": "Hi, <br>\r\n<br>\r\nThe following code will make Microsoft Excel 2007 crash:<br>\r\n&lt;?php<br>\r\nset_include_path(get_include_path() . PATH_SEPARATOR . '../functies/');<br>\r\ninclude 'PHPExcel.php';<br>\r\ninclude 'PHPExcel/IOFactory.php';<br>\r\n<br>\r\n$report = new PHPExcel();<br>\r\n<br>\r\n$report-&gt;getActiveSheet()-&gt;getProte\r\n<div id=\"ctl00_ctl00_MasterContent_Content_DescriptionPanel\"><wbr>ction()-&gt;setSheet(true);<br>\r\n$report-&gt;getSecurity()-&gt;setLockWind<wbr>ows(true);<br>\r\n$report-&gt;getSecurity()-&gt;setLockStru<wbr>cture(true);<br>\r\n$report-&gt;getSecurity()-&gt;setWorkbook<wbr>Password(&quot;test&quot;);<br>\r\n<br>\r\n$report-&gt;setActiveSheetIndex(0);<br>\r\n<br>\r\n$report-&gt;getActiveSheet()-&gt;getStyle<wbr>('B3')-&gt;getProtection()-&gt;setLocked(<br>\r\nPHPExcel_Style_Protection::PROTECTI<wbr>ON_UNPROTECTED<br>\r\n);<br>\r\n<br>\r\n$objValidation = $report-&gt;getActiveSheet()-&gt;getCell(<wbr>'B3')-&gt;getDataValidation();<br>\r\n$objValidation-&gt;setType( PHPExcel_Cell_DataValidation::TYPE_<wbr>WHOLE );<br>\r\n$objValidation-&gt;setErrorStyle( PHPExcel_Cell_DataValidation::STYLE<wbr>_STOP );<br>\r\n$objValidation-&gt;setAllowBlank(true)<wbr>;<br>\r\n$objValidation-&gt;setShowInputMessage<wbr>(true);<br>\r\n$objValidation-&gt;setShowErrorMessage<wbr>(true);<br>\r\n$objValidation-&gt;setErrorTitle('Fout bij ingeven');<br>\r\n$objValidation-&gt;setError('Uw invoer is niet geldig.');<br>\r\n$objValidation-&gt;setPromptTitle('Toe<wbr>gestane invoer');<br>\r\n$objValidation-&gt;setPrompt('Enkel cijfers tussen 0 en 10 zijn toegelaten.');<br>\r\n$objValidation-&gt;setFormula1(0);<br>\r\n$objValidation-&gt;setFormula2(10);<br>\r\n$report-&gt;getActiveSheet()-&gt;getCell(<wbr>'B3')-&gt;setDataValidation($objValida<wbr>tion);<br>\r\n<br>\r\nheader('Content-Type: application/vnd.openxmlformats-offi<wbr>cedocument.spreadsheetml.sheet');<br>\r\nheader('Content-Disposition: attachment;filename=&quot;myfile.xlsx&quot;')<wbr>;<br>\r\nheader('Cache-Control: max-age=0');<br>\r\n<br>\r\n$objWriter = PHPExcel_IOFactory::createWriter($r<wbr>eport, 'Excel2007');<br>\r\n$objWriter-&gt;save('php://output');<br>\r\n?&gt;<br>\r\n<br>\r\nSo what I do is: I create a new protected worksheet, and unprotect cell B3.<br>\r\nThen I make sure that the input of B3 is validated. (a number between 0 and 10). This makes Excel crash. <br>\r\n<br>\r\nDoes anybody has an idea what goes wrong? Is it a bug?<br>\r\n<br>\r\nI accidently made a bug report with the text above. I intended to make a thread instead of a bug report. But if it's a bug, maybe that was the right thing to do. If not, I'm really sorry </div>\r\n",
    "PostedDate": "2009-02-24T10:57:27.503-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "161584",
    "ThreadId": "48398",
    "Html": "I believe we need to take some action on this. Thank you for your report. <br>\r\n<a title=\"Linkification: http://www.codeplex.com/PHPExcel/WorkItem/View.aspx?WorkItemId=9343\" href=\"http://www.codeplex.com/PHPExcel/WorkItem/View.aspx?WorkItemId=9343\"></a><a title=\"Linkification: http://www.codeplex.com/PHPExcel/WorkItem/View.aspx?WorkItemId=9343\" href=\"http://www.codeplex.com/PHPExcel/WorkItem/View.aspx?WorkItemId=9343\">http://www.codeplex.com/PHPExcel/WorkItem/View.aspx?WorkItemId=9343</a><br>\r\n<br>\r\n",
    "PostedDate": "2009-02-24T11:49:37.957-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]