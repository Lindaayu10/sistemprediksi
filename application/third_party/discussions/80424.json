[
  {
    "Id": "275655",
    "ThreadId": "80424",
    "Html": "<div id=\"ctl00_ctl00_MasterContent_Content_PostRepeater_ctl00_BodyDiv\">\r\n<p>I have PHP v5.3.0 installed on my Linux server.&nbsp; The settings are:</p>\r\n<p><strong>Configure Command</strong></p>\r\n<p>'./configure' '--build=i686-pc-linux-gnu' '--host=i686-pc-linux-gnu' '--target=i386-redhat-linux-gnu' '--program-prefix=' '--prefix=/usr' '--exec-prefix=/usr' '--bindir=/usr/bin' '--sbindir=/usr/sbin' '--sysconfdir=/etc' '--datadir=/usr/share' '--includedir=/usr/include' '--libdir=/usr/lib' '--libexecdir=/usr/libexec' '--localstatedir=/var' '--sharedstatedir=/usr/com' '--mandir=/usr/share/man' '--infodir=/usr/share/info' '--cache-file=../config.cache' '--with-libdir=lib' '--with-config-file-path=/etc' '--with-config-file-scan-dir=/etc/php.d' '--disable-debug' '--with-pic' '--disable-rpath' '--without-pear' '--with-bz2' '--with-curl' '--with-exec-dir=/usr/bin' '--with-freetype-dir=/usr' '--with-png-dir=/usr' '--enable-gd-native-ttf' '--without-gdbm' '--with-gettext' '--with-gmp' '--with-iconv' '--with-jpeg-dir=/usr' '--with-openssl' '--with-png' '--with-pspell' '--with-expat-dir=/usr' '--with-pcre-regex=/usr' '--with-zlib' '--with-layout=GNU' '--enable-exif' '--enable-ftp' '--enable-magic-quotes' '--enable-sockets' '--enable-sysvsem' '--enable-sysvshm' '--enable-sysvmsg' '--enable-track-vars' '--enable-trans-sid' '--enable-yp' '--enable-wddx' '--with-kerberos' '--with-unixODBC=shared,/usr' '--enable-memory-limit' '--enable-shmop' '--enable-calendar' '--enable-dbx' '--enable-dio' '--with-mime-magic=/usr/share/file/magic.mime' '--without-sqlite' '--with-libxml-dir=/usr' '--with-xml' '--enable-force-cgi-redirect' '--enable-pcntl' '--with-imap=shared' '--with-imap-ssl' '--enable-mbstring=shared' '--enable-mbstr-enc-trans' '--enable-mbregex' '--with-ncurses=shared' '--with-gd' '--enable-bcmath=shared' '--enable-dba=shared' '--with-db4=/usr' '--with-xmlrpc=shared' '--with-ldap=shared' '--with-mysql=shared,/usr' '--with-mysqli=shared,/usr/bin/mysql_config' '--enable-dom' '--with-dom-xslt=/usr' '--with-dom-exslt=/usr' '--with-pgsql=shared' '--enable-soap=shared' '--with-xsl=shared,/usr' '--enable-xmlreader' '--enable-xmlwriter' '--enable-fastcgi' '--enable-pdo=shared' '--with-pdo-odbc=shared,unixODBC,/usr' '--with-pdo-mysql=shared,/usr' '--with-pdo-pgsql=shared,/usr' '--with-pdo-sqlite=shared,/usr' '--with-readline' '--with-tidy' '--with-apxs2=/usr/sbin/apxs' '--enable-zip'</p>\r\n<p><strong>Additional .ini files parsed</strong></p>\r\n<p>/etc/php.d/bcmath.ini, /etc/php.d/dba.ini, /etc/php.d/dom.ini, /etc/php.d/gd.ini, /etc/php.d/imap.ini, /etc/php.d/ldap.ini, /etc/php.d/mbstring.ini, /etc/php.d/mysqli.ini, /etc/php.d/mysql.ini, /etc/php.d/ncurses.ini, /etc/php.d/odbc.ini, /etc/php.d/pdo.ini, /etc/php.d/pdo_mysql.ini, /etc/php.d/pdo_odbc.ini, /etc/php.d/pdo_pgsql.ini, /etc/php.d/pdo_sqlite.ini, /etc/php.d/pgsql.ini, /etc/php.d/soap.ini, /etc/php.d/xmlreader.ini, /etc/php.d/xmlrpc.ini, /etc/php.d/xmlwriter.ini, /etc/php.d/xsl.ini</p>\r\n<p><strong>Registered PHP Streams</strong></p>\r\n<p>https, ftps, compress.zlib, compress.bzip2, php, file, glob, data, http, ftp, phar, zip</p>\r\n<p><strong>Registered Stream Socket Transports</strong></p>\r\n<p>tcp, udp, unix, udg, ssl, sslv3, sslv2, tls</p>\r\n<p><strong>Registered Stream Filters</strong></p>\r\n<p>zlib.*, bzip2.*, convert.iconv.*, string.rot13, string.toupper, string.tolower, string.strip_tags, convert.*, consumed, dechunk</p>\r\n<hr>\r\n<p>I am running this script using PHPExcel v1.6.7:</p>\r\n&lt;?<br>//set timezone<br>date_default_timezone_set('America/New_York');<br><br>/** Error reporting */<br>error_reporting(E_ALL);<br><br>/** Include path **/<br>ini_set('include_path',ini_get('include_path').PATH_SEPARATOR.'../private/utilities/PHPExcel/Classes/');<br><br>/** PHPExcel */<br>include 'PHPExcel.php';<br><br>/** PHPExcel_Writer_PDF */<br>include 'PHPExcel/Writer/PDF.php';<br><br>// Create new PHPExcel object<br>$objPHPExcel = new PHPExcel();<br><br>// Set properties<br>$objPHPExcel-&gt;getProperties()-&gt;setCreator('Maarten Balliauw');<br>$objPHPExcel-&gt;getProperties()-&gt;setLastModifiedBy('Maarten Balliauw');<br>$objPHPExcel-&gt;getProperties()-&gt;setTitle('Office 2007 XLSX Test Document');<br>$objPHPExcel-&gt;getProperties()-&gt;setSubject('Office 2007 XLSX Test Document');<br>$objPHPExcel-&gt;getProperties()-&gt;setDescription('Test document for Office 2007 XLSX, generated using PHP classes.');<br><br>// redirect output to client browser<br>header('Content-Type: application/pdf');<br>header('Connection: Close');<br>header('Content-Disposition: attachment;filename=&quot;test.pdf&quot;');<br>//header('Content-Disposition: inline');<br>//header('Content-Length: 499096');<br>//header('Accept-Ranges: bytes');<br><br>//output a PDF file<br>$objWriter = new PHPExcel_Writer_PDF($objPHPExcel);<br>$objWriter-&gt;setTempDir('/home/virtual/site1/fst/var/www/html');<br>$objWriter-&gt;save('test.pdf');<br>?&gt;\r\n<p><em> \r\n<hr>\r\n</em></p>\r\n<p>I am having three problems:</p>\r\n<p>1) I can't save the temp PDF file in my /tmp folder even though the tmp folder's permissions are set to 0x777 and I replaced the $objWriter-&gt;setTempDir('/home/virtual/site1/fst/var/www/html'); line above with $objWriter-&gt;setTempDir('/tmp');&nbsp; For some reason, the file is saved in the /home/virtual/site1/fst/var/www/html directory.</p>\r\n<p>2) I can't view the PDF file in the browser.&nbsp; If I comment out the header('Content-Disposition: attachment;filename=&quot;test.pdf&quot;'); line above and uncomment the next three lines, I get a blank page in my browser.&nbsp; I tried this on FF v3.0.15 and IE 7.</p>\r\n<p>3) I get a corrupt file when downloading the PDF file as an attachment.&nbsp; I had to comment out lines 5540 and 5583 in PHPExcel/Classes/PHPExcel/Shared/PDF/tcpdf.php file because of a fatal error based on set_magic_quotes_runtime() being deprecated as of PHP v5.3.0.&nbsp; I also had to replace 'split' with 'explode' because of deprecation in line 10775 of the same file.&nbsp; When I try to open the file in Acrobat I get this error:</p>\r\n<p><em>Acrobat could not open 'test.pdf' because it is either not a supported file type or because the file has been damaged (for example, it was sent as an email attachment and wasn't correctly decoded).</em></p>\r\n<p>Could this be connected to the commenting out of lines 5540 and 5583?&nbsp; I viewed test.pdf in a hex editor.&nbsp; The file is blank.</p>\r\n<p>&nbsp;</p>\r\n<p>Thank you.</p>\r\n</div>",
    "PostedDate": "2010-01-11T05:05:25.69-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "276961",
    "ThreadId": "80424",
    "Html": "<p>Thanks for your report. For a start, can you try to download latest source from here tomorrow:</p>\r\n<p><a href=\"http://phpexcel.codeplex.com/SourceControl/list/changesets\">http://phpexcel.codeplex.com/SourceControl/list/changesets</a></p>\r\n<p>What happens when you run this test:</p>\r\n<p style=\"font-family:Courier New\">Tests/01simple-download-pdf.php</p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2010-01-13T20:35:14.29-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "277768",
    "ThreadId": "80424",
    "Html": "<p>I downloaded the latest version of PHPExcel and brought it up to date via SVN but I'm still getting the same error when I run Tests/01simple-download-pdf.php (downloading as an attachment).&nbsp; I tried viewing the PDF inline and got this error from Acrobat:</p>\r\n<p><em>File does not begin with '%PDF-'.</em></p>",
    "PostedDate": "2010-01-15T15:14:34.173-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "278075",
    "ThreadId": "80424",
    "Html": "<blockquote style=\"border:solid .1em #ccc;font-style:italic;margin:.25em 1em 0 1em;padding:0 .25em 0 .25em\"><strong>lldc wrote:</strong><br>\r\n<p>I downloaded the latest version of PHPExcel and brought it up to date via SVN but I'm still getting the same error when I run Tests/01simple-download-pdf.php (downloading as an attachment).&nbsp; I tried viewing the PDF inline and got this error from Acrobat:</p>\r\n<p><em>File does not begin with '%PDF-'.</em></p>\r\n</blockquote>\r\n<p>This is strange. Can you take that PDF file and open it in a text editor so check that it does not begin with '%PDF-' ? What do you see?</p>",
    "PostedDate": "2010-01-16T20:51:59.223-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "278086",
    "ThreadId": "80424",
    "Html": "<p>As soon as I sent my last resply I remembered that I didn't look at the faulty PDF in a hex editor.&nbsp; I just did that and relized that the PDF has these warnings:</p>\r\n<p><em>Warning: date() [function.date]: It is not safe to rely on the system's timezone settings. You are *required* to use the date.timezone setting or the date_default_timezone_set() function. In case you used any of those methods and you are still getting this warning, you most likely misspelled the timezone identifier. We selected 'America/New_York' for 'EST/-5.0/no DST' instead in /home/virtual/site1/fst/var/www/private/utilities/PHPExcel/Classes/PHPExcel/Shared/PDF/tcpdf.php on line 7316<br><br>Warning: date() [function.date]: It is not safe to rely on the system's timezone settings. You are *required* to use the date.timezone setting or the date_default_timezone_set() function. In case you used any of those methods and you are still getting this warning, you most likely misspelled the timezone identifier. We selected 'America/New_York' for 'EST/-5.0/no DST' instead in /home/virtual/site1/fst/var/www/private/utilities/PHPExcel/Classes/PHPExcel/Shared/PDF/tcpdf.php on line 7316</em></p>\r\n<p>I added date_default_timezone_set('America/New_York'); to the top of Tests/01simple-download-pdf.php and everything works fine now - download as attachment and view inline.&nbsp; Thanks for your help.</p>",
    "PostedDate": "2010-01-16T21:48:01.497-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]