[
  {
    "Id": "775354",
    "ThreadId": "323320",
    "Html": "\r\n<p>First I would like to start CSV Import at row 10 to allow for my image at the top. I've searched but can't find the solution.</p>\r\n<p>Secondly I would like to set the column widths wider but nothing seems to work.</p>\r\n<p>thanks for your help!</p>\r\n<p>&nbsp;</p>\r\n<p></p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre><span style=\"color:green\">/** PHPExcel_IOFactory */</span>\r\n<span style=\"color:blue\">include</span> <span style=\"color:#a31515\">'PHPExcel/IOFactory.php'</span>; \r\n\r\n<span style=\"color:green\">// set headers to redirect output to client browser as a file download</span>\r\nheader(<span style=\"color:#a31515\">'Content-Type: application/vnd.openXMLformats-officedocument.spreadsheetml.sheet'</span>);\r\nheader(<span style=\"color:#a31515\">'Content-Disposition: attachment;filename=&quot;myfile.xlsx&quot;'</span>);\r\nheader(<span style=\"color:#a31515\">'Cache-Control: max-age=0'</span>);\r\n\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension(<span style=\"color:#a31515\">'A'</span>)-&gt;setWidth(24);\r\n\r\n\r\n<span style=\"color:green\">//-----Create a reader, set some parameters and read in the file-----</span>\r\n$objReader = PHPExcel_IOFactory::createReader(<span style=\"color:#a31515\">'CSV'</span>);\r\n$objReader-&gt;setDelimiter(<span style=\"color:#a31515\">','</span>); \r\n$objReader-&gt;setEnclosure(<span style=\"color:#a31515\">''</span>);\r\n$objReader-&gt;setLineEnding(<span style=\"color:#a31515\">&quot;\\r\\n&quot;</span>);\r\n$objReader-&gt;setSheetIndex(0);\r\n$objPHPExcel = $objReader-&gt;load(<span style=\"color:#a31515\">'detail.csv'</span>);\r\n\r\n\r\n\r\n\r\n<span style=\"color:green\">//------image stuff</span>\r\n$gdImage = imagecreatefromjpeg(<span style=\"color:#a31515\">'logo.jpg'</span>);\r\n<span style=\"color:green\">// Add a drawing to the worksheetecho date('H:i:s') . &quot; Add a drawing to the worksheet\\n&quot;;</span>\r\n$objDrawing = <span style=\"color:blue\">new</span> PHPExcel_Worksheet_MemoryDrawing();\r\n$objDrawing-&gt;setName(<span style=\"color:#a31515\">'Sample image'</span>);$objDrawing-&gt;setDescription(<span style=\"color:#a31515\">'Sample image'</span>);\r\n$objDrawing-&gt;setImageResource($gdImage);\r\n$objDrawing-&gt;setRenderingFunction(PHPExcel_Worksheet_MemoryDrawing::RENDERING_JPEG);\r\n$objDrawing-&gt;setMimeType(PHPExcel_Worksheet_MemoryDrawing::MIMETYPE_DEFAULT);\r\n$objDrawing-&gt;setHeight(150);\r\n$objDrawing-&gt;setWorksheet($objPHPExcel-&gt;getActiveSheet());\r\n<span style=\"color:green\">//$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, 'Excel2007');$objWriter-&gt;save(str_replace('.php', '.xlsx', __FILE__));</span>\r\n\r\n\r\n\r\n<span style=\"color:green\">//-----Create a Writer and output the file to the browser-----</span>\r\n$objWriter2007 = PHPExcel_IOFactory::createWriter($objPHPExcel, <span style=\"color:#a31515\">'Excel2007'</span>);\r\n$objWriter2007-&gt;save(<span style=\"color:#a31515\">'php://output'</span>); <span style=\"color:green\">//push out to the client browser</span>\r\n</pre>\r\n</div>\r\n<p></p>\r\n",
    "PostedDate": "2012-02-17T08:08:37.543-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "781389",
    "ThreadId": "323320",
    "Html": "<p>Load the CSV as normal, and then insert 10 new rows at the top of the worksheet using</p>\n<div style=\"color: black; background-color: white;\">\n<pre>$objPHPExcel-&gt;getActiveSheet()-&gt;insertNewRowBefore(1, 10);\r\n</pre>\n</div>\n<p>or</p>\n<p>Set the drawing&nbsp;in a page heading rather than in the worksheet itself (may or may not be an appropriate solution depending on whether the image is only needed for printing or not)</p>\n<p>or</p>\n<p>Tweak the CSV reader code. There is a boolean flag called _contiguous that is used if you want to load multiple csv files into the same worksheet without overwriting. When this flag is set to true using the CSV Reader's setContiguous(true) method, then the code uses the value of the private _contiguousRow attribute to identify the row where it should start loading the CSV file. If you add a method allowing you to set this attribute to 10, of change the setContiguous() to accept a second rowNumber argument, then you have another solution.</p>",
    "PostedDate": "2012-02-19T14:10:10.547-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]