[
  {
    "Id": "1202906",
    "ThreadId": "528982",
    "Html": "I am using the following code to generate a quote which works perfectly but when the quote gets so big it moves to the next PDF worksheet and I would like to keep the headers at the top of each page. How can this be done?<br />\n<pre><code>&lt;?php\n/** Error reporting */\nerror_reporting(E_ALL);\nini_set('display_errors', TRUE);\nini_set('display_startup_errors', TRUE);\ndate_default_timezone_set('Europe/London');\n\n// connection with the database\nsession_start();\ninclude ('core/connect.php');\n\n// require the PHPExcel file\nrequire 'core/PHPExcel.php';\n\n\n// simple query\n\n$query = &quot;SELECT UFPCODE,OEMCODE,PRODUCTDESC,QTY,SELLPRICE,LINETOTAL FROM &quot;.$_SESSION['user'].&quot;_final_quote ORDER by UFPCODE ASC&quot;;\n$headings = array('UFP','OEM','Product','Qty','Price','Line Total');\n\n\n//  Change these values to select the Rendering library that you wish to use\n//      and its directory location on your server\n//$rendererName = PHPExcel_Settings::PDF_RENDERER_TCPDF;\n$rendererName = PHPExcel_Settings::PDF_RENDERER_MPDF;\n//$rendererName = PHPExcel_Settings::PDF_RENDERER_DOMPDF;\n//$rendererLibrary = 'tcPDF5.9';\n$rendererLibrary = 'mPDF';\n//$rendererLibrary = 'domPDF0.6.0beta3';\n$rendererLibraryPath = 'core/PHPExcel/Writer/PDF/' . $rendererLibrary;\n\necho $rendererLibraryPath;\n\n\nif ($result = mysql_query($query) or die(mysql_error())) {\n    // Create a new PHPExcel object\n    $objPHPExcel = new PHPExcel();\n    \n        $objDrawing = new PHPExcel_Worksheet_Drawing();\n        $objDrawing-&gt;setName('logo');\n        $objDrawing-&gt;setDescription('logo');\n        $objDrawing-&gt;setPath('img/UFP_logo.gif');\n        $objDrawing-&gt;setHeight(120);\n        $objDrawing-&gt;setCoordinates('E1');\n        $objDrawing-&gt;setOffsetX(-10);\n            $objDrawing-&gt;setWorksheet($objPHPExcel-&gt;getActiveSheet());\n            \n            // Set document properties\n$objPHPExcel-&gt;getProperties()-&gt;setCreator($_SESSION['user'])\n                             -&gt;setLastModifiedBy($_SESSION['user'])\n                             -&gt;setTitle(&quot;UFP Quote&quot;)\n                             -&gt;setSubject(&quot;UFP Quote&quot;)\n                             -&gt;setDescription(&quot;UFP Quote&quot;)\n                             -&gt;setKeywords(&quot;UFP&quot;);\n    \n\n    $rowNumber = 13;\n    $col = 'A';\n    foreach($headings as $heading) {\n       $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue($col.$rowNumber,$heading);\n       $col++;\n    }\n\n    // Loop through the result set\n    $rowNumber = 14;\n    while ($row = mysql_fetch_row($result)) {\n       $col = 'A';\n       foreach($row as $cell) {\n          $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue($col.$rowNumber,$cell);\n          $col++;\n       }\n       $rowNumber++;\n    }\n    $lastRow = $objPHPExcel-&gt;getActiveSheet()-&gt;getHighestRow();\n    $column_E = 'E';\n    $column_F = 'F';\n    $calculate = '=SUM(F14:F' . $lastRow . ')';\n    \n    $objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension('C')-&gt;setWidth(30);\n    $objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension('A')-&gt;setWidth(25);\n    $objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension('B')-&gt;setWidth(15);\n    $objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension('D')-&gt;setWidth(5);\n    $objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension('E')-&gt;setWidth(6);\n    $objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension('F')-&gt;setWidth(6);\n    \n    $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('C1:C'.$objPHPExcel-&gt;getActiveSheet()-&gt;getHighestRow())\n    -&gt;getAlignment()-&gt;setWrapText(true);\n        \n    $objPHPExcel-&gt;setActiveSheetIndex(0)-&gt;mergeCells('D6:E6');\n            $objPHPExcel-&gt;setActiveSheetIndex(0)-&gt;mergeCells('D7:E7');\n            $objPHPExcel-&gt;setActiveSheetIndex(0)-&gt;mergeCells('D8:E8');\n            $objPHPExcel-&gt;setActiveSheetIndex(0)-&gt;mergeCells('D9:E9');\n            $objPHPExcel-&gt;setActiveSheetIndex(0)-&gt;mergeCells('D10:E10');\n    \n\n    \n\n    // Add some data\n$objPHPExcel-&gt;setActiveSheetIndex(0)\n            -&gt;setCellValue($column_E . ($lastRow+1), 'Total')\n            -&gt;setCellValue($column_F . ($lastRow+1), $calculate)\n            -&gt;setCellValue('A11', ' ')\n            -&gt;setCellValue('A12', ' ')\n            -&gt;setCellValue('D6', 'Account No:')\n            -&gt;setCellValue('D7', 'Quote No:')\n            -&gt;setCellValue('D8', 'Date:')\n            -&gt;setCellValue('D9', 'Rep:')\n            -&gt;setCellValue('D10', 'Tel:')\n            -&gt;setCellValue('A6', $_SESSION['CustName'])\n            -&gt;setCellValue('A7', $_SESSION['CustAdr1'])\n            -&gt;setCellValue('A8', $_SESSION['CustAdr2'])\n            -&gt;setCellValue('A9', $_SESSION['CustTown'])\n            -&gt;setCellValue('A10', $_SESSION['CustPost'])\n            -&gt;setCellValue('F6', $_SESSION['CustNo'])\n            -&gt;setCellValue('F7', rand(19999,99999))\n            -&gt;setCellValue('F8', date(&quot;d/m/Y&quot;))\n            -&gt;setCellValue('F9', $_SESSION['user'])\n            -&gt;setCellValue('F10', '651800');\n                \n    $objPHPExcel-&gt;getDefaultStyle()\n    -&gt;getAlignment()\n    -&gt;setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_CENTER);\n\n    // Freeze pane so that the heading line will not scroll\n    $objPHPExcel-&gt;getActiveSheet()-&gt;freezePane('A14');\n    \n    $objPHPExcel-&gt;getActiveSheet()-&gt;setTitle('UFP Quote');\n    \n    $objPHPExcel-&gt;getActiveSheet()-&gt;setShowGridLines(false);\nif (!PHPExcel_Settings::setPdfRenderer(\n        $rendererName,\n        $rendererLibraryPath\n    )) {\n    die(\n        'NOTICE: Please set the $rendererName and $rendererLibraryPath values' .\n        '&lt;br /&gt;' .\n        'at the top of this script as appropriate for your directory structure'\n    );\n}\n    \n// Redirect output to a client’s web browser (Excel2007)\n// Redirect output to a client’s web browser (PDF)\nheader('Content-Type: application/pdf');\nheader('Content-Disposition: attachment;filename=&quot;'. $_SESSION['user'] .'-' . $_SESSION['CustNo'] . '-quote.pdf&quot;');\nheader('Cache-Control: max-age=0');\n\n$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, 'PDF');\n$objWriter-&gt;save('php://output');\nexit;\nheader ('location: http://ufp-quote.ufp-uk.local/process3.php?&amp;start=0&amp;s=&amp;f=&amp;sort=id&amp;ad=a');\n\n}\n\n</code></pre>\n\n",
    "PostedDate": "2014-02-05T04:41:15.777-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]