[
  {
    "Id": "812306",
    "ThreadId": "349134",
    "Html": "<p>So I noticed that, in Excel 2010, users can create Data Validation List against a range in another worksheet without relying on a named range. &nbsp;I also noticed that, when users&nbsp;inadvertently&nbsp;rely on this new functionality for their cell validation, the Excel2007  Reader doesn't pick up the validation. &nbsp;I looked at the worksheet xml to see what was going on and found this (I have named range list validation on B4 and new transparent direct-reference validation on B7):</p>\n<div style=\"color: black; background-color: white;\">\n<pre><span style=\"color: blue;\"><span>\t</span>&lt;</span><span style=\"color: #a31515;\">dataValidations</span><span style=\"background-color: white;\"> </span><span style=\"color: red;\">count</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">1</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">&gt;</span>\n\t\t<span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">dataValidation</span> <span style=\"color: red;\">type</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">list</span><span style=\"color: black;\">\"</span> <span style=\"color: red;\">allowBlank</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">1</span><span style=\"color: black;\">\"</span> <span style=\"color: red;\">showInputMessage</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">1</span><span style=\"color: black;\">\"</span> <span style=\"color: red;\">showErrorMessage</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">1</span><span style=\"color: black;\">\"</span> <span style=\"color: red;\">sqref</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">B4</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">&gt;</span>\n\t\t\t<span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">formula1</span><span style=\"color: blue;\">&gt;</span>lookup<span style=\"color: blue;\">&lt;/</span><span style=\"color: #a31515;\">formula1</span><span style=\"color: blue;\">&gt;</span>\n\t\t<span style=\"color: blue;\">&lt;/</span><span style=\"color: #a31515;\">dataValidation</span><span style=\"color: blue;\">&gt;</span>\n\t<span style=\"color: blue;\">&lt;/</span><span style=\"color: #a31515;\">dataValidations</span><span style=\"color: blue;\">&gt;</span>\n\t<span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">pageMargins</span> <span style=\"color: red;\">left</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">0.7</span><span style=\"color: black;\">\"</span> <span style=\"color: red;\">right</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">0.7</span><span style=\"color: black;\">\"</span> <span style=\"color: red;\">top</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">0.75</span><span style=\"color: black;\">\"</span> <span style=\"color: red;\">bottom</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">0.75</span><span style=\"color: black;\">\"</span> <span style=\"color: red;\">header</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">0.3</span><span style=\"color: black;\">\"</span> <span style=\"color: red;\">footer</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">0.3</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">/&gt;</span>\n\t<span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">pageSetup</span> <span style=\"color: red;\">orientation</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">portrait</span><span style=\"color: black;\">\"</span> <span style=\"color: red;\">horizontalDpi</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">0</span><span style=\"color: black;\">\"</span> <span style=\"color: red;\">verticalDpi</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">0</span><span style=\"color: black;\">\"</span> <span style=\"color: red;\">r:id</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">rId1</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">/&gt;</span>\n\t<span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">extLst</span><span style=\"color: blue;\">&gt;</span>\n\t\t<span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">ext</span> <span style=\"color: red;\">uri</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">{CCE6A557-97BC-4b89-ADB6-D9C93CAAB3DF}</span><span style=\"color: black;\">\"</span> <span style=\"color: red;\">xmlns:x14</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">http://schemas.microsoft.com/office/spreadsheetml/2009/9/main</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">&gt;</span>\n\t\t\t<span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">x14</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">dataValidations</span> <span style=\"color: red;\">count</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">1</span><span style=\"color: black;\">\"</span> <span style=\"color: red;\">xmlns:xm</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">http://schemas.microsoft.com/office/excel/2006/main</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">&gt;</span>\n\t\t\t\t<span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">x14</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">dataValidation</span> <span style=\"color: red;\">type</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">list</span><span style=\"color: black;\">\"</span> <span style=\"color: red;\">allowBlank</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">1</span><span style=\"color: black;\">\"</span> <span style=\"color: red;\">showInputMessage</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">1</span><span style=\"color: black;\">\"</span> <span style=\"color: red;\">showErrorMessage</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">1</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">&gt;</span>\n\t\t\t\t\t<span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">x14</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">formula1</span><span style=\"color: blue;\">&gt;</span>\n\t\t\t\t\t\t<span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">xm</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">f</span><span style=\"color: blue;\">&gt;</span>lookup!$A$2:$A$4<span style=\"color: blue;\">&lt;/</span><span style=\"color: #a31515;\">xm</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">f</span><span style=\"color: blue;\">&gt;</span>\n\t\t\t\t\t<span style=\"color: blue;\">&lt;/</span><span style=\"color: #a31515;\">x14</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">formula1</span><span style=\"color: blue;\">&gt;</span>\n\t\t\t\t\t<span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">xm</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">sqref</span><span style=\"color: blue;\">&gt;</span>B7<span style=\"color: blue;\">&lt;/</span><span style=\"color: #a31515;\">xm</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">sqref</span><span style=\"color: blue;\">&gt;</span>\n\t\t\t\t<span style=\"color: blue;\">&lt;/</span><span style=\"color: #a31515;\">x14</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">dataValidation</span><span style=\"color: blue;\">&gt;</span>\n\t\t\t<span style=\"color: blue;\">&lt;/</span><span style=\"color: #a31515;\">x14</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">dataValidations</span><span style=\"color: blue;\">&gt;</span>\n\t\t<span style=\"color: blue;\">&lt;/</span><span style=\"color: #a31515;\">ext</span><span style=\"color: blue;\">&gt;</span>\n\t<span style=\"color: blue;\">&lt;/</span><span style=\"color: #a31515;\">extLst</span><span style=\"color: blue;\">&gt;</span>\n</pre>\n</div>\n<p>I could probably write up the piece of simpleXML object parsing to jam these new Microsoft-hacked data validations into the existing dataValidation object. &nbsp;It is sad because it seems like Microsoft made progress with the whole openXML approach for 2007  and then started jamming stuff in with this new extLst tag and the x14: namespaced children - I'm sure they had their reasons. &nbsp;I don't know if there are a bunch more properties/features that are 2010 specific that live under this extLst node - for my current  project I really just need the data validation. &nbsp;Is a 2010 reader already in the works? &nbsp;If I do work something up should I share it and if so where?</p>\n<p>Thanks for taking a look at this!</p>\n<p>Alex</p>",
    "PostedDate": "2012-03-18T20:42:58.11-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "812307",
    "ThreadId": "349134",
    "Html": "<p>Quick bit of Googling revealed that <a href=\"http://msdn.microsoft.com/en-us/library/documentformat.openxml.office2010.excel.aspx\" target=\"_blank\">all of this</a>&nbsp;is in the new Office2010.excel namespace. &nbsp;Cute. &nbsp;Look forward to reply on questions above.</p>",
    "PostedDate": "2012-03-18T20:54:10.94-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]