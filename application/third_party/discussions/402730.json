[
  {
    "Id": "939742",
    "ThreadId": "402730",
    "Html": "\r\n<p>Am trying to export an excel file with 5 worksheets in it.</p>\r\n<p>I would like to export each worksheet as an individual excel file. I have tried using the\r\n<code>getWorksheetIterator</code> but no success and it throws this error.</p>\r\n<p>Catchable fatal error: Object of class PHPExcel_Worksheet could not be converted to string in</p>\r\n<p></p>\r\n<pre>&lt;!--?php //session_start(); ?--&gt;\r\n&lt;!--?php\r\n set_time_limit(0);\r\nrequire_once '../Classes/PHPExcel/IOFactory.php';\r\n$objReader = PHPExcel_IOFactory::createReader('Excel2007');\r\n$objReader---&gt;setReadDataOnly(false);\r\n//$xlsxfiles=$_SESSION['file'];\r\n//echo $xlsxfiles;\r\n$objPHPExcel = $objReader-&gt;load('../upload/Demobook.xlsx');\r\n$num=$objPHPExcel-&gt;getSheetCount() ;\r\n$sheetnames=$objPHPExcel-&gt;getSheetNames() ;\r\n$objWorksheet = $objPHPExcel-&gt;getActiveSheet();\r\n$highestRow = $objWorksheet-&gt;getHighestRow(); // e.g. 10\r\n$objWriter = new PHPExcel_Writer_CSV($objPHPExcel);\r\n$objWriter-&gt;setDelimiter(',');\r\n$objWriter-&gt;setEnclosure('');\r\n$objWriter-&gt;setLineEnding(&quot;\\r\\n&quot;);\r\n$objReader = new PHPExcel_Reader_CSV();\r\n foreach ($objPHPExcel-&gt;getWorksheetIterator() as $worksheet) {\r\n\r\n    $worksheet-&gt;getTitle();\r\n\r\n\r\n\r\n   }\r\n      $objWriter-&gt;save(&quot;../&quot;.&quot;CSV&quot;.&quot;/&quot;.$worksheet.&quot;.&quot;.'csv');\r\n\r\n\r\n\r\n\r\n//header(&quot;Location: column_sort.php&quot;);\r\n//exit;\r\n\r\n\r\n\r\n\r\n\r\n?&gt;\r\n</pre>\r\n<p></p>\r\n",
    "PostedDate": "2012-11-10T16:17:58.463-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "943571",
    "ThreadId": "402730",
    "Html": "\r\n<p>Your problem is</p>\r\n<pre><code><span>$objWriter</span><span>-&gt;</span><span>save</span><span>(</span><span class=\"str\">&quot;../&quot;</span><span>.</span><span class=\"str\">&quot;CSV&quot;</span><span>.</span><span class=\"str\">&quot;/&quot;</span><span>.</span><span>$worksheet</span><span>.</span><span class=\"str\">&quot;.&quot;</span><span>.</span><span class=\"str\">'csv'</span><span>);</span></code></pre>\r\n<p>You're treating a worksheet object as a string, when it's not a string but a worksheet object. Did you mean</p>\r\n<pre><code><span>$objWriter</span><span>-&gt;</span><span>save</span><span>(</span><span class=\"str\">&quot;../&quot;</span><span>.</span><span class=\"str\">&quot;CSV&quot;</span><span>.</span><span class=\"str\">&quot;/&quot;</span><span>.</span><span>$worksheet</span><span>-&gt;</span><span>getTitle</span><span>().</span><span class=\"str\">&quot;.&quot;</span><span>.</span><span class=\"str\">'csv'</span><span>);</span></code></pre>\r\n<p>and you also want this inside the foreach loop.</p>\r\n<p>&nbsp;</p>\r\n<p>You also need to tell the PHPExcel Writer which sheet you wish to save in each iteration using the Writers setSheetIndex() method. Something like:</p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre><span style=\"color:blue\">foreach</span> ($objPHPExcel-&gt;getWorksheetIterator() <span style=\"color:blue\">as</span> $idx =&gt; $worksheet) {\r\n\r\n    $objWriter = <span style=\"color:blue\">new</span> PHPExcel_Writer_CSV($objPHPExcel);\r\n    $objWriter-&gt;setDelimiter(<span style=\"color:#a31515\">','</span>);\r\n    $objWriter-&gt;setEnclosure(<span style=\"color:#a31515\">''</span>);\r\n    $objWriter-&gt;setLineEnding(<span style=\"color:#a31515\">&quot;\\r\\n&quot;</span>);\r\n\r\n    $objWriter-&gt;setSheetIndex($idx);\r\n    $objWriter-&gt;save(<span style=\"color:#a31515\">&quot;../&quot;</span>.<span style=\"color:#a31515\">&quot;CSV&quot;</span>.<span style=\"color:#a31515\">&quot;/&quot;</span>.$worksheet-&gt;getTitle().<span style=\"color:#a31515\">&quot;.&quot;</span>.<span style=\"color:#a31515\">'csv'</span>);\r\n\r\n}\r\n</pre>\r\n</div>\r\n",
    "PostedDate": "2012-11-18T08:22:56.43-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]