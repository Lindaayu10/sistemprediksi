[
  {
    "Id": "133651",
    "ThreadId": "40278",
    "Html": "I was trying to add a comment to a cell.  I used the exact code from the documentation, but the comment did not appear.  What did I do wrong?<br>\r\n<br>\r\n<br>\r\n<span style=\"font-size:18px;color:#660000\"><span style=\"font-size:18px;color:#660000\"> \r\n<p align=left> </p>\r\n<p style=\"margin:0in 0in 0pt\"><span style=\"font-size:9pt;color:#660000;font-family:'courier new'\">$objReader </span><span style=\"font-size:9pt;color:black;font-family:'courier new'\">= PHPExcel_IOFactory::createReader(</span><span style=\"font-size:9pt;color:#008200;font-family:'courier new'\">'Excel5'</span><span style=\"font-size:9pt;color:black;font-family:'courier new'\">);</span> </p>\r\n<p style=\"margin:0in 0in 0pt\"><span style=\"font-size:9pt;color:#660000;font-family:'courier new'\">$objPHPExcel </span><span style=\"font-size:9pt;color:black;font-family:'courier new'\">= </span><span style=\"font-size:9pt;color:#660000;font-family:'courier new'\">$objReader</span><span style=\"font-size:9pt;color:black;font-family:'courier new'\">-&gt;load(</span><span style=\"font-size:9pt;color:#008200;font-family:'courier new'\">'Q:\\stw\\stw_php\\stwconv\\Account_Conversions\\Spreadsheets\\account_changes-v2.xls'</span><span style=\"font-size:9pt;color:black;font-family:'courier new'\">); </span></p>\r\n<p style=\"margin:0in 0in 0pt\"><span style=\"font-size:9pt;color:#660000;font-family:'courier new'\">$objPHPExcel</span><span style=\"font-size:9pt;color:black;font-family:'courier new'\">-&gt;setActiveSheetIndex(</span><span style=\"font-size:9pt;color:red;font-family:'courier new'\">0</span><span style=\"font-size:9pt;color:black;font-family:'courier new'\">);</span> </p>\r\n<p style=\"margin:0in 0in 0pt\"><span style=\"font-size:9pt;color:#660000;font-family:'courier new'\">$input_sheet </span><span style=\"font-size:9pt;color:black;font-family:'courier new'\">= </span><span style=\"font-size:9pt;color:#660000;font-family:'courier new'\">$objPHPExcel</span><span style=\"font-size:9pt;color:black;font-family:'courier new'\">-&gt;getActiveSheet();</span> </p>\r\n<p style=\"margin:0in 0in 0pt\"><span style=\"font-size:9pt;font-family:'courier new'\"><br>\r\n// ---- Create an Excel Comment </span></p>\r\n<p style=\"margin:0in 0in 0pt\"><span style=\"font-size:9pt;color:#660000;font-family:'courier new'\">$objPHPExcel</span><span style=\"font-size:9pt;color:black;font-family:'courier new'\">-&gt;getActiveSheet()-&gt;getComment(</span><span style=\"font-size:9pt;color:#008200;font-family:'courier new'\">'E11'</span><span style=\"font-size:9pt;color:black;font-family:'courier new'\">)-&gt;setAuthor(</span><span style=\"font-size:9pt;color:#008200;font-family:'courier new'\">'PHPExcel'</span><span style=\"font-size:9pt;color:black;font-family:'courier new'\">);</span> </p>\r\n<p style=\"margin:0in 0in 0pt\"><span style=\"font-size:9pt;color:#660000;font-family:'courier new'\">$objCommentRichText </span><span style=\"font-size:9pt;color:black;font-family:'courier new'\">= </span><span style=\"font-size:9pt;color:#660000;font-family:'courier new'\">$objPHPExcel</span><span style=\"font-size:9pt;color:black;font-family:'courier new'\">-&gt;getActiveSheet()-&gt;getComment(</span><span style=\"font-size:9pt;color:#008200;font-family:'courier new'\">'E11'</span><span style=\"font-size:9pt;color:black;font-family:'courier new'\">)-&gt;getText()-&gt;createTextRun(</span><span style=\"font-size:9pt;color:#008200;font-family:'courier new'\">'PHPExcel:'</span><span style=\"font-size:9pt;color:black;font-family:'courier new'\">);</span> </p>\r\n<p style=\"margin:0in 0in 0pt\"><span style=\"font-size:9pt;font-family:'courier new'\"></span></p>\r\n<p style=\"margin:0in 0in 0pt\"><span style=\"font-size:9pt;color:#660000;font-family:'courier new'\">$objCommentRichText</span><span style=\"font-size:9pt;color:black;font-family:'courier new'\">-&gt;getFont()-&gt;setBold(</span><span style=\"font-size:9pt;color:blue;font-family:'courier new'\">true</span><span style=\"font-size:9pt;color:black;font-family:'courier new'\">);</span> </p>\r\n<p style=\"margin:0in 0in 0pt\"><span style=\"font-size:9pt;font-family:'courier new'\"></span></p>\r\n<p style=\"margin:0in 0in 0pt\"><span style=\"font-size:9pt;color:#660000;font-family:'courier new'\">$objPHPExcel</span><span style=\"font-size:9pt;color:black;font-family:'courier new'\">-&gt;getActiveSheet()-&gt;getComment(</span><span style=\"font-size:9pt;color:#008200;font-family:'courier new'\">'E11'</span><span style=\"font-size:9pt;color:black;font-family:'courier new'\">)-&gt;getText()-&gt;createTextRun(</span><span style=\"font-size:9pt;color:#008200;font-family:'courier new'\">&quot;\\r\\n&quot;</span><span style=\"font-size:9pt;color:black;font-family:'courier new'\">);</span> </p>\r\n<p style=\"margin:0in 0in 0pt\"><span style=\"font-size:9pt;font-family:'courier new'\"></span></p>\r\n<p style=\"margin:0in 0in 0pt\"><span style=\"font-size:9pt;color:#660000;font-family:'courier new'\">$objPHPExcel</span><span style=\"font-size:9pt;color:black;font-family:'courier new'\">-&gt;getActiveSheet()-&gt;getComment(</span><span style=\"font-size:9pt;color:#008200;font-family:'courier new'\">'E11'</span><span style=\"font-size:9pt;color:black;font-family:'courier new'\">)-&gt;getText()-&gt;createTextRun(</span><span style=\"font-size:9pt;color:#008200;font-family:'courier new'\">'Total amount on the current invoice, excluding VAT.'</span><span style=\"font-size:9pt;color:black;font-family:'courier new'\">);</span> </p>\r\n<p style=\"margin:0in 0in 0pt\"><span style=\"font-size:9pt;font-family:'courier new'\"> </span></p>\r\n<p style=\"margin:0in 0in 0pt\"><span style=\"font-size:9pt;font-family:'courier new'\"> </span></p>\r\n<p style=\"margin:0in 0in 0pt\"><span style=\"font-size:9pt;color:#660000;font-family:'courier new'\">$objWriter </span><span style=\"font-size:9pt;color:black;font-family:'courier new'\">= PHPExcel_IOFactory::createWriter(</span><span style=\"font-size:9pt;color:#660000;font-family:'courier new'\">$objPHPExcel</span><span style=\"font-size:9pt;color:black;font-family:'courier new'\">, </span><span style=\"font-size:9pt;color:#008200;font-family:'courier new'\">'Excel5'</span><span style=\"font-size:9pt;color:black;font-family:'courier new'\">);</span> </p>\r\n<p style=\"margin:0in 0in 0pt\"><span style=\"font-size:9pt;color:#660000;font-family:'courier new'\">$objWriter</span><span style=\"font-size:9pt;color:black;font-family:'courier new'\">-&gt;save(</span><span style=\"font-size:9pt;color:#008200;font-family:'courier new'\">&quot;test-account_changes.xls&quot;</span><span style=\"font-size:9pt;color:black;font-family:'courier new'\">);</span> </p>\r\n<p style=\"margin:0in 0in 0pt\"><span style=\"font-size:9pt;font-family:verdana\"> </span></p>\r\n<p align=left>&nbsp;</p>\r\n</span>\r\n<p align=left>&nbsp;</p>\r\n</span>\r\n<p align=left><span style=\"font-size:18px\">\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<p>&nbsp;</p>\r\n",
    "PostedDate": "2008-11-19T06:37:19.46-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "133654",
    "ThreadId": "40278",
    "Html": "I'm afraid that comments are not supported in Excel5 reader/writer. You may have to resort to Excel2007 reader/writer. There is rather poor documentation on how comments are stored in BIFF8 (Excel 97-2003) files. BIFF5 (Excel 5.0-95) was much simpler. Yet, it is probably possible to add support in Excel5 reader/writer if one studies hard enough. Until then, sorry...<br>\r\n",
    "PostedDate": "2008-11-19T06:48:58.327-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]