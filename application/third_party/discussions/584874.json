[
  {
    "Id": "1360745",
    "ThreadId": "584874",
    "Html": "I currently have the below code that will loop through the excel file and return rows with missing data. the output is as below:<br />\n<pre><code>- Row number: 37\n    - Missing : in cell B37\n    - Missing : in cell D37</code></pre>\n\nWhat I would like to return is the following<br />\n<pre><code>- Row number: 37\n    - Missing nameFirst : in cell B37\n    - Missing nameLast : in cell D37</code></pre>\n\nWhere nameFirst is the value of cell B1 and nameLast is the value of D1.<br />\n<pre><code>&lt;?PHP\nrequire_once 'Excel/PHPExcel.php';\nrequire_once 'Excel/PHPExcel/Reader/Excel2007.php';\nclass MyReadFilter implements PHPExcel_Reader_IReadFilter\n{\n    public function readCell($column, $row, $worksheetName = '') {\n        $Retour=false;\n        $column=PHPExcel_Cell::columnIndexFromString($column);// Warning ! A=1, not zero as usual\n        if($row&lt;1 || $column&gt;4)\n            $Retour=false;\n        else\n            $Retour=true;\n        return $Retour;\n    }\n}\necho '&lt;pre&gt;';\n$objReader = PHPExcel_IOFactory::createReader('Excel2007');\n$objReader-&gt;setReadDataOnly(true);\n$objReader-&gt;setReadFilter( new MyReadFilter() );\n$objPHPExcel = $objReader-&gt;load('test.xlsx');\n$worksheet=$objPHPExcel-&gt;getSheet(0);\nforeach ($worksheet-&gt;getRowIterator() as $row) {\n        if($row-&gt;getRowIndex()&gt;1){\n            echo '    - Row number: ' . $row-&gt;getRowIndex() . &quot;\\r\\n&quot;;\n\n            $cellIterator = $row-&gt;getCellIterator();\n            $cellIterator-&gt;setIterateOnlyExistingCells(false); // Loop all cells, even if it is not set\n            foreach ($cellIterator as $cell) {\n                 $colIndex = PHPExcel_Cell::columnIndexFromString($cell-&gt;getColumn());\n\n\n\n                if($cell-&gt;getCalculatedValue() == &quot;&quot;)\n                echo '        - Missing &lt;THIS IS WHERE I WANT THE INDEX CELL FOR THE COLUMN&gt; :' . 'in cell ' . $cell-&gt;getCoordinate() . &quot;\\r\\n&quot;;\n\n        }\n        }\n    }\necho '&lt;/pre&gt;';\n\n?&gt;</code></pre>\n\nI tried changing the echo to include the variable $colIndex in addition to:<br />\n<pre><code>            echo '        - Missing '. $worksheet-&gt;getCellByColumnAndRow($colIndex, 1)-&gt;getValue(). '. :'  . $cell-&gt;getCoordinate() . &quot;\\r\\n&quot;;</code></pre>\n\nBut this causes a return of one row and only one correct cell and a whole bunch of blank variables<br />\n<pre><code>- Row number: 2\n    - Missing nameFirst. :B1\n    - Missing . :E1\n    - Missing . :F1\n    - Missing . :G1\n    - Missing . :H1</code></pre>\n\n",
    "PostedDate": "2015-03-08T10:36:58.507-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]