[
  {
    "Id": "1343254",
    "ThreadId": "578062",
    "Html": "Hi Guys,\r<br />\n<br />\nI've been pulling my hair out over this for 2 days and hoping somebody can help.\r<br />\n<br />\nHere is the test URL for the site: fram.de22.co.uk\r<br />\n<br />\nOn the filter life calculation tab, this is the 5th one down the table doesn't show the values correctly, but only if the years on the &quot;filter life&quot; tab is set to 3 or 5 all other years work fine, nothing changes in the spreadsheet with these years and if you open the spreadsheet the values are there but PHPExcel doesn't read them for some reason, even more confusing is if I manually type the value in it then reads it fine.\r<br />\n<br />\nHere is the code for the filter life calculation page:<br />\n<div style=\"color:Black;background-color:White;\"><pre>\r\n&lt;?php\n    session_start();\n    <span style=\"color:Blue;\">if</span>(<span style=\"color:Blue;\">isset</span>($_GET[<span style=\"color:#A31515;\">&#39;sestamp&#39;</span>])) {\n        $clientfile = $_GET[<span style=\"color:#A31515;\">&#39;sestamp&#39;</span>];\n        $path = <span style=\"color:#A31515;\">&#39;inc/files/&#39;</span>.$clientfile;\n\n    } <span style=\"color:Blue;\">else</span> {\n        $clientfile = $_SESSION[<span style=\"color:#A31515;\">&#39;file&#39;</span>];\n        $path = <span style=\"color:#A31515;\">&#39;inc/files/&#39;</span>.$clientfile;\n\n    }\n\n    <span style=\"color:Blue;\">echo</span> $clientfile;\n\n?&gt;\n\n&lt;?php <span style=\"color:Blue;\">include</span>(<span style=\"color:#A31515;\">&#39;inc/header.php&#39;</span>); ?&gt;\n\n&lt;div <span style=\"color:Blue;\">class</span>=<span style=\"color:#A31515;\">&quot;left-panel&quot;</span>&gt;\n    &lt;img src=<span style=\"color:#A31515;\">&quot;images/side-logo.png&quot;</span> alt=<span style=\"color:#A31515;\">&quot;FRAM Industrial&quot;</span> /&gt;\n    &lt;div <span style=\"color:Blue;\">class</span>=<span style=\"color:#A31515;\">&quot;side-nav&quot;</span>&gt;\n        &lt;a href=<span style=\"color:#A31515;\">&quot;index.php&quot;</span> <span style=\"color:Blue;\">class</span>=<span style=\"color:#A31515;\">&quot;nav-1&quot;</span>&gt;Home&lt;/a&gt;\n        &lt;a href=<span style=\"color:#A31515;\">&quot;2-turbine.php&quot;</span> <span style=\"color:Blue;\">class</span>=<span style=\"color:#A31515;\">&quot;nav-2&quot;</span>&gt;Turbine&lt;/a&gt;\n        &lt;a href=<span style=\"color:#A31515;\">&quot;3-pair-price.php&quot;</span> <span style=\"color:Blue;\">class</span>=<span style=\"color:#A31515;\">&quot;nav-3&quot;</span>&gt;Pair Price&lt;/a&gt;\n        &lt;a href=<span style=\"color:#A31515;\">&quot;4-filter-life.php&quot;</span> <span style=\"color:Blue;\">class</span>=<span style=\"color:#A31515;\">&quot;nav-4&quot;</span>&gt;Filter Life&lt;/a&gt;\n        &lt;a href=<span style=\"color:#A31515;\">&quot;5-filter-calculation.php&quot;</span> <span style=\"color:Blue;\">class</span>=<span style=\"color:#A31515;\">&quot;nav-5 active&quot;</span>&gt;Filter Calculation&lt;/a&gt;\n        &lt;a href=<span style=\"color:#A31515;\">&quot;6-filter-class.php&quot;</span> <span style=\"color:Blue;\">class</span>=<span style=\"color:#A31515;\">&quot;nav-6&quot;</span>&gt;Filter Class&lt;/a&gt;\n        &lt;a href=<span style=\"color:#A31515;\">&quot;7-contamination-calculation.php&quot;</span> <span style=\"color:Blue;\">class</span>=<span style=\"color:#A31515;\">&quot;nav-7&quot;</span>&gt;Contamination Calculation&lt;/a&gt;\n        &lt;a href=<span style=\"color:#A31515;\">&quot;8-revenue.php&quot;</span> <span style=\"color:Blue;\">class</span>=<span style=\"color:#A31515;\">&quot;nav-8&quot;</span>&gt;Revenue&lt;/a&gt;\n        &lt;a href=<span style=\"color:#A31515;\">&quot;9-notes.php&quot;</span> <span style=\"color:Blue;\">class</span>=<span style=\"color:#A31515;\">&quot;nav-9&quot;</span>&gt;Notes&lt;/a&gt;\n    &lt;/div&gt;\n    &lt;div <span style=\"color:Blue;\">class</span>=<span style=\"color:#A31515;\">&quot;side-foot&quot;</span>&gt;\n        &lt;p <span style=\"color:Blue;\">class</span>=<span style=\"color:#A31515;\">&quot;white&quot;</span>&gt;&lt;strong&gt;FRAM Industrial&lt;br /&gt;(Europe) Ltd&lt;/strong&gt;&lt;/p&gt;\n        &lt;p <span style=\"color:Blue;\">class</span>=<span style=\"color:#A31515;\">&quot;white&quot;</span>&gt;Crown Farm Way,&lt;br /&gt;\n        Mansfield,&lt;br /&gt;\n        Nottinghamshire,&lt;br /&gt;\n        NG19 0FT&lt;/p&gt;\n        &lt;p <span style=\"color:Blue;\">class</span>=<span style=\"color:#A31515;\">&quot;white&quot;</span>&gt;01623 412 412&lt;br /&gt;\n        &lt;a href=<span style=\"color:#A31515;\">&quot;http://www.framindustrial.com/&quot;</span>&gt;&lt;strong&gt;www.framindustrial.com&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;\n    &lt;/div&gt;\n&lt;/div&gt;\n\n&lt;div <span style=\"color:Blue;\">class</span>=<span style=\"color:#A31515;\">&quot;right-panel&quot;</span>&gt;\n    &lt;div <span style=\"color:Blue;\">class</span>=<span style=\"color:#A31515;\">&quot;right-cont&quot;</span>&gt;\n        &lt;div <span style=\"color:Blue;\">class</span>=<span style=\"color:#A31515;\">&quot;right-left&quot;</span>&gt;\n            &lt;div <span style=\"color:Blue;\">class</span>=<span style=\"color:#A31515;\">&quot;spacer&quot;</span>&gt;&amp;nbsp;&lt;/div&gt;\n            &lt;?php\n                $objReader = PHPExcel_IOFactory::createReader(<span style=\"color:#A31515;\">&#39;Excel2007&#39;</span>);\n                $objReader-&gt;setReadDataOnly(true);\n\n                $objPHPExcel = $objReader-&gt;load($path);\n                $objPHPExcel-&gt;setActiveSheetIndexByName(<span style=\"color:#A31515;\">&quot;PAIR CALC&quot;</span>);\n                $objWorksheet = $objPHPExcel-&gt;getActiveSheet();\n\n                $filter = $objPHPExcel-&gt;getActiveSheet()-&gt;getCell(<span style=\"color:#A31515;\">&#39;G8&#39;</span>)-&gt;getCalculatedValue();\n\n            ?&gt;\n            &lt;?php\n                <span style=\"color:Green;\">//Test Code</span>\n\n\n            ?&gt;\n\n                &lt;table width=<span style=\"color:#A31515;\">&quot;450&quot;</span> cellspacing=<span style=\"color:#A31515;\">&quot;0&quot;</span>&gt;\n                    &lt;tr <span style=\"color:Blue;\">class</span>=<span style=\"color:#A31515;\">&quot;table-title&quot;</span>&gt;\n                        &lt;td width=<span style=\"color:#A31515;\">&quot;116&quot;</span> align=<span style=\"color:#A31515;\">&quot;center&quot;</span> valign=<span style=\"color:#A31515;\">&quot;middle&quot;</span>&gt;&lt;strong&gt;Pressure Loss&lt;br /&gt;Calculation&lt;/strong&gt;&lt;/td&gt;\n                        &lt;td width=<span style=\"color:#A31515;\">&quot;142&quot;</span> align=<span style=\"color:#A31515;\">&quot;center&quot;</span> valign=<span style=\"color:#A31515;\">&quot;middle&quot;</span>&gt;&lt;strong&gt;Comparison&lt;/strong&gt;&lt;/td&gt;\n                        &lt;td width=<span style=\"color:#A31515;\">&quot;142&quot;</span> align=<span style=\"color:#A31515;\">&quot;center&quot;</span> valign=<span style=\"color:#A31515;\">&quot;middle&quot;</span>&gt;&lt;strong&gt;&lt;?php <span style=\"color:Blue;\">echo</span> $filter; ?&gt;&lt;/strong&gt;&lt;/td&gt;\n                    &lt;/tr&gt;\n                    &lt;tr <span style=\"color:Blue;\">class</span>=<span style=\"color:#A31515;\">&quot;first-row&quot;</span>&gt;\n                        &lt;td valign=<span style=\"color:#A31515;\">&quot;middle&quot;</span> height=<span style=\"color:#A31515;\">&quot;20&quot;</span>&gt;Efficiency Loss (%)&lt;/td&gt;\n                        &lt;td align=<span style=\"color:#A31515;\">&quot;center&quot;</span> valign=<span style=\"color:#A31515;\">&quot;middle&quot;</span> height=<span style=\"color:#A31515;\">&quot;30&quot;</span>&gt;&lt;?php <span style=\"color:Blue;\">echo</span> $objPHPExcel-&gt;getActiveSheet()-&gt;getCell(<span style=\"color:#A31515;\">&#39;E26&#39;</span>)-&gt;getFormattedValue(); ?&gt;&lt;/td&gt;\n                        &lt;td align=<span style=\"color:#A31515;\">&quot;center&quot;</span> valign=<span style=\"color:#A31515;\">&quot;middle&quot;</span> height=<span style=\"color:#A31515;\">&quot;30&quot;</span>&gt;&lt;?php <span style=\"color:Blue;\">echo</span> $objPHPExcel-&gt;getActiveSheet()-&gt;getCell(<span style=\"color:#A31515;\">&#39;G26&#39;</span>)-&gt;getFormattedValue(); ?&gt;&lt;/td&gt;\n                    &lt;/tr&gt;\n                    &lt;tr&gt;\n                        &lt;td valign=<span style=\"color:#A31515;\">&quot;middle&quot;</span>&gt;Lost Energy (mWh)&lt;/td&gt;\n                        &lt;td align=<span style=\"color:#A31515;\">&quot;center&quot;</span> valign=<span style=\"color:#A31515;\">&quot;middle&quot;</span> height=<span style=\"color:#A31515;\">&quot;30&quot;</span>&gt;&lt;?php <span style=\"color:Blue;\">echo</span> $objPHPExcel-&gt;getActiveSheet()-&gt;getCell(<span style=\"color:#A31515;\">&#39;E27&#39;</span>)-&gt;getFormattedValue(); ?&gt;&lt;/td&gt;\n                        &lt;td align=<span style=\"color:#A31515;\">&quot;center&quot;</span> valign=<span style=\"color:#A31515;\">&quot;middle&quot;</span> height=<span style=\"color:#A31515;\">&quot;30&quot;</span>&gt;&lt;?php <span style=\"color:Blue;\">echo</span> $objPHPExcel-&gt;getActiveSheet()-&gt;getCell(<span style=\"color:#A31515;\">&#39;G27&#39;</span>)-&gt;getFormattedValue(); ?&gt;&lt;/td&gt;\n                    &lt;/tr&gt;\n                    &lt;tr&gt;\n                        &lt;td valign=<span style=\"color:#A31515;\">&quot;middle&quot;</span>&gt;Lost Revenue (&#163;)&lt;/td&gt;\n                            &lt;?php\n                                $custrev = $objPHPExcel-&gt;getActiveSheet()-&gt;getCell(<span style=\"color:#A31515;\">&#39;E28&#39;</span>)-&gt;getCalculatedValue();\n                                $custrev = number_format ( $custrev, 2, <span style=\"color:#A31515;\">&#39;.&#39;</span>, <span style=\"color:#A31515;\">&#39;,&#39;</span> );\n                                $filtrev = $objPHPExcel-&gt;getActiveSheet()-&gt;getCell(<span style=\"color:#A31515;\">&#39;G28&#39;</span>)-&gt;getCalculatedValue();\n                                $filtrev = number_format ( $filtrev, 2, <span style=\"color:#A31515;\">&#39;.&#39;</span>, <span style=\"color:#A31515;\">&#39;,&#39;</span> );\n                                $totrev = $objPHPExcel-&gt;getActiveSheet()-&gt;getCell(<span style=\"color:#A31515;\">&#39;I26&#39;</span>)-&gt;getCalculatedValue();\n                                $totrev = number_format ( $totrev, 2, <span style=\"color:#A31515;\">&#39;.&#39;</span>, <span style=\"color:#A31515;\">&#39;,&#39;</span> );\n                            ?&gt;\n                        &lt;td align=<span style=\"color:#A31515;\">&quot;center&quot;</span> valign=<span style=\"color:#A31515;\">&quot;middle&quot;</span> height=<span style=\"color:#A31515;\">&quot;30&quot;</span>&gt;&amp;pound;&lt;?php <span style=\"color:Blue;\">echo</span> $custrev; ?&gt;&lt;/td&gt;\n                        &lt;td align=<span style=\"color:#A31515;\">&quot;center&quot;</span> valign=<span style=\"color:#A31515;\">&quot;middle&quot;</span> height=<span style=\"color:#A31515;\">&quot;30&quot;</span>&gt;&amp;pound;&lt;?php <span style=\"color:Blue;\">echo</span> $filtrev; ?&gt;&lt;/td&gt;\n                    &lt;/tr&gt;\n                    &lt;tr&gt;\n                        &lt;td align=<span style=\"color:#A31515;\">&quot;right&quot;</span> valign=<span style=\"color:#A31515;\">&quot;middle&quot;</span> height=<span style=\"color:#A31515;\">&quot;30&quot;</span>&gt;&lt;strong&gt;&lt;span <span style=\"color:Blue;\">class</span>=<span style=\"color:#A31515;\">&quot;orange&quot;</span>&gt;Revenue&lt;br /&gt;Difference&lt;/span&gt;&lt;/strong&gt;&lt;/td&gt;\n                        &lt;td colspan=<span style=\"color:#A31515;\">&quot;2&quot;</span> align=<span style=\"color:#A31515;\">&quot;center&quot;</span> valign=<span style=\"color:#A31515;\">&quot;middle&quot;</span> height=<span style=\"color:#A31515;\">&quot;30&quot;</span>&gt;&lt;strong&gt;&amp;pound;&lt;?php <span style=\"color:Blue;\">echo</span> $totrev; ?&gt;&lt;/strong&gt;&lt;/td&gt;\n                    &lt;/tr&gt;\n                &lt;/table&gt;\n\n                &lt;br /&gt;&lt;br /&gt;\n\n\n        &lt;/div&gt;\n        &lt;div <span style=\"color:Blue;\">class</span>=<span style=\"color:#A31515;\">&quot;right-right&quot;</span>&gt;\n            &lt;img src=<span style=\"color:#A31515;\">&quot;images/logo.png&quot;</span> alt=<span style=\"color:#A31515;\">&quot;FRAM Industrial&quot;</span>&gt;\n            &lt;h1 <span style=\"color:Blue;\">class</span>=<span style=\"color:#A31515;\">&quot;orange&quot;</span>&gt;Filter Life Calculation&lt;/h1&gt;\n            &lt;p&gt;This is the increased revenue prediction based around the filter life data previously estimated, this can be adjusted by going back to alter the estimated data.&lt;/p&gt;\n            &lt;p&gt;The graphs show a visual representation of the estimate average turbine efficiency loss curve, due to the filters pressure characteristic, over a desired time frame.&lt;/p&gt;\n            &lt;div <span style=\"color:Blue;\">class</span>=<span style=\"color:#A31515;\">&quot;links&quot;</span>&gt;\n                &lt;a href=<span style=\"color:#A31515;\">&quot;4-filter-life.php&quot;</span> <span style=\"color:Blue;\">class</span>=<span style=\"color:#A31515;\">&quot;back&quot;</span>&gt;Back&lt;/a&gt;\n                &lt;a href=<span style=\"color:#A31515;\">&quot;6-filter-class.php&quot;</span>&gt;Filter Class&lt;/a&gt;\n            &lt;/div&gt;\n        &lt;/div&gt;\n    &lt;/div&gt;\n&lt;/div&gt;\n\n&lt;?php <span style=\"color:Blue;\">include</span>(<span style=\"color:#A31515;\">&#39;inc/footer.php&#39;</span>); ?&gt;\r\n</pre></div>I've outputted the filename being used to the top of the page so if you got to:\r<br />\n<a href=\"http://fram.de22.co.uk/inc/files/\" rel=\"nofollow\">http://fram.de22.co.uk/inc/files/</a> <em>name of the file here</em>\r<br />\nyou can download and see the spreadsheet that it's currently working from,\r<br />\n<br />\nCan anyone help with this?<br />\n",
    "PostedDate": "2015-01-19T07:41:18.543-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]