[
  {
    "Id": "412610",
    "ThreadId": "203384",
    "Html": "<p>Hi,</p>\r\n<p>I generate an excel and php throw me the error:&nbsp; &quot;Out of memory (allocated 515637248) (tried to allocate 68 bytes)&quot;.&nbsp; The memory seems pretty big so i suppose the problem is generated by my scripts which generate the excel and i don't figure out what I'm doing wrong.The final excel has 2-300 KB.</p>\r\n<p>I can attach a sample of generated excel but I preffer to keep this file private .</p>",
    "PostedDate": "2010-03-01T00:59:42.08-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "413031",
    "ThreadId": "203384",
    "Html": "<p>I have a similar problem - the memory used by PHPExcel is quite big. Is there any chance to have it reduced in the near future?</p>",
    "PostedDate": "2010-03-02T00:10:48.683-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "413048",
    "ThreadId": "203384",
    "Html": "<p>There are many threads about the memory usage of PHPExcel here on the board, and most reiterate the same thing.</p>\r\n<p>Yes, we are actively working on reducing the memory usage. We've already made significant inroads, and provided a number of facilities that allow you to read in only certain worksheets or parts of worksheets or the data only (no formatting information)&nbsp;to reduce the volumes of data and corresponding memory usage. The latest SVN code includes a lazy loader that only accesses the PHPExcel classes that you actually need within your script (current 1.7.2 code still includes all classes) in order to reduce the memory footprint.</p>\r\n<p>And we are still working on this.</p>",
    "PostedDate": "2010-03-02T00:50:07.88-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "414580",
    "ThreadId": "203384",
    "Html": "<blockquote style=\"border:solid .1em #ccc;font-style:italic;margin:.25em 1em 0 1em;padding:0 .25em 0 .25em\"><strong>MarkBaker wrote:</strong></blockquote>\r\n<blockquote style=\"border:solid .1em #ccc;font-style:italic;margin:.25em 1em 0 1em;padding:0 .25em 0 .25em\">The latest SVN code includes a lazy loader that only accesses the PHPExcel classes that you actually need within your script (current 1.7.2 code still includes all classes) in order to reduce the memory footprint</blockquote>\r\n<p>Hi,</p>\r\n<p>thx for ur great job on PHPexcel.</p>\r\n<p>i have similar problem too, as ur direction where can i download the latest SVN that include lazy loader, and how to configure it on my PHPexcel 1.7.2</p>\r\n<p>thx for ur reply Mr. Mark Baker</p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2010-03-05T05:41:31.98-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "414758",
    "ThreadId": "203384",
    "Html": "<p>The Daily SVN builds can be found under the &quot;Source&quot; tab here on CodePlex PHPExcel</p>\r\n<p><a href=\"http://phpexcel.codeplex.com/SourceControl/list/changesets\">http://phpexcel.codeplex.com/SourceControl/list/changesets</a></p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2010-03-05T13:46:52.793-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "416271",
    "ThreadId": "203384",
    "Html": "<p>hi,</p>\r\n<p>thx for ur quick reply, i have downloaded <a href=\"../SourceControl/list/changesets\">http://phpexcel.codeplex.com/SourceControl/list/changesets</a> , but i still have same error</p>\r\n<p><strong>Fatal error</strong>:  Allowed memory size of 16777216 bytes exhausted (tried to allocate 67 bytes) in <strong>/var/www/Classes/PHPExcel/Worksheet.php</strong> on line <strong>939</strong></p>\r\n<p><strong>pls let me know how to solve&nbsp; this problem? <br></strong></p>",
    "PostedDate": "2010-03-10T01:30:53.437-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "416361",
    "ThreadId": "203384",
    "Html": "<blockquote style=\"border:solid .1em #ccc;font-style:italic;margin:.25em 1em 0 1em;padding:0 .25em 0 .25em\"><strong>vatoer wrote:</strong><br>\r\n<p><strong>pls let me know how to solve&nbsp; this problem? <br></strong></p>\r\n</blockquote>\r\n<p>&nbsp;</p>\r\n<p>At present, the only way to solve this problem is to allocate more memory to PHP by changing the memory_limit setting in php.ini, e.g</p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre>memory_limit=32MB</pre>\r\n</div>\r\n<p>setting an .htaccess entry to increase the allocated memory, e.g</p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre>php_value memory_limit 32M</pre>\r\n</div>\r\n<p>or (may not work) changing the limit at the top of your script, e.g</p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre>ini_set(&rsquo;memory_limit&rsquo;, &lsquo;32M&rsquo;);</pre>\r\n</div>\r\n<p>We <strong><em>are</em></strong> actively working on this. I've spent most of the last two weeks prototyping a mechanism for &quot;cell caching&quot; which can reduce memory usage drastically, but at a cost in performance. Basically, only the currently active cell object is resident in memory at any one time. Other cells might be held serialized in memory, or stored on disk or in a database, or in APC or memcache; but at a cost in&nbsp;speed... whenever another cell is accessed, the first is stored back in cache, and the newly requested&nbsp;cell retrieved from cache.<br>There is no simple solution: if reducing memory usage results in constant timeouts, then it isn't a viable solution.&nbsp;We're looking for the best solution that will accomodate all users of PHPExcel so that you don't hit memory <strong><em>or</em></strong> timeout problems, and the work I'm doing at the moment is analysing and tuning to find the best memory reduction with the minimum increase in execution time.</p>\r\n<p>As an example (for 16,384 cells):</p>\r\n<table border=1 cellspacing=2 cellpadding=2>\r\n<tbody>\r\n<tr>\r\n<th valign=bottom>Cell Storage Method</th><th valign=bottom>Memory Usage<br>(MB)</th><th>Cell Creation time<br>(seconds for<br>16,384 cells)</th><th>Cell retrieve time<br>(seconds for<br>16,384 cells)</th><th>\r\n<p>Cell modify time<br>(seconds for<br>16,384 cells)</p>\r\n</th>\r\n</tr>\r\n<tr>\r\n<td>Current cell storage</td>\r\n<td align=right>12.25</td>\r\n<td align=right>0.2293</td>\r\n<td align=right>0.0674</td>\r\n<td align=right>0.2117</td>\r\n</tr>\r\n<tr>\r\n<td>Serialized cell storage</td>\r\n<td align=right>9</td>\r\n<td align=right>0.4141</td>\r\n<td align=right>0.3384</td>\r\n<td align=right>1.5574</td>\r\n</tr>\r\n<tr>\r\n<td>APC cell storage</td>\r\n<td align=right>0</td>\r\n<td align=right>0.9113</td>\r\n<td align=right>0.5387</td>\r\n<td align=right>2.8961</td>\r\n</tr>\r\n<tr>\r\n<td>Memcache cell storage</td>\r\n<td align=right>0</td>\r\n<td align=right>11.6727</td>\r\n<td align=right>5.6859</td>\r\n<td align=right>18.4403</td>\r\n</tr>\r\n<tr>\r\n<td>Disk (Partial) cell storage<br>(using an ISAM file for all cells)</td>\r\n<td align=right valign=top>4.75</td>\r\n<td align=right valign=top>1.0742</td>\r\n<td align=right valign=top>0.7211</td>\r\n<td align=right valign=top>2.9781</td>\r\n</tr>\r\n<tr>\r\n<td>Disk (Full) cell storage<br>(using a temporary file for each cell)</td>\r\n<td align=right valign=top>0</td>\r\n<td align=right valign=top>45.04405</td>\r\n<td align=right valign=top>10.4741</td>\r\n<td align=right valign=top>66.5842</td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n<p>As you can see, the more we reduce the memory usage, the slower a script will run. APC or Full Disk storage offer the best memory footprint (only the currently accessed cell is ever resident in PHP memory at any time); but not every user has APC enabled, and the speed for Full Disk storage is simply not acceptable. Serialized cell storage and Partial Disk storage seem to offer the best balance of memory reduction and script execution time; but they're still very slow in comparison to the current method of holding every cell object in memory.</p>\r\n<p>We are trying to resolve this problem, and while we have already achieved a great deal in reducing the memory footprint, we know there's still a lot more work to do before we can consider the problem is resolved. Please bear with us while we do that work.</p>",
    "PostedDate": "2010-03-10T05:50:11.94-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "416762",
    "ThreadId": "203384",
    "Html": "<blockquote style=\"border:solid .1em #ccc;font-style:italic;margin:.25em 1em 0 1em;padding:0 .25em 0 .25em\"><strong>MarkBaker wrote:</strong><br>\r\n<p>At present, the only way to solve this problem is to allocate more memory to PHP by changing the memory_limit setting in php.ini, e.g</p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre>memory_limit=32MB</pre>\r\n</div>\r\n<p>setting an .htaccess entry to increase the allocated memory, e.g</p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre>php_value memory_limit 32M</pre>\r\n</div>\r\n<p>or (may not work) changing the limit at the top of your script, e.g</p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre>ini_set(&rsquo;memory_limit&rsquo;, &lsquo;32M&rsquo;);</pre>\r\n</div>\r\n<p>..........</p>\r\n</blockquote>\r\n<p>thx for temporary solve the problem.</p>\r\n<p>just for information ( i hope this will give u little useful information )</p>\r\n<p>i create excel from template with file size : 7KB</p>\r\n<p>i try to increase my mymory up to 32M and the result can produce maximum +- 444 new inserted row and Y column in my excel template</p>\r\n<p>64M -&gt; +- 900 new inserted row , Y column</p>\r\n<p>128M -&gt; +- 1800 new inserted row , Y column</p>\r\n<p>&nbsp;</p>\r\n<p>i really appreciated for ur great job n hopefully u can do it with <span id=\"result_box\"><span style=\"background-color:#ffffff\" title=\"semangat pantang menyerah\">unyielding spirit. thanks for sharing your knowledge<br></span></span></p>",
    "PostedDate": "2010-03-10T19:44:32.167-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "991488",
    "ThreadId": "203384",
    "Html": "\r\n<p>I have also similar problem</p>\r\n<p>I&nbsp;<span>&nbsp;use PhpExcel in CodeIgniter.When I generate huge amount of data in Excel it will produce Fatal error:</span></p>\r\n<p><span>&nbsp;</span><span style=\"font-family:Consolas,'Courier New',Courier,monospace; font-size:1em\">Out</span><span style=\"font-family:Consolas,'Courier New',Courier,monospace; font-size:1em\"> of memory\r\n</span><span style=\"font-family:Consolas,'Courier New',Courier,monospace; font-size:1em\">(</span><span style=\"font-family:Consolas,'Courier New',Courier,monospace; font-size:1em\">allocated\r\n</span><span style=\"font-family:Consolas,'Courier New',Courier,monospace; font-size:1em\">883949568</span><span style=\"font-family:Consolas,'Courier New',Courier,monospace; font-size:1em\">)</span><span style=\"font-family:Consolas,'Courier New',Courier,monospace; font-size:1em\">\r\n</span><span style=\"font-family:Consolas,'Courier New',Courier,monospace; font-size:1em\">(</span><span style=\"font-family:Consolas,'Courier New',Courier,monospace; font-size:1em\">tried to allocate\r\n</span><span style=\"font-family:Consolas,'Courier New',Courier,monospace; font-size:1em\">93</span><span style=\"font-family:Consolas,'Courier New',Courier,monospace; font-size:1em\"> bytes</span><span style=\"font-family:Consolas,'Courier New',Courier,monospace; font-size:1em\">)</span><span style=\"font-family:Consolas,'Courier New',Courier,monospace; font-size:1em\">\r\n</span><span style=\"font-family:Consolas,'Courier New',Courier,monospace; font-size:1em\">in</span><span style=\"font-family:Consolas,'Courier New',Courier,monospace; font-size:1em\">\r\n</span><span style=\"font-family:Consolas,'Courier New',Courier,monospace; font-size:1em\">/</span><span style=\"font-family:Consolas,'Courier New',Courier,monospace; font-size:1em\">home</span><span style=\"font-family:Consolas,'Courier New',Courier,monospace; font-size:1em\">/</span><span style=\"font-family:Consolas,'Courier New',Courier,monospace; font-size:1em\">abc</span><span style=\"font-family:Consolas,'Courier New',Courier,monospace; font-size:1em\">/</span><span style=\"font-family:Consolas,'Courier New',Courier,monospace; font-size:1em\">public_html</span><span style=\"font-family:Consolas,'Courier New',Courier,monospace; font-size:1em\">/</span><span style=\"font-family:Consolas,'Courier New',Courier,monospace; font-size:1em\">xxx</span><span style=\"font-family:Consolas,'Courier New',Courier,monospace; font-size:1em\">/</span><span style=\"font-family:Consolas,'Courier New',Courier,monospace; font-size:1em\">application</span><span style=\"font-family:Consolas,'Courier New',Courier,monospace; font-size:1em\">/</span><span style=\"font-family:Consolas,'Courier New',Courier,monospace; font-size:1em\">libraries</span><span style=\"font-family:Consolas,'Courier New',Courier,monospace; font-size:1em\">/</span><span style=\"font-family:Consolas,'Courier New',Courier,monospace; font-size:1em\">excel</span><span style=\"font-family:Consolas,'Courier New',Courier,monospace; font-size:1em\">/</span><span style=\"font-family:Consolas,'Courier New',Courier,monospace; font-size:1em\">PHPExcel</span><span style=\"font-family:Consolas,'Courier New',Courier,monospace; font-size:1em\">/</span><span style=\"font-family:Consolas,'Courier New',Courier,monospace; font-size:1em\">Style</span><span style=\"font-family:Consolas,'Courier New',Courier,monospace; font-size:1em\">.</span><span style=\"font-family:Consolas,'Courier New',Courier,monospace; font-size:1em\">php\r\n on line </span><span style=\"font-family:Consolas,'Courier New',Courier,monospace; font-size:1em\">465.</span></p>\r\n<p><span style=\"font-family:Consolas,'Courier New',Courier,monospace; font-size:1em\">Even though I set&nbsp;</span><span style=\"font-family:Consolas,'Courier New',Courier,monospace; font-size:1em\">memory_limit in controller&nbsp;<span>ini_set( &quot;memory_limit&quot;,&quot;5120M&quot;);\r\n and also in php.ini.</span></span></p>\r\n<p>I also set cell caching in controller.</p>\r\n<p>I set memoryCacheSize&nbsp;in&nbsp;PHPExcel/CachedObjectStorage/PHPTemp.php 1MB to 5120MB.</p>\r\n<p>I also increase the&nbsp;cacheTime in&nbsp;PHPExcel/CachedObjectStorage/Memcache.php 600 to&nbsp;259200 and also in othef file in&nbsp;CachedObjectStorage.</p>\r\n<p><span style=\"font-family:Consolas,'Courier New',Courier,monospace; font-size:1em\"><span>but could not solve this problem.</span></span></p>\r\n<p><span style=\"font-family:Consolas,'Courier New',Courier,monospace; font-size:1em\"><span>Please<strong>&nbsp;let me know how to solve this problem?</strong></span></span></p>\r\n<p><span><br>\r\n</span></p>\r\n",
    "PostedDate": "2013-01-24T05:01:37.503-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]