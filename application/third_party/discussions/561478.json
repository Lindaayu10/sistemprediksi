[
  {
    "Id": "1290973",
    "ThreadId": "561478",
    "Html": "I am using PHp Excel\r<br />\n<br />\ncould extract / read data but cannot extract images\r<br />\n<br />\n<a href=\"http://webvikas.net.in/advent/readexcel.php\" rel=\"nofollow\">TEXT</a>\r<br />\n<br />\n<br />\nwhich allows me to read excel file (only data) \r<br />\nbut do not   extract images\r<br />\n<br />\nMy code\r<br />\n&lt;?php \r<br />\n include 'Classes/PHPExcel/IOFactory.php';\r<br />\n<br />\n$inputFileName = 'advent-bb-products.xls';\r<br />\n<br />\n//  Read your Excel workbook\r<br />\ntry {<br />\n<pre><code>$inputFileType = PHPExcel_IOFactory::identify($inputFileName);\n$objReader = PHPExcel_IOFactory::createReader($inputFileType);\n$objPHPExcel = $objReader-&gt;load($inputFileName);</code></pre>\n\n} catch (Exception $e) {<br />\n<pre><code>die('Error loading file &quot;' . pathinfo($inputFileName, PATHINFO_BASENAME) . '&quot;: ' . $e-&gt;getMessage());</code></pre>\n\n}\r<br />\n<br />\n$rowIterator = $objPHPExcel-&gt;getActiveSheet()-&gt;getRowIterator();\r<br />\n$array_data = array();\r<br />\nforeach ($rowIterator as $row) {<br />\n<pre><code>$cellIterator = $row-&gt;getCellIterator();\n$cellIterator-&gt;setIterateOnlyExistingCells(false);\n$rowIndex = $row-&gt;getRowIndex();\n$array_data[$rowIndex] = array('A' =&gt; '', 'B' =&gt; '', 'C' =&gt; '', 'D' =&gt; '', 'E' =&gt; '', 'F' =&gt; '', 'G' =&gt; '');\n\nforeach ($cellIterator as $cell) {\n    if ('A' == $cell-&gt;getColumn()) {\n        $array_data[$rowIndex][$cell-&gt;getColumn()] = $cell-&gt;getCalculatedValue();\n    } else if ('B' == $cell-&gt;getColumn()) {\n        $array_data[$rowIndex][$cell-&gt;getColumn()] = $cell-&gt;getCalculatedValue();\n    } else if ('C' == $cell-&gt;getColumn()) {\n        $array_data[$rowIndex][$cell-&gt;getColumn()] = $cell-&gt;getCalculatedValue();\n    } else if ('D' == $cell-&gt;getColumn()) {\n        $array_data[$rowIndex][$cell-&gt;getColumn()] = $cell-&gt;getCalculatedValue();\n    } else if ('E' == $cell-&gt;getColumn()) {\n        $array_data[$rowIndex][$cell-&gt;getColumn()] = $cell-&gt;getCalculatedValue();\n    } else if ('F' == $cell-&gt;getColumn()) {\n        $array_data[$rowIndex][$cell-&gt;getColumn()] = $cell-&gt;getCalculatedValue();\n    } else if ('G' == $cell-&gt;getColumn()) {\n        $array_data[$rowIndex][$cell-&gt;getColumn()] = $cell-&gt;getCalculatedValue();\n    }\n}</code></pre>\n\n}\r<br />\n<br />\necho '&lt;pre&gt;';\r<br />\n// displays the row wise cell values \r<br />\n<br />\nprint_r($array_data);\r<br />\n \r<br />\n echo '&lt;br&gt; extracting images from work sheet'; ////////////////////////////////////////////////\r<br />\n ///////////// this code I had used from <a href=\"https://phpexcel.codeplex.com/discussions/257231\" rel=\"nofollow\">https://phpexcel.codeplex.com/discussions/257231</a>\r<br />\n<br />\n$worksheet = $PHPExcel-&gt;getActiveSheet();\r<br />\n<br />\n// extract images from worksheet and save files:  0.jpeg, 1.jpeg, 2.png, ...\r<br />\nforeach ($worksheet-&gt;getDrawingCollection() as $i =&gt; $drawing) {<br />\n<pre><code>$filename = $drawing-&gt;getPath();\n$imagesize = getimagesize($filename);\n\nswitch ($imagesize[2]) {\n\ncase 1:\n    $image = imagecreatefromgif($filename);\n    imagegif($image, &quot;$i.gif&quot;);\n    break;\n\ncase 2:\n    $image = imagecreatefromjpeg($filename);\n    imagejpeg($image, &quot;$i.jpeg&quot;);\n    break;\n\ncase 3:\n    $image = imagecreatefrompng($filename);\n    imagepng($image, &quot;$i.png&quot;);\n    break;\n\ndefault:\n    continue 2;\n\n}</code></pre>\n\n}\r<br />\n?&gt;<br />\n",
    "PostedDate": "2014-08-18T01:11:28.577-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1290993",
    "ThreadId": "561478",
    "Html": "Have you read the developer docs? There's a section (<code>4.6.37</code> entitled <code>Reading Images from a worksheet</code>) specifically explaining how to extract images.<br />\n<div style=\"color:Black;background-color:White;\"><pre>\r\n$i = 0;\n<span style=\"color:Blue;\">foreach</span> ($objPHPExcel-&gt;getActiveSheet()-&gt;getDrawingCollection() <span style=\"color:Blue;\">as</span> $drawing) {\n    <span style=\"color:Blue;\">if</span> ($drawing <span style=\"color:Blue;\">instanceof</span> PHPExcel_Worksheet_MemoryDrawing) {\n        ob_start();\n        call_user_func(\n            $drawing-&gt;getRenderingFunction(),\n            $drawing-&gt;getImageResource()\n        );\n        $imageContents = ob_get_contents();\n        ob_end_clean();\n        <span style=\"color:Blue;\">switch</span> ($drawing-&gt;getMimeType()) {\n            <span style=\"color:Blue;\">case</span> PHPExcel_Worksheet_MemoryDrawing::MIMETYPE_PNG :\n                    $extension = <span style=\"color:#A31515;\">&#39;png&#39;</span>; <span style=\"color:Blue;\">break</span>;\n            <span style=\"color:Blue;\">case</span> PHPExcel_Worksheet_MemoryDrawing::MIMETYPE_GIF:\n                    $extension = <span style=\"color:#A31515;\">&#39;gif&#39;</span>; <span style=\"color:Blue;\">break</span>;\n            <span style=\"color:Blue;\">case</span> PHPExcel_Worksheet_MemoryDrawing::MIMETYPE_JPEG :\n                    $extension = <span style=\"color:#A31515;\">&#39;jpg&#39;</span>; <span style=\"color:Blue;\">break</span>;\n        }\n    } <span style=\"color:Blue;\">else</span> {\n        $zipReader = fopen($drawing-&gt;getPath(),<span style=\"color:#A31515;\">&#39;r&#39;</span>);\n        $imageContents = <span style=\"color:#A31515;\">&#39;&#39;</span>;\n        <span style=\"color:Blue;\">while</span> (!feof($zipReader)) {\n            $imageContents .= fread($zipReader,1024);\n        }\n        <span style=\"color:Blue;\">fclose</span>($zipReader);\n        $extension = $drawing-&gt;getExtension();\n    }\n    $myFileName = <span style=\"color:#A31515;\">&#39;00_Image_&#39;</span>.++$i.<span style=\"color:#A31515;\">&#39;.&#39;</span>.$extension;\n    file_put_contents($myFileName,$imageContents);\n}\r\n</pre></div>",
    "PostedDate": "2014-08-18T02:52:15.64-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]