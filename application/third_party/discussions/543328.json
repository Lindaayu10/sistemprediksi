[
  {
    "Id": "1237996",
    "ThreadId": "543328",
    "Html": "Hi,<br />\n<br />\n<strong>Please help me</strong> <br />\nI am getting problem reading large excel file using PHPExcel file<br />\nI am passing excel tha have 93 rows so actually it should read row like 1-10 then 11-20...upto 90 but when we are printing row count it is printing below like this <br />\n<br />\n123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359360361362363364365366367368369370371372373374375376377378379380381382383384385386387388389390391392393394395396397398399400401402403404405406407408409410411412413414415416417418419420421422423424425426427428429430431432433434435436437438439440441442443444445446447448449450<br />\n<br />\nbut it should print 1...93 as total 93 rows in excel file<br />\n<br />\nwe have large file but we rae taking as sample of 93 rows<br />\n<br />\n<strong><em>Below is my code</em></strong><br />\n<pre><code>  class chunkReadFilter implements PHPExcel_Reader_IReadFilter\n{\n        private $_startRow = 0;\n\n        private $_endRow = 0;\n\n        /**  Set the list of rows that we want to read  */\n        public function setRows($startRow, $chunkSize) {\n                $this-&gt;_startRow    = $startRow;\n                $this-&gt;_endRow        = $startRow + $chunkSize;\n        }\n\n        public function readCell($column, $row, $worksheetName = '') {\n                //  Only read the heading row, and the rows that are configured in $this-&gt;_startRow and $this-&gt;_endRow\n                if (($row == 1) || ($row &gt;= $this-&gt;_startRow &amp;&amp; $row &lt; $this-&gt;_endRow)) {\n                        return true;\n                }\n                return false;\n        }\n}\n\n</code></pre>\n\n$inputFileType = PHPExcel_IOFactory::identify($file_path);<br />\n/<strong>  Create a new Reader of the type that has been identified  </strong>/<br />\n<pre><code>$objReader = PHPExcel_IOFactory::createReader($inputFileType);\n$objReader-&gt;setReadDataOnly(true);\n\n$total_sheet_rows = 90;\n\n/**  Define how many rows we want to read for each &quot;chunk&quot;  **/ \n$chunkSize = 10; \n/**  Create a new Instance of our Read Filter  **/ \n$chunkFilter = new chunkReadFilter(); \n\n/**  Tell the Reader that we want to use the Read Filter  **/ \n\n$objReader-&gt;setReadFilter($chunkFilter); \n\n$row_count = 0;\n</code></pre>\n\n/<strong>  Loop to read our worksheet in &quot;chunk size&quot; blocks  </strong>/ <br />\n<pre><code>for ($startRow = 1; $startRow &lt;= $total_sheet_rows; $startRow += $chunkSize) { \n\n\n$chunkFilter-&gt;setRows($startRow,$chunkSize);\n\n\n$objPHPExcel = $objReader-&gt;load($file_path);\n$objWorksheet = $objPHPExcel-&gt;getActiveSheet(); \n\n\n\n\nforeach ($objWorksheet-&gt;getRowIterator() as $row)\n{\n\n        $row_data = array();\n        $cellIterator = $row-&gt;getCellIterator();\n        $cellIterator-&gt;setIterateOnlyExistingCells(false);\n\n        $row_count++;\n        echo $row_count;\n}   \n$objPHPExcel-&gt;disconnectWorksheets(); \nunset($objPHPExcel, $objWorksheet, $cellIterator); </code></pre>\n\n",
    "PostedDate": "2014-04-25T05:28:32.74-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]