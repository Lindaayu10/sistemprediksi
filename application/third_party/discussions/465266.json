[
  {
    "Id": "1117064",
    "ThreadId": "465266",
    "Html": "Hi there,\r<br />\n<br />\nI have recently added PHPExcel to a clients site and it's great. \r<br />\n<br />\nThe only issue is when the XLS file is downloaded and he tries to create a mail merge in Office 2011 (Mac). When he tries to use the XLS document, he gets an error.\r<br />\n<br />\n<img src=\"http://s21.postimg.org/5mvb2b7qf/Client_test.png\" alt=\"Image\" />\r<br />\n<br />\nThe only way he can get it to work is open the XLS document and Save As an XLSX file.\r<br />\n<br />\nI gave it a try on my Mac which also has Office 2011 and I get a different error.\r<br />\n<br />\n<img src=\"http://s21.postimg.org/bp2xssw6f/My_Test.png\" alt=\"Image\" />\r<br />\n<br />\nI manage to get it to work by first opening the XLS document and hitting Save. It's like the formatting of the document isn't quite right and I have to save again for Excel to fix it.\r<br />\n<br />\nHere is my code:<br />\n<pre><code>// This function is used to clean the data in the cells\nfunction clean_export_cell($string) {\n    $string = stripslashes($string);\n    $string = trim($string);\n    $string = str_replace('&amp;#039;', &quot;'&quot;, $string);\n    $string = str_replace('&amp;amp;', &quot;&amp;&quot;, $string);\n    utf8_encode($string);\n    return $string;\n}\n\n// Required files\nrequire_once('PHPExcel.php');\n\n// Start PHPExcel object\n$objPHPExcel = new PHPExcel();\n\n// Set font\n$objPHPExcel-&gt;getDefaultStyle()-&gt;getFont()-&gt;setName('Arial')-&gt;setSize(10);\n\n// Set page orientation\n$objPHPExcel-&gt;getActiveSheet()-&gt;getPageSetup()-&gt;setOrientation(PHPExcel_Worksheet_PageSetup::ORIENTATION_LANDSCAPE);\n\n// Set page size\n$objPHPExcel-&gt;getActiveSheet()-&gt;getPageSetup()-&gt;setPaperSize(PHPExcel_Worksheet_PageSetup::PAPERSIZE_A4);\n\n// Default cell width and row height\n$objPHPExcel-&gt;getActiveSheet()-&gt;getDefaultColumnDimension()-&gt;setWidth(20);\n$objPHPExcel-&gt;getActiveSheet()-&gt;getDefaultRowDimension()-&gt;setRowHeight(15);\n\n// Heading\n$row = 1;\n$col = 0;\nforeach($field_names AS $field_name) {\n    $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValueByColumnAndRow($col, $row, clean_export_cell($field_name));\n    $col++;\n}\n\n// Data\nif (!empty($csv_array)) {\n    foreach($csv_array AS $csv_array_data) {\n        $row++;\n        $col = 0;\n        foreach($csv_array_data AS $csv_array_data_value) {\n            $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValueByColumnAndRow($col, $row, clean_export_cell($csv_array_data_value));\n            $col++;\n        }\n    }\n}\n\nheader('Content-Encoding: UTF-8');\nheader('Content-Type: application/vnd.ms-excel; charset=UTF-8');\nheader('Content-Disposition: attachment; charset=UTF-8; filename=&quot;sample.xls&quot;');\nheader('Cache-Control: max-age=0');\n$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, 'Excel5');\n$objWriter-&gt;save('php://output');</code></pre>\n\nIs there an issue with my code or is this a Office 2011 issue?<br />\n",
    "PostedDate": "2013-11-03T23:10:28.033-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]