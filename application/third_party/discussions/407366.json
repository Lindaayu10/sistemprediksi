[
  {
    "Id": "958585",
    "ThreadId": "407366",
    "Html": "\r\n<p>Hi, I'm new to PHPExcel having only switched to using it yesterday as I need to read and write from various spreadsheet formats (ods,xls,xlsx) but whilst reading files appears to be fine I am finding that writing to files just doesn't work correctly outside\r\n of the tests (though they may also be wrong).<br>\r\n<br>\r\nThe problems I am having are that the worksheets are being created in the opposite order to that in which they were created. Only rows which have no data are being created OR data is only written to some of the worksheets (I have an excel file with 9 sheets,\r\n though I have also tested with a document with three sheets and only data on one of them).</p>\r\n<p>The documents also appear to be created as right-to-left even though that option is not set.</p>\r\n<p>What I am trying to achieve is the a script which reads an xlxs file (preferably only reading a limited number of sheets and a limited number of rows per sheet, so using&nbsp;<strong>setReadDataOnly,&nbsp;</strong><strong>setLoadSheetsOnly</strong> and&nbsp;<strong>setReadFilter()</strong>),\r\n adds content into new cells onto some of the worksheets and then saves the file again.</p>\r\n<p>However, to test the problem I created a new set of spreadsheets (Excel2010 (xlsx), Excell2003 (xml) and Excel5 compatible) and with the first sheet having cells A1 and B2 with data in them.</p>\r\n<p>I then used this to test the script for &quot;Excel2007&quot; and Excel5 (changing the reader each time).</p>\r\n<p></p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre>$excel2 = PHPExcel_IOFactory::createReader(<span style=\"color:#a31515\">'Excel5'</span>);\r\n$excel2 = $excel2-&gt;load($filename); <span style=\"color:green\">// Empty Sheet</span>\r\n$excel2-&gt;setActiveSheetIndex(0);\r\n$excel2-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#a31515\">'C6'</span>, <span style=\"color:#a31515\">'4'</span>)\r\n    -&gt;setCellValue(<span style=\"color:#a31515\">'C7'</span>, <span style=\"color:#a31515\">'5'</span>)\r\n    -&gt;setCellValue(<span style=\"color:#a31515\">'C8'</span>, <span style=\"color:#a31515\">'6'</span>)\r\n    -&gt;setCellValue(<span style=\"color:#a31515\">'C9'</span>, <span style=\"color:#a31515\">'7'</span>);\r\n\r\n$excel2-&gt;setActiveSheetIndex(1);\r\n$excel2-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#a31515\">'A7'</span>, <span style=\"color:#a31515\">'4'</span>)\r\n    -&gt;setCellValue(<span style=\"color:#a31515\">'C7'</span>, <span style=\"color:#a31515\">'5'</span>);\r\n$objWriter = PHPExcel_IOFactory::createWriter($excel2, <span style=\"color:#a31515\">'Excel5'</span>);\r\n$objWriter-&gt;save($filename.<span style=\"color:#a31515\">'.xls'</span>);\r\n</pre>\r\n</div>\r\n<p></p>\r\n<p>This one (above) worked fine for the Excel5 file. But when I tried it with the .xlsx (Excel2010) version it breaks. It creates the sheets right-to-left, with the first cell being on B3 (so the first two rows which had data are done) and the view is focused\r\n on cells AND3 through AML3. The three worksheets are also created in reverse order.<br>\r\n<br>\r\nBefore I move onto a different excel writer has anyone got this to actual work?&nbsp;</p>\r\n<p>PHPExcel Version 1.7.8</p>\r\n<p>I'm running PHP 5.4.3&nbsp;</p>\r\n",
    "PostedDate": "2012-12-19T10:14:21.51-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]