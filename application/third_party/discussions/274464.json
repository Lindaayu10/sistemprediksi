[
  {
    "Id": "678915",
    "ThreadId": "274464",
    "Html": "\r\n<p>Hello,</p>\r\n<p>I can't figure how to split an Excel document sheet by sheet,where each sheet is created as a new Excel document.</p>\r\n<p>I also need to delete the empty lines in the new Excel documents produced.</p>\r\n<p>What's the best way to do it ?</p>\r\n<p>All your experiences are greatly appreciated.</p>\r\n<p>Best regards.</p>\r\n",
    "PostedDate": "2011-10-01T01:05:05.77-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "679209",
    "ThreadId": "274464",
    "Html": "<p>I have found the way of what I wanted.<br /> <br /> Here is a solution (maybe not the best way, but it works fine enough) :&nbsp;&nbsp;&nbsp;</p>\n<div style=\"color: black; background-color: white;\">\n<pre>    $<span style=\"color: blue;\">file</span> = $_POST[<span style=\"color: #a31515;\">'file'</span>];\n    $filename = pathinfo($<span style=\"color: blue;\">file</span>, PATHINFO_FILENAME);\n \n    <span style=\"color: blue;\">require_once</span> <span style=\"color: #a31515;\">'phpexcel/Classes/PHPExcel.php'</span>;\n\n    $xls = <span style=\"color: blue;\">new</span> PHPExcel();\n    $xlsReader= <span style=\"color: blue;\">new</span> PHPExcel_Reader_Excel5();\n    $xlsTemplate = $xlsReader-&gt;load($<span style=\"color: blue;\">file</span>);\n\n    $sheet1 = $xlsTemplate-&gt;getSheetByName(<span style=\"color: #a31515;\">'Sheet1'</span>);\n    $xls-&gt;addExternalSheet($sheet1,0);\n    $xls-&gt;removeSheetByIndex(1);\n    $xlsWriter = <span style=\"color: blue;\">new</span> PHPExcel_Writer_Excel5($xls);\n    $xlsWriter-&gt;save($filename.<span style=\"color: #a31515;\">\"_Sheet1.xls\"</span>);\n\n    $sheet2 = $xlsTemplate-&gt;getSheetByName(<span style=\"color: #a31515;\">'Sheet2'</span>);\n    $xls-&gt;addExternalSheet($sheet2,0);\n    $xls-&gt;removeSheetByIndex(1);\n    $xlsWriter = <span style=\"color: blue;\">new</span> PHPExcel_Writer_Excel5($xls);\n    $xlsWriter-&gt;save($filename.<span style=\"color: #a31515;\">\"_Sheet2.xls\"</span>);\n\n    $sheet3 = $xlsTemplate-&gt;getSheetByName(<span style=\"color: #a31515;\">'Sheet3'</span>);\n    $xls-&gt;addExternalSheet($sheet3,0);\n    $xls-&gt;removeSheetByIndex(1);\n    $xlsWriter = <span style=\"color: blue;\">new</span> PHPExcel_Writer_Excel5($xls);\n    $xlsWriter-&gt;save($filename.<span style=\"color: #a31515;\">\"_Sheet3.xls\"</span>);\n\n    $sheet4 = $xlsTemplate-&gt;getSheetByName(<span style=\"color: #a31515;\">'Sheet4'</span>);\n    $xls-&gt;addExternalSheet($sheet4,0);\n    $xls-&gt;removeSheetByIndex(1);\n    $xlsWriter = <span style=\"color: blue;\">new</span> PHPExcel_Writer_Excel5($xls);\n    $xlsWriter-&gt;save($filename.<span style=\"color: #a31515;\">\"_Sheet4.xls\"</span>);\n\n    $sheet5 = $xlsTemplate-&gt;getSheetByName(<span style=\"color: #a31515;\">'Sheet5'</span>);\n    $xls-&gt;addExternalSheet($sheet5,0);\n    $xls-&gt;removeSheetByIndex(1);\n    $xlsWriter = <span style=\"color: blue;\">new</span> PHPExcel_Writer_Excel5($xls);\n    $xlsWriter-&gt;save($filename.<span style=\"color: #a31515;\">\"_Sheet5.xls\"</span>);\n\n    $sheet6 = $xlsTemplate-&gt;getSheetByName(<span style=\"color: #a31515;\">'Sheet6'</span>);\n    $xls-&gt;addExternalSheet($sheet6,0);\n    $xls-&gt;removeSheetByIndex(1);\n    $xlsWriter = <span style=\"color: blue;\">new</span> PHPExcel_Writer_Excel5($xls);\n    $xlsWriter-&gt;save($filename.<span style=\"color: #a31515;\">\"_Sheet6.xls\"</span>);\n</pre>\n</div>\n<p>Then, my original Excel file, containing 6 sheets is now splitted in 6 Excel files, as I wanted.<br /> <br /> As you can see, it was not so hard to release, but the documentation is so confusing...<br /> <br /> Hope this can help.</p>",
    "PostedDate": "2011-10-02T21:18:43.257-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]