[
  {
    "Id": "1232153",
    "ThreadId": "541685",
    "Html": "Hello,<br />\nI have a problem with PHPExcel and can’t seem to find the solution to fix it.<br />\nI wrote a script based on the basic examples provided in the PHPExcel documentation to create a PDF file out of a XLSX file my code looks like this:<br />\n<pre><code>$inputfile = “test.xlsx”;\n$objReader = PHPExcel_IOFactory::createReaderForFile($inputfile);\n$objReader-&gt;setReadDataOnly(true);\n$objPHPExcel = $objReader-&gt;load($inputfile);\n\n[…]\n\n$objWriter = new PHPExcel_Writer_PDF($objPHPExcel);\n$objWriter-&gt;setSheetIndex(0);\n$objWriter-&gt;setPreCalculateFormulas(true);\n$objWriter-&gt;save(&quot;test.pdf&quot;);</code></pre>\n\nNow the problem is that this will return me an Error <br />\n<pre><code>Fatal error: Uncaught exception 'PHPExcel_Calculation_Exception' with message 'Sheet!C5 -&gt; Formula Error: Wrong number of arguments for COUNTIFS() function: 4 given, 2 expected' in D:\\xampp\\htdocs\\doc\\phpxls\\Classes\\PHPExcel\\Cell.php:300 Stack trace: #0 D:\\xampp\\htdocs\\doc\\phpxls\\Classes\\PHPExcel\\Writer\\HTML.php(1174): PHPExcel_Cell-&gt;getCalculatedValue() #1 D:\\xampp\\htdocs\\doc\\phpxls\\Classes\\PHPExcel\\Writer\\HTML.php(436): PHPExcel_Writer_HTML-&gt;_generateRow(Object(PHPExcel_Worksheet), Array, 4) #2 D:\\xampp\\htdocs\\doc\\phpxls\\Classes\\PHPExcel\\Writer\\PDF\\DomPDF.php(109): PHPExcel_Writer_HTML-&gt;generateSheetData() #3 [internal function]: PHPExcel_Writer_PDF_DomPDF-&gt;save('testing.pdf') #4 D:\\xampp\\htdocs\\doc\\phpxls\\Classes\\PHPExcel\\Writer\\PDF.php(87): call_user_func_array(Array, Array) #5 D:\\xampp\\htdocs\\doc\\interface\\xls2pdf_2.php(59): PHPExcel_Writer_PDF-&gt;__call('save', Array) #6 D:\\xampp\\htdocs\\doc\\interface\\xls2pdf_2.php(59): PHPExcel_Writer_PDF-&gt;save('testing.pdf') #7 {main} thrown in D:\\xampp\\htdocs\\doc\\phpxls\\Classes\\PHPExcel\\Cell.php on line 300</code></pre>\n\nYou can see it’s something about “COUNTIFS()” my assumption was that setReadDataOnly(true)  would only give me the values of the cells and ignore the formulas after reading the documentation I realize this is not true. Is there a way to only get the values of the Cell without formula?<br />\n <br />\nIf I set<br />\n<pre><code>$objWriter-&gt;setPreCalculateFormulas(true); </code></pre>\n\nTo<br />\n<pre><code>$objWriter-&gt;setPreCalculateFormulas(false);</code></pre>\n\nIt will work without error but the returned PDF file will show the formulas instead of the calculated values in the cells (obviously) <br />\n<br />\nIs there any way to make this work like I intended it to? Just reading / writing the values and ignoring the formula?<br />\n<br />\nMy suspicion is that the error has something to do with the separator in the formula which in the local format I am using (German) is semicolon but in the US/Standard format is comma so the formula looks like this in the original file <br />\n<pre><code>=ZÄHLENWENNS(Migration_LSA!$AR$2:$AR$121;&quot;&gt;=1/4/2014&quot;;Migration_LSA!$AR$2:$AR$121;&quot;&lt;=30/4/2014&quot;)</code></pre>\n\nAnd PHPExcel is looking for this<br />\n<pre><code>=COUNTIFS(Migration_LSA!$AR$2:$AR$121,&quot;&gt;=1/4/2014&quot;,Migration_LSA!$AR$2:$AR$121,&quot;&lt;=30/4/2014&quot;)</code></pre>\n\nI accidentally submitted this post under the Issues section first sorry about that<br />\n<a href=\"https://phpexcel.codeplex.com/workitem/20897/edit\" rel=\"nofollow\">https://phpexcel.codeplex.com/workitem/20897/edit</a><br />\n",
    "PostedDate": "2014-04-09T00:03:10.213-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1232154",
    "ThreadId": "541685",
    "Html": "Mark answered my question on StackOverflow\r<br />\n<br />\n<a href=\"http://stackoverflow.com/questions/22954959/issue-with-countifs-in-phpexcel-when-generating-a-pdf/22955173\" rel=\"nofollow\">http://stackoverflow.com/questions/22954959/issue-with-countifs-in-phpexcel-when-generating-a-pdf/22955173</a><br />\n",
    "PostedDate": "2014-04-09T00:20:18.807-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1232157",
    "ThreadId": "541685",
    "Html": "The problem isn't to do with the separator at all, this is only an issue if you were inserting the formula into PHPExcel directly as <br />\n<pre><code>    =ZÄHLENWENNS(Migration_LSA!$AR$2:$AR$121;&quot;&gt;=1/4/2014&quot;;Migration_LSA!$AR$2:$AR$121;&quot;&lt;=30/4/2014&quot;)</code></pre>\n\nwhen you would need to set the locale, and use the translate methods before inserting it. Internally (in both PHPExcel and MS Excel) formulae are represented in their English/US format. The MS Excel GUI hides this from you with automatic translation on insert/display.\r<br />\n<br />\n<br />\nAt the moment, the COUNTIFS() formula in PHPExcel only works with a single range/criteria pair. \r<br />\n<br />\nYou can work round this by splitting your multiple range/criteria pairs into single range/criteria pairs and adding those together, so:<br />\n<pre><code>    =COUNTIFS(Migration_LSA!$AR$2:$AR$121,&quot;&gt;=1/4/2014&quot;) +\n        COUNTIFS(Migration_LSA!$AR$2:$AR$121,&quot;&lt;=30/4/2014&quot;)</code></pre>\n\n<code>setReadDataOnly(true)</code> tells the PHPExcel Reader only to read the cell content, not to read styles, format masks, print settings, conditional styles, etc... but formulae are still cell content<br />\n",
    "PostedDate": "2014-04-09T00:26:40.317-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": "2014-04-09T01:12:10.91-07:00"
  }
]