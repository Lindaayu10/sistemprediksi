[
  {
    "Id": "164903",
    "ThreadId": "49300",
    "Html": "Hello,<br>\r\n<br>\r\nI have a problem when I try to open a generated Excel 2007 file on Office 2003 with conditional formating. Excel said to me that my condiotionnal formating style isn't compatible with this version of Excel. I try to set the &quot;setOffice2003Compatibilty&quot; to true, but I have the same result.<br>\r\nHere the code :<br>\r\n<br>\r\n$objPHPExcel = new PHPExcel();<br>\r\n<br>\r\n$objPHPExcel-&gt;setActiveSheetIndex(0);<br>\r\n<br>\r\n$conditional1 = new PHPExcel_Style_Conditional();<br>\r\n$conditional1-&gt;setConditionType(PHPExcel_Style_Conditional::CONDITION_CELLIS);<br>\r\n$conditional1-&gt;setOperatorType(PHPExcel_Style_Conditional::OPERATOR_EQUAL);<br>\r\n$conditional1-&gt;addCondition(10);<br>\r\n$conditional1-&gt;getStyle()-&gt;getFont()-&gt;getColor()-&gt;setARGB(PHPExcel_Style_Color::COLOR_YELLOW);<br>\r\n$conditional1-&gt;getStyle()-&gt;getFont()-&gt;setBold(true);<br>\r\n<br>\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('A1')-&gt;setConditionalStyles(array($conditional1));<br>\r\n<br>\r\n$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, 'Excel2007');<br>\r\n$objWriter-&gt;setOffice2003Compatibility(true);<br>\r\n$objWriter-&gt;save('test.xlsx');<br>\r\n<br>\r\nAnother thing : I have created a Excel file in Excel with the same conditional formatting and I have saved it to a .xlsx file and that's work...<br>\r\nI have found a difference between the generated and the created file in the style.xml file<br>\r\nGenerated file :<br>\r\n&lt;dxf&gt;<br>\r\n&nbsp;&nbsp; &lt;font&gt;<br>\r\n&nbsp;&nbsp;&nbsp; &lt;name val=&quot;Calibri&quot;/&gt;<br>\r\n&nbsp;&nbsp;&nbsp; &lt;sz val=&quot;10&quot;/&gt;<br>\r\n&nbsp;&nbsp;&nbsp; &lt;b val=&quot;true&quot;/&gt;<br>\r\n&nbsp;&nbsp;&nbsp; &lt;u val=&quot;none&quot;/&gt;<br>\r\n&nbsp;&nbsp;&nbsp; &lt;color rgb=&quot;FFFFFF00&quot;/&gt;<br>\r\n&nbsp;&nbsp; &lt;/font&gt;<br>\r\n&nbsp;&nbsp; &lt;numFmt numFmtId=&quot;164&quot; formatCode=&quot;General&quot;/&gt;<br>\r\n&nbsp;&nbsp; &lt;fill&gt;<br>\r\n&nbsp;&nbsp;&nbsp; &lt;patternFill patternType=&quot;none&quot;&gt;<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp; &lt;fgColor rgb=&quot;FFFFFFFF&quot;/&gt;<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp; &lt;bgColor rgb=&quot;FF000000&quot;/&gt;<br>\r\n&nbsp;&nbsp;&nbsp; &lt;/patternFill&gt;<br>\r\n&nbsp;&nbsp; &lt;/fill&gt;<br>\r\n&nbsp;&nbsp; &lt;alignment horizontal=&quot;general&quot; vertical=&quot;bottom&quot; textRotation=&quot;0&quot;/&gt;<br>\r\n&nbsp;&nbsp; &lt;border outline=&quot;true&quot;/&gt;<br>\r\n&nbsp; &lt;/dxf&gt;<br>\r\n<br>\r\nCreated file :<br>\r\n&lt;dxf&gt;<br>\r\n&nbsp; &lt;font&gt;<br>\r\n&nbsp;&nbsp;&nbsp; &lt;b/&gt;<br>\r\n&nbsp; &nbsp; &lt;i val=&quot;0&quot;/&gt;<br>\r\n&nbsp; &nbsp; &lt;condense val=&quot;0&quot;/&gt;<br>\r\n&nbsp; &nbsp; &lt;extend val=&quot;0&quot;/&gt;<br>\r\n&nbsp; &nbsp; &lt;color indexed=&quot;13&quot;/&gt;<br>\r\n&nbsp; &nbsp; &lt;/font&gt;<br>\r\n&lt;/dxf&gt;<br>\r\n<br>\r\nI try to copy-paste the tags from created file to generated file with no success.<br>\r\n<br>\r\nHow to resolve this problem (if it is possible to resolve it) ?<br>\r\n<br>\r\nThank <br>\r\n<br>\r\n<br>\r\n<br>\r\n\r\n",
    "PostedDate": "2009-03-05T08:45:13.883-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "165087",
    "ThreadId": "49300",
    "Html": "We will need Maarten to look at this!<br>\r\n<br>\r\n",
    "PostedDate": "2009-03-05T15:36:34.373-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]