[
  {
    "Id": "829760",
    "ThreadId": "353913",
    "Html": "\r\n<p>Hy Everyone,</p>\r\n<p><span>I have an excel file which includes 15 column and 248 rows. I want to insert this excel file data into database. For this purpose i choose PHPExcel script. With this script i have successfully inserted 14 column data into database table. But 15 column\r\n name 'Description' included on html tags or codes in each cell. When i try to upload it along others 14 column then only 92 records inserted instead 248. Without 15 column others successfully insert 248 rows. &nbsp;I am sharing my codes my let me know where\r\n is problem. Thanks</span></p>\r\n<p><span><br>\r\n</span></p>\r\n<p><span>&nbsp;</span></p>\r\n<pre>include($HTTP_SERVER_VARS[&quot;DOCUMENT_ROOT&quot;] .&quot;/my_session.php&quot;);\r\nrequire_once ($HTTP_SERVER_VARS[&quot;DOCUMENT_ROOT&quot;] .&quot;/includes/Classes/PHPExcel/IOFactory.php&quot;);\r\n\r\n$filetype = $_FILES[&quot;file&quot;][&quot;type&quot;];\r\n$filename = $_FILES[&quot;file&quot;][&quot;name&quot;];\r\n$filetmp = $_FILES[&quot;file&quot;][&quot;tmp_name&quot;];\r\n$Ext = strrchr($filename,&quot;.&quot;);\r\n//set_time_limit(3000);\r\n\r\n$objReader = new PHPExcel_Reader_CSV();\r\n$objPHPExcel = $objReader-&gt;load(&quot;ebay.csv&quot;);\r\n\r\nforeach ($objPHPExcel-&gt;getWorksheetIterator() as $worksheet) {\r\n    $worksheetTitle     = $worksheet-&gt;getTitle();\r\n    $highestRow         = $worksheet-&gt;getHighestRow(); // e.g. 10\r\n    $highestColumn      = $worksheet-&gt;getHighestColumn(); // e.g 'F'\r\n    $highestColumnIndex = PHPExcel_Cell::columnIndexFromString($highestColumn);\r\n    $nrColumns = ord($highestColumn) - 64;\r\n\r\nfor ($row=2; $row&lt;=$highestRow; $row&#43;&#43;) {\r\n\t\t$item_name = $worksheet-&gt;getCellByColumnAndRow(3, $row)-&gt;getValue();\r\n\t\t$condition = $worksheet-&gt;getCellByColumnAndRow(4, $row)-&gt;getValue();\r\n\t\t$Category = $worksheet-&gt;getCellByColumnAndRow(7, $row)-&gt;getValue();\r\n\t\t$Quantity = $worksheet-&gt;getCellByColumnAndRow(11, $row)-&gt;getValue();\r\n\t\t$StartPrice = $worksheet-&gt;getCellByColumnAndRow(14, $row)-&gt;getValue();\r\n\t\t$BuyItNowPrice = $worksheet-&gt;getCellByColumnAndRow(15, $row)-&gt;getValue();\r\n\t\t$Duration = &quot;365&quot;;\r\n\t\t$ItemID = $worksheet-&gt;getCellByColumnAndRow(29, $row)-&gt;getValue();\r\n\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;getCell('A1')-&gt;getValue();\r\n\t\t\r\n\t\t$PostageServices1 = $worksheet-&gt;getCellByColumnAndRow(95, $row)-&gt;getValue();\r\n\t\t$PostageCost1 = $worksheet-&gt;getCellByColumnAndRow(96, $row)-&gt;getValue();\r\n\t\t$PostageServices2 = $worksheet-&gt;getCellByColumnAndRow(101, $row)-&gt;getValue();\r\n\t\t$PostageCost2 = $worksheet-&gt;getCellByColumnAndRow(102, $row)-&gt;getValue();\r\n\t\t$PostageServices3 = $worksheet-&gt;getCellByColumnAndRow(106, $row)-&gt;getValue();\r\n\t\t$PostageCost3 = $worksheet-&gt;getCellByColumnAndRow(107, $row)-&gt;getValue();\r\n\t\t$DispatchTimeMax = $worksheet-&gt;getCellByColumnAndRow(122, $row)-&gt;getValue();\r\n\t\t$ReturnsAcceptedOption = $worksheet-&gt;getCellByColumnAndRow(195, $row)-&gt;getValue();\r\n\t\t$AdditionalDetails = $worksheet-&gt;getCellByColumnAndRow(202, $row)-&gt;getValue();\r\n\t\t//if($DispatchTimeMax == 1){$DispatchTime == &quot;1 Working Day&quot;;} else {$DispatchTime == $DispatchTimeMax.&quot; Working Days&quot;;}\r\n\t\t$item_description = stripslashes($worksheet-&gt;getCellByColumnAndRow(30, $row)-&gt;getValue());\r\n\r\n\r\ninsertInto(&quot;INSERT INTO mytable (`item_name`,`condition`,`Category`,`Quantity`,`StartPrice`,`BuyItNowPrice`,`Duration`,`item_code`,`PostageServices1`,`PostageCost1`,`PostageServices2`,`PostageCost2`,`PostageServices3`,`PostageCost3`,`DispatchTimeMax`,`ReturnsAcceptedOption`,`AdditionalDetails`) VALUES ('$item_name','$condition','$Category','$Quantity','$StartPrice','$BuyItNowPrice','$Duration','$ItemID','$PostageServices1','$PostageCost1','$PostageServices2','$PostageCost2','$PostageServices3','$PostageCost3','$DispatchTimeMax','$ReturnsAcceptedOption','$AdditionalDetails')&quot;);\r\n}\r\n}</pre>\r\n<p>&nbsp;</p>\r\n<p><span>The description cell contains on html elements i.e{&lt;table&gt;, &lt;p&gt;, &lt;b&gt; font so on....}. Each excel cell is heavy therefore i need proper method which will deal with html. Is there any function or method in phpexcel that will handle\r\n this html cell data and take it from excel and insert into database from start to end? If yes please give me at least one example. Thanks&nbsp;</span></p>\r\n",
    "PostedDate": "2012-04-28T13:33:11.757-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "829781",
    "ThreadId": "353913",
    "Html": "<p>Problem has been resolved by escape function in query.</p>\r\n<p>\r\n<pre>$description = $worksheet-&gt;getCellByColumnAndRow(30, $row)-&gt;getValue();\r\n\r\n$item_description = mysql_real_escape_string(stripslashes($description));</pre>\r\n</p>",
    "PostedDate": "2012-04-28T16:24:26.13-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "829893",
    "ThreadId": "353913",
    "Html": "<p>If you had use prepared statements you wouldn't have to escape anything. As it is your code is still vulnerable to SQL injection since you don't escape <strong>everything</strong> that goes into the query.</p>",
    "PostedDate": "2012-04-29T06:36:48.94-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]