[
  {
    "Id": "1309429",
    "ThreadId": "568741",
    "Html": "Hi everyone,\r<br />\n<br />\nI am quite new to PHPExcel and learning PHP as I go. I managed to get PHPexcel to export my data from SQL via the code below. Right now its just outputting in basic style, meaning its just serialized the data from SQL and next record would show up in the next row. I added an image of what I would like to accomplish, is this something possible with PHPexcel or am I dreaming. \r<br />\n<br />\nIf anyone could send me a quick example of how to accomplish this it would be greatly appreciated.\r<br />\n<br />\n<img src=\"http://postimg.org/image/m3n60hn25/\" alt=\"Image\" />\r<br />\n<a href=\"http://postimg.org/image/m3n60hn25/\" rel=\"nofollow\">http://postimg.org/image/m3n60hn25/</a>\r<br />\n<br />\nBelow is a working sample of a simple serialized export.<br />\n<pre><code>&lt;?php\n\n// connection with the database \n$dbhost = &quot;localhost&quot;; \n$dbuser = &quot;IMC_COE2&quot;; \n$dbpass = &quot;XXX&quot;; \n$dbname = &quot;IMC_COE2&quot;; \n\nmysql_connect($dbhost,$dbuser,$dbpass); \nmysql_select_db($dbname); \n\n// require the PHPExcel file \nrequire '/Excelphp/Classes/PHPExcel.php'; \n\n// simple query \n\n$query = 'SELECT client, team_name,support_team_prime,prime_comments,support_team_backup,backup_comments,escalation1,escalation1_comments,escalation2,escalation2_comments,escalation3,escalation3_comments,escalation4,escalation4_comments,note FROM tbl_address ORDER by team_name DESC'; \n$headings = array('Client Name','Team Name','Prime Contact','Comments','Backup Contacts','Comments','Escalation 1','Comments','Escalation 2','Comments','Escalation 3','Comments','Escalation 4','Comments','Additional notes'); \n\nif ($result = mysql_query($query) or die(mysql_error())) { \n    // Create a new PHPExcel object \n    $objPHPExcel = new PHPExcel(); \n    $objPHPExcel-&gt;getActiveSheet()-&gt;setTitle('List of Users'); \n\n    $rowNumber = 1; \n    $col = 'A'; \n    foreach($headings as $heading) { \n       $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue($col.$rowNumber,$heading); \n       $col++; \n    } \n\n    // Loop through the result set \n    $rowNumber = 2; \n    while ($row = mysql_fetch_row($result)) { \n       $col = 'A'; \n       foreach($row as $cell) { \n          $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue($col.$rowNumber,$cell); \n          $col++; \n       } \n       $rowNumber++; \n    } \n\n    // Freeze pane so that the heading line won't scroll \n    $objPHPExcel-&gt;getActiveSheet()-&gt;freezePane('A2'); \n\n    // Save as an Excel BIFF (xls) file \n    $objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, 'Excel5'); \n\n   header('Content-Type: application/vnd.ms-excel'); \n   header('Content-Disposition: attachment;filename=&quot;userList.xls&quot;'); \n   header('Cache-Control: max-age=0'); \n\n   $objWriter-&gt;save('php://output'); \n   exit(); \n} \necho 'a problem has occurred... no data retrieved from the database'; \n</code></pre>\n\n",
    "PostedDate": "2014-09-30T21:05:43.07-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1309607",
    "ThreadId": "568741",
    "Html": "Alright so far Ive got answers form other forums that I should be using setCellValue() and formarray(). having a real hard time finding examples online with what I am trying to accomplish. Would anyone be kind to provide me with an example of what the structure of the code would looks like pulling data from SQL and import specific value to certians cells to my choosing. Once I get that I think I may be able to work from there. At the moment im at a lost on where to start.<br />\n",
    "PostedDate": "2014-10-01T09:01:45.533-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1310065",
    "ThreadId": "568741",
    "Html": "Alright i'm getting closer to getting to the actual end result however its only showing 1 record at a time. Im sure im missing a code that I am not understanding, would anyone know what I am missing? I need it dump all the records from the database and keept<br />\n<br />\nThis is what im trying to get to:<br />\n<a href=\"http://postimg.org/image/m3n60hn25/\" rel=\"nofollow\">http://postimg.org/image/m3n60hn25/</a> <br />\n<br />\nWhat I am getting now:<br />\n<a href=\"http://s28.postimg.org/a8bbb206l/Result_now.png\" rel=\"nofollow\">http://s28.postimg.org/a8bbb206l/Result_now.png</a><br />\n<br />\nHere is my current code:<br />\n<pre><code>&lt;?php  \n/** PHPExcel */  \nrequire_once '/Excelphp/Classes/PHPExcel.php';  \n\n// Create new PHPExcel object  \n$objPHPExcel = new PHPExcel();  \n\n// Set properties  \n$objPHPExcel-&gt;getProperties()-&gt;setCreator(&quot;Maarten Balliauw&quot;)  \n-&gt;setLastModifiedBy(&quot;Maarten Balliauw&quot;)  \n-&gt;setTitle(&quot;Office 2007 XLSX Test Document&quot;)  \n-&gt;setSubject(&quot;Office 2007 XLSX Test Document&quot;)  \n-&gt;setDescription(&quot;Test document for Office 2007 XLSX, generated using PHP classes.&quot;)  \n-&gt;setKeywords(&quot;office 2007 openxml php&quot;)  \n-&gt;setCategory(&quot;Test result file&quot;);  \n\n    $objPHPExcel-&gt;getActiveSheet()-&gt;mergeCells('B2:D2');  \n    $objPHPExcel-&gt;getActiveSheet()-&gt;mergeCells('B4:D4');  \n    $objPHPExcel-&gt;getActiveSheet()-&gt;mergeCells('B7:D7');  \n    $objPHPExcel-&gt;getActiveSheet()-&gt;mergeCells('B12:D12');  \n    $objPHPExcel-&gt;getActiveSheet()-&gt;mergeCells('C3:D3');  \n    $objPHPExcel-&gt;getActiveSheet()-&gt;mergeCells('B13:D13');  \n    $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('C3:D3')-&gt;getAlignment()-&gt;setWrapText(true);\n    $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('C5:D5')-&gt;getAlignment()-&gt;setWrapText(true);\n    $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('C6:D6')-&gt;getAlignment()-&gt;setWrapText(true);\n    $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('C8:D8')-&gt;getAlignment()-&gt;setWrapText(true);\n    $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('C9:D9')-&gt;getAlignment()-&gt;setWrapText(true);\n    $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('C10:D10')-&gt;getAlignment()-&gt;setWrapText(true);\n    $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('C11:D11')-&gt;getAlignment()-&gt;setWrapText(true);\n    $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('B13:D13')-&gt;getAlignment()-&gt;setWrapText(true);\n    $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('A1')-&gt;getAlignment()-&gt;setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_CENTER);  \n    $objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension('C')-&gt;setAutoSize(false);  \n    $objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension('B')-&gt;setWidth(12);  \n    $objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension('C')-&gt;setWidth(50);  \n    $objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension('D')-&gt;setWidth(50);  \n\n//Setting for borders   \n$styleArray = array('borders' =&gt; array('outline' =&gt; array('style' =&gt; PHPExcel_Style_Border::BORDER_THIN,'color' =&gt; array('argb' =&gt; 'FFA0A0A0'),),),);\n\n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('B2:B13')-&gt;applyFromArray($styleArray);\n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('C2:C13')-&gt;applyFromArray($styleArray);\n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('D2:D13')-&gt;applyFromArray($styleArray);\n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('B2:D2')-&gt;applyFromArray($styleArray);\n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('B3:D3')-&gt;applyFromArray($styleArray);\n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('B4:D4')-&gt;applyFromArray($styleArray);\n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('B5:D5')-&gt;applyFromArray($styleArray);\n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('B6:D6')-&gt;applyFromArray($styleArray);\n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('B7:D7')-&gt;applyFromArray($styleArray);\n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('B8:D8')-&gt;applyFromArray($styleArray);\n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('B9:D9')-&gt;applyFromArray($styleArray);\n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('B10:D10')-&gt;applyFromArray($styleArray);\n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('B11:D11')-&gt;applyFromArray($styleArray);\n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('B12:D12')-&gt;applyFromArray($styleArray);\n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('B13:D13')-&gt;applyFromArray($styleArray);\n\n//Background color on cells \n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('B2:D2')-&gt;getFill()-&gt;setFillType(PHPExcel_Style_Fill::FILL_SOLID)-&gt;getStartColor()-&gt;setARGB('FFCCE5FF');\n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('B4:D4')-&gt;getFill()-&gt;setFillType(PHPExcel_Style_Fill::FILL_SOLID)-&gt;getStartColor()-&gt;setARGB('FFCCE5FF');\n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('B7:D7')-&gt;getFill()-&gt;setFillType(PHPExcel_Style_Fill::FILL_SOLID)-&gt;getStartColor()-&gt;setARGB('FFCCE5FF');\n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('B12:D12')-&gt;getFill()-&gt;setFillType(PHPExcel_Style_Fill::FILL_SOLID)-&gt;getStartColor()-&gt;setARGB('FFCCE5FF');\n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('B7:D7')-&gt;getFill()-&gt;setFillType(PHPExcel_Style_Fill::FILL_SOLID)-&gt;getStartColor()-&gt;setARGB('FFCCE5FF');\n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('B3')-&gt;getFill()-&gt;setFillType(PHPExcel_Style_Fill::FILL_SOLID)-&gt;getStartColor()-&gt;setARGB('FFE0E0E0');\n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('B5')-&gt;getFill()-&gt;setFillType(PHPExcel_Style_Fill::FILL_SOLID)-&gt;getStartColor()-&gt;setARGB('FFE0E0E0');\n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('B6')-&gt;getFill()-&gt;setFillType(PHPExcel_Style_Fill::FILL_SOLID)-&gt;getStartColor()-&gt;setARGB('FFE0E0E0');\n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('B8')-&gt;getFill()-&gt;setFillType(PHPExcel_Style_Fill::FILL_SOLID)-&gt;getStartColor()-&gt;setARGB('FFE0E0E0');\n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('B9')-&gt;getFill()-&gt;setFillType(PHPExcel_Style_Fill::FILL_SOLID)-&gt;getStartColor()-&gt;setARGB('FFE0E0E0');\n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('B10')-&gt;getFill()-&gt;setFillType(PHPExcel_Style_Fill::FILL_SOLID)-&gt;getStartColor()-&gt;setARGB('FFE0E0E0');\n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('B11')-&gt;getFill()-&gt;setFillType(PHPExcel_Style_Fill::FILL_SOLID)-&gt;getStartColor()-&gt;setARGB('FFE0E0E0');\n\n    // Add some data  \n    $objPHPExcel-&gt;setActiveSheetIndex(0)  \n                -&gt;setCellValue('A1', '')   \n                -&gt;setCellValue('B1', '')  \n                -&gt;setCellValue('C1', '')  \n                -&gt;setCellValue('D1', '')  \n                -&gt;setCellValue('E1', '')\n                -&gt;setCellValue('A14', '')   \n                -&gt;setCellValue('B14', '')  \n                -&gt;setCellValue('C14', '')  \n                -&gt;setCellValue('D14', '')  \n                -&gt;setCellValue('E14', '')\n                -&gt;setCellValue('B3', 'Client:')\n                -&gt;setCellValue('B5', 'Prime:')\n                -&gt;setCellValue('B4', 'Support group contacts')              \n                -&gt;setCellValue('B6', 'Backup:')\n                -&gt;setCellValue('B7', 'Escalations') \n                -&gt;setCellValue('B8', 'Escalation 1:') \n                -&gt;setCellValue('B9', 'Escalation 2:') \n                -&gt;setCellValue('B10', 'Escalation 3:') \n                -&gt;setCellValue('B11', 'Escalation 4:') \n                -&gt;setCellValue('B12', 'Notes');      \n\n    //  SQl database connections\n    $db = mysql_connect(&quot;localhost&quot;, &quot;IMC_COE2&quot;, &quot;IMC123&quot;);  \n    mysql_select_db(&quot;IMC_COE2&quot;,$db);  \n\n    $sqlgroups=&quot;select client, team_name,support_team_prime,prime_comments,support_team_backup,backup_comments,escalation1,escalation1_comments,escalation2,escalation2_comments,escalation3,escalation3_comments,escalation4,escalation4_comments,note from tbl_address ORDER by team_name&quot;;  \n    $resultgroups=mysql_query($sqlgroups);  \n        $numrows=mysql_num_rows($resultgroups);  \n        if ($numrows&gt;0)  \n        {  \n            $count=2;  \n            while($data=mysql_fetch_array($resultgroups))  \n            {  \n                $count+=1;  \n \n                $objPHPExcel-&gt;setActiveSheetIndex(0)              \n                            -&gt;setCellValue('C3', $data['client'])  \n                            -&gt;setCellValue('B2', $data['team_name'])  \n                            -&gt;setCellValue('C5', $data['support_team_prime'])  \n                            -&gt;setCellValue('D5', $data['prime_comments'])  \n                            -&gt;setCellValue('C6', $data['support_team_backup'])  \n                            -&gt;setCellValue('D6', $data['backup_comments'])  \n                            -&gt;setCellValue('C8', $data['escalation1'])\n                            -&gt;setCellValue('D8', $data['escalation1_comments'])\n                            -&gt;setCellValue('C9', $data['escalation2'])\n                            -&gt;setCellValue('D9', $data['escalation2_comments'])\n                            -&gt;setCellValue('C10', $data['escalation3'])\n                            -&gt;setCellValue('D10', $data['escalation3_comments'])\n                            -&gt;setCellValue('C11', $data['escalation4'])\n                            -&gt;setCellValue('D11', $data['escalation4_comments'])\n                            -&gt;setCellValue('B13', $data['note']); \n \n            }  \n        }          \n\n    // Rename sheet  \n    $objPHPExcel-&gt;getActiveSheet()-&gt;setTitle('Directory Tool Full dump');\n    \n    // Set active sheet index to the first sheet, so Excel opens this as the first sheet\n    $objPHPExcel-&gt;setActiveSheetIndex(0);\n    \n    // Redirect output to a clientâ€™s web browser (Excel5) \n    ob_end_clean(); \n    $objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, 'Excel5');  \n    header('Content-Type: application/vnd.ms-excel'); \n    header('Content-Disposition: attachment;filename=&quot;Export-Directory Tool.xls&quot;'); \n    header('Cache-Control: max-age=0'); \n    $objWriter-&gt;save('php://output');  \n    exit;  \n    ?&gt; </code></pre>\n\n",
    "PostedDate": "2014-10-02T15:37:21.213-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1310187",
    "ThreadId": "568741",
    "Html": "Alright well im getting help at <a href=\"http://stackoverflow.com/questions/26133953/phpexcel-help-how-to-export-data-with-phpexcel-in-an-custom-table-layout?noredirect=1#comment41037845_26133953\" rel=\"nofollow\">http://stackoverflow.com/questions/26133953/phpexcel-help-how-to-export-data-with-phpexcel-in-an-custom-table-layout?noredirect=1#comment41037845_26133953</a> so for those struggling with similar issues you might gets answers over there instead.<br />\n<br />\nIf anyone has any better feedback please dont be shy.<br />\n",
    "PostedDate": "2014-10-03T04:15:32.67-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]