[
  {
    "Id": "262331",
    "ThreadId": "76716",
    "Html": "<p>Hi everybody,</p>\r\n<p>I am using the following code, but then the xls downloads, I open it, and its empty.</p>\r\n<p>Can anybody help?</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\">&lt;?php</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\">error_reporting(E_ALL);</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\">/** Include path **/</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\">ini_set('include_path', ini_get('include_path').';Classes/');</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\">/** PHPExcel */</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\">include 'Classes/PHPExcel.php';</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\">/** PHPExcel_Writer_Excel2007 */</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\">include 'Classes/PHPExcel/Writer/Excel2007.php';</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\">// Create new PHPExcel object</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\">$objPHPExcel = new PHPExcel();</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\">$objPHPExcel-&gt;getProperties()-&gt;setCreator(&quot;Maarten Balliauw&quot;);</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\">$objPHPExcel-&gt;getProperties()-&gt;setLastModifiedBy(&quot;Maarten Balliauw&quot;);</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\">$objPHPExcel-&gt;getProperties()-&gt;setTitle(&quot;Office 2007 XLSX Test Document&quot;);</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\">$objPHPExcel-&gt;getProperties()-&gt;setSubject(&quot;Office 2007 XLSX Test Document&quot;);</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\">$objPHPExcel-&gt;getProperties()-&gt;setDescription(&quot;Test document for Office 2007 XLSX, generated using PHP classes.&quot;);</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\">// Add some data</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\">$objPHPExcel-&gt;setActiveSheetIndex(0);</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\">$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue('A1', 'Hello');</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\">$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue('B2', 'world!');</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\">$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue('C1', 'Hello');</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\">$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue('D2', 'world!');</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\">// Rename sheet</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\">$objPHPExcel-&gt;getActiveSheet()-&gt;setTitle('Simple');</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\"><span style=\"white-space:pre\"> </span></div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\">// Save Excel 2007 file</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\">// Echo done</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\">header('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\">header('Content-Disposition: attachment;filename=&quot;01simple.xls&quot;');</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\">header('Cache-Control: max-age=0');</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\">$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, 'Excel2007');</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\">$objWriter-&gt;save('php://output');&nbsp;</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\">?&gt;</div>\r\n<p>\r\n<p>&lt;?php</p>\r\n<p>error_reporting(E_ALL);</p>\r\n<p>&nbsp;</p>\r\n<p>/** Include path **/</p>\r\n<p>ini_set('include_path', ini_get('include_path').';Classes/');</p>\r\n<p>&nbsp;</p>\r\n<p>/** PHPExcel */</p>\r\n<p>include 'Classes/PHPExcel.php';</p>\r\n<p>&nbsp;</p>\r\n<p>/** PHPExcel_Writer_Excel2007 */</p>\r\n<p>include 'Classes/PHPExcel/Writer/Excel2007.php';</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n<p>// Create new PHPExcel object</p>\r\n<p>&nbsp;</p>\r\n<p>$objPHPExcel = new PHPExcel();</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n<p>$objPHPExcel-&gt;getProperties()-&gt;setCreator(&quot;Maarten Balliauw&quot;);</p>\r\n<p>$objPHPExcel-&gt;getProperties()-&gt;setLastModifiedBy(&quot;Maarten Balliauw&quot;);</p>\r\n<p>$objPHPExcel-&gt;getProperties()-&gt;setTitle(&quot;Office 2007 XLSX Test Document&quot;);</p>\r\n<p>$objPHPExcel-&gt;getProperties()-&gt;setSubject(&quot;Office 2007 XLSX Test Document&quot;);</p>\r\n<p>$objPHPExcel-&gt;getProperties()-&gt;setDescription(&quot;Test document for Office 2007 XLSX, generated using PHP classes.&quot;);</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n<p>// Add some data</p>\r\n<p>$objPHPExcel-&gt;setActiveSheetIndex(0);</p>\r\n<p>$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue('A1', 'Hello');</p>\r\n<p>$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue('B2', 'world!');</p>\r\n<p>$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue('C1', 'Hello');</p>\r\n<p>$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue('D2', 'world!');</p>\r\n<p>&nbsp;</p>\r\n<p>// Rename sheet</p>\r\n<p>&nbsp;</p>\r\n<p>$objPHPExcel-&gt;getActiveSheet()-&gt;setTitle('Simple');</p>\r\n<p>&nbsp;</p>\r\n<p><span style=\"white-space:pre\"> </span></p>\r\n<p>// Save Excel 2007 file</p>\r\n<p>&nbsp;</p>\r\n<p>// Echo done</p>\r\n<p>header('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');</p>\r\n<p>header('Content-Disposition: attachment;filename=&quot;01simple.xls&quot;');</p>\r\n<p>header('Cache-Control: max-age=0');</p>\r\n<p>&nbsp;</p>\r\n<p>$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, 'Excel2007');</p>\r\n<p>$objWriter-&gt;save('php://output');&nbsp;</p>\r\n<p>?&gt;</p>\r\n<div></div>\r\n<div>Thanks in advance.</div>\r\n</p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2009-12-01T08:28:07.343-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "280388",
    "ThreadId": "76716",
    "Html": "<p>Can you try to run 01simple-download-xls.php found in the Tests directory in the download?</p>",
    "PostedDate": "2010-01-21T21:55:24.99-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]