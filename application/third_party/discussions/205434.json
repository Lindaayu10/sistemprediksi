[
  {
    "Id": "420033",
    "ThreadId": "205434",
    "Html": "<p>I'm generating an Excel file, and it seems that every other time, or just intermittently, this shows up at the bottom of the Excel file contents:</p>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\">V&eacute;&oslash;&otilde;&#129;&ouml;Ž&#21;[K&ETH;O&para;&quot;&#30;e&Auml;&brvbar;&times;&AElig;&sbquo;&sect;&Eacute;&#18;&frac34;&ndash;&rsquo;&acirc;Y5z&#15;5E&lsaquo;&yen;&igrave;y&bull;z9&sup3;~&Ouml;&Eacute;y&#23;&iexcl;&Egrave;&ccedil;&uuml;r&#15;;?\\&acute;&ndash;Lt&#24;,&ntilde;\\(&frac12;</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\">&lt;!DOCTYPE HTML PUBLIC &quot;-//IETF//DTD HTML 2.0//EN&quot;&gt;</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\">&lt;html&gt;&lt;head&gt;</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\">&lt;title&gt;200 OK&lt;/title&gt;</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\">&lt;/head&gt;&lt;body&gt;</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\">&lt;h1&gt;OK&lt;/h1&gt;</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\">&lt;p&gt;The server encountered an internal error or</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\">misconfiguration and was unable to complete</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\">your request.&lt;/p&gt;</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\"><span style=\"color:#000000\">&lt;p&gt;Please contact the server administrator,</span></div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\">&nbsp;admin@example.com and inform them of the time the error occurred,</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\">and anything you might have done that may have</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\">caused the error.&lt;/p&gt;</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\">&lt;p&gt;More information about this error may be available</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\">in the server error og.&lt;/p&gt;</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\">&lt;/body&gt;&lt;/html</div>\r\n<p style=\"padding-left:60px\"><span style=\"color:#808080\">V&eacute;&oslash;&euro;&permil;&Oacute;ijJ&Ugrave;^&raquo;&#3;&Oslash;&#31;&circ;&icirc;p&#27;&aacute;&agrave;&OElig;O&iexcl;&#30;_A&frac14;&nbsp;&otilde;&#129;&ouml;Ž&#21;[K&ETH;O&para;&quot;&#30;e&Auml;&brvbar;&times;&AElig;&sbquo;&sect;&Eacute;&#18;&frac34;&ndash;&rsquo;&acirc;Y5z&#15;5E&lsaquo;&yen;&igrave;y&bull;z9&sup3;~&Ouml;&Eacute;y&#23;&iexcl;&Egrave;&ccedil;&uuml;r&#15;;?\\&acute;&ndash;Lt&#24;,&ntilde;\\(&frac12;</span></p>\r\n<p style=\"padding-left:60px\"><span style=\"color:#808080\">&lt;!DOCTYPE HTML PUBLIC &quot;-//IETF//DTD HTML 2.0//EN&quot;&gt;</span></p>\r\n<p style=\"padding-left:60px\"><span style=\"color:#808080\">&lt;html&gt;&lt;head&gt;</span></p>\r\n<p style=\"padding-left:60px\"><span style=\"color:#808080\">&lt;title&gt;200 OK&lt;/title&gt;</span></p>\r\n<p style=\"padding-left:60px\"><span style=\"color:#808080\">&lt;/head&gt;&lt;body&gt;</span></p>\r\n<p style=\"padding-left:60px\"><span style=\"color:#808080\">&lt;h1&gt;OK&lt;/h1&gt;</span></p>\r\n<p style=\"padding-left:60px\"><span style=\"color:#808080\">&lt;p&gt;The server encountered an internal error or</span></p>\r\n<p style=\"padding-left:60px\"><span style=\"color:#808080\">misconfiguration and was unable to complete</span></p>\r\n<p style=\"padding-left:60px\"><span style=\"color:#808080\">your request.&lt;/p&gt;</span></p>\r\n<p style=\"padding-left:60px\"><span style=\"color:#808080\">&lt;p&gt;Please contact the server administrator,</span></p>\r\n<p style=\"padding-left:60px\"><span style=\"color:#808080\">admin@example.com and inform them of the time the error occurred,</span></p>\r\n<p style=\"padding-left:60px\"><span style=\"color:#808080\">and anything you might have done that may have</span></p>\r\n<p style=\"padding-left:60px\"><span style=\"color:#808080\">caused the error.&lt;/p&gt;</span></p>\r\n<p style=\"padding-left:60px\"><span style=\"color:#808080\">&lt;p&gt;More information about this error may be available</span></p>\r\n<p style=\"padding-left:60px\"><span style=\"color:#808080\">in the server error log.&lt;/p&gt;</span></p>\r\n<p style=\"padding-left:60px\"><span style=\"color:#808080\">&lt;/body&gt;&lt;/html&gt;</span></p>\r\n<p><span style=\"color:#000000\">It seems to be coming from Apache, but just for the sake of information, I am running on a Windows 7 laptop, ZendServer CE, Zend Framework 1.10, PHP 5.3, and my memory limit is set to 128M. When I run this code during the Excel file generation:</span></p>\r\n<pre style=\"padding-left:60px\">error_reporting(E_ALL);\r\nini_set('display_errors', '1');\r\nini_set('memory_limit', '128M');\r\n$bytes = 5000000;\r\n$x = str_repeat('a', $bytes);\r\n</pre>\r\n<pre style=\"padding-left:60px\">...</pre>\r\n<pre style=\"padding-left:60px\">...</pre>\r\n<pre style=\"padding-left:60px\">// debugging to look at peak memory usage in PHP ...\r\n$objPHPExcel-&gt;setActiveSheetIndex()\r\n      -&gt;setCellValue(\r\n      'A'.($row_name+1),\r\n      &quot; Peak memory usage: &quot; . (number_format(memory_get_peak_usage(true))) . &quot; B\\r\\n&quot;</pre>\r\n<pre style=\"padding-left:60px\">);</pre>\r\n<p>When it writes that error message to the bottom of the file, the memory usage says 11,534,336 B, but when the file succeeds, the memory usages hits 23,330,816 B  Let me know if you have any ideas what might be going on. Thanks for the help,</p>\r\n<p>Dave</p>",
    "PostedDate": "2010-03-18T16:18:20.903-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "420044",
    "ThreadId": "205434",
    "Html": "<p>Hmm... Haven't seen this problem before. Googling on that error message, people suggest looking at the Apache error log?</p>",
    "PostedDate": "2010-03-18T16:59:00.37-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "420047",
    "ThreadId": "205434",
    "Html": "<p>Yeah, I tried that, and I don't see anything unusual. I only see messages from when I restarted the server.</p>",
    "PostedDate": "2010-03-18T17:03:50.51-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "420053",
    "ThreadId": "205434",
    "Html": "<p>I have no idea what the problem is. For the record, can you say if this is happening only with big Excel files?</p>\r\n<p>Does the script always terminate after the same period of time? How many seconds? Maybe also check if there are some strange .htaccess files.</p>",
    "PostedDate": "2010-03-18T17:17:33.66-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "420084",
    "ThreadId": "205434",
    "Html": "<p>Actually, one thing that seems unique in this situation is that the Excel files are only 7Kb or so by the time it fails. The logic that pulls records from the database using Propel ORM is quite complex, though, and I believe it's using a lot of memory, even if it's only generating a small Excel file.</p>\r\n<p>&nbsp;</p>\r\n<p>The amount of time it takes to create the bad files and good files is the same. It takes anywhere from 4-10 seconds to generate the Excel file, and sometimes they contain the Apache error page, and sometimes they don't. At first, it seemed to happen exactly every other time, but now I don't believe there is a perfect pattern like that.</p>\r\n<p>&nbsp;</p>\r\n<p>I will check into the .htaccess files, and if I don't find anything, I am going to have to refactor my Propel query logic. Thanks for your advice,</p>\r\n<p>Dave</p>",
    "PostedDate": "2010-03-18T19:53:25.907-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]