[
  {
    "Id": "650815",
    "ThreadId": "267357",
    "Html": "\r\n<p>Hi, i have a php script that connect to active directory and retrive some fields and then generate an excel file(Excel5), then i connect by ODBC with TOAD to query the data from the excel file, but it not show me the first column and add a column, if i open\r\n and save the excel file, toad show me the data without problem, i think that the problem is the excel format that it generate</p>\r\n<p>i use this code to retrive and generate the excel file, my script run in linux box</p>\r\n<p>&nbsp;</p>\r\n<p></p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre>    <span style=\"color:blue\">if</span> ($ldapbind) {\r\n        <span style=\"color:green\">//echo &quot;LDAP bind successful...&quot;;</span>\r\n        $filter = <span style=\"color:#a31515\">&quot;(cn=*)&quot;</span>;\r\n        $fields = <span style=\"color:blue\">array</span>(<span style=\"color:#a31515\">&quot;uid&quot;</span>,<span style=\"color:#a31515\">&quot;cn&quot;</span>,<span style=\"color:#a31515\">&quot;whencreated&quot;</span>,<span style=\"color:#a31515\">&quot;accountexpires&quot;</span>,<span style=\"color:#a31515\">&quot;memberof&quot;</span>);\r\n        $sr = ldap_search($ldapconn, $dn, $filter, $fields);\r\n        $info = ldap_get_entries($ldapconn, $sr);\r\n                <span style=\"color:green\">//print_r($info);</span>\r\n        <span style=\"color:green\">//var_dump($info);</span>\r\n        $objPHPExcel-&gt;setActiveSheetIndex(0);\r\n        $objPHPExcel-&gt;getActiveSheet()-&gt;setTitle(<span style=\"color:#a31515\">'UsuariosAD'</span>);\r\n        $objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue(<span style=\"color:#a31515\">'A1'</span>, <span style=\"color:#a31515\">'NUM_DNI'</span>);\r\n        $objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue(<span style=\"color:#a31515\">'B1'</span>, <span style=\"color:#a31515\">'DES_PROVEEDOR'</span>);\r\n        $objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue(<span style=\"color:#a31515\">'C1'</span>, <span style=\"color:#a31515\">'FEC_INI_CON'</span>);\r\n        $objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue(<span style=\"color:#a31515\">'D1'</span>, <span style=\"color:#a31515\">'FEC_FIN_CON'</span>);\r\n        <span style=\"color:green\">//echo &quot;NUM_DNI\\tDES_PROVEEDOR\\tFEC_INI_CON\\tFEC_FIN_CON\\n&quot;;</span>\r\n        $objPHPExcel-&gt;setActiveSheetIndex(0);\r\n        $k=2;\r\n        <span style=\"color:blue\">for</span> ($i=0; $i&lt;$info[<span style=\"color:#a31515\">&quot;count&quot;</span>]; $i&#43;&#43;)\r\n        {\r\n                <span style=\"color:blue\">for</span> ($j=0; $j &lt; count($info[$i][<span style=\"color:#a31515\">&quot;memberof&quot;</span>]); $j&#43;&#43;){\r\n                        <span style=\"color:blue\">if</span> ($info[$i][<span style=\"color:#a31515\">&quot;memberof&quot;</span>][$j] == <span style=\"color:#a31515\">&quot;cn=xx,dc=ssksk,dc=com&quot;</span>)\r\n                                <span style=\"color:green\">//echo $info[$i][&quot;uid&quot;][0].&quot;\\t&quot;.$info[$i][&quot;cn&quot;][0].&quot;\\t&quot;.format_whencreated($info[$i][&quot;whencreated&quot;][0]).&quot;\\t&quot;.convert_format_date($info[$i][&quot;accountexpires&quot;][0]).&quot;\\n&quot;;</span>\r\n                        {               $objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue(<span style=\"color:#a31515\">'A'</span>.$k,$info[$i][<span style=\"color:#a31515\">&quot;uid&quot;</span>][0]);\r\n                                        $objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue(<span style=\"color:#a31515\">'B'</span>.$k,$info[$i][<span style=\"color:#a31515\">&quot;cn&quot;</span>][0]);\r\n                                        $objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue(<span style=\"color:#a31515\">'C'</span>.$k,format_whencreated($info[$i][<span style=\"color:#a31515\">&quot;whencreated&quot;</span>][0]));\r\n                                        $objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue(<span style=\"color:#a31515\">'D'</span>.$k,convert_format_date($info[$i][<span style=\"color:#a31515\">&quot;accountexpires&quot;</span>][0]));\r\n                                        $k&#43;&#43;;\r\n                                        $objPHPExcel-&gt;setActiveSheetIndex(0);\r\n                        }\r\n                }\r\n        }\r\n        <span style=\"color:green\">// 2003</span>\r\n        $objPHPExcel-&gt;setActiveSheetIndex(0);\r\n        $objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, <span style=\"color:#a31515\">'Excel5'</span>);\r\n        $objWriter-&gt;save(str_replace(<span style=\"color:#a31515\">'.php'</span>, <span style=\"color:#a31515\">'.xls'</span>,<span style=\"color:#a31515\">'/opt/share/UsuariosAD.xls'</span>));\r\n\r\n</pre>\r\n</div>\r\n<p></p>\r\n",
    "PostedDate": "2011-08-01T15:21:03.137-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "651408",
    "ThreadId": "267357",
    "Html": "<p>Hi, I think that i have the problem with the format, I generate the excel with Excel5 format, and when i open the file, this open in compatibility mode, is there a way to generate with 2003 format?, because i only see \"Excel5\" and \"Excel 2007\"</p>",
    "PostedDate": "2011-08-02T14:36:12.077-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]