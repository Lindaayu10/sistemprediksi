[
  {
    "Id": "450561",
    "ThreadId": "214714",
    "Html": "<p>Hi Mark, &nbsp;&nbsp;</p>\r\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; With your suggestion to me and by seeing your previous posts to  other developers i tried to manage some what and&nbsp; could now&nbsp; work with  templates. But the problem now my template sheet consists of six sheets</p>\r\n<p>from which i am trying to generate 86 sheets .&nbsp; The first sheet wwill  be cloned 82 times and the rest were copied once . But i could make  this&nbsp; only for 85 sheets after which i a getting this message</p>\r\n<pre><code>&lt;b&gt;Fatal error&lt;/b&gt;:  Allowed memory size of 1073741824 bytes exhausted (tried to allocate 3 bytes) in</code><code> &lt;b&gt;D:\\projects\\VRM\\pfizerCRS\\pfizer_crash_report\\PHPExcel\\Classes\\PHPExcel\\Worksheet.php&lt;/b&gt; <br>on line</code><code> &lt;b&gt;2485&lt;/b&gt;&lt;br /&gt;<br><br>but my ini_set level is 1024M<br><br>For your convenience i have given some code part<br><br>Can u help me<br><br></code>&lt;?php<br><br>&nbsp;&nbsp; /****<br>&nbsp;&nbsp;&nbsp; * File : dummy.php<br>&nbsp;&nbsp;&nbsp; * created for cloning the xls worksheets dynamically and to fetch records<br>&nbsp;&nbsp;&nbsp; * */&nbsp;&nbsp; &nbsp;<br>&nbsp; &nbsp;<br>&nbsp; &nbsp;&nbsp; // include the configuartion file <br>&nbsp;&nbsp; &nbsp;require_once('../../../include/conf.inc.php');<br>&nbsp; &nbsp;<br>&nbsp;&nbsp; //Declaration of variables <br>&nbsp;&nbsp; &nbsp;$i = 0;<br>&nbsp;&nbsp; &nbsp;<br>&nbsp;&nbsp; &nbsp;$countrySheet = &quot;&quot;;<br>&nbsp;&nbsp; &nbsp;$tcoSheet = &quot;&quot;;<br>&nbsp;&nbsp; &nbsp;$tcoAnnual = &quot;&quot;;<br>&nbsp;&nbsp; &nbsp;$CO2Sheet = &quot;&quot;;<br>&nbsp;&nbsp; &nbsp;$safetySheet = &quot;&quot;;<br>&nbsp;&nbsp; &nbsp;$imburseSheet = &quot;&quot;;<br>&nbsp;&nbsp; &nbsp;<br>&nbsp;&nbsp; &nbsp;$sheet = &quot;&quot;;<br>&nbsp;&nbsp; &nbsp;$sheetTCOQuarter = &quot;&quot;;<br>&nbsp;&nbsp; &nbsp;$sheetTCOAnnual = &quot;&quot;;<br>&nbsp;&nbsp; &nbsp;$sheetSafety = &quot;&quot;;<br>&nbsp;&nbsp; &nbsp;$sheetCO2 = &quot;&quot;;<br>&nbsp;&nbsp; &nbsp;$sheetImburse = &quot;&quot;;<br>&nbsp;&nbsp; &nbsp;<br>&nbsp;&nbsp; &nbsp;<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$objPHPExcel = PHPExcel_IOFactory::load(&quot;../excel_templates/report.xls&quot;);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;//Get the copy of all the sheets in the template.<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$countrySheet = $objPHPExcel-&gt;getSheetByName('Sheet1')-&gt;copy();<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$tcoSheet = $objPHPExcel-&gt;getSheetByName('Sheet2')-&gt;copy();<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$tcoAnnual = $objPHPExcel-&gt;getSheetByName('Sheet3')-&gt;copy();<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$CO2Sheet = $objPHPExcel-&gt;getSheetByName('Sheet4')-&gt;copy();<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$safetySheet = $objPHPExcel-&gt;getSheetByName('Sheet5')-&gt;copy();<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$imburseSheet = $objPHPExcel-&gt;getSheetByName('Sheet6')-&gt;copy();<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;//disconnect all existing sheets<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$objPHPExcel-&gt;disconnectWorkSheets();<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;<br>&nbsp;&nbsp; &nbsp;<br><br>&nbsp;&nbsp; &nbsp;// looping with different quarters and countries <br>&nbsp;&nbsp; &nbsp;foreach($countryArray as $ck =&gt;$cv) {<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;//Sheets are cloned here and 82 tabs are created and one for each country<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; $sheet = &quot;&quot;;<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; $sheet = clone $countrySheet;<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$sheet-&gt;setTitle($cv);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$objPHPExcel-&gt;addSheet($sheet);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$objPHPExcel-&gt;setActiveSheetIndex($ck);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br>&nbsp;&nbsp; &nbsp;}&nbsp;&nbsp; &nbsp;//unset the copied sheet which has been created for countries<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;unset($countrySheet);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;unset($sheet);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;// Here the sheet is cloned for Tco quarterly report<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$sheetTCOQuarter = clone $tcoSheet;<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$sheetTCOQuarter-&gt;setTitle(&quot;TCO Report quarterly&quot;);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$objPHPExcel-&gt;addSheet($sheetTCOQuarter);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$objPHPExcel-&gt;setActiveSheetIndex(82);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;unset($tcoSheet);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;unset($sheetTCOQuarter);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;//Here the sheet is cloned for Tco Annual report<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$sheetTCOAnnual = clone $tcoAnnual;<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$sheetTCOAnnual-&gt;setTitle(&quot;TCO Annual Report&quot;);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$objPHPExcel-&gt;addSheet($sheetTCOAnnual);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$objPHPExcel-&gt;setActiveSheetIndex(83);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;unset($tcoAnnual);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;unset($sheetTCOAnnual);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;//Here the sheet is cloned for CO2 report<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$sheetCO2 = clone $CO2Sheet;<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$sheetCO2-&gt;setTitle(&quot;CO2 Report&quot;);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$objPHPExcel-&gt;addSheet($sheetCO2);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$objPHPExcel-&gt;setActiveSheetIndex(84);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;unset($CO2Sheet);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;unset($sheetCO2);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;//Here the sheet is cloned for Safety report<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$sheetSafety = clone $safetySheet;<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$sheetSafety-&gt;setTitle(&quot;Safety Report&quot;);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$objPHPExcel-&gt;addSheet($sheetSafety);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$objPHPExcel-&gt;setActiveSheetIndex(85);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;unset($safetySheet);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;unset($sheetSafety);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;//Here the sheet is cloned for Reimbursement report<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; $sheetImburse = clone $imburseSheet;<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$sheetImburse-&gt;setTitle(&quot;Re-Imbursement Report&quot;);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$objPHPExcel-&gt;addSheet($sheetImburse);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$objPHPExcel-&gt;setActiveSheetIndex(86);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;unset($imburseSheet);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;unset($sheetImburse);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;<br>&nbsp;&nbsp; &nbsp;<br>?&gt;</pre>",
    "PostedDate": "2010-06-02T06:03:58.86-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "450865",
    "ThreadId": "214714",
    "Html": "<p>Try calling the disconnectCells() method before unsetting any of the template worksheets.</p>\r\n<p>e.g.</p>\r\n<div style=\"color:black;background-color:white\">\r\n<pre>$tcoSheet-&gt;disconnectCells();\r\n<span style=\"color:blue\">unset</span>($tcoSheet)\r\n</pre>\r\n</div>\r\n<p>You could also try cloning just the country sheets, but simply rename the other sheets in the template. This doesn't just help memory usage, but it's also simpler code and faster.</p>\r\n<div style=\"color:black;background-color:white\">\r\n<pre>$objPHPExcel = PHPExcel_IOFactory::load(<span style=\"color:#a31515\">&quot;../excel_templates/report.xls&quot;</span>);\r\n\r\n$objPHPExcel-&gt;getSheetByName(<span style=\"color:#a31515\">'Sheet2'</span>)-&gt;setTitle(<span style=\"color:#a31515\">&quot;TCO Report quarterly&quot;</span>);\r\n$objPHPExcel-&gt;getSheetByName(<span style=\"color:#a31515\">'Sheet3'</span>)-&gt;setTitle(<span style=\"color:#a31515\">&quot;TCO Annual Report&quot;</span>);\r\n$objPHPExcel-&gt;getSheetByName(<span style=\"color:#a31515\">'Sheet4'</span>)-&gt;setTitle(<span style=\"color:#a31515\">&quot;CO2 Report&quot;</span>);\r\n$objPHPExcel-&gt;getSheetByName(<span style=\"color:#a31515\">'Sheet5'</span>)-&gt;setTitle(<span style=\"color:#a31515\">&quot;Safety Report&quot;</span>);\r\n$objPHPExcel-&gt;getSheetByName(<span style=\"color:#a31515\">'Sheet6'</span>)-&gt;setTitle(<span style=\"color:#a31515\">&quot;Re-Imbursement Report&quot;</span>);\r\n\r\n$lastCountry = array_pop($countryArray);\r\n<span style=\"color:blue\">foreach</span>($countryArray <span style=\"color:blue\">as</span> $ck =&gt;$cv) {\r\n   $countrySheet = <span style=\"color:blue\">clone</span> $objPHPExcel-&gt;getSheetByName(<span style=\"color:#a31515\">'Sheet1'</span>);\r\n   $countrySheet-&gt;setTitle($cv);\r\n   $objPHPExcel-&gt;addSheet($countrySheet);\r\n}\r\n$objPHPExcel-&gt;getSheetByName(<span style=\"color:#a31515\">'Sheet1'</span>)-&gt;setTitle($lastCountry);\r\n</pre>\r\n</div>\r\n<p>While we've tried to improve the excessive memory usage of PHPExcel, we can only reduce it, not eliminate the need for memory completely; but this code logic should give you the complete set of sheets that you want using less memory than your code.</p>\r\n<p>You may need to use $objPHPExcel-&gt;setIndexByName($sheetName, $indexPosition) for each sheet to order the tabs as you want them.</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2010-06-02T14:51:32.897-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "451009",
    "ThreadId": "214714",
    "Html": "<p>hi mark,</p>\r\n<p>&nbsp;&nbsp;&nbsp; Ur concept of disconnecting the cells is working fine, but the problem is takes much time to generate a report. Actually to say, to generate 87 sheets without any data itself it takes more than 7 minutes .&nbsp; Now i'm afraid, that i have to include 8</p>\r\n<p>sheets and&nbsp; along with this, if data is going to be included , how long it will take to generate.&nbsp; And the other problem i a facing , when it is generating the machine gets slower in access, what would be the problem.&nbsp; How to solve this</p>\r\n<p>&nbsp;</p>\r\n<p>Once again thanks for all your posts.&nbsp; With ur suggestions , now i could generate more than 87 sheets</p>",
    "PostedDate": "2010-06-02T23:18:00.04-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]