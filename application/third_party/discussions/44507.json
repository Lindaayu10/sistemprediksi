[
  {
    "Id": "148127",
    "ThreadId": "44507",
    "Html": "I'm trying to get PHPExcel to work in CakePHP.<br>\r\n<br>\r\nI've declared the class (and the files) as a 3rd party class (using vendor classes).<br>\r\n<br>\r\nThen I used the standard example code just to see if I could get something as output.<br>\r\n<br>\r\nI've declared an controller action called &quot;export&quot; which takes care of the creation of the file.<br>\r\n<br>\r\nThe browser indeeds sends me a file, but it'sz completely blank.<br>\r\n<br>\r\nhere the code I use in my controller action:<br>\r\n<br>\r\n<pre>\tfunction __doExport($exportType) {<br>\t\t$findParams = array('conditions' =&gt; $this-&gt;Session-&gt;read('conditions'),<br>\t  \t\t\t\t    \t'order' =&gt; 'Entity.name');<br>\t\t$Entities = $this-&gt;Entity-&gt;find('all', $findParams);<br><br>\t\t// create Excel export object<br>\t\t$objPHPExcel = new PHPExcel();<br>\t\t// Set properties<br>\t\t$objPHPExcel-&gt;getProperties()-&gt;setCreator(&quot;CratosManager&quot;);<br>\t\t$objPHPExcel-&gt;getProperties()-&gt;setLastModifiedBy(&quot;CratosManager&quot;);<br>\t\t// set values<br>\t\t$objPHPExcel-&gt;setActiveSheetIndex(0);<br>\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension('A')-&gt;setAutoSize(true);<br>\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension('B')-&gt;setAutoSize(true);<br>\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension('C')-&gt;setAutoSize(true);<br>\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension('D')-&gt;setAutoSize(true);<br>\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('A1', 'Hello');<br>\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('B2', 'world!');<br>\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('C1', 'Hello');<br>\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('D2', 'world!');<br>\t\t// redirect output to client browser<br>\t\theader('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');<br>\t\theader('Content-Disposition: attachment;filename=&quot;export.xls&quot;');<br>\t\theader('Cache-Control: max-age=0');<br>\t\t$objWriter = new PHPExcel_Writer_Excel5($objPHPExcel);<br>\t\t<br>\t\t$objWriter-&gt;save('php://output');<br>\t}</pre>\r\nI must be doing something wrong I guess, but I don't see the issue. Can someone tell me what I'm doing wrong here?<br>\r\n<br>\r\nthank<br>\r\n",
    "PostedDate": "2009-01-18T13:37:03.617-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "148156",
    "ThreadId": "44507",
    "Html": "If you are sending xls file to the browser, the appropriate Content-Type is <code>application/vnd.ms-excel</code>. But this is probably not the error. I tried you script and it is working for me!<br>\r\n<br>\r\nCan you try to save the file normally to disk and get that working first?<br>\r\n<br>\r\n<br>\r\n<br>\r\n<br>\r\n",
    "PostedDate": "2009-01-18T16:23:12.787-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "148464",
    "ThreadId": "44507",
    "Html": "Thanks Koyama for the tip, but as you thought already it didn't solve the issue.<br>\r\n<br>\r\nI have changed the header &amp; Writer lines to:<br>\r\n<br>\r\n<pre>   $objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, 'Excel2007');<br>   $objWriter-&gt;save(str_replace('.php', '.xlsx', __FILE__));</pre>\r\n<br>\r\nWithin my CakePHP controller I've added the line just before the ones above (for debugging):<br>\r\n<br>\r\n<pre>debug($objPHPExcel);</pre>\r\n<br>\r\nthis is what I get (which seems ok):<br>\r\n<br>\r\n<pre>app/controllers/companies_controller.php (line 136)<br><br>PHPExcel Object<br>(<br>    [_properties:private] =&gt; PHPExcel_DocumentProperties Object<br>        (<br>            [_creator:private] =&gt; CratosManager<br>            [_lastModifiedBy:private] =&gt; CratosManager<br>            [_created:private] =&gt; 1232394188<br>            [_modified:private] =&gt; 1232394188<br>            [_title:private] =&gt; Untitled Spreadsheet<br>            [_description:private] =&gt; <br>            [_subject:private] =&gt; <br>            [_keywords:private] =&gt; <br>            [_category:private] =&gt; <br>        )<br><br>    [_security:private] =&gt; PHPExcel_DocumentSecurity Object<br>        (<br>            [_lockRevision:private] =&gt; <br>            [_lockStructure:private] =&gt; <br>            [_lockWindows:private] =&gt; <br>            [_revisionsPassword:private] =&gt; <br>            [_workbookPassword:private] =&gt; <br>        )<br><br>    [_workSheetCollection:private] =&gt; Array<br>        (<br>            [0] =&gt; PHPExcel_Worksheet Object<br>                (<br>                    [_parent:private] =&gt; PHPExcel Object<br> *RECURSION*<br>                    [_cellCollection:private] =&gt; Array<br>                        (<br>                            [A1] =&gt; PHPExcel_Cell Object<br>                                (<br>                                    [_column:private] =&gt; A<br>                                    [_row:private] =&gt; 1<br>                                    [_value:private] =&gt; Hello<br>                                    [_dataType:private] =&gt; s<br>                                    [_dataValidation:private] =&gt; <br>                                    [_hyperlink:private] =&gt; <br>                                    [_parent:private] =&gt; PHPExcel_Worksheet Object<br> *RECURSION*<br>                                )<br><br>                            [B2] =&gt; PHPExcel_Cell Object<br>                                (<br>                                    [_column:private] =&gt; B<br>                                    [_row:private] =&gt; 2<br>                                    [_value:private] =&gt; world!<br>                                    [_dataType:private] =&gt; s<br>                                    [_dataValidation:private] =&gt; <br>                                    [_hyperlink:private] =&gt; <br>                                    [_parent:private] =&gt; PHPExcel_Worksheet Object<br> *RECURSION*<br>                                )<br><br>                            [C1] =&gt; PHPExcel_Cell Object<br>                                (<br>                                    [_column:private] =&gt; C<br>                                    [_row:private] =&gt; 1<br>                                    [_value:private] =&gt; Hello<br>                                    [_dataType:private] =&gt; s<br>                                    [_dataValidation:private] =&gt; <br>                                    [_hyperlink:private] =&gt; <br>                                    [_parent:private] =&gt; PHPExcel_Worksheet Object<br> *RECURSION*<br>                                )<br><br>                            [D2] =&gt; PHPExcel_Cell Object<br>                                (<br>                                    [_column:private] =&gt; D<br>                                    [_row:private] =&gt; 2<br>                                    [_value:private] =&gt; world!<br>                                    [_dataType:private] =&gt; s<br>                                    [_dataValidation:private] =&gt; <br>                                    [_hyperlink:private] =&gt; <br>                                    [_parent:private] =&gt; PHPExcel_Worksheet Object<br> *RECURSION*<br>                                )<br><br>                        )<br><br>                    [_rowDimensions:private] =&gt; Array<br>                        (<br>                        )<br><br>                    [_defaultRowDimension:private] =&gt; PHPExcel_Worksheet_RowDimension Object<br>                        (<br>                            [_rowIndex:private] =&gt; <br>                            [_rowHeight:private] =&gt; -1<br>                            [_visible:private] =&gt; 1<br>                            [_outlineLevel:private] =&gt; 0<br>                            [_collapsed:private] =&gt; <br>                        )<br><br>                    [_columnDimensions:private] =&gt; Array<br>                        (<br>                            [A] =&gt; PHPExcel_Worksheet_ColumnDimension Object<br>                                (<br>                                    [_columnIndex:private] =&gt; A<br>                                    [_width:private] =&gt; -1<br>                                    [_autoSize:private] =&gt; 1<br>                                    [_visible:private] =&gt; 1<br>                                    [_outlineLevel:private] =&gt; 0<br>                                    [_collapsed:private] =&gt; <br>                                )<br><br>                            [B] =&gt; PHPExcel_Worksheet_ColumnDimension Object<br>                                (<br>                                    [_columnIndex:private] =&gt; B<br>                                    [_width:private] =&gt; -1<br>                                    [_autoSize:private] =&gt; 1<br>                                    [_visible:private] =&gt; 1<br>                                    [_outlineLevel:private] =&gt; 0<br>                                    [_collapsed:private] =&gt; <br>                                )<br><br>                            [C] =&gt; PHPExcel_Worksheet_ColumnDimension Object<br>                                (<br>                                    [_columnIndex:private] =&gt; C<br>                                    [_width:private] =&gt; -1<br>                                    [_autoSize:private] =&gt; 1<br>                                    [_visible:private] =&gt; 1<br>                                    [_outlineLevel:private] =&gt; 0<br>                                    [_collapsed:private] =&gt; <br>                                )<br><br>                            [D] =&gt; PHPExcel_Worksheet_ColumnDimension Object<br>                                (<br>                                    [_columnIndex:private] =&gt; D<br>                                    [_width:private] =&gt; -1<br>                                    [_autoSize:private] =&gt; 1<br>                                    [_visible:private] =&gt; 1<br>                                    [_outlineLevel:private] =&gt; 0<br>                                    [_collapsed:private] =&gt; <br>                                )<br><br>                        )<br><br>                    [_defaultColumnDimension:private] =&gt; PHPExcel_Worksheet_ColumnDimension Object<br>                        (<br>                            [_columnIndex:private] =&gt; <br>                            [_width:private] =&gt; -1<br>                            [_autoSize:private] =&gt; <br>                            [_visible:private] =&gt; 1<br>                            [_outlineLevel:private] =&gt; 0<br>                            [_collapsed:private] =&gt; <br>                        )<br><br>                    [_drawingCollection:private] =&gt; ArrayObject Object<br>                        (<br>                        )<br><br>                    [_title:private] =&gt; Worksheet<br>                    [_pageSetup:private] =&gt; PHPExcel_Worksheet_PageSetup Object<br>                        (<br>                            [_paperSize:private] =&gt; 1<br>                            [_orientation:private] =&gt; default<br>                            [_scale:private] =&gt; <br>                            [_fitToHeight:private] =&gt; <br>                            [_fitToWidth:private] =&gt; <br>                            [_columnsToRepeatAtLeft:private] =&gt; Array<br>                                (<br>                                    [0] =&gt; <br>                                    [1] =&gt; <br>                                )<br><br>                            [_rowsToRepeatAtTop:private] =&gt; Array<br>                                (<br>                                    [0] =&gt; 0<br>                                    [1] =&gt; 0<br>                                )<br><br>                            [_horizontalCentered:private] =&gt; <br>                            [_verticalCentered:private] =&gt; <br>                            [_printArea:private] =&gt; <br>                        )<br><br>                    [_pageMargins:private] =&gt; PHPExcel_Worksheet_PageMargins Object<br>                        (<br>                            [_left:private] =&gt; 0.7<br>                            [_right:private] =&gt; 0.7<br>                            [_top:private] =&gt; 0.75<br>                            [_bottom:private] =&gt; 0.75<br>                            [_header:private] =&gt; 0.3<br>                            [_footer:private] =&gt; 0.3<br>                        )<br><br>                    [_headerFooter:private] =&gt; PHPExcel_Worksheet_HeaderFooter Object<br>                        (<br>                            [_oddHeader:private] =&gt; <br>                            [_oddFooter:private] =&gt; <br>                            [_evenHeader:private] =&gt; <br>                            [_evenFooter:private] =&gt; <br>                            [_firstHeader:private] =&gt; <br>                            [_firstFooter:private] =&gt; <br>                            [_differentOddEven:private] =&gt; <br>                            [_differentFirst:private] =&gt; <br>                            [_scaleWithDocument:private] =&gt; 1<br>                            [_alignWithMargins:private] =&gt; 1<br>                            [_headerFooterImages:private] =&gt; Array<br>                                (<br>                                )<br><br>                        )<br><br>                    [_sheetView:private] =&gt; PHPExcel_Worksheet_SheetView Object<br>                        (<br>                            [_zoomScale:private] =&gt; 100<br>                            [_zoomScaleNormal:private] =&gt; 100<br>                        )<br><br>                    [_protection:private] =&gt; PHPExcel_Worksheet_Protection Object<br>                        (<br>                            [_sheet:private] =&gt; <br>                            [_objects:private] =&gt; <br>                            [_scenarios:private] =&gt; <br>                            [_formatCells:private] =&gt; <br>                            [_formatColumns:private] =&gt; <br>                            [_formatRows:private] =&gt; <br>                            [_insertColumns:private] =&gt; <br>                            [_insertRows:private] =&gt; <br>                            [_insertHyperlinks:private] =&gt; <br>                            [_deleteColumns:private] =&gt; <br>                            [_deleteRows:private] =&gt; <br>                            [_selectLockedCells:private] =&gt; <br>                            [_sort:private] =&gt; <br>                            [_autoFilter:private] =&gt; <br>                            [_pivotTables:private] =&gt; <br>                            [_selectUnlockedCells:private] =&gt; <br>                            [_password:private] =&gt; <br>                        )<br><br>                    [_styles:private] =&gt; Array<br>                        (<br>                            [default] =&gt; PHPExcel_Style Object<br>                                (<br>                                    [_font:private] =&gt; <br>                                    [_fill:private] =&gt; <br>                                    [_borders:private] =&gt; <br>                                    [_alignment:private] =&gt; <br>                                    [_numberFormat:private] =&gt; <br>                                    [_conditionalStyles:private] =&gt; Array<br>                                        (<br>                                        )<br><br>                                    [_protection:private] =&gt; <br>                                    [_hashIndex:private] =&gt; <br>                                )<br><br>                            [gray125] =&gt; PHPExcel_Style Object<br>                                (<br>                                    [_font:private] =&gt; <br>                                    [_fill:private] =&gt; PHPExcel_Style_Fill Object<br>                                        (<br>                                            [_fillType:private] =&gt; gray125<br>                                            [_rotation:private] =&gt; 0<br>                                            [_startColor:private] =&gt; PHPExcel_Style_Color Object<br>                                                (<br>                                                    [_argb:private] =&gt; FFFFFFFF<br>                                                    [_hashIndex:private] =&gt; <br>                                                )<br><br>                                            [_endColor:private] =&gt; PHPExcel_Style_Color Object<br>                                                (<br>                                                    [_argb:private] =&gt; FF000000<br>                                                    [_hashIndex:private] =&gt; <br>                                                )<br><br>                                            [_parent:private] =&gt; <br>                                            [_parentPropertyName:private] =&gt; _fill<br>                                            [_hashIndex:private] =&gt; <br>                                        )<br><br>                                    [_borders:private] =&gt; <br>                                    [_alignment:private] =&gt; <br>                                    [_numberFormat:private] =&gt; <br>                                    [_conditionalStyles:private] =&gt; Array<br>                                        (<br>                                        )<br><br>                                    [_protection:private] =&gt; <br>                                    [_hashIndex:private] =&gt; <br>                                )<br><br>                        )<br><br>                    [_cellCollectionIsSorted:private] =&gt; <br>                    [_breaks:private] =&gt; Array<br>                        (<br>                        )<br><br>                    [_mergeCells:private] =&gt; Array<br>                        (<br>                        )<br><br>                    [_protectedCells:private] =&gt; Array<br>                        (<br>                        )<br><br>                    [_autoFilter:private] =&gt; <br>                    [_freezePane:private] =&gt; <br>                    [_showGridlines:private] =&gt; 1<br>                    [_printGridlines:private] =&gt; <br>                    [_showSummaryBelow:private] =&gt; 1<br>                    [_showSummaryRight:private] =&gt; 1<br>                    [_comments:private] =&gt; Array<br>                        (<br>                        )<br><br>                    [_selectedCell:private] =&gt; A1<br>                    [_hashIndex:private] =&gt; <br>                )<br><br>        )<br><br>    [_activeSheetIndex:private] =&gt; 0<br>    [_namedRanges:private] =&gt; Array<br>        (<br>        )<br><br>    [_log] =&gt; <br>)</pre>\r\nBut still no luck. I'm now trying to get some debug output from the save function in the Excel2007 Writer, but without any luck so far.<br>\r\n<br>\r\n",
    "PostedDate": "2009-01-19T11:48:22.143-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "148469",
    "ThreadId": "44507",
    "Html": "By the way:<br>\r\n<br>\r\nI've tried with the Excel5 writer as well: same thing = nothing.<br>\r\nNo entries in any log or error message.<br>\r\n<br>\r\nI've checked if my PHP supported XML &amp; ZIP: it does.<br>\r\n<br>\r\nI'm still trying to get some debug output from within the class function: no luck so far.<br>\r\n",
    "PostedDate": "2009-01-19T11:57:14.12-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "148477",
    "ThreadId": "44507",
    "Html": "Update: I've tried to run the code outside an CakePHP controlled path, so it is plain PHP code.<br>\r\n<br>\r\nGuess what: it doesn't work.<br>\r\n<br>\r\nNow I'm thinking: would it have to do anything with the webserver used? Lighttpd...<br>\r\n<br>\r\nAny idea?<br>\r\n",
    "PostedDate": "2009-01-19T12:25:07.2-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "148491",
    "ThreadId": "44507",
    "Html": "I've tried with an exact copy of the archive with some changes:<br>\r\n<br>\r\ncopied the original classes/PHPExcel to /data/www/test/dev/<br>\r\ncopied the original classes/PHPExcel.php to /data/www/test/dev/<br>\r\n<br>\r\ncreated an test.php in /data/www/test/dev. the content of test.php is an exact copy of tests/01simple.php example file<br>\r\n<br>\r\nWhen running the test.php browser stays blank and no file created.<br>\r\n<br>\r\nThis confirms to me that this is a bug because of the lighttpd webserver.<br>\r\n<br>\r\nI have opened Issue&nbsp;<span id=\"ctl00_ctl00_MasterContent_RightSideBar_WorkItemDetailsControl_DetailsSidebar_IssueIdLabel\">8965</span> for this in the Issue list.<br>\r\n<br>\r\nHopefully a quick solution can be found <br>\r\n",
    "PostedDate": "2009-01-19T12:53:09.637-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]