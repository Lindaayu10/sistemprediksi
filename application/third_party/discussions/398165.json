[
  {
    "Id": "922406",
    "ThreadId": "398165",
    "Html": "\r\n<p>is there any way to change the format date type from Reader Object&nbsp; into my desire like 'dd/mm/yyyy' or 'dd-mm-yyyy' . i mention this cause i try to logging the function of Worksheet-&gt;rangeToArray()&nbsp; , i added my line</p>\r\n<p>&nbsp;</p>\r\n<p></p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre>\t<span style=\"color:blue\">public</span> <span style=\"color:blue\">function</span> rangeToArray($pRange = <span style=\"color:#a31515\">'A1'</span>, $nullValue = null, $calculateFormulas = true, $formatData = true, $returnCellRef = false) {\r\n\t\t<span style=\"color:green\">// Returnvalue</span>\r\n\t\t$returnValue = <span style=\"color:blue\">array</span>();\r\n\r\n\t\t<span style=\"color:green\">//\tIdentify the range that we need to extract from the worksheet</span>\r\n\t\t<span style=\"color:blue\">list</span>($rangeStart, $rangeEnd) = PHPExcel_Cell::rangeBoundaries($pRange);\r\n\t\t$minCol = PHPExcel_Cell::stringFromColumnIndex($rangeStart[0] -1);\r\n\t\t$minRow = $rangeStart[1];\r\n\t\t$maxCol = PHPExcel_Cell::stringFromColumnIndex($rangeEnd[0] -1);\r\n\t\t$maxRow = $rangeEnd[1];\r\n\r\n\t\t$maxCol&#43;&#43;;\r\n\r\n\t\t<span style=\"color:green\">// Loop through rows</span>\r\n\t\t$r = -1;\r\n\t\t<span style=\"color:blue\">for</span> ($row = $minRow; $row &lt;= $maxRow; &#43;&#43;$row) {\r\n\t\t\t$rRef = ($returnCellRef) ? $row : &#43;&#43;$r;\r\n\t\t\t$c = -1;\r\n\t\t\t<span style=\"color:green\">// Loop through columns in the current row</span>\r\n\t\t\t<span style=\"color:blue\">for</span> ($col = $minCol; $col != $maxCol; &#43;&#43;$col) {\r\n\t\t\t\t$cRef = ($returnCellRef) ? $col : &#43;&#43;$c;\r\n\t\t\t\t<span style=\"color:green\">//\tUsing getCell() will create a new cell if it doesn't already exist. We don't want that to happen</span>\r\n\t\t\t\t<span style=\"color:green\">//\t\tso we test and retrieve directly against _cellCollection</span>\r\n\t\t\t\t<span style=\"color:blue\">if</span> ($this-&gt;_cellCollection-&gt;isDataSet($col.$row)) {\r\n\t\t\t\t\t<span style=\"color:green\">// Cell exists</span>\r\n\t\t\t\t\t$cell = $this-&gt;_cellCollection-&gt;getCacheData($col.$row);\r\n\t\t\t\t\t<span style=\"color:blue\">if</span> ($cell-&gt;getValue() !== null) {\r\n\t\t\t\t\t\t<span style=\"color:blue\">if</span> ($cell-&gt;getValue() <span style=\"color:blue\">instanceof</span> PHPExcel_RichText) {\r\n\t\t\t\t\t\t\t$returnValue[$rRef][$cRef] = $cell-&gt;getValue()-&gt;getPlainText();\r\n\t\t\t\t\t\t} <span style=\"color:blue\">else</span> {\r\n\t\t\t\t\t\t\t<span style=\"color:blue\">if</span> ($calculateFormulas) {\r\n\t\t\t\t\t\t\t\t$returnValue[$rRef][$cRef] = $cell-&gt;getCalculatedValue();\r\n\t\t\t\t\t\t\t} <span style=\"color:blue\">else</span> {\r\n\t\t\t\t\t\t\t\t$returnValue[$rRef][$cRef] = $cell-&gt;getValue();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t<span style=\"color:blue\">if</span> ($formatData) {\r\n\t\t\t\t\t\t    \r\n\t\t\t\t\t\t\t$style = $this-&gt;_parent-&gt;getCellXfByIndex($cell-&gt;getXfIndex());\r\n                                                         <span style=\"color:green\">//this is my line</span>\r\n\t\t\t\t\t\t\tlog_message(<span style=\"color:#a31515\">'info'</span>, $returnValue[$rRef][$cRef].<span style=\"color:#a31515\">' format_code:'</span>.$style-&gt;getNumberFormat()-&gt;getFormatCode());\r\n\t\t\t\t\t\t\t$returnValue[$rRef][$cRef] = PHPExcel_Style_NumberFormat::toFormattedString($returnValue[$rRef][$cRef], $style-&gt;getNumberFormat()-&gt;getFormatCode());\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} <span style=\"color:blue\">else</span> {\r\n\t\t\t\t\t\t<span style=\"color:green\">// Cell holds a NULL</span>\r\n\t\t\t\t\t\t$returnValue[$rRef][$cRef] = $nullValue;\r\n\t\t\t\t\t}\r\n\t\t\t\t} <span style=\"color:blue\">else</span> {\r\n\t\t\t\t\t<span style=\"color:green\">// Cell doesn't exist</span>\r\n\t\t\t\t\t$returnValue[$rRef][$cRef] = $nullValue;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t<span style=\"color:green\">// Return</span>\r\n\t\t<span style=\"color:blue\">return</span> $returnValue;\r\n\t}\r\n</pre>\r\n</div>\r\n<p></p>\r\n<p>&nbsp;and i always get lines like this:</p>\r\n<p>NURHAYATI DG NURUNG format_code:General<br>\r\nINFO&nbsp; - 2012-10-05 20:42:46 --&gt; SINJAI format_code:General<br>\r\nINFO&nbsp; - 2012-10-05 20:42:46 --&gt; 26115 format_code:mm-dd-yy<br>\r\nINFO&nbsp; - 2012-10-05 20:42:46 --&gt; 38 format_code:General</p>\r\n<p>&nbsp;</p>\r\n<p>let us focus in the line of INFO&nbsp; - 2012-10-05 20:42:46 --&gt; 26115 format_code:mm-dd-yy , i know it was MS Office Excel serial number of date.</p>\r\n<p>the mention are, how could i possibly hook the Reader classes object to format date data type like the example format_code mm-dd-yy , i want to change it something like dd-mm-yyyy , so i can get my desire result, is there any way except hacking the core\r\n classes?</p>\r\n<p>&nbsp;</p>\r\n",
    "PostedDate": "2012-10-05T06:01:19.473-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "922625",
    "ThreadId": "398165",
    "Html": "\r\n<p>Instead of getValue() use getFormattedValue().</p>\r\n<p>- Christopher Mullins</p>\r\n",
    "PostedDate": "2012-10-05T13:18:37.567-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "945954",
    "ThreadId": "398165",
    "Html": "\r\n<p>I am also looking for the best approach how to achieve this. I have tried to use getFormattedValue() &nbsp;but to no avail. Does anyone know how exactly we can set the desired date format when reading excel files?</p>\r\n",
    "PostedDate": "2012-11-22T21:35:22.5-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "945965",
    "ThreadId": "398165",
    "Html": "\r\n<p>I don't know if this is the right approach, but what I did is tweaked a little bit on the rangeToArray() function:<br>\r\n<br>\r\n</p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre>\t<span style=\"color:blue\">public</span> <span style=\"color:blue\">function</span> rangeToArray($pRange = <span style=\"color:#a31515\">'A1'</span>, $nullValue = null, $calculateFormulas = true, $formatData = true, $returnCellRef = false) {\r\n\t\t<span style=\"color:green\">// Returnvalue</span>\r\n\t\t$returnValue = <span style=\"color:blue\">array</span>();\r\n\r\n\t\t<span style=\"color:green\">//\tIdentify the range that we need to extract from the worksheet</span>\r\n\t\t<span style=\"color:blue\">list</span>($rangeStart, $rangeEnd) = PHPExcel_Cell::rangeBoundaries($pRange);\r\n\t\t$minCol = PHPExcel_Cell::stringFromColumnIndex($rangeStart[0] -1);\r\n\t\t$minRow = $rangeStart[1];\r\n\t\t$maxCol = PHPExcel_Cell::stringFromColumnIndex($rangeEnd[0] -1);\r\n\t\t$maxRow = $rangeEnd[1];\r\n\r\n\t\t$maxCol++;\r\n\r\n\t\t<span style=\"color:green\">// Loop through rows</span>\r\n\t\t$r = -1;\r\n\t\t<span style=\"color:blue\">for</span> ($row = $minRow; $row &lt;= $maxRow; ++$row) {\r\n\t\t\t$rRef = ($returnCellRef) ? $row : ++$r;\r\n\t\t\t$c = -1;\r\n\t\t\t<span style=\"color:green\">// Loop through columns in the current row</span>\r\n\t\t\t<span style=\"color:blue\">for</span> ($col = $minCol; $col != $maxCol; ++$col) {\r\n\t\t\t\t$cRef = ($returnCellRef) ? $col : ++$c;\r\n\t\t\t\t<span style=\"color:green\">//\tUsing getCell() will create a new cell if it doesn't already exist. We don't want that to happen</span>\r\n\t\t\t\t<span style=\"color:green\">//\t\tso we test and retrieve directly against _cellCollection</span>\r\n\t\t\t\t<span style=\"color:blue\">if</span> ($this-&gt;_cellCollection-&gt;isDataSet($col.$row)) {\r\n\t\t\t\t\t<span style=\"color:green\">// Cell exists</span>\r\n\t\t\t\t\t$cell = $this-&gt;_cellCollection-&gt;getCacheData($col.$row);\r\n\t\t\t\t\t<span style=\"color:green\">// if ($cell-&gt;getValue() !== null) {</span>\r\n\t\t\t\t\t<span style=\"color:blue\">if</span> ($cell-&gt;getFormattedValue() !== null) {\r\n\t\t\t\t\t\t<span style=\"color:green\">// if ($cell-&gt;getValue() instanceof PHPExcel_RichText) {</span>\r\n\t\t\t\t\t\t<span style=\"color:blue\">if</span> ($cell-&gt;getFormattedValue() <span style=\"color:blue\">instanceof</span> PHPExcel_RichText) {\r\n\t\t\t\t\t\t\t<span style=\"color:green\">// $returnValue[$rRef][$cRef] = $cell-&gt;getValue()-&gt;getPlainText();</span>\r\n\t\t\t\t\t\t\t$returnValue[$rRef][$cRef] = $cell-&gt;getFormattedValue()-&gt;getPlainText();\r\n\t\t\t\t\t\t} <span style=\"color:blue\">else</span> {\r\n\t\t\t\t\t\t\t<span style=\"color:blue\">if</span> ($calculateFormulas) {\r\n\t\t\t\t\t\t\t\t$returnValue[$rRef][$cRef] = $cell-&gt;getCalculatedValue();\r\n\t\t\t\t\t\t\t} <span style=\"color:blue\">else</span> {\r\n\t\t\t\t\t\t\t\t<span style=\"color:green\">// $returnValue[$rRef][$cRef] = $cell-&gt;getValue();</span>\r\n\t\t\t\t\t\t\t\t$returnValue[$rRef][$cRef] = $cell-&gt;getFormattedValue();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t<span style=\"color:blue\">if</span> ($formatData) {\r\n\t\t\t\t\t\t\t$style = $this-&gt;_parent-&gt;getCellXfByIndex($cell-&gt;getXfIndex());\r\n\t\t\t\t\t\t\t<span style=\"color:green\">/* Here is the line I changed */</span>\r\n\t\t\t\t\t\t\t<span style=\"color:blue\">if</span>(PHPExcel_Shared_Date::isDateTime($cell)) {\r\n\t\t\t\t\t\t\t\t$returnValue[$rRef][$cRef] = date(<span style=\"color:#a31515\">'Y-m-d'</span>, strtotime($returnValue[$rRef][$cRef]));\r\n\t\t\t\t\t\t\t}<span style=\"color:blue\">else</span>{\r\n\t\t\t\t\t\t\t\t$returnValue[$rRef][$cRef] = PHPExcel_Style_NumberFormat::toFormattedString($returnValue[$rRef][$cRef], $style-&gt;getNumberFormat()-&gt;getFormatCode());\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t<span style=\"color:green\">/* End */</span>\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} <span style=\"color:blue\">else</span> {\r\n\t\t\t\t\t\t<span style=\"color:green\">// Cell holds a NULL</span>\r\n\t\t\t\t\t\t$returnValue[$rRef][$cRef] = $nullValue;\r\n\t\t\t\t\t}\r\n\t\t\t\t} <span style=\"color:blue\">else</span> {\r\n\t\t\t\t\t<span style=\"color:green\">// Cell doesn't exist</span>\r\n\t\t\t\t\t$returnValue[$rRef][$cRef] = $nullValue;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t<span style=\"color:green\">//print_r($returnValue);</span>\r\n\t\t<span style=\"color:green\">// Return</span>\r\n\t\t<span style=\"color:blue\">return</span> $returnValue;\r\n\t}\r\n</pre>\r\n</div>\r\n<p></p>\r\n<p>&nbsp;</p>\r\n<p>Hope this would help others.</p>\r\n",
    "PostedDate": "2012-11-22T22:32:31.277-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "946003",
    "ThreadId": "398165",
    "Html": "\r\n<p>After a series of debugging I come up with the following:</p>\r\n<p></p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre>\n\t<span style=\"color:blue\">public</span> <span style=\"color:blue\">function</span> rangeToArray($pRange = <span style=\"color:#a31515\">'A1'</span>, $nullValue = null, $calculateFormulas = true, $formatData = true, $returnCellRef = false) {\n\t\t<span style=\"color:green\">// Returnvalue</span>\n\t\t$returnValue = <span style=\"color:blue\">array</span>();\n\n\t\t<span style=\"color:green\">//\tIdentify the range that we need to extract from the worksheet</span>\n\t\t<span style=\"color:blue\">list</span>($rangeStart, $rangeEnd) = PHPExcel_Cell::rangeBoundaries($pRange);\n\t\t$minCol = PHPExcel_Cell::stringFromColumnIndex($rangeStart[0] -1);\n\t\t$minRow = $rangeStart[1];\n\t\t$maxCol = PHPExcel_Cell::stringFromColumnIndex($rangeEnd[0] -1);\n\t\t$maxRow = $rangeEnd[1];\n\n\t\t$maxCol&#43;&#43;;\n\n\t\t<span style=\"color:green\">// Loop through rows</span>\n\t\t$r = -1; $k=0;\n\t\t<span style=\"color:blue\">for</span> ($row = $minRow; $row &lt;= $maxRow; &#43;&#43;$row) {\n\t\t\t$rRef = ($returnCellRef) ? $row : &#43;&#43;$r;\n\t\t\t$c = -1;\n\t\t\t\t\t\t\t$z=0;\n\t\t\t<span style=\"color:green\">// Loop through columns in the current row</span>\n\t\t\t<span style=\"color:blue\">for</span> ($col = $minCol; $col != $maxCol; &#43;&#43;$col) {\n\t\t\t\t$cRef = ($returnCellRef) ? $col : &#43;&#43;$c;\n\t\t\t\t<span style=\"color:green\">//\tUsing getCell() will create a new cell if it doesn't already exist. We don't want that to happen</span>\n\t\t\t\t<span style=\"color:green\">//\t\tso we test and retrieve directly against _cellCollection</span>\n\t\t\t\t<span style=\"color:blue\">if</span> ($this-&gt;_cellCollection-&gt;isDataSet($col.$row)) {\n\t\t\t\t\t<span style=\"color:green\">// Cell exists</span>\n\t\t\t\t\t$cell = $this-&gt;_cellCollection-&gt;getCacheData($col.$row);\n\t\t\t\t\t\n\t\t\t\t\t<span style=\"color:blue\">if</span>(PHPExcel_Shared_Date::isDateTime($cell)) {\n\t\t\t\t\t\t$this-&gt;_parent-&gt;getCellXfByIndex($cell-&gt;getXfIndex())-&gt;getNumberFormat()-&gt;setFormatCode(PHPExcel_Style_NumberFormat::FORMAT_DATE_YYYYMMDD2);\n\t\t\t\t\t}\n\t\t\t\t\t<span style=\"color:blue\">if</span> ($cell-&gt;getValue() !== null) {\n\t\t\t\t\t\t<span style=\"color:blue\">if</span> ($cell-&gt;getValue() <span style=\"color:blue\">instanceof</span> PHPExcel_RichText) {\n\t\t\t\t\t\t\t$returnValue[$rRef][$cRef] = $cell-&gt;getValue()-&gt;getPlainText();\n\t\t\t\t\t\t} <span style=\"color:blue\">else</span> {\n\t\t\t\t\t\t\t<span style=\"color:blue\">if</span> ($calculateFormulas) {\n\t\t\t\t\t\t\t\t$returnValue[$rRef][$cRef] = $cell-&gt;getCalculatedValue();\n\t\t\t\t\t\t\t} <span style=\"color:blue\">else</span> {\n\t\t\t\t\t\t\t\t$returnValue[$rRef][$cRef] = $cell-&gt;getValue();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t<span style=\"color:blue\">if</span> ($formatData) {\n\t\t\t\t\t\t\t$style = $this-&gt;_parent-&gt;getCellXfByIndex($cell-&gt;getXfIndex());\n\t\t\t\t\t\t\t<span style=\"color:green\">/* Here is the line I changed */</span>\n\t\t\t\t\t\t\t\t$returnValue[$rRef][$cRef] = PHPExcel_Style_NumberFormat::toFormattedString($returnValue[$rRef][$cRef], $style-&gt;getNumberFormat()-&gt;getFormatCode());\n\t\t\t\t\t\t\t<span style=\"color:green\">/* End */</span>\n\t\t\t\t\t\t}\n\t\t\t\t\t} <span style=\"color:blue\">else</span> {\n\t\t\t\t\t\t<span style=\"color:green\">// Cell holds a NULL</span>\n\t\t\t\t\t\t$returnValue[$rRef][$cRef] = $nullValue;\n\t\t\t\t\t}\n\t\t\t\t} <span style=\"color:blue\">else</span> {\n\t\t\t\t\t<span style=\"color:green\">// Cell doesn't exist</span>\n\t\t\t\t\t$returnValue[$rRef][$cRef] = $nullValue;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t<span style=\"color:green\">//print_r($returnValue);</span>\n\t\t<span style=\"color:green\">// Return</span>\n\t\t<span style=\"color:blue\">return</span> $returnValue;\n\t}\n</pre>\r\n</div>\r\n<p></p>\r\n<p>cheers!</p>\r\n",
    "PostedDate": "2012-11-23T00:09:06.023-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]