[
  {
    "Id": "902284",
    "ThreadId": "392544",
    "Html": "\r\n<p>I'm generating Excel files on the fly within my PHP application. I'm using the\r\n<code>Excel2007</code> format.</p>\r\n<p>When a user visits the URL that creates and forces the download of the Excel file, everything works great in all browsers **except for mobile Safari** (iPhone and iPad).</p>\r\n<p>Here are my headers and the `readfile` method:</p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre>header(<span style=\"color:#a31515\">'Content-type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'</span>);\nheader(<span style=\"color:#a31515\">'Content-disposition: attachment; filename='</span> . $file_name . <span style=\"color:#a31515\">'.xlsx;'</span>);\nheader(<span style=\"color:#a31515\">'Content-Length: '</span> . filesize($path_to_file . <span style=\"color:#a31515\">'.xlsx'</span>));\nreadfile($path_to_file . <span style=\"color:#a31515\">'.xlsx'</span>);\n</pre>\r\n</div>\r\n<p>When I browse in mobile Safari to the URL that is supposed to download the .xlsx file I can actually see the tabs representing each worksheet of the file, but I don't see the actual data like so:</p>\r\n<p><img src=\"http://i.stack.imgur.com/QRL50.png\" alt=\"\"></p>\r\n<p>Furthermore, there are two additional weird behaviors I'm encountering with this:</p>\r\n<ul>\r\n<li>If I download this file on a desktop browser and email it to myself and open it with the Mail app in iOS, the file displays correctly.\r\n</li><li>f I then take that attachment from the Mail app in iOS and import into, say, Dropbox, it does NOT display properly (it displays the same as the screenshot above).\r\n</li><li>In Chrome, the file downloads properly and opens in Excel or even Numbers as expected, but in the console I see this message:\r\n<code>Resource interpreted as Document but transferred with MIME type application/vnd.ms-excel:</code>\r\n</li></ul>\r\n<p>Also, per the PHPExcel documentation, in place of <code>readfile</code> I have also tried:</p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre>$objWriter-&gt;save(<span style=\"color:#a31515\">'php://output'</span>);</pre>\r\n</div>\r\n<p>That, however, produces an error in mobile Safari that reads: <code>OfficeImportErrorDomain Error 912</code></p>\r\n<p>To eliminate the <code>Content-type</code> as being the issue I've experimented by adjusting the `Content-type` to other values (such as\r\n<code>application/vnd.ms-excel</code> or even <code>application/download</code>). Unfortunately (though not surprisingly) those don't work either.</p>\r\n<p>Any guidance is greatly appreciate.</p>\r\n<p>By the way, I've posted this issue over at <a href=\"http://stackoverflow.com/q/12065269/1177191\">\r\nStack Overflow</a> as well.</p>\r\n",
    "PostedDate": "2012-08-21T19:45:38.353-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]