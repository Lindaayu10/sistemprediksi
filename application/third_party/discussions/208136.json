[
  {
    "Id": "426738",
    "ThreadId": "208136",
    "Html": "<p>Hello,</p>\r\n<p>got strange behaviour of autosize property in excel 2007 (WIN XP).</p>\r\n<p>&nbsp;</p>\r\n<p>Later i was using office xp, but need to see more than 65k rows in Excel, so switched to 2007 version.</p>\r\n<p>Problem is:</p>\r\n<p>If i generate excel file with Excel5 writer, AutoSize property seems to be ignored, so when i open downloaded file, column widths are not correct. Was fine in excel xp (office xp). The width was okey and bit wider than widest column content. But in 2007 it is not, widths are incorrect.</p>\r\n<p>If i generate excel file with Excel2007 writer i get &quot;corrupt content &amp; recovery&quot; message.</p>\r\n<p>I'm using php 5.2.13 version of dot.deb for lenny debian.</p>\r\n<p>According to phpinfo():</p>\r\n<h2><a name=\"module_zip\">zip</a></h2>\r\n<table border=0 cellpadding=3 width=600>\r\n<tbody>\r\n<tr>\r\n<td>Zip</td>\r\n<td>enabled</td>\r\n</tr>\r\n<tr>\r\n<td>Extension Version</td>\r\n<td>$Id: php_zip.c  293036 2010-01-03 09:23:27Z sebastian $</td>\r\n</tr>\r\n<tr>\r\n<td>Zip version</td>\r\n<td>1.8.11</td>\r\n</tr>\r\n<tr>\r\n<td>Libzip version</td>\r\n<td>0.9.0</td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n<p>&nbsp;</p>\r\n<h2><a name=\"module_zlib\">zlib</a></h2>\r\n<table border=0 cellpadding=3 width=600>\r\n<tbody>\r\n<tr>\r\n<td>ZLib Support</td>\r\n<td>enabled</td>\r\n</tr>\r\n<tr>\r\n<td>Stream Wrapper support</td>\r\n<td>compress.zlib://</td>\r\n</tr>\r\n<tr>\r\n<td>Stream Filter support</td>\r\n<td>zlib.inflate,  zlib.deflate</td>\r\n</tr>\r\n<tr>\r\n<td>Compiled Version</td>\r\n<td>1.2.1.1</td>\r\n</tr>\r\n<tr>\r\n<td>Linked Version</td>\r\n<td>1.2.3.3</td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n<p>My code :</p>\r\n<p>&nbsp;</p>\r\n<p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre>\t<span style=\"color:Blue\">require_once</span> <span style=\"color:#A31515\">'../lib/Classes/PHPExcel.php'</span>;\r\n\t<span style=\"color:Blue\">require_once</span> <span style=\"color:#A31515\">'../lib/Classes/PHPExcel/IOFactory.php'</span>;\r\n\t\r\n\t$objPHPExcel = <span style=\"color:Blue\">new</span> PHPExcel();\r\n\t\t\r\n\t\r\n\t$objPHPExcel-&gt;getActiveSheet(0)-&gt;setCellValue(<span style=\"color:#A31515\">'A1'</span>, <span style=\"color:#A31515\">'date'</span>);\r\n\t$objPHPExcel-&gt;getActiveSheet(0)-&gt;setCellValue(<span style=\"color:#A31515\">'B1'</span>, <span style=\"color:#A31515\">'number'</span>);\r\n\t$objPHPExcel-&gt;getActiveSheet(0)-&gt;setCellValue(<span style=\"color:#A31515\">'C1'</span>, <span style=\"color:#A31515\">'num'</span>);\r\n\t$objPHPExcel-&gt;getActiveSheet(0)-&gt;setCellValue(<span style=\"color:#A31515\">'D1'</span>, <span style=\"color:#A31515\">'make'</span>);\r\n\t$objPHPExcel-&gt;getActiveSheet(0)-&gt;setCellValue(<span style=\"color:#A31515\">'E1'</span>, <span style=\"color:#A31515\">'me'</span>);\r\n\t$objPHPExcel-&gt;getActiveSheet(0)-&gt;setCellValue(<span style=\"color:#A31515\">'F1'</span>, <span style=\"color:#A31515\">'quantity'</span>);\r\n\t$objPHPExcel-&gt;getActiveSheet(0)-&gt;setCellValue(<span style=\"color:#A31515\">'G1'</span>, <span style=\"color:#A31515\">'what'</span>);\r\n\t$objPHPExcel-&gt;getActiveSheet(0)-&gt;setCellValue(<span style=\"color:#A31515\">'H1'</span>, <span style=\"color:#A31515\">'user'</span>);\r\n\r\n\t\r\n\t$i = 2;\r\n\t\r\n\t<span style=\"color:Blue\">while</span> ($excl = mysql_fetch_assoc($excel)){\r\n\t$objPHPExcel-&gt;getActiveSheet(0)-&gt;setCellValue(<span style=\"color:#A31515\">'A'</span>.$i, $date[<span style=\"color:#A31515\">'when'</span>]);\r\n\t\t\r\n\t$objPHPExcel-&gt;getActiveSheet(0)-&gt;setCellValue(<span style=\"color:#A31515\">'B'</span>.$i, $excl[<span style=\"color:#A31515\">'number'</span>]);\r\n\t$objPHPExcel-&gt;getActiveSheet(0)-&gt;setCellValue(<span style=\"color:#A31515\">'C'</span>.$i, <span style=\"color:#A31515\">'NUM'</span>);\r\n\t$objPHPExcel-&gt;getActiveSheet(0)-&gt;setCellValue(<span style=\"color:#A31515\">'D'</span>.$i, $excl[<span style=\"color:#A31515\">'make'</span>]);\r\n\t\t\r\n\t$objPHPExcel-&gt;getActiveSheet(0)-&gt;getCell(<span style=\"color:#A31515\">'E'</span>.$i)-&gt;setValueExplicit($excl[<span style=\"color:#A31515\">'me'</span>], PHPExcel_Cell_DataType::TYPE_STRING);\r\n\t\r\n\t\t\r\n\t$objPHPExcel-&gt;getActiveSheet(0)-&gt;setCellValue(<span style=\"color:#A31515\">'F'</span>.$i, $excl[<span style=\"color:#A31515\">'quant'</span>]);\r\n\t\t\r\n\t$objPHPExcel-&gt;getActiveSheet(0)-&gt;setCellValue(<span style=\"color:#A31515\">'G'</span>.$i, $excl[<span style=\"color:#A31515\">'what'</span>]);\r\n\t$objPHPExcel-&gt;getActiveSheet(0)-&gt;setCellValue(<span style=\"color:#A31515\">'H'</span>.$i, $excl[<span style=\"color:#A31515\">'user'</span>]);\r\n\t\t\r\n\t\r\n\t$i++;\r\n\t}\r\n\t\r\n\t$objPHPExcel-&gt;getActiveSheet(0)-&gt;getColumnDimension(<span style=\"color:#A31515\">'A'</span>)-&gt;setAutoSize(true);\r\n\t$objPHPExcel-&gt;getActiveSheet(0)-&gt;getColumnDimension(<span style=\"color:#A31515\">'B'</span>)-&gt;setAutoSize(true);\r\n\t$objPHPExcel-&gt;getActiveSheet(0)-&gt;getColumnDimension(<span style=\"color:#A31515\">'C'</span>)-&gt;setAutoSize(true);\r\n\t$objPHPExcel-&gt;getActiveSheet(0)-&gt;getColumnDimension(<span style=\"color:#A31515\">'D'</span>)-&gt;setAutoSize(true);\r\n\t$objPHPExcel-&gt;getActiveSheet(0)-&gt;getColumnDimension(<span style=\"color:#A31515\">'E'</span>)-&gt;setAutoSize(true);\r\n\t$objPHPExcel-&gt;getActiveSheet(0)-&gt;getColumnDimension(<span style=\"color:#A31515\">'F'</span>)-&gt;setAutoSize(true);\r\n\t$objPHPExcel-&gt;getActiveSheet(0)-&gt;getColumnDimension(<span style=\"color:#A31515\">'G'</span>)-&gt;setAutoSize(true);\r\n\t$objPHPExcel-&gt;getActiveSheet(0)-&gt;getColumnDimension(<span style=\"color:#A31515\">'H'</span>)-&gt;setAutoSize(true);\t\t\r\n\t\t\t\r\n$objPHPExcel-&gt;setActiveSheetIndex(0);\r\n\theader(<span style=\"color:#A31515\">'Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet; charset=utf-8'</span>);\r\n\theader(<span style=\"color:#A31515\">'Content-Disposition: attachment;filename=&quot;myfile.xlsx&quot;'</span>);\r\n\theader(<span style=\"color:#A31515\">'Cache-Control: max-age=0'</span>);\r\n\theader(<span style=\"color:#A31515\">&quot;Content-Transfer-Encoding: binary\\n&quot;</span>);\r\n\t$objWriter = <span style=\"color:Blue\">new</span> PHPExcel_Writer_Excel2007($objPHPExcel);\r\n\t$objWriter-&gt;setOffice2003Compatibility(true);\r\n\t$objWriter-&gt;save(<span style=\"color:#A31515\">'php://output'</span>);\r\n<br><br>The code for outputting Excel5 writer's output is from manual, so as for 2007, i don't quote it here.<br><br>Maby i'm missing updated version of something or doing something wrong?<br><br>Using PHPExcel 42439 from snapshots. <br><br>Thanks.</pre>\r\n</div>\r\n</p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2010-04-01T23:56:56.37-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "427392",
    "ThreadId": "208136",
    "Html": "<p>There was a temporary problem in the snapshots where calculation of column width was skipped in Excel5 writer. Can you try again with latest source code:</p>\r\n<p><a href=\"http://phpexcel.codeplex.com/SourceControl/list/changesets\">http://phpexcel.codeplex.com/SourceControl/list/changesets</a></p>\r\n<p>Not sure what the problem is with Excel2007. Can you try to remove this line and see if it gets better:</p>\r\n<pre>$objWriter-&gt;setOffice2003Compatibility(true);<br></pre>",
    "PostedDate": "2010-04-05T04:13:29.81-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "433747",
    "ThreadId": "208136",
    "Html": "<p>Hello,</p>\r\n<p>&nbsp;</p>\r\n<p>with current latest Excel5 seems to be ok, Excel2007 is still &quot;broken&quot; (wants to recover file contents )</p>",
    "PostedDate": "2010-04-21T09:34:14.1-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]