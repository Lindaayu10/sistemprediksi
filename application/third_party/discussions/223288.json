[
  {
    "Id": "479437",
    "ThreadId": "223288",
    "Html": "<p>Hi, I am very new to this. Your help would be greatly appreciated. I would like to know how to export data from a MySql table into an excel spreadsheet. I have the knowledge to get the information from the database to the spreadsheet but how do I have the code repeat until all data is echoed onto the page?</p>\r\n<p>Here is what I have already. This produces only a single row of results from the database...just need to know how to get it all onto the spreadsheet!</p>\r\n<p>\r\n<div style=\"color:black;background-color:white\">\r\n<pre>&lt;?php\r\n\r\n<span style=\"color:green\">/** Error reporting */</span>\r\nerror_reporting(E_ALL);\r\n\r\n<span style=\"color:green\">/** PHPExcel */</span>\r\n<span style=\"color:blue\">require_once</span> <span style=\"color:#a31515\">'../Classes/PHPExcel.php'</span>;\r\n\r\n\r\n<span style=\"color:green\">// Create new PHPExcel object</span>\r\n$objPHPExcel = <span style=\"color:blue\">new</span> PHPExcel();\r\n\r\n<span style=\"color:blue\">require_once</span>(<span style=\"color:#a31515\">'../includes/connection.php'</span>);\r\n\r\n$result = mysqli_query($connection,<span style=\"color:#a31515\">&quot;SELECT * FROM students ORDER BY school ASC&quot;</span>)\r\n<span style=\"color:blue\">or</span> <span style=\"color:blue\">die</span>(mysqli_error($connection));\r\n\r\n<span style=\"color:blue\">while</span>($row = mysqli_fetch_array($result)) {\r\n\r\n<span style=\"color:green\">//get all rows you want from the tutors table</span>\r\n\r\n$school = $row[<span style=\"color:#a31515\">'school'</span>];\r\n\r\n}\r\n\r\n<span style=\"color:green\">// Set properties</span>\r\n$objPHPExcel-&gt;getProperties()-&gt;setCreator(<span style=\"color:#a31515\">&quot;Somebody&quot;</span>)\r\n\t\t\t\t\t\t\t -&gt;setLastModifiedBy(<span style=\"color:#a31515\">&quot;Somebody&quot;</span>)\r\n\t\t\t\t\t\t\t -&gt;setTitle($school.<span style=\"color:#a31515\">&quot;Student List&quot;</span>)\r\n\t\t\t\t\t\t\t -&gt;setSubject($school.<span style=\"color:#a31515\">&quot;Student List&quot;</span>)\r\n\t\t\t\t\t\t\t -&gt;setDescription(<span style=\"color:#a31515\">&quot;Student List at &quot;</span>.$school)\r\n\t\t\t\t\t\t\t -&gt;setKeywords(<span style=\"color:#a31515\">&quot;Student List&quot;</span>)\r\n\t\t\t\t\t\t\t -&gt;setCategory(<span style=\"color:#a31515\">&quot;Student List&quot;</span>);\r\n\r\n\r\n<span style=\"color:green\">// Add some data</span>\r\n\r\n$result = mysqli_query($connection,<span style=\"color:#a31515\">&quot;SELECT * FROM students ORDER BY school ASC&quot;</span>)\r\n<span style=\"color:blue\">or</span> <span style=\"color:blue\">die</span>(mysqli_error($connection));\r\n\r\n<span style=\"color:blue\">while</span>($row = mysqli_fetch_array($result)) {\r\n\r\n<span style=\"color:green\">//get all rows you want from the tutors table</span>\r\n\r\n$id = $row[<span style=\"color:#a31515\">'id'</span>];\r\n$full_name = $row[<span style=\"color:#a31515\">'full_name'</span>];\r\n$school = $row[<span style=\"color:#a31515\">'school'</span>];\r\n$year = $row[<span style=\"color:#a31515\">'school_year'</span>];\r\n$<span style=\"color:blue\">class</span> = $row[<span style=\"color:#a31515\">'class'</span>];\r\n$contact = $row[<span style=\"color:#a31515\">'contact'</span>];\r\n$phone_h = $row[<span style=\"color:#a31515\">'phone_h'</span>];\r\n$phone_m = $row[<span style=\"color:#a31515\">'phone_m'</span>];\r\n$tutor_1 = $row[<span style=\"color:#a31515\">'tutor_1'</span>];\r\n\r\n$objPHPExcel-&gt;setActiveSheetIndex(0)\r\n            -&gt;setCellValue(<span style=\"color:#a31515\">'A1'</span>, $full_name)\r\n            -&gt;setCellValue(<span style=\"color:#a31515\">'B1'</span>, $contact)\r\n            -&gt;setCellValue(<span style=\"color:#a31515\">'C1'</span>, $year.$<span style=\"color:blue\">class</span>)\r\n            -&gt;setCellValue(<span style=\"color:#a31515\">'D1'</span>, $tutor_1);\r\n\r\n}\r\n\r\n<span style=\"color:green\">// Rename sheet</span>\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setTitle(<span style=\"color:#a31515\">'Simple'</span>);\r\n\r\n\r\n<span style=\"color:green\">// Set active sheet index to the first sheet, so Excel opens this as the first sheet</span>\r\n$objPHPExcel-&gt;setActiveSheetIndex(0);\r\n\r\n\r\n<span style=\"color:green\">// Redirect output to a client&rsquo;s web browser (Excel5)</span>\r\nheader(<span style=\"color:#a31515\">'Content-Type: application/vnd.ms-excel'</span>);\r\nheader(<span style=\"color:#a31515\">'Content-Disposition: attachment;filename=&quot;01simple.xls&quot;'</span>);\r\nheader(<span style=\"color:#a31515\">'Cache-Control: max-age=0'</span>);\r\n\r\n$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, <span style=\"color:#a31515\">'Excel5'</span>);\r\n$objWriter-&gt;save(<span style=\"color:#a31515\">'php://output'</span>);\r\n<span style=\"color:blue\">exit</span>;\r\n?&gt;\r\n</pre>\r\n</div>\r\n</p>",
    "PostedDate": "2010-08-11T17:56:53.777-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "482747",
    "ThreadId": "223288",
    "Html": "<p>I also don't get this working..</p>",
    "PostedDate": "2010-08-20T06:00:07.707-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "482759",
    "ThreadId": "223288",
    "Html": "<p>Increment the row number for the Excel cell references for each row that you read from the database</p>\r\n<p><span style=\"color:blue\">\r\n<div style=\"color:black;background-color:white\">\r\n<pre>$row = 1;\r\n<span style=\"color:blue\">while</span>($row = mysqli_fetch_array($result)) {\r\n\r\n<span style=\"color:green\">   //get all rows you want from the tutors table</span>\r\n\r\n   $id = $row[<span style=\"color:#a31515\">'id'</span>];\r\n   $full_name = $row[<span style=\"color:#a31515\">'full_name'</span>];\r\n   $school = $row[<span style=\"color:#a31515\">'school'</span>];\r\n   $year = $row[<span style=\"color:#a31515\">'school_year'</span>];\r\n   $<span style=\"color:blue\">class</span> = $row[<span style=\"color:#a31515\">'class'</span>];\r\n   $contact = $row[<span style=\"color:#a31515\">'contact'</span>];\r\n   $phone_h = $row[<span style=\"color:#a31515\">'phone_h'</span>];\r\n   $phone_m = $row[<span style=\"color:#a31515\">'phone_m'</span>];\r\n   $tutor_1 = $row[<span style=\"color:#a31515\">'tutor_1'</span>];\r\n\r\n   $objPHPExcel-&gt;setActiveSheetIndex(0)\r\n            -&gt;setCellValue(<span style=\"color:#a31515\">'A'</span>.$row, $full_name)\r\n            -&gt;setCellValue(<span style=\"color:#a31515\">'B'</span>.$row, $contact)\r\n            -&gt;setCellValue(<span style=\"color:#a31515\">'C'</span>.$row, $year.$<span style=\"color:blue\">class</span>)\r\n            -&gt;setCellValue(<span style=\"color:#a31515\">'D'</span>.$row, $tutor_1);\r\n   $row++;\r\n}\r\n</pre>\r\n</div>\r\n</span></p>",
    "PostedDate": "2010-08-20T06:10:37.667-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "482775",
    "ThreadId": "223288",
    "Html": "<p>haha thanks! That was stupid :P Put everything in one cell haha</p>",
    "PostedDate": "2010-08-20T06:49:40.373-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]