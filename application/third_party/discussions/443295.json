[
  {
    "Id": "1042071",
    "ThreadId": "443295",
    "Html": "I'm creating a list with Work Places like so (sheet 2 by name &quot;dataValidation&quot;)<br />\n<pre><code>  $sql-&gt;query(&quot;select * from workPlaces order by workPlaceName ASC&quot;); \n  while($sql-&gt;get_assoc()){                \n    $sheet-&gt;setCellValue(&quot;A$currentRow&quot;,&quot;workPlace&quot;.$sql-&gt;get_acol('workPlaceId'));\n    $sheet-&gt;setCellValue(&quot;B$currentRow&quot;,$sql-&gt;get_acol('workPlaceName'));\n    $workPlaceIds[$sql-&gt;get_acol('workPlaceId')]=$currentRow;\n    $currentRow++;\n  }\n  $sheet-&gt;setCellValue(&quot;A$currentRow&quot;,&quot;workPlace&quot;);\n  $sheet-&gt;setCellValue(&quot;B$currentRow&quot;,&quot;Select Work Place&quot;);</code></pre>\n\nthen adding some comitees under each work place:<br />\n<pre><code>  $sql1-&gt;query(&quot;select * from comitees order by workPlaceId ASC&quot;);\n  while($sql1-&gt;get_row()) {\n    $id = $sql1-&gt;get_col();\n    $wid = $sql1-&gt;get_col();\n    if(!$owid) { $owid=$wid; }\n    $name = $sql1-&gt;get_col();\n    $sheet-&gt;setCellValue(&quot;A$currentRow&quot;,$id);\n    $sheet-&gt;setCellValue(&quot;B$currentRow&quot;,$name);\n    if($wid!=$owid) {\n      $name = &quot;workPlace$owid&quot;;\n      $owid = $wid;\n      $excel-&gt;addNamedRange(new PHPExcel_NamedRange($name,$sheet,&quot;B{$comitees['start']}:B$currentRow&quot;));\n      $comitees['start']=$currentRow+1;\n    }\n    $currentRow++;\n  }</code></pre>\n\nSo list with Work Places and Comitees (with named ranges) works fine, then adding Data Validation in 1st sheet named &quot;Form&quot;:<br />\n<pre><code>  echo $range = &quot;{$range['column']}{$range['start']}:{$range['column']}{$range['end']}&quot;; // makes list from work Places\n  $cell = &quot;A1&quot;\n  $objValidation = $sheet-&gt;getCell($cell)-&gt;getDataValidation();\n  $objValidation-&gt;setType( PHPExcel_Cell_DataValidation::TYPE_LIST );\n  $objValidation-&gt;setErrorStyle( PHPExcel_Cell_DataValidation::STYLE_STOP );\n  $objValidation-&gt;setAllowBlank(true);\n  $objValidation-&gt;setShowDropDown(true);\n  $objValidation-&gt;setFormula1(&quot;dataValidation!$range&quot;);\n  $sheet-&gt;setCellValue($cell,&quot;Select Work Place&quot;);</code></pre>\n\nup until this moment, everything works fine. but adding next data validation, Excel says that something is wrong, and removes every data validation.<br />\n<pre><code>  $cell = &quot;A2&quot;;\n  $objValidation = $sheet-&gt;getCell($cell)-&gt;getDataValidation();\n  $objValidation-&gt;setType( PHPExcel_Cell_DataValidation::TYPE_LIST );\n  $objValidation-&gt;setErrorStyle( PHPExcel_Cell_DataValidation::STYLE_STOP );\n  $objValidation-&gt;setAllowBlank(true);\n  $objValidation-&gt;setShowDropDown(true);\n  $objValidation-&gt;setFormula1(&quot;=INDIRECT(LOOKUP(A1;dataValidation!B1:dataValidation!B&quot;.count($workPlaceIds).&quot;;dataValidation!A1:dataValidation!A&quot;.count($workPlaceIds).&quot;))&quot;);</code></pre>\n\nbut when i add formula:<br />\n<pre><code>  $objValidation-&gt;setFormula1('=INDIRECT(&quot;workPlace3&quot;))');</code></pre>\n\nit shows list wich is from Named range workPlace3\r<br />\n<br />\ni tried to print that &quot;not&quot; working function and copy it in excel manually, and that didn't seem to show up errors.\r<br />\n<br />\nAny ideas how to make it work ?<br />\n",
    "PostedDate": "2013-05-10T13:53:54.907-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1042500",
    "ThreadId": "443295",
    "Html": "Sorry, all sorted out! didn't know that setting formulas you have to use comma instead of semicolon.<br />\n",
    "PostedDate": "2013-05-12T11:53:34.45-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]