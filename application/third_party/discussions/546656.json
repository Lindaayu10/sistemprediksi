[
  {
    "Id": "1249849",
    "ThreadId": "546656",
    "Html": "I have 60,000 rows to write in an excel each one with 11 columns and it takes so long time and through the error message &quot;The server at localhost is taking too long to respond&quot;.\r<br />\n<br />\nHere is my code<br />\n<pre><code>sec_session_start();\nerror_reporting(E_ALL);\nini_set('display_errors', TRUE);\nini_set('display_startup_errors', TRUE);\nini_set('max_execution_time', 680);\nini_set('memory_limit', '-1');\ndefine('EOL',(PHP_SAPI == 'cli') ? PHP_EOL : '&lt;br /&gt;');\n\n/** Include PHPExcel */\nrequire_once dirname(__FILE__) . '\\Classes\\PHPExcel.php';\n\n// Create new PHPExcel object\n$objPHPExcel = new PHPExcel();\n\n// Set document properties\n$objPHPExcel-&gt;getProperties()-&gt;setCreator(&quot;Maarten Balliauw&quot;)\n                             -&gt;setLastModifiedBy(&quot;Maarten Balliauw&quot;)\n                             -&gt;setTitle(&quot;Office 2007 XLSX Test Document&quot;)\n                             -&gt;setSubject(&quot;Office 2007 XLSX Test Document&quot;)\n                             -&gt;setDescription(&quot;Test document for Office 2007 XLSX, generated using PHP classes.&quot;)\n                             -&gt;setKeywords(&quot;office 2007 openxml php&quot;)\n                             -&gt;setCategory(&quot;Test result file&quot;);\n\n\n// Create a first sheet\n//echo date('H:i:s') , &quot; Add data&quot; , EOL;\n$objPHPExcel-&gt;setActiveSheetIndex(0);\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('A1', &quot;column1&quot;);\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('B1', &quot;column2&quot;);\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('C1', &quot;column3&quot;);\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('D1', &quot;column4&quot;);\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('E1', &quot;Test1&quot;);\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('F1', &quot;test2&quot;);\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('G1', &quot;Customer Name&quot;);\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('H1', &quot;Product Group&quot;);\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('I1', &quot;Product Segment&quot;);\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('J1', &quot;Product Type&quot;);\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('K1', &quot;Product Code&quot;);\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('L1', &quot;Product Description&quot;);\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('M1', &quot;Sales Voucher Type&quot;);\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('N1', &quot;Quantity&quot;);\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('O1', &quot;Net Amount&quot;);\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('P1', &quot;Tax Amount&quot;);\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('Q1', &quot;Gross Amount&quot;);\n\n// Freeze panes\n$objPHPExcel-&gt;getActiveSheet()-&gt;freezePane('A2');\n\n\n// Rows to repeat at top\n$objPHPExcel-&gt;getActiveSheet()-&gt;getPageSetup()-&gt;setRowsToRepeatAtTopByStartAndEnd(1, 1);\n\n\n// Add data\n$url = 'http://localhost:8090/solr/salesreport/select?q='.$_SESSION['form_controls'].'&amp;wt=xml&amp;start=0&amp;rows=200000&amp;indent=true';\n$xml = simplexml_load_file($url);\n//$test = $xml-&gt;result[numFound];\n$i=2;\n$j=1;\n// Set active sheet index to the first sheet, so Excel opens this as the first sheet\n$objPHPExcel-&gt;setActiveSheetIndex(0);\nforeach($xml-&gt;result-&gt;children() as $VOUCHER)\n {\n    \n    $salesdate = date('d-m-Y',strtotime($VOUCHER-&gt;str[4])) ;\n    $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('A' . $i, $VOUCHER-&gt;str[8])\n                                  -&gt;setCellValue('B' . $i, $VOUCHER-&gt;str[16])\n                                  -&gt;setCellValue('C' . $i, $VOUCHER-&gt;str[17])\n                                  -&gt;setCellValue('D' . $i, $VOUCHER-&gt;str[18])\n                                  -&gt;setCellValue('E' . $i, $VOUCHER-&gt;str[11])\n                                  -&gt;setCellValue('F' . $i, $salesdate)\n                                  -&gt;setCellValue('G' . $i, $VOUCHER-&gt;str[5])\n                                  -&gt;setCellValue('H' . $i, $VOUCHER-&gt;str[10])\n                                  -&gt;setCellValue('I' . $i, $VOUCHER-&gt;str[3])\n                                  -&gt;setCellValue('J' . $i, $VOUCHER-&gt;str[15])\n                                  -&gt;setCellValue('K' . $i, $VOUCHER-&gt;str[0])\n                                  -&gt;setCellValue('L' . $i, $VOUCHER-&gt;str[1])\n                                  -&gt;setCellValue('M' . $i, $VOUCHER-&gt;str[14])\n                                  -&gt;setCellValue('N' . $i, $VOUCHER-&gt;str[13])\n                                  -&gt;setCellValue('O' . $i, $VOUCHER-&gt;str[6])\n                                  -&gt;setCellValue('P' . $i, $VOUCHER-&gt;str[2])\n                                  -&gt;setCellValue('Q' . $i, $VOUCHER-&gt;str[12]);\n                                  $i++;\n}\n\n// Redirect output to a clientâ€™s web browser (Excel2007)\nheader('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');\nheader('Content-Disposition: attachment;filename=&quot;Salesreport.xlsx&quot;');\nheader('Cache-Control: max-age=0');\nIf you're serving to IE 9, then the following may be needed\nheader('Cache-Control: max-age=1');\n\nIf you're serving to IE over SSL, then the following may be needed\nheader ('Expires: Mon, 26 Jul 1997 05:00:00 GMT'); // Date in the past\nheader ('Last-Modified: '.gmdate('D, d M Y H:i:s').' GMT'); // always modified\nheader ('Cache-Control: cache, must-revalidate'); // HTTP/1.1\nheader ('Pragma: public'); // HTTP/1.0\n\n$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, 'Excel2007');\n$objWriter-&gt;save('php://output');\nexit;</code></pre>\n\nIs there any chance to improve my code and get the excel export for huge records and make it faster?? <br />\n",
    "PostedDate": "2014-05-26T23:11:18.86-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]