[
  {
    "Id": "692770",
    "ThreadId": "278057",
    "Html": "<p>Hi All!</p>\n<p>I honestly spend last 2h looking for some solution. Im using php function (Code 1) in order to display query results.</p>\n<p>Im trying to ad link/Icon - \"Save as Excel File\" on every dynamically generated page.</p>\n<p>I found code (Code 2) but using RAW output from SQL is not perfect solution,</p>\n<p>I would like to process data with php and generate static HTML table and add option to save this table as Excel file if needed.</p>\n<p>Thank you in advance for any help.</p>\n<p>Code 1</p>\n<div style=\"color: black; background-color: white;\">\n<pre>&lt;?php\r\n<span style=\"color: blue;\">function</span> <span style=\"color: blue;\">list</span>() {\r\n <span style=\"color: blue;\">include</span>(<span style=\"color: #a31515;\">\"dbset.php\"</span>); <span style=\"color: green;\">//start SQL connection</span>\r\n $q = mysql_query(<span style=\"color: #a31515;\">\"SELECT \"</span>) <span style=\"color: blue;\">or</span> <span style=\"color: blue;\">die</span> (<span style=\"color: #a31515;\">'SQL Error !&lt;br&gt;'</span>.$q.<span style=\"color: #a31515;\">'&lt;br&gt;'</span>.mysql_error());\r\n <span style=\"color: blue;\">echo</span> <span style=\"color: #a31515;\">\"&lt;table id=\\\"staff-table\\\" width=\\\"100%\\\" border=\\\"0\\\" cellspacing=\\\"0\\\" cellpadding=\\\"0\\\"&gt;\"</span>;\r\n <span style=\"color: blue;\">echo</span> \"&lt;colgroup&gt;\r\n &lt;col <span style=\"color: blue;\">class</span>=\\\"col1\\\" /&gt;\r\n &lt;col <span style=\"color: blue;\">class</span>=\\\"col2\\\" /&gt;\r\n &lt;col <span style=\"color: blue;\">class</span>=\\\"col3\\\" /&gt;\r\n &lt;col <span style=\"color: blue;\">class</span>=\\\"col4\\\" /&gt;\r\n &lt;col <span style=\"color: blue;\">class</span>=\\\"col5\\\" /&gt;\r\n &lt;col <span style=\"color: blue;\">class</span>=\\\"col6\\\" /&gt;\r\n &lt;/colgroup&gt;\";\r\n <span style=\"color: blue;\">echo</span> <span style=\"color: #a31515;\">\"&lt;tr&gt;&lt;td colspan=\\\"6\\\" scope=\\\"col\\\"&gt;&lt;span class=\\\"bold\\\"&gt;Training Name: &lt;/span&gt;\"</span>;\r\n <span style=\"color: blue;\">echo</span> <span style=\"color: #a31515;\">\"&lt;/tD&gt;&lt;/tr&gt;\"</span>;\r\n <span style=\"color: blue;\">echo</span> <span style=\"color: #a31515;\">\"&lt;tr&gt;&lt;td colspan=\\\"6\\\" scope=\\\"col\\\"&gt;&lt;span class=\\\"bold\\\"&gt;Training Description: &lt;/span&gt;\"</span>;\r\n <span style=\"color: blue;\">echo</span> <span style=\"color: #a31515;\">\"&lt;/tD&gt;&lt;/tr&gt;\"</span>;\r\n <span style=\"color: blue;\">echo</span> <span style=\"color: #a31515;\">\"&lt;tr&gt;&lt;td colspan=\\\"6\\\" scope=\\\"col\\\"&gt;&lt;span class=\\\"bold\\\"&gt;Number of unique entries: &lt;/span&gt;\"</span>;\r\n <span style=\"color: blue;\">echo</span> <span style=\"color: #a31515;\">\"&lt;/tD&gt;&lt;/tr&gt;\"</span>;\r\n <span style=\"color: blue;\">echo</span> <span style=\"color: #a31515;\">\"&lt;tr&gt;\"</span>;\r\n <span style=\"color: blue;\">echo</span> <span style=\"color: #a31515;\">\"&lt;th scope=\\\"col\\\" width=\\\"10%\\\"&gt;&lt;span class=\\\"class2\\\"&gt;1&lt;/span&gt;&lt;/th&gt;\"</span>;\r\n <span style=\"color: blue;\">echo</span> <span style=\"color: #a31515;\">\"&lt;th scope=\\\"col\\\" width=\\\"18%\\\"&gt;&lt;span class=\\\"class2\\\"&gt;2&lt;/span&gt;&lt;/th&gt;\"</span>;\r\n <span style=\"color: blue;\">echo</span> <span style=\"color: #a31515;\">\"&lt;th scope=\\\"col\\\" width=\\\"18%\\\"&gt;&lt;span class=\\\"class2\\\"&gt;3&lt;/span&gt;&lt;/th&gt;\"</span>;\r\n <span style=\"color: blue;\">echo</span> <span style=\"color: #a31515;\">\"&lt;th scope=\\\"col\\\" width=\\\"12%\\\"&gt;&lt;span class=\\\"class2\\\"&gt;4&lt;/span&gt;&lt;/th&gt;\"</span>;\r\n <span style=\"color: blue;\">echo</span> <span style=\"color: #a31515;\">\"&lt;th scope=\\\"col\\\" width=\\\"20%\\\"&gt;&lt;span class=\\\"class2\\\"&gt;5&lt;/span&gt;&lt;/th&gt;\"</span>;\r\n <span style=\"color: blue;\">echo</span> <span style=\"color: #a31515;\">\"&lt;th scope=\\\"col\\\" width=\\\"22%\\\"&gt;&lt;span class=\\\"class2\\\"&gt;6&lt;/span&gt;&lt;/th&gt;\"</span>;\r\n <span style=\"color: blue;\">echo</span> <span style=\"color: #a31515;\">\"&lt;/tr&gt;\"</span>;\r\n $t = 1; <span style=\"color: green;\">// colors changer for rows</span>\r\n <span style=\"color: blue;\">while</span> ($a = mysql_fetch_array($q)) {\r\n <span style=\"color: blue;\">echo</span> <span style=\"color: #a31515;\">\"&lt;tr class=\\\"d$t\\\"&gt;\"</span>;\r\n <span style=\"color: blue;\">echo</span> <span style=\"color: #a31515;\">\"&lt;td&gt;\"</span>.$a[<span style=\"color: #a31515;\">''</span>].<span style=\"color: #a31515;\">\"&lt;/td&gt;\"</span>;\r\n <span style=\"color: blue;\">echo</span> <span style=\"color: #a31515;\">\"&lt;td&gt;\"</span>.$a[<span style=\"color: #a31515;\">''</span>].<span style=\"color: #a31515;\">\"&lt;/td&gt;\"</span>;\r\n <span style=\"color: blue;\">echo</span> <span style=\"color: #a31515;\">\"&lt;td&gt;\"</span>.$a[<span style=\"color: #a31515;\">''</span>].<span style=\"color: #a31515;\">\"&lt;/td&gt;\"</span>;\r\n <span style=\"color: blue;\">echo</span> <span style=\"color: #a31515;\">\"&lt;td&gt;\"</span>.$a[<span style=\"color: #a31515;\">''</span>].<span style=\"color: #a31515;\">\"&lt;/td&gt;\"</span>;\r\n <span style=\"color: blue;\">echo</span> <span style=\"color: #a31515;\">\"&lt;td&gt;\"</span>.$a[<span style=\"color: #a31515;\">''</span>].<span style=\"color: #a31515;\">\"&lt;/td&gt;\"</span>;\r\n <span style=\"color: blue;\">echo</span> <span style=\"color: #a31515;\">\"&lt;td&gt;\"</span>.$a[<span style=\"color: #a31515;\">''</span>].<span style=\"color: #a31515;\">\"&lt;/td&gt;\"</span>;\r\n <span style=\"color: blue;\">echo</span> <span style=\"color: #a31515;\">\"&lt;/tr&gt;\"</span>;\r\n $t != 0 ? $t = 0 : $t = 1;\r\n }\r\n <span style=\"color: blue;\">echo</span> <span style=\"color: #a31515;\">\"&lt;tr&gt;&lt;td colspan=\\\"6\\\" scope=\\\"col\\\"&gt;&lt;span class=\\\"bold\\\"&gt;Number of unique entries: &lt;/span&gt;\"</span>;\r\n <span style=\"color: blue;\">echo</span> <span style=\"color: #a31515;\">\"&lt;/td&gt;&lt;/tr&gt;\"</span>;\r\n <span style=\"color: blue;\">echo</span> <span style=\"color: #a31515;\">\"&lt;/table&gt;\"</span>;\r\n <span style=\"color: blue;\">include</span> (<span style=\"color: #a31515;\">\"dbend.php\"</span>); <span style=\"color: green;\">// end SQL connection</span>\r\n<span style=\"color: green;\">// --------------------------------------------------------&gt; End</span>\r\n}\r\n?&gt;\r\n</pre>\n</div>\n<p>&nbsp;</p>\n<p>Code 2</p>\n<div style=\"color: black; background-color: white;\">\n<pre>&lt;?php\r\nsession_start();\r\n<span style=\"color: blue;\">require_once</span> <span style=\"color: #a31515;\">'PHPExcel.php'</span>;\r\n<span style=\"color: green;\">//require_once 'PHPExcel/IOFactory.php';</span>\r\n<span style=\"color: green;\">// $sql = \"Select * from T12594_RELOAD\";</span>\r\nmysql_connect(<span style=\"color: #a31515;\">\"1**.***.*4\"</span>,<span style=\"color: #a31515;\">\"t****g\"</span>,<span style=\"color: #a31515;\">\"N*****u\"</span>);\r\nmysql_select_db(<span style=\"color: #a31515;\">\"training_records\"</span>);\r\n$sql = $_SESSION[<span style=\"color: #a31515;\">'sql'</span>];\r\n$result = mysql_query(<span style=\"color: #a31515;\">\"$sql\"</span>);\r\n<span style=\"color: green;\">// Create new PHPExcel object</span>\r\n$objPHPExcel = <span style=\"color: blue;\">new</span> PHPExcel();\r\n<span style=\"color: green;\">// Set properties</span>\r\n$objPHPExcel-&gt;getProperties()-&gt;setCreator(<span style=\"color: #a31515;\">\"***-LTD UK\"</span>)\r\n        -&gt;setLastModifiedBy(<span style=\"color: #a31515;\">\"***-LTD UK\"</span>)\r\n        -&gt;setTitle(<span style=\"color: #a31515;\">\"Office 2007 XLSX Test Document\"</span>)\r\n        -&gt;setSubject(<span style=\"color: #a31515;\">\"Office 2007 XLSX Test Document\"</span>)\r\n        -&gt;setDescription(<span style=\"color: #a31515;\">\"Test document for Office 2007 XLSX, generated using PHP classes.\"</span>)\r\n        -&gt;setKeywords(<span style=\"color: #a31515;\">\"Office 2007 openxml php\"</span>)\r\n        -&gt;setCategory(<span style=\"color: #a31515;\">\"DB \"</span>);\r\n$objPHPExcel-&gt;setActiveSheetIndex(0);\r\n<span style=\"color: green;\">// Rename sheet</span>\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setTitle(<span style=\"color: #a31515;\">'Name of Sheet 1'</span>);\r\n<span style=\"color: green;\">// datadunp</span>\r\n$rowIterator = 0;\r\n<span style=\"color: blue;\">while</span>($row = mysql_fetch_assoc($result)) {\r\n   $col = 0;\r\n    <span style=\"color: blue;\">foreach</span>($row <span style=\"color: blue;\">as</span> $key=&gt;$value) {\r\n        $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValueByColumnAndRow($col, $rowIterator, $value);\r\n        $col++;\r\n    }\r\n    $rowIterator++;\r\n}\r\n \r\n<span style=\"color: green;\">// Redirect output to a client?s web browser (Excel5)</span>\r\n$today = date(<span style=\"color: #a31515;\">'Y-m-d'</span>);\r\nheader(<span style=\"color: #a31515;\">'Content-Type: application/vnd.ms-excel; charset=utf-8'</span>);\r\nheader(<span style=\"color: #a31515;\">'Content-Disposition: attachment;filename=\"test.xls\"'</span>);\r\nheader(<span style=\"color: #a31515;\">'Cache-Control: max-age=0'</span>);\r\n$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, <span style=\"color: #a31515;\">'Excel5'</span>);\r\n$objWriter-&gt;save(<span style=\"color: #a31515;\">'php://output'</span>);\r\n<span style=\"color: blue;\">exit</span>;\r\n</pre>\n</div>",
    "PostedDate": "2011-11-02T07:49:04.89-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]