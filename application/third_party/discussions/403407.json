[
  {
    "Id": "942367",
    "ThreadId": "403407",
    "Html": "\r\n<p>Hi,</p>\r\n<p>I am using PHPExcel (develop) from Nov. 15, 2012 and am encountering a problem, that I can't figure out how to resolve.</p>\r\n<p>Basically I have a workbook with 2 sheets (similar to example 33). My bar-chart is vertical, instead of horizontal and I have more data (4 columns, 1200 values each).</p>\r\n<p>When looking for differences between my chart-object and the one of example 33 (with print_r($chart) ) I see that whereas example 33 has a cell-array for each cell, and mine uses a ptr (Not too sure about the cell-aray wording, but if needed I can clarify\r\n tomorow).</p>\r\n<p>Some other things that are different: I have cells with UTF-8 Portuguese text, but that should not be a problem (I think).</p>\r\n<p>The file opens fine with LibreOffice, even showing the chart! But with Excel 2010 (Win) and Excel 2011 (OSX) it results in a corrupted file, that after being corrected is stripped from it's graph.</p>\r\n<p>If I do not include the graph when writing the xlsx-file, it is perfect (but obviously without graph).</p>\r\n<p>The error is:</p>\r\n<p></p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre><span style=\"color:blue\">&lt;?</span><span style=\"color:#a31515\">xml</span> <span style=\"color:red\">version</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">1.0</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">encoding</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">UTF-8</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">standalone</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">yes</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">?&gt;</span>\r\n<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">recoveryLog</span> <span style=\"color:red\">xmlns</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">http://schemas.openxmlformats.org/spreadsheetml/2006/main</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">&gt;</span><span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">logFileName</span><span style=\"color:blue\">&gt;</span><span style=\"background-color:white\">Repair Result to Energist-2012-11-01_2012-11-15-29 08327.xml</span><span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">logFileName</span><span style=\"color:blue\">&gt;</span><span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">summary</span><span style=\"color:blue\">&gt;</span><span style=\"background-color:white\">Errors were detected in file 'Flatlander OS:Users:martijn:Downloads:Energist-2012-11-01_2012-11-15-29.xlsx'</span><span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">summary</span><span style=\"color:blue\">&gt;</span><span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">removedParts</span><span style=\"background-color:white\"> </span><span style=\"color:red\">summary</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">Following is a list of removed parts:</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">&gt;</span><span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">removedPart</span><span style=\"color:blue\">&gt;</span><span style=\"background-color:white\">Removed Part: /xl/drawings/drawing1.xml part.  (Drawing shape)</span><span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">removedPart</span><span style=\"color:blue\">&gt;</span><span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">removedParts</span><span style=\"color:blue\">&gt;</span><span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">recoveryLog</span><span style=\"color:blue\">&gt;</span></pre>\r\n</div>\r\n<p></p>\r\n<p>&nbsp;</p>\r\n<p>I could upload the file, but it is very possible my error and not yours :-)</p>\r\n<p>Basically, how can one go around and do some debugging, to see where this error might come from?</p>\r\n<p>Thanks, PHPExcel is awesome!</p>\r\n<p>Martijn</p>\r\n",
    "PostedDate": "2012-11-15T14:36:37.68-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "942601",
    "ThreadId": "403407",
    "Html": "\r\n<p>Partly SOLVED</p>\r\n<p>&nbsp;</p>\r\n<p>I got the graphs working in Excel 2010 and 2011.</p>\r\n<p>I thought the direction of the bar was optional and set to vertical by default. It is not.</p>\r\n<p>I added the following line to my php-code:</p>\r\n<p>$series-&gt;setPlotDirection(PHPExcel_Chart_DataSeries::DIRECTION_COL);</p>\r\n<p>&nbsp;</p>\r\n<p>And now it works, so that part is solved.</p>\r\n<p>&nbsp;</p>\r\n<p>Still remaining is some hints on how to do debugging instead of brute-force try everything and hope it works.</p>\r\n<p>/Martijn</p>\r\n",
    "PostedDate": "2012-11-16T01:34:56.293-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]