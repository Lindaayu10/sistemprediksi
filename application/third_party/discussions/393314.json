[
  {
    "Id": "904977",
    "ThreadId": "393314",
    "Html": "\r\n<p>Hi there,</p>\r\n<p>I encounter some problems while creating a big xls(5)-file.<br>\r\nAfter a while I receive a 500-error. No error-info is written to the logfile.<br>\r\nSometimes I get a timeout or memory exeeded error.</p>\r\n<p>What I am doing:<br>\r\nDoing some SQL-querys to get some data. The data will be approx. 5000 rows long and about 50 columns wide. There will be numbers and text in the xls-doc.</p>\r\n<p>printing the data with print_r() will output the data within 10 seconds.</p>\r\n<p>Putting this data into an excel-doc will fail (see above).</p>\r\n<p>Almost every cell is styled with an format-information<br>\r\n</p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre>$xls-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#a31515\">'A1'</span>)-&gt;applyFromArray($style[<span style=\"color:#a31515\">'borders'</span>])\r\n</pre>\r\n</div>\r\n<p></p>\r\n<p>Are there any options to write data direct to harddrive, and therefore no memory errors will occur. How is it done creating big xls-files? Am I doing something wrong.</p>\r\n<p>See below some snippets of my code.</p>\r\n<p></p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre><span style=\"color:blue\">require_once</span> <span style=\"color:#a31515\">'../PHPExcel.php'</span>;\r\n$xls = <span style=\"color:blue\">new</span> PHPExcel();\r\n$xls-&gt;getProperties()-&gt;setCreator(<span style=\"color:#a31515\">&quot;mycreator&quot;</span>)\r\n -&gt;setLastModifiedBy(<span style=\"color:#a31515\">&quot;mycreator&quot;</span>)\r\n -&gt;setTitle(<span style=\"color:#a31515\">&quot;title&quot;</span>)\r\n -&gt;setSubject(<span style=\"color:#a31515\">&quot;title&quot;</span>)\r\n -&gt;setDescription(<span style=\"color:#a31515\">&quot;title&quot;</span>)\r\n -&gt;setKeywords(<span style=\"color:#a31515\">&quot;title&quot;</span>);\r\n$xls-&gt;setActiveSheetIndex(0);\r\n$xls-&gt;getActiveSheet()-&gt;setTitle(<span style=\"color:#a31515\">'title'</span>);\t\r\n$orientation = <span style=\"color:blue\">array</span>(\r\n<span style=\"color:#a31515\">'horizontal'</span> =&gt; PHPExcel_Style_Alignment::HORIZONTAL_CENTER,\r\n<span style=\"color:#a31515\">'vertical'</span>   =&gt; PHPExcel_Style_Alignment::VERTICAL_CENTER,\r\n);\r\n\r\n[...]\r\n\r\n$xls-&gt;getActiveSheet()-&gt;mergeCells(<span style=\"color:#a31515\">'B1:B2'</span>);\r\n$xls-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#a31515\">'B1'</span>)-&gt;applyFromArray($style[<span style=\"color:#a31515\">'bold'</span>])-&gt;getAlignment()-&gt;applyFromArray($orientation);\r\n$xls-&gt;getActiveSheet()-&gt;setCellValueByColumnAndRow(1, 1, $months[$month-1].<span style=\"color:#a31515\">' '</span>.$year);\r\n\r\n[...]\r\n\r\n$xls-&gt;getActiveSheet()-&gt;getStyle($cols[$col].$row)-&gt;applyFromArray($style[<span style=\"color:#a31515\">'normal'</span>])-&gt;getNumberFormat()-&gt;setFormatCode(PHPExcel_Style_NumberFormat::FORMAT_NUMBER_00);\r\n$xls-&gt;getActiveSheet()-&gt;setCellValueByColumnAndRow($col, $row, $number);\r\n\r\n[...]\r\n\r\n<span style=\"color:blue\">for</span> ($i=0;$i&lt;$breite;$i&#43;&#43;) $xls-&gt;getActiveSheet()-&gt;getColumnDimension($cols[$i])-&gt;setAutoSize(true);\r\nheader(<span style=\"color:#a31515\">'Content-Type: application/vnd.ms-excel'</span>);\r\nheader(<span style=\"color:#a31515\">'Content-Disposition: attachment;filename=&quot;myfile.xls&quot;'</span>);\r\nheader(<span style=\"color:#a31515\">'Cache-Control: max-age=0'</span>);\r\n$objWriter = PHPExcel_IOFactory::createWriter($xls, <span style=\"color:#a31515\">'Excel5'</span>);\r\n$objWriter-&gt;save(<span style=\"color:#a31515\">'php://output'</span>);\r\n</pre>\r\n</div>\r\n<p></p>\r\n<p>Thanks a lot for your help<br>\r\nJens</p>\r\n",
    "PostedDate": "2012-08-28T01:52:31.93-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]