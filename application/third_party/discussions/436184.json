[
  {
    "Id": "1013378",
    "ThreadId": "436184",
    "Html": "I'm trying to generate large file containing more than 5000 rows...\r<br />\n<br />\nI had some memory problem. I've tried to use de caching but I think i'm half way there:\r<br />\n<br />\nBefore using APC I would memory exhaust when I was looping to set each cell value.  Now, I can loop 5-10-15 thousand time without memory exhausting.My problem now is with the writer.\r<br />\n<br />\nI still memory exhaust but when saving and generating the file. \r<br />\n<br />\nPlease help!!\r<br />\n<br />\nHere is a pretty simple example: \r<br />\n// Set caching properties\r<br />\necho date('H:i:s') . &quot; Set cache properties\\n&quot;;\r<br />\n$cacheMethod = PHPExcel_CachedObjectStorageFactory::cache_to_apc;\r<br />\n$cacheSettings = array( 'cacheTime' =&gt; 600);\r<br />\n$response = PHPExcel_Settings::setCacheStorageMethod($cacheMethod, $cacheSettings);\r<br />\necho date('H:i:s') . &quot; Cache Response: |$response|\\r\\n&quot;;\r<br />\n<br />\n// Create new PHPExcel object\r<br />\necho date('H:i:s') . &quot; Create new PHPExcel object\\n&quot;;\r<br />\n$objPHPExcel = new PHPExcel();\r<br />\n<br />\n// Add some data\r<br />\necho date('H:i:s') . &quot; Add some data\\n&quot;;\r<br />\n$objPHPExcel-&gt;setActiveSheetIndex(0);\r<br />\n$row=1;\r<br />\nwhile ($row &lt;= 6000)\r<br />\n{<br />\n<pre><code>//print_r(&quot;$row\\n&quot;);\n$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue('A'.$row, 'Hello');\n$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue('B'.$row, 'world!');\n$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue('C'.$row, 'HELLO');\n$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue('D'.$row, 'WORLD!');\n\n++$row;</code></pre>\n\n}\r<br />\n<br />\n// Rename sheet\r<br />\necho date('H:i:s') . &quot; Rename sheet\\n&quot;;\r<br />\n$objPHPExcel-&gt;getActiveSheet()-&gt;setTitle('Simple');\r<br />\n\t\t\r<br />\n// Save Excel 2007 file\r<br />\necho date('H:i:s') . &quot; Write to Excel2007 format\\n&quot;;\r<br />\n<br />\n$objPHPExcel-&gt;getDefaultStyle()-&gt;getFont()-&gt;setName('Calibri');\r<br />\n$objPHPExcel-&gt;getDefaultStyle()-&gt;getFont()-&gt;setSize(8);\r<br />\n<br />\necho &quot;Peak memory usage: &quot; . (memory_get_peak_usage(true) / 1024 / 1024) . &quot; MB&quot;; // 217.25\r<br />\n<br />\n$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, &quot;Excel2007&quot;);\r<br />\n$objWriter-&gt;setUseDiskCaching(true, '/tmp/');\r<br />\n$objWriter-&gt;save('spyke.xlsx');<br />\n",
    "PostedDate": "2013-03-11T10:21:42.227-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]