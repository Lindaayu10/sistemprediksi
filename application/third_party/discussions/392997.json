[
  {
    "Id": "903771",
    "ThreadId": "392997",
    "Html": "\r\n<p>Hello,</p>\r\n<p>I've to write more than 370 columns and 7000 cells into a file so I've a memory problem.</p>\r\n<p>Maybe is there a solution that automatically write a new file or a new worksheet if the limit of 2000 cells are reached and&nbsp; a new file for the next 2000 starts.</p>\r\n<p>Or is there another solution???</p>\r\n<p>May with disconnect but how should I implement it into my code ?? </p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre>$objPHPExcel-&gt;disconnectWorksheets();\n     <span style=\"color:blue\">unset</span>($objPHPExcel);\n</pre>\r\n</div>\r\n<p></p>\r\n<p>Below my current code which I use but sometimes I've a memory problem.</p>\r\n<p>Please help me thank you.</p>\r\n<p>&nbsp;</p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre>&lt;?php\n\n<span style=\"color:green\">/** require the PHPExcel file 1.0 */</span>\n    <span style=\"color:blue\">require</span> <span style=\"color:#a31515\">'Classes/PHPExcel.php'</span>;\n\n<span style=\"color:green\">/** Set Memory Limit 1.0 */</span>\n    ini_set(<span style=\"color:#a31515\">&quot;memory_limit&quot;</span>,<span style=\"color:#a31515\">&quot;1000M&quot;</span>);\n\n<span style=\"color:green\">/** Caching to discISAM 1.0*/</span>\n$cacheMethod = PHPExcel_CachedObjectStorageFactory:: cache_to_discISAM;\n$cacheSettings = <span style=\"color:blue\">array</span>( <span style=\"color:#a31515\">'dir'</span>  =&gt; <span style=\"color:#a31515\">'/usr/local/tmp'</span>\n                      );\nPHPExcel_Settings::setCacheStorageMethod($cacheMethod, $cacheSettings);\n\n<span style=\"color:green\">/** connection with the database 1.0 */</span>\n    $dbhost = <span style=\"color:#a31515\">&quot;localhost&quot;</span>;\n    $dbuser = <span style=\"color:#a31515\">&quot;user&quot;</span>;\n    $dbpass = <span style=\"color:#a31515\">&quot;pw&quot;</span>;\n    $dbname = <span style=\"color:#a31515\">&quot;mydb&quot;</span>;\n    mysql_connect($dbhost,$dbuser,$dbpass);\n    mysql_select_db($dbname);\n\n<span style=\"color:green\">/** Query 1.0 */</span>\n    $query = <span style=\"color:#a31515\">&quot;SELECT * FROM tblpsrmonth&quot;</span>;\n\n    <span style=\"color:blue\">if</span> ($result = mysql_query($query) <span style=\"color:blue\">or</span> <span style=\"color:blue\">die</span>(mysql_error())) {\n<span style=\"color:green\">/** Create a new PHPExcel object 1.0 */</span>\n   $objPHPExcel = <span style=\"color:blue\">new</span> PHPExcel();\n   $objPHPExcel-&gt;getActiveSheet()-&gt;setTitle(<span style=\"color:#a31515\">'Technical Data'</span>);\n   }  \n  \n<span style=\"color:green\">/** Loop through the result set 1.0 */</span>\n    $rowNumber = 1;\n    <span style=\"color:blue\">while</span> ($row = mysql_fetch_row($result)) {\n       $col = <span style=\"color:#a31515\">'A'</span>;\n       <span style=\"color:blue\">foreach</span>($row <span style=\"color:blue\">as</span> $cell) {\n          $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue($col.$rowNumber,$cell);\n          $col&#43;&#43;;\n       }\n       $rowNumber&#43;&#43;;\n}\n   \n<span style=\"color:green\">/** Create Excel 2007 file with writer 1.0 */</span>\n    header(<span style=\"color:#a31515\">'Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'</span>);\n    header(<span style=\"color:#a31515\">'Content-Disposition: attachment;filename=&quot;Technical.xlsx&quot;'</span>);\n    header(<span style=\"color:#a31515\">'Cache-Control: max-age=0'</span>);\n    $objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, <span style=\"color:#a31515\">'Excel2007'</span>);\n    $objWriter-&gt;save(<span style=\"color:#a31515\">'php://output'</span>);\n<span style=\"color:blue\">exit</span>;\n\n?&gt;\n</pre>\r\n</div>\r\n",
    "PostedDate": "2012-08-24T14:04:15.32-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "903833",
    "ThreadId": "392997",
    "Html": "<blockquote style=\"padding-bottom: 0px; font-style: italic; margin: 0.25em 1em 0px; padding-left: 0.25em; padding-right: 0.25em; padding-top: 0px; border: #ccc 0.1em solid;\"><strong>frank1973 wrote:</strong><br />\r\n<p>Hello,</p>\r\n<p>I've to write more than 370 columns and 7000 cells into a file so I've a memory problem.</p>\r\n<p>Or is there another solution???</p>\r\n</blockquote>\r\n<p>The only real solution is either to increase your memory, or to use cell caching, or both.</p>\r\n<p>The drawback with a pure PHP script for writing Excel workbooks is that it's subject to the memory limitations defined in php.ini. Cell caching is one way of reducing the effect of that limitation, but the limit is still there.</p>\r\n<blockquote style=\"padding-bottom: 0px; font-style: italic; margin: 0.25em 1em 0px; padding-left: 0.25em; padding-right: 0.25em; padding-top: 0px; border: #ccc 0.1em solid;\"><strong>frank1973 wrote:</strong><br />\r\n<p>Hello,</p>\r\n<p>I've to write more than 370 columns and 7000 cells into a file so I've a memory problem.</p>\r\n<p>Maybe is there a solution that automatically write a new file or a new worksheet if the limit of 2000 cells are reached and a new file for the next 2000 starts.</p>\r\n</blockquote>\r\n<p>There isn't any automatic solution to do this. If you simply switched to a new worksheet, it would still use PHP memory for that sheet, although each sheet is separately cached when you're using cell caching. If you change to a different workbook, then you can clear the first workbook from memory before creating a second blank workbook and continuing there.</p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2012-08-24T17:11:06.95-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "903924",
    "ThreadId": "392997",
    "Html": "<p>Hello Mark,</p>\r\n<p>the second solution seems for me the best.</p>\r\n<p>But how to do it to change to a different workbook, that I  can clear the first workbook from memory before creating a second blank workbook and continuing there.</p>\r\n<p>Please help me how to implement it into my code.</p>\r\n<p>Thanks.</p>",
    "PostedDate": "2012-08-25T01:50:27.373-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]