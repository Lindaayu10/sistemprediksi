[
  {
    "Id": "1306779",
    "ThreadId": "568003",
    "Html": "Hi, first time here.<br />\nI have an xlsx file which holds a simple table and a line chart. What I hope to be able to do is fill the values in from a database to update the chart (I'm not at that stage yet). As I am new to PHPExcel and finding my way with the library, what I have done is simply created the table with some random numbers except for 1 cell and a line chart. I open my browser, point to my php file and what I want to happen is that a new file is created with a random number generated by php in the empty cell, chart is updated with the new number and save it as result.xlsx. I'm at the early stages of learning here!!<br />\n<br />\nEverything works except I can't get the chart generated in the new file even though it is already there in the initial file. The only thing I have left in the new file is the updated table.<br />\n<br />\nNo errors are reported so I'm not sure where I'm going wrong.<br />\n<br />\nWindows 8.1<br />\nExcel 2010<br />\nPHPExcel 1.8<br />\nphp version 5.4.24<br />\nApache 2.4<br />\n<br />\nChecked my phpinfo() and all is enabled (ie php.zip, php.xml, php.gd)<br />\n<br />\nMy code is;<br />\n<br />\n&lt;?php<br />\n<br />\n/*<em> Error reporting </em>/<br />\nerror_reporting(E_ALL);<br />\nini_set('display_errors', TRUE);<br />\nini_set('display_startup_errors', TRUE);<br />\ndate_default_timezone_set('Europe/London');<br />\n<br />\nrequire_once 'Classes/PHPExcel.php';<br />\ninclude 'Classes/PHPExcel/IOFactory.php';<br />\n<br />\n$inputFileName = 'Gas Exception Report.xlsx';<br />\n<br />\n//$objPHPExcel=$objPHPExcel_new = new PHPExcel();<br />\n$objReader = PHPExcel_IOFactory::createReader('Excel2007');<br />\n$objReader-&gt;setIncludeCharts(TRUE);<br />\n<br />\n$objPHPExcel = PHPExcel_IOFactory::load($inputFileName);<br />\n<br />\n$objPHPExcel-&gt;setActiveSheetIndex(0)-&gt;setCellValue('B24', rand(10,100));<br />\n<br />\n$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, 'Excel2007');<br />\n$objWriter-&gt;setIncludeCharts(TRUE);<br />\n$objWriter-&gt;save('result.xlsx');<br />\n<br />\n$objPHPExcel-&gt;disconnectWorksheets();<br />\n<br />\nunset($objPHPExcel);<br />\n?&gt;<br />\n<br />\nAppreciate any help, regards<br />\n<br />\nBrian730<br />\n<br />\nUPDATE<br />\nI tried the examples which came with PHPExcel and all worked. I changed the first chart example and saved it with my own chart and table. It produces a new file but with the following error when opening<br />\n<br />\n&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;true&quot;?&gt;<br />\n&lt;recoveryLog xmlns=&quot;<a href=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" rel=\"nofollow\">http://schemas.openxmlformats.org/spreadsheetml/2006/main</a>&quot;&gt;<br />\n&lt;logFileName&gt;error063600_01.xml&lt;/logFileName&gt;<br />\n&lt;summary&gt;Errors were detected in file 'C:\\Apache24\\htdocs\\Tests\\32readwriteAreaChart1.xlsx'&lt;/summary&gt;<br />\n&lt;removedParts summary=&quot;Following is a list of removed parts:&quot;&gt;<br />\n&lt;removedPart&gt;Removed Part: /xl/drawings/drawing1.xml part. (Drawing shape)&lt;/removedPart&gt;<br />\n&lt;/removedParts&gt;<br />\n&lt;/recoveryLog&gt;<br />\nStill baffled but will persevere!!!!<br />\n",
    "PostedDate": "2014-09-21T04:10:34.51-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]