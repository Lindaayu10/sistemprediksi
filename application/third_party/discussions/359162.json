[
  {
    "Id": "847452",
    "ThreadId": "359162",
    "Html": "\r\n<p>I'm trying to get/set the values for the custom Sjarepoint server properties values from an excel file but I cannot find a way to do it. I tried the&nbsp;getCustomProperties() function but the properties do not appear there.</p>\r\n<p>In Excel the properties do not appear under the custom properties tab in the advanced properties window. They only appear if you click the &quot;Show more properties link&quot; in the properties section under the file menu. Most of them cannot be edited and say that\r\n they should be edited on the server, but some of them can be edited in Excel, either from the properties window in File menu or in a&nbsp;separate&nbsp;properties panel</p>\r\n<p>I have also uploaded a sample file for this issue.</p>\r\n",
    "PostedDate": "2012-06-11T06:17:21.883-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "848642",
    "ThreadId": "359162",
    "Html": "\r\n<p>The script I've used to test this is:</p>\r\n<div style=\"background-color:white; color:black\">\r\n<pre>$inputFileType = <span style=\"color:#a31515\">'Excel2007'</span>;\r\n$inputFileName = <span style=\"color:#a31515\">'SharepointProperties.xlsx'</span>;\r\n\r\n<span style=\"color:blue\">echo</span> <span style=\"color:#a31515\">&quot;Load Properties Test from $inputFileType file&lt;br /&gt;\\n&quot;</span>;\r\n$objPHPExcelReader = PHPExcel_IOFactory::createReader($inputFileType);\r\n$objPHPExcel = $objPHPExcelReader-&gt;load($inputFileName);\r\n \r\n<span style=\"color:blue\">echo</span> <span style=\"color:#a31515\">'&lt;h3&gt;Core Properties&lt;/h3&gt;'</span>;\r\n<span style=\"color:blue\">echo</span> <span style=\"color:#a31515\">'&lt;b&gt;Created by &lt;/b&gt;'</span>,$objPHPExcel-&gt;getProperties()-&gt;getCreator(),<span style=\"color:#a31515\">'&lt;br /&gt;'</span>;\r\n<span style=\"color:blue\">echo</span> <span style=\"color:#a31515\">'&lt;b&gt;Created on &lt;/b&gt;'</span>,date(<span style=\"color:#a31515\">'d-M-Y'</span>,$objPHPExcel-&gt;getProperties()-&gt;getCreated()),<span style=\"color:#a31515\">' at '</span>,date(<span style=\"color:#a31515\">'H:i:s'</span>,$objPHPExcel-&gt;getProperties()-&gt;getCreated()),<span style=\"color:#a31515\">'&lt;br /&gt;'</span>;\r\n<span style=\"color:blue\">echo</span> <span style=\"color:#a31515\">'&lt;b&gt;Last Modified by &lt;/b&gt;'</span>,$objPHPExcel-&gt;getProperties()-&gt;getLastModifiedBy(),<span style=\"color:#a31515\">'&lt;br /&gt;'</span>;\r\n<span style=\"color:blue\">echo</span> <span style=\"color:#a31515\">'&lt;b&gt;Last Modified on &lt;/b&gt;'</span>,date(<span style=\"color:#a31515\">'d-M-Y'</span>,$objPHPExcel-&gt;getProperties()-&gt;getModified()),<span style=\"color:#a31515\">' at '</span>,date(<span style=\"color:#a31515\">'H:i:s'</span>,$objPHPExcel-&gt;getProperties()-&gt;getModified()),<span style=\"color:#a31515\">'&lt;br /&gt;'</span>;\r\n<span style=\"color:blue\">echo</span> <span style=\"color:#a31515\">'&lt;b&gt;Title: &lt;/b&gt;'</span>,$objPHPExcel-&gt;getProperties()-&gt;getTitle(),<span style=\"color:#a31515\">'&lt;br /&gt;'</span>;\r\n<span style=\"color:blue\">echo</span> <span style=\"color:#a31515\">'&lt;b&gt;Subject: &lt;/b&gt;'</span>,$objPHPExcel-&gt;getProperties()-&gt;getSubject(),<span style=\"color:#a31515\">'&lt;br /&gt;'</span>;\r\n<span style=\"color:blue\">echo</span> <span style=\"color:#a31515\">'&lt;b&gt;Description: &lt;/b&gt;'</span>,$objPHPExcel-&gt;getProperties()-&gt;getDescription(),<span style=\"color:#a31515\">'&lt;br /&gt;'</span>;\r\n<span style=\"color:blue\">echo</span> <span style=\"color:#a31515\">'&lt;b&gt;Keywords: &lt;/b&gt;'</span>,$objPHPExcel-&gt;getProperties()-&gt;getKeywords(),<span style=\"color:#a31515\">'&lt;br /&gt;'</span>;\r\n\r\n<span style=\"color:blue\">echo</span> <span style=\"color:#a31515\">'&lt;hr /&gt;'</span>;\r\n\r\n<span style=\"color:blue\">echo</span> <span style=\"color:#a31515\">'&lt;h3&gt;Extended (Application) Properties&lt;/h3&gt;'</span>;\r\n<span style=\"color:blue\">echo</span> <span style=\"color:#a31515\">'&lt;b&gt;Category: &lt;/b&gt;'</span>,$objPHPExcel-&gt;getProperties()-&gt;getCategory(),<span style=\"color:#a31515\">'&lt;br /&gt;'</span>;\r\n<span style=\"color:blue\">echo</span> <span style=\"color:#a31515\">'&lt;b&gt;Company: &lt;/b&gt;'</span>,$objPHPExcel-&gt;getProperties()-&gt;getCompany(),<span style=\"color:#a31515\">'&lt;br /&gt;'</span>;\r\n<span style=\"color:blue\">echo</span> <span style=\"color:#a31515\">'&lt;b&gt;Manager: &lt;/b&gt;'</span>,$objPHPExcel-&gt;getProperties()-&gt;getManager(),<span style=\"color:#a31515\">'&lt;br /&gt;'</span>;\r\n\r\n<span style=\"color:blue\">echo</span> <span style=\"color:#a31515\">'&lt;hr /&gt;'</span>;\r\n\r\n<span style=\"color:blue\">echo</span> <span style=\"color:#a31515\">'&lt;h3&gt;Custom Properties&lt;/h3&gt;'</span>;\r\n$customProperties = $objPHPExcel-&gt;getProperties()-&gt;getCustomProperties();\r\n$customPropertyCount = count($customProperties);\r\n<span style=\"color:blue\">echo</span> <span style=\"color:#a31515\">'&lt;p&gt;There '</span>,(($customPropertyCount !== 1) ? <span style=\"color:#a31515\">'are'</span> : <span style=\"color:#a31515\">'is'</span>),<span style=\"color:#a31515\">' '</span>,$customPropertyCount,<span style=\"color:#a31515\">' custom propert'</span>,(($customPropertyCount !== 1) ? <span style=\"color:#a31515\">'ies'</span> : <span style=\"color:#a31515\">'y'</span>),<span style=\"color:#a31515\">'&lt;/p&gt;'</span>;\r\n<span style=\"color:blue\">foreach</span>($customProperties <span style=\"color:blue\">as</span> $customProperty) {\r\n    $propertyValue = $objPHPExcel-&gt;getProperties()-&gt;getCustomPropertyValue($customProperty);\r\n    $propertyType = $objPHPExcel-&gt;getProperties()-&gt;getCustomPropertyType($customProperty);\r\n    <span style=\"color:blue\">if</span> ($propertyType == PHPExcel_DocumentProperties::PROPERTY_TYPE_DATE) {\r\n        <span style=\"color:blue\">echo</span> <span style=\"color:#a31515\">'&lt;b&gt;'</span>.$customProperty.<span style=\"color:#a31515\">' ('</span>,$propertyType,<span style=\"color:#a31515\">') : &lt;/b&gt;'</span>,date(<span style=\"color:#a31515\">'d-M-Y H:i:s'</span>,$propertyValue),<span style=\"color:#a31515\">'&lt;br /&gt;'</span>;\r\n    } <span style=\"color:blue\">elseif</span> ($propertyType == PHPExcel_DocumentProperties::PROPERTY_TYPE_BOOLEAN) {\r\n        <span style=\"color:blue\">echo</span> <span style=\"color:#a31515\">'&lt;b&gt;'</span>.$customProperty.<span style=\"color:#a31515\">' ('</span>,$propertyType,<span style=\"color:#a31515\">') : &lt;/b&gt;'</span>,(($propertyValue) ? <span style=\"color:#a31515\">'TRUE'</span> : <span style=\"color:#a31515\">'FALSE'</span>),<span style=\"color:#a31515\">'&lt;br /&gt;'</span>;\r\n    } <span style=\"color:blue\">else</span> {\r\n        <span style=\"color:blue\">echo</span> <span style=\"color:#a31515\">'&lt;b&gt;'</span>.$customProperty.<span style=\"color:#a31515\">' ('</span>,$propertyType,<span style=\"color:#a31515\">') : &lt;/b&gt;'</span>,$propertyValue,<span style=\"color:#a31515\">'&lt;br /&gt;'</span>;\r\n    }\r\n}\r\n</pre>\r\n</div>\r\n<p>The result I'm getting is:</p>\r\n<p>Load Properties Test from Excel2007 file</p>\r\n<h3>Core Properties</h3>\r\n<p><strong>Created by </strong><br>\r\n<strong>Created on </strong>16-Sep-2006 at 01:00:00<br>\r\n<strong>Last Modified by </strong><br>\r\n<strong>Last Modified on </strong>11-Jun-2012 at 14:26:45<br>\r\n<strong>Title: </strong>Report_2012_WK21<br>\r\n<strong>Subject: </strong><br>\r\n<strong>Description: </strong><br>\r\n<strong>Keywords: </strong></p>\r\n<hr>\r\n<h3>Extended (Application) Properties</h3>\r\n<p><strong>Category: </strong><br>\r\n<strong>Company: </strong>Microsoft Corporation<br>\r\n<strong>Manager: </strong></p>\r\n<hr>\r\n<h3>Custom Properties</h3>\r\n<p>There is 1 custom property</p>\r\n<p><strong>ContentTypeId (s) : </strong>0x0101002604D0191AC41D45BCA83F3A621C78F7003FCAA407CBF69B45A08153D003D3CC20</p>\r\n<p>&nbsp;</p>\r\n<p>And this isn't crashing or causing any problems with script execution.</p>\r\n<p>Still investigating why all the properties aren't being read, but it looks as though there's a CustomXML section of the document that's being used for these additional property definitions&nbsp;and values</p>\r\n",
    "PostedDate": "2012-06-13T14:01:38.253-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "848863",
    "ThreadId": "359162",
    "Html": "<p>Thanks for all this work on your side. I think you are right about the custom XML with the rest of the properties.&nbsp;<br />I managed to work around the update of this custom XML properties for now, by doing the following:</p>\r\n<p>1) I unzip the xlsx file</p>\r\n<p>2) I edit the xml values in the file \"customXml/item1.xml\"</p>\r\n<p>3) I save the file</p>\r\n<p>4) I repack everything into an excel file</p>\r\n<p>5) The custom excel properties are updated</p>\r\n<p>&nbsp;</p>\r\n<p>I'm guessing that the problem is that phpExcel is not searching for customXML property files. I'm not sure about this, it's just a guess...</p>",
    "PostedDate": "2012-06-14T02:43:01.137-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "848873",
    "ThreadId": "359162",
    "Html": "<p>I don't know if this helps but I can edit the customXML properties using the following vba code withing the Excel file.</p>\r\n<p>\r\n<div style=\"color: black; background-color: white;\">\r\n<pre>    <span style=\"color: blue;\">Dim</span> ExcelDoc <span style=\"color: blue;\">As</span> Excel.Workbook \r\n    <span style=\"color: blue;\">Dim</span> Prop\r\n    \r\n    <span style=\"color: blue;\">For</span> <span style=\"color: blue;\">Each</span> Prop <span style=\"color: blue;\">In</span> ExcelDoc.ContentTypeProperties\r\n        <span style=\"color: blue;\">If</span> Prop.Name = <span style=\"color: #a31515;\">\"col_Year\"</span> <span style=\"color: blue;\">Then</span>\r\n            Prop.Value = intYear <span style=\"color: green;\">'Integer value</span>\r\n        <span style=\"color: blue;\">End</span> <span style=\"color: blue;\">If</span>\r\n    <span style=\"color: blue;\">Next</span> Prop\r\n\r\n</pre>\r\n</div>\r\n</p>",
    "PostedDate": "2012-06-14T03:34:33.173-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]