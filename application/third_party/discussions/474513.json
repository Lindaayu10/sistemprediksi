[
  {
    "Id": "1137552",
    "ThreadId": "474513",
    "Html": "Not sure if this is the right place to ask this, but I couldn't find another way of asking if the #VALUE! error is a known bug. <br />\n<br />\nI get #VALUE! errors randomly when I read cells from an excel file. The error occurs on cells that reference other cells. I know that there is an issue if a cell is NULL, but in my worksheet the cells will NEVER be NULL.<br />\n<br />\nI created a xls workbook (eg KS0.xls) - inside which there is a worksheet KS0-A that has the same format line after line; a concatenate function that references 4 columns<br />\n(=CONCATENATE(&quot;Col E2: &quot;,E244,&quot;, Col F2: &quot;,F244,&quot;, Col G2: &quot;,G244,&quot;, Col H2: &quot;,H244))<br />\n<br />\ncols E, F, G, H have a simple function: =CHOOSE(RANDBETWEEN(1,3),&quot;OK1&quot;,&quot;OK2&quot;,&quot;OK3&quot;),<br />\nso they will always have either OK1, OK2, or OK3<br />\n<br />\nThis is the output when I read the cells that have the concatenate function (as above): look at how #VALUE! appears randomly, suggesting there is a problem... My PHP is a simple loop that reads the lines row by row<br />\n<br />\nSTOP PRESS!!! I've just noticed that there is no OK1 in my output, and by laws of probability I guess that the #VALUE! errors are occurring when RANDBETWEEN(1,3) returns 1 (and so should pick OK1).... that is still a problem, but it may be a clue to a solution? Can anyone see what the problem is?<br />\n<br />\nOutput on RUN 1<br />\nType:CH1 __Q1: Col E2: OK3, Col F2: OK2, Col G2: #VALUE!, Col H2: OK3<br />\nType:CH2 __Q2: Col E2: #VALUE!, Col F2: OK3, Col G2: OK2, Col H2: OK2<br />\nType:CH3 __Q3: Col E2: OK3, Col F2: #VALUE!, Col G2: OK3, Col H2: OK2<br />\nType:CH4 __Q4: Col E2: #VALUE!, Col F2: #VALUE!, Col G2: OK3, Col H2: OK2<br />\n<br />\nAnd when I run the php again i get:<br />\n<br />\nOutput on RUN 2<br />\nType:CH1 __Q1: Col E2: #VALUE!, Col F2: #VALUE!, Col G2: OK3, Col H2: #VALUE!<br />\nType:CH2 __Q2: Col E2: OK3, Col F2: OK3, Col G2: OK2, Col H2: #VALUE!<br />\nType:CH3 __Q3: Col E2: OK3, Col F2: #VALUE!, Col G2: #VALUE!, Col H2: OK2<br />\n<h1>Type:CH4 __Q4: Col E2: OK3, Col F2: OK3, Col G2: OK2, Col H2: OK3</h1>\nFixed: see <a href=\"https://github.com/PHPOffice/PHPExcel/issues/258?source=cc\" rel=\"nofollow\">https://github.com/PHPOffice/PHPExcel/issues/258?source=cc</a><br />\n",
    "PostedDate": "2013-12-18T07:31:02.41-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": "2013-12-28T08:58:34.733-08:00"
  }
]