[
  {
    "Id": "216255",
    "ThreadId": "63595",
    "Html": "<p>&nbsp;</p>\r\n<p>now i am working in symfony framework, during database data's report generating, i was easily generate excel report.</p>\r\n<p>but now i am trying to generate pdf report by using same classes,<span style=\"text-decoration:underline\"> <span>PHPExcel1.6.7(http://phpexcel.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=10716)</span></span></p>\r\n<p>i got some error when data is exported to pdf.</p>\r\n<p>after generating greater than 3*3 matrix data, single value( mainly zero '0' ) is replaced by other value. but string value is in right condition.i</p>\r\n<p>i thing its a bug of PHPExcel_Writer_PDF($objPHPExcel) class.</p>\r\n<p>read my follwing code carefully mainly&nbsp; cell's input value and generated correponding output in pdf format.</p>\r\n<p>// Create new PHPExcel object</p>\r\n<p>&nbsp;&nbsp;&nbsp;&nbsp; $objPHPExcel = new sfPhpExcel();<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('A1','Report1:');<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('A2','Report2:');<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('A3','Report3:');&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('A4','Report4:');<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('A5','Report5:');<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('B1', &quot;0&quot;);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('B2',&quot;0&quot;);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('B3',&quot;0&quot;);&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue<strong>('B4',&quot;0&quot;);</strong>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('B5',&quot;5&quot;);&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('C1', &quot;5&quot;);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('C2',&quot;6&quot;);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('C3',&quot;7&quot;);&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('C4',&quot;8&quot;);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue<strong>('C5',&quot;0&quot;);</strong><br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('D1', &quot;9&quot;);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('D2',&quot;10&quot;);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('D3',&quot;12&quot;);&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('D4',&quot;13&quot;);&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('D5',&quot;14&quot;);<br>&nbsp;&nbsp; &nbsp;$fileName = &quot;-&quot;.date('H-i-s-ms').&quot;.pdf&quot;;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $objWriter = new PHPExcel_Writer_PDF($objPHPExcel);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // $objWriter-&gt;writeAllSheets();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // $objWriter-&gt;setSheetIndex(0);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //$objWriter-&gt;setPreCalculateFormulas(false);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $objWriter-&gt;save('../web/uploads/'.$fileName);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; $data = file_get_contents('../web/uploads/'.$fileName); <br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; $context = sfContext::getInstance();<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; $response = $context-&gt;getResponse();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //$response = $this-&gt;getContext()-&gt;getResponse();<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; $response-&gt;setHttpHeader('Pragma', '');<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; $response-&gt;setHttpHeader('Cache-Control', '');<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; $response-&gt;setHttpHeader('Content-Disposition', 'attachment;filename=&quot;'.$fileName.'&quot;');&nbsp;</p>\r\n<p>//output: wrong data at B4 and C5 here (for example) if you have any solution, please help me</p>\r\n<p>&lt;!--   \t\tBODY,DIV,TABLE,THEAD,TBODY,TFOOT,TR,TH,TD,P { font-family:&quot;Calibri&quot;; font-size:x-small } --&gt;</p>\r\n<table style=\"height:104px\" border=0 cellspacing=0 width=364 rules=none>\r\n<colgroup><col width=89><col width=89><col width=89><col width=89></colgroup> \r\n<tbody>\r\n<tr>\r\n<td width=89 height=17 align=left><span style=\"color:#000000\">Report1:</span></td>\r\n<td width=89 align=right><span style=\"color:#000000\">0</span></td>\r\n<td width=89 align=right><span style=\"color:#000000\">5</span></td>\r\n<td width=89 align=right><span style=\"color:#000000\">9</span></td>\r\n</tr>\r\n<tr>\r\n<td height=17 align=left><span style=\"color:#000000\">Report2:</span></td>\r\n<td align=right><span style=\"color:#000000\">0</span></td>\r\n<td align=right><span style=\"color:#000000\">6</span></td>\r\n<td align=right><span style=\"color:#000000\">10</span></td>\r\n</tr>\r\n<tr>\r\n<td height=17 align=left><span style=\"color:#000000\">Report3:</span></td>\r\n<td align=right><span style=\"color:#000000\">0</span></td>\r\n<td align=right><span style=\"color:#000000\">7</span></td>\r\n<td align=right><span style=\"color:#000000\">12</span></td>\r\n</tr>\r\n<tr>\r\n<td height=17 align=left><span style=\"color:#000000\">Report4:</span></td>\r\n<td align=right><strong><span style=\"color:#000000\">6</span></strong></td>\r\n<td align=right><span style=\"color:#000000\">8</span></td>\r\n<td align=right><span style=\"color:#000000\">13</span></td>\r\n</tr>\r\n<tr>\r\n<td height=17 align=left><span style=\"color:#000000\">Report5:</span></td>\r\n<td align=right><span style=\"color:#000000\">5</span></td>\r\n<td align=right><strong><span style=\"color:#000000\">12</span></strong></td>\r\n<td align=right><span style=\"color:#000000\">14</span></td>\r\n</tr>\r\n</tbody>\r\n</table>",
    "PostedDate": "2009-07-26T21:41:01.34-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "216555",
    "ThreadId": "63595",
    "Html": "<p><em>&gt;&gt; after generating greater than 3*3 matrix data, single value( mainly zero '0' )<br> &gt;&gt; is replaced by other value. but string value is in right condition</em><br><br>We were recently informed of a bug that looks very similar to your case. It turned out to be a bug in TCPDF which has now been fixed.<br><a href=\"../WorkItem/View.aspx?WorkItemId=10340\">http://phpexcel.codeplex.com/WorkItem/View.aspx?WorkItemId=10340</a><br> <br> Can you try with latest source code instead of PHPExcel 1.6.7 ? I think the bug will be gone.<br> <a href=\"../SourceControl/ListDownloadableCommits.aspx\">http://phpexcel.codeplex.com/SourceControl/ListDownloadableCommits.aspx</a></p>",
    "PostedDate": "2009-07-27T14:56:44.267-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]