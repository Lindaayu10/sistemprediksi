[
  {
    "Id": "1243397",
    "ThreadId": "544785",
    "Html": "Good Afternoon.<br />\n<br />\nI need help regarding exporting data to xlsx format.<br />\n<br />\nI always get this error message:<br />\n<br />\n&lt;IP Address&gt; - download.phpをダウンロードできません。<br />\n<br />\nWhich says that the download.php cannot be downloaded.<br />\n<br />\nOn the other hand, when I try to change this to xls format, I was able to download the file correctly.<br />\n<br />\nhere is my simple code:<br />\n<br />\n&lt;index.php&gt;<br />\n<pre><code>&lt;script&gt;\n    function ExportDataTemplate()\n    {\n        window.location = &quot;download.php&quot;;\n    }\n    \n&lt;/script&gt;\n\n&lt;input type=&quot;button&quot; class=&quot;MyButton&quot; value=&quot;Data With Template&quot; style=&quot;width: 150px;&quot; onClick=&quot;ExportDataTemplate();&quot;/&gt;</code></pre>\n\n&lt;download.php&gt;<br />\n<pre><code>&lt;?php\ninclude 'Classes/PHPExcel.php';\ninclude 'Classes/PHPExcel/IOFactory.php';\n\nerror_reporting(E_ALL ^E_NOTICE);\n\nini_set('memory_limit', -1);\nset_time_limit (0) ;\n\n$objReader = PHPExcel_IOFactory::createReader(&quot;Excel2007&quot;); \n$objPHPExcel = $objReader-&gt;load(&quot;Templates/tl_export_xlsx.xlsx&quot;);\n\n$objWorksheet = $objPHPExcel-&gt;getActiveSheet();\n$objPHPExcel-&gt;getDefaultStyle()-&gt;getFont()-&gt;setName('ＭＳ Ｐゴシック')-&gt;setSize(10);\n\n$worksheet = $objPHPExcel-&gt;setActiveSheetIndex(0);\n\n$newFilename = &quot;TL_Export_&quot;. date(&quot;YmdHi&quot;).&quot;.xlsx&quot;;\n\n$styleArray = array(\n  'borders' =&gt; array(\n    'allborders' =&gt; array(\n      'style' =&gt; PHPExcel_Style_Border::BORDER_THIN\n    )\n  )\n);\n    \n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('A1:C1')-&gt;applyFromArray($styleArray);\n    \n$worksheet-&gt;setCellValueByColumnAndRow(0, 2, &quot;1&quot;);\n$worksheet-&gt;setCellValueByColumnAndRow(1, 2, &quot;Department&quot;);\n$worksheet-&gt;setCellValueByColumnAndRow(2, 2, &quot;Team Leader&quot;);\n        \nunset($styleArray);\nob_clean();\n\nheader(&quot;Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet&quot;);\nheader(&quot;Content-Disposition: attachment; filename=\\&quot;&quot;.$newFilename.&quot;\\&quot;&quot;);\nheader(&quot;Cache-Control: max-age=0&quot;);\n$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, 'Excel2007'); \n$objWriter-&gt;save('php://output');\n\n?&gt;</code></pre>\n\nThank you in advance.<br />\n<br />\nBy the way, I am using Linux Cent OS.<br />\nPHPExcel v1.7.6<br />\nPHP  5.3.3<br />\n",
    "PostedDate": "2014-05-09T01:23:57.603-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]