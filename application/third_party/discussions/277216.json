[
  {
    "Id": "689391",
    "ThreadId": "277216",
    "Html": "\r\n<p></p>\r\n<pre>Hi,</pre>\r\n<pre>I found some code snippet from Mr.Baker on &quot;autofit&quot; and wraptext topic.I am running 1.7.6, 2011-02-27 with Excel5.</pre>\r\n<pre>However,modify the code according to my attached one,you will notice that row 4 heights is &quot;wrong&quot; and get and extra white space. This is &quot;expected&quot; and is easily adjusted in Excel with the cell-format-Autofit rowheight button.</pre>\r\n<pre>Why arent the </pre>\r\n<p></p>\r\n<pre>$objPHPExcel-&gt;getActiveSheet()-&gt;getRowDimension(4)-&gt;setRowHeight(-1);</pre>\r\n<pre>equal to that function ?</pre>\r\n<pre>What is the ratio of the cell textlength Vs cellHeight,so i can compute it (given the string) and set the height hard coded instead.</pre>\r\n<pre>Thanks!</pre>\r\n<pre><br></pre>\r\n<pre>The code:</pre>\r\n<p></p>\r\n<pre>getActiveSheet()-&gt;getCell('A1')-&gt;setValue(&quot;This is a large block of text,\\ncomprising several lines,\\nthat will be set to autofit.&quot;);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getCell('A2')-&gt;setValue(&quot;This is a large block of text that will NOT be set to autofit.&quot;);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getCell('B1')-&gt;setValue(&quot;This is another large block of text without any line breaks, that will be set to autofit.&quot;);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getCell('A3')-&gt;setValue(&quot;This is another large block of text,\\ncomprising several lines,\\nthat will be set to autofit.&quot;);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getCell('A4')-&gt;setValue(&quot;This is another large block of text without any line breaks, that will be set to autofit but not wrap.&quot;);\r\n// Fix the column width to a reasonable size\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension('A')-&gt;setWidth(30);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension('B')-&gt;setWidth(30);\r\n//  Set text wrap for cells A1 and B1. This forces the text to wrap, but doesn't adjust the height of the row\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('A1')-&gt;getAlignment()-&gt;setWrapText(true);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('B1')-&gt;getAlignment()-&gt;setWrapText(true);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('A4')-&gt;getAlignment()-&gt;setWrapText(true);\r\n// Set rows 1, 3 and 4 to autofit the height to the size of text\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getRowDimension(1)-&gt;setRowHeight(-1);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getRowDimension(3)-&gt;setRowHeight(-1);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getRowDimension(4)-&gt;setRowHeight(-1);\r\n\r\n$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, 'Excel5');\r\n$objWriter-&gt;save('testAutoHeight.xls');\r\n?&gt;</pre>\r\n<p></p>\r\n",
    "PostedDate": "2011-10-25T19:30:14.603-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]