[
  {
    "Id": "641023",
    "ThreadId": "264812",
    "Html": "\r\n<p>Dear all,</p>\r\n<p>&nbsp;</p>\r\n<p>First, thanks for your crazy class PHPExcel.<br>\r\nIt's like magic !</p>\r\n<p>I try to use your class to generate xls file for exporting some database data&nbsp;</p>\r\n<p>I build a simple sample :</p>\r\n<p>&lt;?phpheader(&quot;Content-Type: text/html&quot;);echo &quot;Start bench&lt;br&gt;&quot;;error_reporting(E_ALL);$iterator=2000;echo date('H:i:s') . &quot; last Peak memory usage: &quot; . (memory_get_peak_usage(true) / 1024 / 1024) . &quot; MB&lt;br&gt;&quot;;require_once '1.7.6/Classes/PHPExcel.php';echo\r\n date('H:i:s') . &quot; last Peak memory usage: &quot; . (memory_get_peak_usage(true) / 1024 / 1024) . &quot; MB&lt;br&gt;&quot;;$objPHPExcel = new PHPExcel();for ($i=0;$i&lt;$iterator;$i&#43;&#43;){<span>\r\n</span>echo $i . &quot; -&gt; : &quot; . (memory_get_peak_usage(true) / 1024 / 1024) . &quot; MB&lt;br&gt;&quot;;<span>\r\n</span><span></span>$objPHPExcel-&gt;setActiveSheetIndex(0)-&gt;setCellValue('A'.$i, &quot;A_&quot;.$i);<span>\r\n</span>$objPHPExcel-&gt;setActiveSheetIndex(0)-&gt;setCellValue('B'.$i, &quot;B_&quot;.$i);<span>\r\n</span>$objPHPExcel-&gt;setActiveSheetIndex(0)-&gt;setCellValue('C'.$i, &quot;C_&quot;.$i);<span>\r\n</span>$objPHPExcel-&gt;setActiveSheetIndex(0)-&gt;setCellValue('D'.$i, &quot;D_&quot;.$i);<span>\r\n</span>$objPHPExcel-&gt;setActiveSheetIndex(0)-&gt;setCellValue('E'.$i, &quot;E_&quot;.$i);<span>\r\n</span>$objPHPExcel-&gt;setActiveSheetIndex(0)-&gt;setCellValue('F'.$i, &quot;F_&quot;.$i);<span>\r\n</span>$objPHPExcel-&gt;setActiveSheetIndex(0)-&gt;setCellValue('G'.$i, &quot;G_&quot;.$i);<span>\r\n</span>$objPHPExcel-&gt;setActiveSheetIndex(0)-&gt;setCellValue('H'.$i, &quot;H_&quot;.$i);<br>\r\n}<br>\r\necho date('H:i:s') . &quot; last Peak memory usage: &quot; . (memory_get_peak_usage(true) / 1024 / 1024) . &quot; MB&lt;br&gt;&quot;;$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, 'Excel5');echo &quot;Output to &quot;.&quot;output/test&quot;.date('H_i_s').&quot;.xls&quot;;$objWriter-&gt;save(&quot;output/test&quot;.date('H_i_s').&quot;.xls&quot;);?&gt;</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n<p>And my output is&nbsp;</p>\r\n<p>&nbsp;</p>\r\n<p>Start bench<br>\r\n10:07:40 last Peak memory usage: 0.5 MB<br>\r\n10:07:40 last Peak memory usage: 0.75 MB<br>\r\n0 -&gt; : 3 MB<br>\r\n1 -&gt; : 4.5 MB<br>\r\n2 -&gt; : 4.5 MB<br>\r\n3 -&gt; : 4.5 MB<br>\r\n4 -&gt; : 4.5 MB<br>\r\n5 -&gt; : 4.5 MB<br>\r\n6 -&gt; : 4.5 MB<br>\r\n7 -&gt; : 4.5 MB<br>\r\n8 -&gt; : 4.5 MB<br>\r\n9 -&gt; : 4.5 MB<br>\r\n10 -&gt; : 4.5 MB<br>\r\n11 -&gt; : 4.5 MB<br>\r\n12 -&gt; : 4.5 MB<br>\r\n13 -&gt; : 4.5 MB<br>\r\n14 -&gt; : 4.5 MB<br>\r\n15 -&gt; : 4.5 MB<br>\r\n16 -&gt; : 4.5 MB<br>\r\n17 -&gt; : 4.5 MB<br>\r\n18 -&gt; : 4.5 MB<br>\r\n19 -&gt; : 4.5 MB<br>\r\n20 -&gt; : 4.5 MB<br>\r\n21 -&gt; : 4.5 MB<br>\r\n22 -&gt; : 4.5 MB<br>\r\n23 -&gt; : 4.5 MB<br>\r\n24 -&gt; : 4.5 MB<br>\r\n25 -&gt; : 4.5 MB<br>\r\n26 -&gt; : 4.5 MB<br>\r\n27 -&gt; : 4.5 MB<br>\r\n28 -&gt; : 4.5 MB<br>\r\n29 -&gt; : 4.5 MB<br>\r\n30 -&gt; : 4.5 MB<br>\r\n31 -&gt; : 4.5 MB<br>\r\n32 -&gt; : 4.5 MB<br>\r\n33 -&gt; : 4.5 MB<br>\r\n34 -&gt; : 4.5 MB</p>\r\n<p>&nbsp;</p>\r\n<p>....</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n<p>1466 -&gt; : 16 MB<br>\r\n1467 -&gt; : 16 MB<br>\r\n1468 -&gt; : 16 MB<br>\r\n1469 -&gt; : 16 MB<br>\r\n1470 -&gt; : 16 MB<br>\r\n1471 -&gt; : 16 MB<br>\r\n1472 -&gt; : 16 MB<br>\r\n1473 -&gt; : 16 MB<br>\r\n1474 -&gt; : 16 MB<br>\r\n1475 -&gt; : 16 MB<br>\r\n1476 -&gt; : 16 MB<br>\r\n1477 -&gt; : 16 MB<br>\r\n1478 -&gt; : 16 MB<br>\r\n1479 -&gt; : 16 MB<br>\r\n1480 -&gt; : 16 MB<br>\r\n1481 -&gt; : 16 MB<br>\r\n1482 -&gt; : 16 MB<br>\r\n1483 -&gt; : 16 MB<br>\r\n<br>\r\n<span style=\"font-size:xx-small\"></span></p>\r\n<table dir=\"ltr\" border=\"1\" cellspacing=\"0\" cellpadding=\"1\">\r\n<tbody>\r\n<tr>\r\n<th colspan=\"5\" align=\"left\"><span>( ! )</span>&nbsp;Fatal error: Allowed memory size of 16777216 bytes exhausted (tried to allocate 59 bytes) in D:\\wamp\\www\\xlstest\\1.7.6\\Classes\\PHPExcel\\Worksheet.php on line&nbsp;<em>961</em></th>\r\n</tr>\r\n<tr>\r\n<th colspan=\"5\" align=\"left\">Call Stack</th>\r\n</tr>\r\n<tr>\r\n<th align=\"center\">#</th>\r\n<th align=\"left\">Time</th>\r\n<th align=\"left\">Memory</th>\r\n<th align=\"left\">Function</th>\r\n<th align=\"left\">Location</th>\r\n</tr>\r\n<tr>\r\n<td align=\"center\" bgcolor=\"#eeeeec\">1</td>\r\n<td align=\"center\" bgcolor=\"#eeeeec\">0.0082</td>\r\n<td align=\"right\" bgcolor=\"#eeeeec\">386120</td>\r\n<td bgcolor=\"#eeeeec\">{main}( )</td>\r\n<td title=\"D:\\wamp\\www\\xlstest\\test.php\" bgcolor=\"#eeeeec\">..\\test.php<strong>:</strong>0</td>\r\n</tr>\r\n<tr>\r\n<td align=\"center\" bgcolor=\"#eeeeec\">2</td>\r\n<td align=\"center\" bgcolor=\"#eeeeec\">5.5122</td>\r\n<td align=\"right\" bgcolor=\"#eeeeec\">16770864</td>\r\n<td bgcolor=\"#eeeeec\">PHPExcel_Worksheet-&gt;setCellValue( )</td>\r\n<td title=\"D:\\wamp\\www\\xlstest\\test.php\" bgcolor=\"#eeeeec\">..\\test.php<strong>:</strong>13</td>\r\n</tr>\r\n<tr>\r\n<td align=\"center\" bgcolor=\"#eeeeec\">3</td>\r\n<td align=\"center\" bgcolor=\"#eeeeec\">5.5122</td>\r\n<td align=\"right\" bgcolor=\"#eeeeec\">16770896</td>\r\n<td bgcolor=\"#eeeeec\">PHPExcel_Worksheet-&gt;getCell( )</td>\r\n<td title=\"D:\\wamp\\www\\xlstest\\1.7.6\\Classes\\PHPExcel\\Worksheet.php\" bgcolor=\"#eeeeec\">\r\n..\\Worksheet.php<strong>:</strong>860</td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n<p><span style=\"font-size:xx-small\"></span></p>\r\n<p>&nbsp;</p>\r\n<p>Maybe I'm doing something wrong ?</p>\r\n<p>Do you know there is a solution to save memory and complete my loop ?</p>\r\n<p>I can't add more memory to my php script because I'm on shared server.</p>\r\n<p>&nbsp;</p>\r\n<p>Best</p>\r\n<p>Ultral ?</p>\r\n",
    "PostedDate": "2011-07-12T05:28:46.3-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "641052",
    "ThreadId": "264812",
    "Html": "<p>I play with the&nbsp;PHPExcel_CachedObjectStorageFactory and if I add this , it's much much better :</p>\r\n<p>&nbsp;</p>\r\n<p>$cacheMethod = PHPExcel_CachedObjectStorageFactory::cache_to_phpTemp &nbsp; ;</p>\r\n<p>PHPExcel_Settings::setCacheStorageMethod($cacheMethod);</p>\r\n<p>&nbsp;</p>\r\n<p>Unfortunelly, it crash when I try to save the file :(</p>\r\n<p>This is my ouput :</p>\r\n<p>&nbsp;</p>\r\n<p>Output to output/test13_18_16.xls<br /><span style=\"font-size: xx-small;\"> </span></p>\r\n<table class=\"xdebug-error\" dir=\"ltr\" border=\"1\" cellspacing=\"0\" cellpadding=\"1\">\r\n<tbody>\r\n<tr>\r\n<th colspan=\"5\" align=\"left\"><span>( ! )</span>&nbsp;Fatal error: Allowed memory size of 16777216 bytes exhausted (tried to allocate 24 bytes) in D:\\wamp\\www\\xlstest\\1.7.6\\Classes\\PHPExcel\\CachedObjectStorage\\PHPTemp.php on line&nbsp;<em>98</em></th>\r\n</tr>\r\n<tr>\r\n<th colspan=\"5\" align=\"left\">Call Stack</th>\r\n</tr>\r\n<tr>\r\n<th align=\"center\">#</th><th align=\"left\">Time</th><th align=\"left\">Memory</th><th align=\"left\">Function</th><th align=\"left\">Location</th>\r\n</tr>\r\n<tr>\r\n<td align=\"center\" bgcolor=\"#eeeeec\">1</td>\r\n<td align=\"center\" bgcolor=\"#eeeeec\">0.0076</td>\r\n<td align=\"right\" bgcolor=\"#eeeeec\">386040</td>\r\n<td bgcolor=\"#eeeeec\">{main}( )</td>\r\n<td title=\"D:\\wamp\\www\\xlstest\\test.php\" bgcolor=\"#eeeeec\">..\\test.php<strong>:</strong>0</td>\r\n</tr>\r\n<tr>\r\n<td align=\"center\" bgcolor=\"#eeeeec\">2</td>\r\n<td align=\"center\" bgcolor=\"#eeeeec\">8.6953</td>\r\n<td align=\"right\" bgcolor=\"#eeeeec\">11845800</td>\r\n<td bgcolor=\"#eeeeec\">PHPExcel_Writer_Excel2007-&gt;save( )</td>\r\n<td title=\"D:\\wamp\\www\\xlstest\\test.php\" bgcolor=\"#eeeeec\">..\\test.php<strong>:</strong>36</td>\r\n</tr>\r\n<tr>\r\n<td align=\"center\" bgcolor=\"#eeeeec\">3</td>\r\n<td align=\"center\" bgcolor=\"#eeeeec\">13.9172</td>\r\n<td align=\"right\" bgcolor=\"#eeeeec\">12052008</td>\r\n<td bgcolor=\"#eeeeec\">PHPExcel_Writer_Excel2007_StringTable-&gt;createStringTable( )</td>\r\n<td title=\"D:\\wamp\\www\\xlstest\\1.7.6\\Classes\\PHPExcel\\Writer\\Excel2007.php\" bgcolor=\"#eeeeec\">..\\Excel2007.php<strong>:</strong>210</td>\r\n</tr>\r\n<tr>\r\n<td align=\"center\" bgcolor=\"#eeeeec\">4</td>\r\n<td align=\"center\" bgcolor=\"#eeeeec\">16.5482</td>\r\n<td align=\"right\" bgcolor=\"#eeeeec\">16635744</td>\r\n<td bgcolor=\"#eeeeec\">PHPExcel_Worksheet-&gt;getCell( )</td>\r\n<td title=\"D:\\wamp\\www\\xlstest\\1.7.6\\Classes\\PHPExcel\\Writer\\Excel2007\\StringTable.php\" bgcolor=\"#eeeeec\">..\\StringTable.php<strong>:</strong>64</td>\r\n</tr>\r\n<tr>\r\n<td align=\"center\" bgcolor=\"#eeeeec\">5</td>\r\n<td align=\"center\" bgcolor=\"#eeeeec\">16.5482</td>\r\n<td align=\"right\" bgcolor=\"#eeeeec\">16635744</td>\r\n<td bgcolor=\"#eeeeec\">PHPExcel_CachedObjectStorage_PHPTemp-&gt;getCacheData( )</td>\r\n<td title=\"D:\\wamp\\www\\xlstest\\1.7.6\\Classes\\PHPExcel\\Worksheet.php\" bgcolor=\"#eeeeec\">..\\Worksheet.php<strong>:</strong>929</td>\r\n</tr>\r\n<tr>\r\n<td align=\"center\" bgcolor=\"#eeeeec\">6</td>\r\n<td align=\"center\" bgcolor=\"#eeeeec\">16.5483</td>\r\n<td align=\"right\" bgcolor=\"#eeeeec\">16636224</td>\r\n<td bgcolor=\"#eeeeec\"><a href=\"http://www.php.net/unserialize\" target=\"_new\">unserialize</a>&nbsp;( )</td>\r\n<td title=\"D:\\wamp\\www\\xlstest\\1.7.6\\Classes\\PHPExcel\\CachedObjectStorage\\PHPTemp.php\" bgcolor=\"#eeeeec\">..\\PHPTemp.php<strong>:</strong>98</td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n<p><span style=\"font-size: xx-small;\"> </span></p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2011-07-12T06:20:37.177-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "641054",
    "ThreadId": "264812",
    "Html": "<p>Hi, you need to increase your memory limit. 16MB is a little low ;) try 128M or higher! (search this forum for more memory conserving tips and tricks)</p>",
    "PostedDate": "2011-07-12T06:23:17.807-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "641075",
    "ThreadId": "264812",
    "Html": "<p>I can't increase memory because I'm on shared server :(</p>\r\n<p>This is why i'll be happy if there is another solution.</p>",
    "PostedDate": "2011-07-12T07:01:43.563-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]