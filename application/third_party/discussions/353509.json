[
  {
    "Id": "828304",
    "ThreadId": "353509",
    "Html": "\r\n<p>Hallo,</p>\r\n<p>Can you guys help me with a script that gets selective data from given cells within a xlsx file and makes a csv file from that data.</p>\r\n<p>This is wat i got now.</p>\r\n<p></p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre>&lt;?php\r\n<span style=\"color:blue\">include</span> <span style=\"color:#a31515\">'Classes/PHPExcel.php'</span>;\r\n\r\n$inputFileType = <span style=\"color:#a31515\">'Excel5'</span>; \r\n$inputFileName = <span style=\"color:#a31515\">'example.xls'</span>; \r\n$sheetname = <span style=\"color:#a31515\">'Data Sheet #1'</span>; \r\n\r\n\r\n<span style=\"color:green\">/**  Define a Read Filter class implementing PHPExcel_Reader_IReadFilter  */</span> \r\n<span style=\"color:blue\">class</span> MyReadFilter <span style=\"color:blue\">implements</span> PHPExcel_Reader_IReadFilter \r\n{ \r\n    <span style=\"color:blue\">public</span> <span style=\"color:blue\">function</span> readCell($column, $row, $worksheetName = <span style=\"color:#a31515\">''</span>) { \r\n        <span style=\"color:green\">//  Read rows 11 to 17 and columns X to Z only </span>\r\n        <span style=\"color:blue\">if</span> ($row &gt;= 11 &amp;&amp; $row &lt;= 17) { \r\n            <span style=\"color:blue\">if</span> (in_array($column,range(<span style=\"color:#a31515\">'X'</span>,<span style=\"color:#a31515\">'Z'</span>))) { \r\n                <span style=\"color:blue\">return</span> true; \r\n            } \r\n        } \r\n        <span style=\"color:blue\">return</span> false; \r\n    } \r\n} \r\n\r\n<span style=\"color:green\">/**  Create an Instance of our Read Filter  **/</span> \r\n$filterSubset = <span style=\"color:blue\">new</span> MyReadFilter(); \r\n\r\n<span style=\"color:green\">/**  Create a new Reader of the type defined in $inputFileType  **/</span> \r\n$objReader = PHPExcel_IOFactory::createReader($inputFileType); \r\n<span style=\"color:green\">/**  Tell the Reader that we want to use the Read Filter  **/</span> \r\n$objReader-&gt;setReadFilter($filterSubset); \r\n<span style=\"color:green\">/**  Load only the rows and columns that match our filter to PHPExcel  **/</span> \r\n$objPHPExcel = $objReader-&gt;load($inputFileName);\r\n\r\n<span style=\"color:green\">// Rename sheet</span>\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setTitle(<span style=\"color:#a31515\">'Simple'</span>);\r\n\r\n\r\n<span style=\"color:green\">// Set active sheet index to the first sheet, so Excel opens this as the first sheet</span>\r\n$objPHPExcel-&gt;setActiveSheetIndex(0);\r\n\r\n\r\n<span style=\"color:green\">// Redirect output to a clientï¿½s web browser (Excel5)</span>\r\nheader(<span style=\"color:#a31515\">'Content-Type: application/vnd.ms-excel'</span>);\r\nheader(<span style=\"color:#a31515\">'Content-Disposition: attachment;filename=&quot;01simple.xls&quot;'</span>);\r\nheader(<span style=\"color:#a31515\">'Cache-Control: max-age=0'</span>);\r\n\r\n$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, <span style=\"color:#a31515\">'Excel5'</span>);\r\n$objWriter-&gt;save(<span style=\"color:#a31515\">'php://output'</span>);\r\n<span style=\"color:blue\">exit</span>;\r\n?&gt;\r\n</pre>\r\n</div>\r\n<p></p>\r\n<p>This one only selects rows 11 to 17 and cols X to Z, then it makes a xls file from that data.<br>\r\nThe script works good but i want to create a csv file comma delimitted and also add other cells like B2, B3, E2, E5 etc.</p>\r\n<p>Can anyone help me with this, i'm a beginner PHP programmer.</p>\r\n",
    "PostedDate": "2012-04-25T04:09:33.957-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]