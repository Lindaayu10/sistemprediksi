[
  {
    "Id": "895246",
    "ThreadId": "390189",
    "Html": "\r\n<p>Hi! We have a fantastically complicated spreadsheet we're working with that I am able to read values out of when loading the file with PHPExcel, but if I attempt to change any of the values and output the file as a download or otherwise this causes a very\r\n peculiar error, which I will paste below.</p>\r\n<p>&nbsp;</p>\r\n<p>~~~~~~~~~~~~~~~~~~~~~</p>\r\n<p>Fatal error: Uncaught exception 'Exception' with message 'Detail Calc!D7 -&gt; Detail Calc!H61 -&gt; Detail Calc!D61 -&gt; Detail Calc!H60 -&gt; Detail Calc!D60 -&gt; Detail Calc!H59 -&gt; Detail Calc!D59 -&gt; Detail Calc!H58 -&gt; Detail Calc!D58 -&gt;\r\n Detail Calc!H57 -&gt; Detail Calc!D57 -&gt; Detail Calc!H56 -&gt; Detail Calc!D56 -&gt; Detail Calc!H55 -&gt; Detail Calc!D55 -&gt; Detail Calc!H54 -&gt; Detail Calc!D54 -&gt; Detail Calc!H53 -&gt; Detail Calc!D53 -&gt; Detail Calc!H52 -&gt; Detail Calc!D52\r\n -&gt; Detail Calc!H51 -&gt; Detail Calc!D51 -&gt; Detail Calc!H50 -&gt; Detail Calc!D50 -&gt; Detail Calc!H49 -&gt; Detail Calc!D49 -&gt; Detail Calc!H48 -&gt; Detail Calc!D48 -&gt; Detail Calc!H47 -&gt; Detail Calc!D47 -&gt; Detail Calc!H46 -&gt; Detail Calc!D46\r\n -&gt; Detail Calc!H45 -&gt; Detail Calc!D45 -&gt; Detail Calc!H44 -&gt; Detail Calc!D44 -&gt; Detail Calc!H43 -&gt; Detail Calc!D43 -&gt; Detail Calc!H42 -&gt; Detail Calc!D42 -&gt; Detail Calc!H41 -&gt; Detail Calc!D41 -&gt; Detail Calc!H40 -&gt; Detail Calc!D40\r\n -&gt; Detail Calc!H39 -&gt; Detail Calc!D39 -&gt; Detail Calc!H38 -&gt; Detail Calc!D38 -&gt; Detail Calc!H37 -&gt; Detail Calc!D37 -&gt; Detail Calc in /opt/local/apache2/htdocs/passwordtrustee/web/PHPExcel/PHPExcel/Cell.php on line 293</p>\r\n<p>~~~~~~~~~~~~~~~~~~~~~~</p>\r\n<p>&nbsp;</p>\r\n<p>I am running PHP 5.3.12 on OS X with the gd2, zip, xml extensions and xdebug is disabled. An example of the code that I am using can be found here:&nbsp;https://gist.github.com/8d8e379218bf3e966833</p>\r\n<p>... but the important parts are these:</p>\r\n<pre>require_once dirname(__FILE__) . '/PHPExcel/PHPExcel.php';\r\n$objPHPExcel = new PHPExcel();\r\n\r\n$objReader = new PHPExcel_Reader_Excel5();\r\n$objReader-&gt;setReadDataOnly(true);\r\n$objPHPExcel = $objReader-&gt;load( dirname(__FILE__) . '/test.xls' );\r\n$assumpSheet = $objPHPExcel-&gt;setActiveSheetIndexByName('Assump');</pre>\r\n<pre><div id=\"LC42\"><span>$formData</span> <span>=</span> <span>$_POST</span><span>[</span><span>'assumptions'</span><span>];</span></div><div id=\"LC43\"><span>$assumpSheet</span><span>-&gt;</span><span>getCell</span><span>(</span><span>'F10'</span><span>)</span><span>-&gt;</span><span>setValue</span><span>(</span><span>$formData</span><span>[</span><span>'spending'</span><span>]);</span></div><div id=\"LC44\"><span>$assumpSheet</span><span>-&gt;</span><span>getCell</span><span>(</span><span>'F36'</span><span>)</span><span>-&gt;</span><span>setValue</span><span>(</span><span>$formData</span><span>[</span><span>'spendingIncreaseConstant'</span><span>]);</span></div><div id=\"LC45\"><span>$assumpSheet</span><span>-&gt;</span><span>getCell</span><span>(</span><span>'E62'</span><span>)</span><span>-&gt;</span><span>setValue</span><span>(</span><span>$formData</span><span>[</span><span>'portfolioCost'</span><span>]);</span></div><div id=\"LC46\"><span>$assumpSheet</span><span>-&gt;</span><span>getCell</span><span>(</span><span>'D42'</span><span>)</span><span>-&gt;</span><span>setValue</span><span>(</span><span>$formData</span><span>[</span><span>'portfolioExistingTaxable'</span><span>]);</span></div><div id=\"LC55\"><span>$objWriter</span> <span>=</span> <span>new</span> <span>PHPExcel_Writer_Excel2007</span><span>(</span><span>$objPHPExcel</span><span>);</span></div><div id=\"LC56\"><span>$objWriter</span><span>-&gt;</span><span>save</span><span>(</span><span>'test.xls'</span><span>);</span></div><div id=\"LC56\"><span><br></span></div><div id=\"LC56\"><span>Any ideas on how to fix this exception or am I doomed to being able to read from this sheet but not actually make changes and output them?</span></div><div><span><br></span></div></pre>\r\n",
    "PostedDate": "2012-08-03T09:35:50.91-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "895381",
    "ThreadId": "390189",
    "Html": "<div id=\"LC55\"><span>Try setting precalculate formulas to false before the save:</span></div>\r\n<div><span>&nbsp;</span></div>\r\n<div><span>$objWriter</span> <span>=</span> <span>new</span> <span>PHPExcel_Writer_Excel2007</span><span>(</span><span>$objPHPExcel</span><span>);</span></div>\r\n<div><span><span>$objWriter</span><span>-&gt;</span>setPreCalculateFormulas(FALSE);</span></div>\r\n<div id=\"LC56\"><span>$objWriter</span><span>-&gt;</span><span>save</span><span>(</span><span>'test.xls'</span><span>);</span></div>\r\n<div><span>&nbsp;</span></div>\r\n<div><span>This stops PHPExcel from precalculating formulae, forcing MS Excel to do it when the newly saved file is first loaded.</span></div>\r\n<div><span>&nbsp;</span></div>\r\n<div><span>If it's possible to send me a copy of the workbook I'd appreciate it. I'd like to run some tests to see what is triggering this problem.</span></div>",
    "PostedDate": "2012-08-03T13:47:15.643-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "896075",
    "ThreadId": "390189",
    "Html": "<p>Hey Mark,</p>\r\n<p>That helped me surmount this particular problem, thank you! As it turns out however, because the excel file has macros, and despite the fact that I dont actually want PHPExcel to use the macros but instead just update a couple of field values (and then let a user download/run the macros in their copy of excel)... I won't be able to use PHPExcel to serve my needs for this particular task. Thanks anyway!</p>",
    "PostedDate": "2012-08-06T08:15:11.06-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]