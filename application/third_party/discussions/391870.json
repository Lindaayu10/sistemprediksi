[
  {
    "Id": "899899",
    "ThreadId": "391870",
    "Html": "\r\n<p>Hi everyone !</p>\r\n<p>I tried to use the script given on the phpexcel homepage, in order to get some content from my SQL database, but it doesn't work...<br>\r\n<br>\r\nHere's the snippet of code :</p>\r\n<div style=\"background-color:white; color:black\">\r\n<pre>&lt;?php\r\n\r\n<span style=\"color:green\">/** PHPExcel */</span>\r\n<span style=\"color:blue\">require_once</span> <span style=\"color:#a31515\">'../include/PHPExcel.php'</span>;\r\n\r\n<span style=\"color:green\">/** DB and stuff */</span>\r\n<span style=\"color:blue\">include</span>(<span style=\"color:#a31515\">&quot;../include/connexionmysql.inc.php&quot;</span>);\r\n<span style=\"color:blue\">include</span>(<span style=\"color:#a31515\">&quot;../include/lib-prc2.php&quot;</span>);\r\n\r\n<span style=\"color:green\">// Create new PHPExcel object</span>\r\n$objPHPExcel = <span style=\"color:blue\">new</span> PHPExcel();\r\n\r\n<span style=\"color:green\">// Database with existing object</span>\r\n$sql = <span style=\"color:#a31515\">&quot;SELECT * FROM `client` ORDER BY `id_client` ASC&quot;</span>;\r\n$res = $db-&gt;query($sql) OR <span style=\"color:blue\">die</span> (<span style=\"color:#a31515\">&quot;Erreur :&quot;</span> .$this-&gt;db-&gt;error);\r\n\r\n<span style=\"color:green\">// First Row (Names)</span>\r\n$objPHPExcel-&gt;setActiveSheetIndex(0);\r\n<span style=\"color:blue\">foreach</span> ($res-&gt;getColumnNames() <span style=\"color:blue\">as</span> $coluna=&gt;$num) {\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValueByColumnAndRow ($num,1,$coluna);\r\n}\r\n\r\n<span style=\"color:green\">// Other Rows (Data)</span>\r\n$i = 2;\r\n<span style=\"color:blue\">while</span> ($row = $res-&gt;fetchrow()) {\r\n<span style=\"color:blue\">foreach</span> ($row <span style=\"color:blue\">as</span> $col=&gt;$dado) $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValueByColumnAndRow ($col,$i,$dado);\r\n$i&#43;&#43;;\r\n}\r\n\r\n<span style=\"color:green\">// Redirect output to a client&acirc;&euro;&trade;s web browser (Excel5)</span>\r\nheader(<span style=\"color:#a31515\">'Content-Type: application/vnd.ms-excel'</span>);\r\nheader(<span style=\"color:#a31515\">'Content-Disposition: attachment;filename=&quot;table.xls&quot;'</span>);\r\nheader(<span style=\"color:#a31515\">'Cache-Control: max-age=0'</span>);\r\n\r\n$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, <span style=\"color:#a31515\">'Excel5'</span>);\r\n$objWriter-&gt;save(<span style=\"color:#a31515\">'php://output'</span>);\r\n<span style=\"color:blue\">exit</span>;\r\n?&gt;</pre>\r\nIn my browser I get the following error :</div>\r\n<p>Fatal error: Call to undefined method mysqli_result::getColumnNames() in [...] on line 20</p>\r\n<p>Any idea ?<br>\r\nThanks in advance</p>\r\n<p><strong>Apache/2.2.22 (Win32) PHP/5.4.4</strong></p>\r\n",
    "PostedDate": "2012-08-16T05:34:59.663-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]