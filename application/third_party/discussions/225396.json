[
  {
    "Id": "486787",
    "ThreadId": "225396",
    "Html": "<p>Hi,</p>\r\n<p>I got a prob while reading .xslx file.</p>\r\n<p>The file has around 100 columns and 20000 rows.</p>\r\n<p>Didn't get any output or error.</p>\r\n<p>Kindly advice.</p>\r\n<p>Thanks in advance.</p>\r\n<p>&nbsp;</p>\r\n<p>- Prema</p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2010-08-31T01:12:23.93-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "487536",
    "ThreadId": "225396",
    "Html": "<p>This doesn't really give us much to help with identifying any problem.</p>\r\n<p>Are you suppressing any errors? what code are you using to read the file? How do you know it's not being read correctly? Is there anything in the xlsx file that might be breaking PHPExcel? We can try to help, but only if you give us something to work with.</p>",
    "PostedDate": "2010-09-01T05:16:05.44-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "488002",
    "ThreadId": "225396",
    "Html": "<p>Thanks Mark.</p>\r\n<p>We are not suppressing errors.</p>\r\n<p>How to read more than 10MB size of&nbsp; .xlsx files ?</p>\r\n<p>Will PHPExcel support more than 10MB .xlsx file to .xls conversion ?</p>\r\n<p>Kindly advice as soon as possible.</p>\r\n<p>Thanks</p>\r\n<p>&nbsp;</p>\r\n<p>- Prema</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2010-09-01T22:46:57.587-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "488121",
    "ThreadId": "225396",
    "Html": "<blockquote style=\"border:solid .1em #ccc;font-style:italic;margin:.25em 1em 0 1em;padding:0 .25em 0 .25em\"><strong>Premalatha wrote:</strong><br>\r\n<p>We are not suppressing errors.</p>\r\n</blockquote>\r\n<p>&nbsp;If memory was your issue, I'd still expect to see PHP's standard error message for exceeding the permitted memory.</p>\r\n<blockquote style=\"border:solid .1em #ccc;font-style:italic;margin:.25em 1em 0 1em;padding:0 .25em 0 .25em\"><strong>Premalatha wrote:</strong><br>\r\n<p>How to read more than 10MB size of&nbsp; .xlsx files ?</p>\r\n<p>Will PHPExcel support more than 10MB .xlsx file to .xls conversion ?</p>\r\n<p>Kindly advice as soon as possible.</p>\r\n</blockquote>\r\n<p>PHPExcel doesn't limit size, but PHP itself does limit the memory resources available for scripts, and this can cause problems when trying to work with large files.</p>\r\n<p>File size isn't a good measure for workbook files when working with PHPExcel. The number of rows and columns (ie cells) is more important.</p>\r\n<p>The PHPExcel code itself has a footprint of between 10 and 25MB, depending on which components are being accessed.</p>\r\n<p>At present, each cell in a workbook takes on average 1k of memory (without any caching) or 1.6k on 64-bit PHP - I'll assume 32-bit PHP for the moment - so (for example) a worksheet of 20,000&nbsp;rows with 100 columns (2,000,000 cells) will be about 1.9GB. With cell cacheing (such as php://temp or DiskISAM), that can be reduced to about a third, so the 20,000&nbsp;rows by&nbsp;100 columns will require about 650MB.</p>\r\n<p>The writers may double that requirement.</p>\r\n<p>There are a number of options available to help you reduce the memory usage:</p>\r\n<p>Are you using cell caching with PHPExcel?</p>\r\n<pre><code><span>require_once </span><span class=str>'./Classes/PHPExcel.php'</span><span>;</span><span>&nbsp;\r\n&nbsp;\r\n$cacheMethod </span><span>=</span><span> </span><span>PHPExcel_CachedObjectStorageFactory</span><span>::</span><span> cache_to_phpTemp</span><span>;</span><span>&nbsp;\r\n$cacheSettings </span><span>=</span><span> array</span><span>(</span><span> </span><span class=str>' memoryCacheSize '</span><span> </span><span>=&gt;</span><span> </span><span class=str>'8MB'</span><span>);</span><span>&nbsp;\r\n</span><span>PHPExcel_Settings</span><span>::</span><span>setCacheStorageMethod</span><span>(</span><span>$cacheMethod</span><span>,</span><span> $cacheSettings</span><span>);</span><span>&nbsp;\r\n&nbsp;\r\n$objReader </span><span>=</span><span> </span><span>PHPExcel_IOFactory</span><span>::</span><span>createReader</span><span>(</span><span class=str>'Excel2007'</span><span>);</span><span>&nbsp;\r\n$objPHPExcel </span><span>=</span><span> $objReader</span><span>-&gt;</span><span>load</span><span>(</span><span class=str>&quot;test.xlsx&quot;</span><span>);</span><span>&nbsp;\r\n</span></code></pre>\r\n<p>If you only need to access data in your worksheets, and don't need access to the cell formatting, then you can disable reading the formatting information from the workbook:</p>\r\n<pre><code><span>$objReader </span><span>=</span><span> </span><span>PHPExcel_IOFactory</span><span>::</span><span>createReader</span><span>(</span><span class=str>'Excel2007'</span><span>);</span><span>&nbsp;\r\n$objReader</span><span>-&gt;</span><span>setReadDataOnly</span><span>(</span><span>true</span><span>);</span><span>&nbsp;\r\n$objPHPExcel </span><span>=</span><span> $objReader</span><span>-&gt;</span><span>load</span><span>(</span><span class=str>&quot;test.xlsx&quot;</span><span>);</span><span>&nbsp;\r\n</span></code></pre>\r\n<p>If you only need to access some, but not all of the worksheets in the workbook, you can load only those worksheets:</p>\r\n<pre><code><span>$objReader </span><span>=</span><span> </span><span>PHPExcel_IOFactory</span><span>::</span><span>createReader</span><span>(</span><span class=str>'Excel2007'</span><span>);</span><span>&nbsp;\r\n$objReader</span><span>-&gt;</span><span>setLoadSheetsOnly</span><span>(</span><span> array</span><span>(</span><span class=str>&quot;Worksheet1&quot;</span><span>,</span><span> </span><span class=str>&quot;Worksheet2&quot;</span><span>)</span><span> </span><span>);</span><span>&nbsp;\r\n$objPHPExcel </span><span>=</span><span> $objReader</span><span>-&gt;</span><span>load</span><span>(</span><span class=str>&quot;test.xlsx&quot;</span><span>);</span><span>&nbsp;\r\n</span></code></pre>\r\n<p>if you only want to read certain cells within worksheets, you can add a filter:</p>\r\n<pre><code><span>class</span><span> </span><span>MyReadFilter</span><span> </span><span>implements</span><span> </span><span>PHPExcel_Reader_IReadFilter</span><span>&nbsp;\r\n</span><span>{</span><span>&nbsp;\r\n&nbsp; &nbsp; </span><span>public</span><span> </span><span>function</span><span> readCell</span><span>(</span><span>$column</span><span>,</span><span> $row</span><span>,</span><span> $worksheetName </span><span>=</span><span> </span><span class=str>''</span><span>)</span><span> </span><span>{</span><span>&nbsp;\r\n&nbsp; &nbsp; &nbsp; &nbsp; </span><span>// Read title row and rows 20 - 30</span><span>&nbsp;\r\n&nbsp; &nbsp; &nbsp; &nbsp; </span><span>if</span><span> </span><span>(</span><span>$row </span><span>==</span><span> </span><span>1</span><span> </span><span>||</span><span> </span><span>(</span><span>$row </span><span>&gt;=</span><span> </span><span>20</span><span> </span><span>&amp;&amp;</span><span> $row </span><span>&lt;=</span><span> </span><span>30</span><span>))</span><span> </span><span>{</span><span>&nbsp;\r\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span>return</span><span> </span><span>true</span><span>;</span><span>&nbsp;\r\n&nbsp; &nbsp; &nbsp; &nbsp; </span><span>}</span><span>&nbsp;\r\n&nbsp;\r\n&nbsp; &nbsp; &nbsp; &nbsp; </span><span>return</span><span> </span><span>false</span><span>;</span><span>&nbsp;\r\n&nbsp; &nbsp; </span><span>}</span><span>&nbsp;\r\n</span><span>}</span><span>&nbsp;\r\n&nbsp;\r\n$objReader </span><span>=</span><span> </span><span>PHPExcel_IOFactory</span><span>::</span><span>createReader</span><span>(</span><span class=str>'Excel2007'</span><span>);</span><span>&nbsp;\r\n$objReader</span><span>-&gt;</span><span>setReadFilter</span><span>(</span><span> </span><span>new</span><span> </span><span>MyReadFilter</span><span>()</span><span> </span><span>);</span><span>&nbsp;\r\n$objPHPExcel </span><span>=</span><span> $objReader</span><span>-&gt;</span><span>load</span><span>(</span><span class=str>&quot;test.xlsx&quot;</span><span>);</span><span>&nbsp;\r\n</span></code></pre>\r\n<p>All of these techniques can significantly reduce the memory requirements.</p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2010-09-02T03:22:38.313-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]