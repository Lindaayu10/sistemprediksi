[
  {
    "Id": "1126321",
    "ThreadId": "470388",
    "Html": "I'm having problems generating a kind of complex Excel file that uses a couple of for loops. I've troubleshoot the problem and it boils down to this:<br />\n<br />\nThis code produces a valid Excel file:<br />\n<pre><code>&lt;?php\nrequire_once 'PHPExcel/PHPExcel.php';\n\n$objPHPExcel = new PHPExcel();\n\nfor($i = 0; $i &lt; 17; $i++)\n{\n    $objPHPExcel-&gt;setActiveSheetIndex(0)\n                -&gt;setCellValue(&quot;A$i&quot;, $i);\n}\n\n$objPHPExcel-&gt;setActiveSheetIndex(0);\n\nheader('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');\nheader('Content-Disposition: attachment;filename=&quot;test.xlsx&quot;');\nheader('Cache-Control: max-age=0');\n$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, 'Excel2007');\n$objWriter-&gt;save('php://output');\nexit;</code></pre>\n\nBut this one doesn't:<br />\n<pre><code>&lt;?php\nrequire_once 'PHPExcel/PHPExcel.php';\n\n$objPHPExcel = new PHPExcel();\n\nfor($i = 0; $i &lt; 18; $i++)\n{\n    $objPHPExcel-&gt;setActiveSheetIndex(0)\n                -&gt;setCellValue(&quot;A$i&quot;, $i);\n}\n\n$objPHPExcel-&gt;setActiveSheetIndex(0);\n\nheader('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');\nheader('Content-Disposition: attachment;filename=&quot;test.xlsx&quot;');\nheader('Cache-Control: max-age=0');\n$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, 'Excel2007');\n$objWriter-&gt;save('php://output');\nexit;</code></pre>\n\nHint: over 17 loops, the file gets corrupted...<br />\n<br />\n<br />\nBut this works without a problem:<br />\n<pre><code>&lt;?php\nrequire_once 'PHPExcel/PHPExcel.php';\n\n$objPHPExcel = new PHPExcel();\n\nfor($i = 0; $i &lt; 100; $i++)\n{\n    $objPHPExcel-&gt;setActiveSheetIndex(0)\n                -&gt;setCellValue(&quot;A$i&quot;, 'blaba');\n}\n\n$objPHPExcel-&gt;setActiveSheetIndex(0);\n\nheader('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');\nheader('Content-Disposition: attachment;filename=&quot;test.xlsx&quot;');\nheader('Cache-Control: max-age=0');\n$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, 'Excel2007');\n$objWriter-&gt;save('php://output');\nexit;</code></pre>\n\nSo the problem is only with integers, at least from my experience. I'm originally outputting a simple line number coming from another system, which exposes the same problem.<br />\n<br />\nMy environment:<br />\n<ul>\n<li>Window Server 2008 SP2</li>\n<li>IIS 6.0 SP2</li>\n<li>PHP 5.2.8 (FastCGI)</li>\n<li>\nPHPExcel 1.7.9<br />\n</li>\n</ul>\nCould it be IIS? I'm really puzzled!<br />\n<br />\nThanks if advance for your help!<br />\n<br />\nEDIT: Forgot to specify that once recovered, the excel file is okay except that line 17, 19, 29, 39, etc. have &quot;.:&quot; added to the end. It's always the same numbers but I can't make sense of them...<br />\n<br />\nEDIT 2: Wow, after spending 5 minutes writing this post, I went back and now it's outputting properly! This is crazy, I've been troubleshooting for an hour and I was always able to reproduce the problem. It's got to be IIS but I have no clue what exactly could be causing this. Would anybody have a clue? I know it's getting off topic..<br />\n<br />\nEDIT 3: Started acting up again and &quot;iisreset&quot; fixed the problem. Definitely an IIS problem... sorry for polluting the forum!<br />\n",
    "PostedDate": "2013-11-18T18:29:59.547-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": "2013-11-18T18:53:05.717-08:00"
  }
]