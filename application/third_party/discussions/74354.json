[
  {
    "Id": "254343",
    "ThreadId": "74354",
    "Html": "<p>Greetings,</p>\r\n<p>I have one course with two &quot;Team Learning&quot; sessions where about 12 test students took 3 exams, (IRAT, GRAT, and AppEx).</p>\r\n<p>I am trying to pull this info and write it to Excel.</p>\r\n<p>The dump of my main session_grade table looks like this.</p>\r\n<p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre>tl_session_grades` (\r\n  `Session_ID` <span style=\"color:Blue\">int</span>(11) <span style=\"color:Blue\">NOT</span> <span style=\"color:Blue\">NULL</span> <span style=\"color:Blue\">default</span> <span style=\"color:#A31515\">'0'</span>,\r\n  `SOMS_KEY` <span style=\"color:Blue\">int</span>(11) <span style=\"color:Blue\">NOT</span> <span style=\"color:Blue\">NULL</span> <span style=\"color:Blue\">default</span> <span style=\"color:#A31515\">'0'</span>,\r\n  `UID` <span style=\"color:Blue\">varchar</span>(9) <span style=\"color:Blue\">default</span> <span style=\"color:Blue\">NULL</span>,\r\n  `Group_ID` <span style=\"color:Blue\">int</span>(11) <span style=\"color:Blue\">NOT</span> <span style=\"color:Blue\">NULL</span> <span style=\"color:Blue\">default</span> <span style=\"color:#A31515\">'0'</span>,\r\n  `IRAT_Raw` <span style=\"color:Blue\">decimal</span>(3,1) <span style=\"color:Blue\">NOT</span> <span style=\"color:Blue\">NULL</span>,\r\n  `GRAT_Raw` <span style=\"color:Blue\">decimal</span>(3,1) <span style=\"color:Blue\">NOT</span> <span style=\"color:Blue\">NULL</span>,\r\n  `AppEx_Raw` <span style=\"color:Blue\">decimal</span>(4,2) <span style=\"color:Blue\">NOT</span> <span style=\"color:Blue\">NULL</span>,\r\n  `IRAT_Grade` <span style=\"color:Blue\">decimal</span>(5,2) <span style=\"color:Blue\">default</span> <span style=\"color:Blue\">NULL</span>,\r\n  `GRAT_Grade` <span style=\"color:Blue\">decimal</span>(5,2) <span style=\"color:Blue\">default</span> <span style=\"color:Blue\">NULL</span>,\r\n  `AppEx_Grade` <span style=\"color:Blue\">decimal</span>(5,2) <span style=\"color:Blue\">default</span> <span style=\"color:Blue\">NULL</span>,\r\n  `TL_Avg` <span style=\"color:Blue\">decimal</span>(5,2) <span style=\"color:Blue\">default</span> <span style=\"color:Blue\">NULL</span>,\r\n  `Academic_Year` <span style=\"color:Blue\">varchar</span>(5) <span style=\"color:Blue\">NOT</span> <span style=\"color:Blue\">NULL</span> <span style=\"color:Blue\">default</span> <span style=\"color:#A31515\">''</span>,\r\n  <span style=\"color:Blue\">KEY</span> `SOMS_KEY` (`SOMS_KEY`),\r\n  <span style=\"color:Blue\">KEY</span> `UID` (`UID`),\r\n  <span style=\"color:Blue\">KEY</span> `Group_ID` (`Group_ID`)\r\n) ENGINE=MyISAM <span style=\"color:Blue\">DEFAULT</span> CHARSET=latin1;\r\n<br><br>I want to pull all the results for a single course for whatever year appears in the drop down listbox on the form.<br><br><div style=\"color:Black;background-color:White\"><pre>$Course_Number = ( <span style=\"color:Blue\">isset</span>($_GET[<span style=\"color:#A31515\">'Course_Number'</span>]) ) ? ($_GET[<span style=\"color:#A31515\">'Course_Number'</span>]) : ( ( <span style=\"color:Blue\">isset</span>($_POST[<span style=\"color:#A31515\">'Course_Number'</span>]) ) ? ($_POST[<span style=\"color:#A31515\">'Course_Number'</span>]) : <span style=\"color:#A31515\">''</span>) ;<br>$query_Year = ( <span style=\"color:Blue\">isset</span>($_GET[<span style=\"color:#A31515\">'query_Year'</span>]) ) ? ($_GET[<span style=\"color:#A31515\">'query_Year'</span>]) : ( ( <span style=\"color:Blue\">isset</span>($_POST[<span style=\"color:#A31515\">'query_Year'</span>]) ) ? ($_POST[<span style=\"color:#A31515\">'query_Year'</span>]) : <span style=\"color:#A31515\">''</span>) ;<br><br><br>For now I'm just trying to pull the names and get those written to the Excel spreadsheet.<pre><br>$result = $db-&gt;sql_query(<span style=\"color:#A31515\">&quot;SELECT b.Name_Last, b.Name_First FROM &quot;</span>.$prefix.&quot;_tl_session_grades a                        <br>JOIN <span style=\"color:#A31515\">&quot;.$prefix.&quot;</span>_tl_session s ON (a.Session_ID = s.Session_ID)                         <br>JOIN <span style=\"color:#A31515\">&quot;.$prefix.&quot;</span>_tl_students b ON (a.SOMS_KEY = b.SOMS_KEY)<br>JOIN <span style=\"color:#A31515\">&quot;.$prefix.&quot;</span>_tl_group_students c ON (a.SOMS_KEY = c.SOMS_KEY)<br>JOIN <span style=\"color:#A31515\">&quot;.$prefix.&quot;</span>_tl_groups g ON (c.Group_ID = g.Group_ID)<br>WHERE s.Course_Number = <span style=\"color:#A31515\">'$Course_Number'</span><br>AND s.Academic_Year = <span style=\"color:#A31515\">'$query_Year'</span><br>ORDER BY b.Name_Last ASC&quot;);<br>        <br><span style=\"color:Blue\">while</span> ($row = $db-&gt;sql_fetchrow($result)) {<br>   $column = <span style=\"color:#A31515\">'C'</span>;<br>   <span style=\"color:Blue\">foreach</span>($row <span style=\"color:Blue\">as</span> $columnData) {<br>      $cellRef = $column.$row;<br>      $objPHPExcel-&gt;setActiveSheetIndex(0)-&gt;setCellValue($cellRef, $columnData);<br>      $column++;<br>   }<br>   $row++;<br>}<br><br>$objPHPExcel-&gt;getActiveSheet()-&gt;setTitle(<span style=\"color:#A31515\">'Simple'</span>);<br>$objPHPExcel-&gt;setActiveSheetIndex(0);<br><br>header(<span style=\"color:#A31515\">'Content-Type: application/vnd.ms-excel'</span>);<br>header(<span style=\"color:#A31515\">'Content-Disposition: attachment;filename=&quot;test-'</span>.date(<span style=\"color:#A31515\">'dMY'</span>).<span style=\"color:#A31515\">'.xls&quot;'</span>);<br>header(<span style=\"color:#A31515\">'Cache-Control: max-age=0'</span>);<br>$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, <span style=\"color:#A31515\">'Excel5'</span>);<br>$objWriter-&gt;save(<span style=\"color:#A31515\">'php://output'</span>);<br><br><br>All I get is garbage data.<br><br>&lt;!-- table \t{mso-displayed-decimal-separator:&quot;\\.&quot;; \tmso-displayed-thousand-separator:&quot;\\,&quot;;} .font0 \t{color:windowtext; \tfont-size:10.0pt; \tfont-weight:400; \tfont-style:normal; \ttext-decoration:none; \tfont-family:Verdana; \tmso-generic-font-family:auto; \tmso-font-charset:0;} .font5 \t{color:windowtext; \tfont-size:10.0pt; \tfont-weight:400; \tfont-style:normal; \ttext-decoration:none; \tfont-family:&quot;小塚ゴシック Pro H&quot;; \tmso-generic-font-family:auto; \tmso-font-charset:128;} .font6 \t{color:windowtext; \tfont-size:10.0pt; \tfont-weight:400; \tfont-style:normal; \ttext-decoration:none; \tfont-family:&quot;Marker Felt&quot;; \tmso-generic-font-family:auto; \tmso-font-charset:0;} td \t{padding-top:1px; \tpadding-right:1px; \tpadding-left:1px; \tmso-ignore:padding; \tcolor:windowtext; \tfont-size:10.0pt; \tfont-weight:400; \tfont-style:normal; \ttext-decoration:none; \tfont-family:Verdana; \tmso-generic-font-family:auto; \tmso-font-charset:0; \tmso-number-format:General; \ttext-align:general; \tvertical-align:bottom; \tborder:none; \tmso-background-source:auto; \tmso-pattern:auto; \tmso-protection:locked visible; \twhite-space:nowrap; \tmso-rotate:0;} ruby \t{ruby-align:left;} rt \t{color:windowtext; \tfont-size:8.0pt; \tfont-weight:400; \tfont-style:normal; \ttext-decoration:none; \tfont-family:Verdana; \tmso-generic-font-family:auto; \tmso-font-charset:0; \tmso-char-type:none; \tdisplay:none;} --&gt; <br></pre>\r\n</pre>\r\n</div>\r\n</pre>\r\n</div>\r\n</p>\r\n<table style=\"border-collapse:collapse\" border=0 cellspacing=0 cellpadding=0 width=1790>\r\n<col width=1790> \r\n<tbody>\r\n<tr height=13>\r\n&lt;!--StartFragment--&gt;\r\n<td width=1790 height=13>&Atilde;<span>&#7;</span><span>&mdash;</span><span>&#1;&#6;&#4;</span><span>B</span><span>&#2;</span><span>&infin;</span><span>&#4;</span><span>=</span><span>&#18;</span><span>&ordm;%r</span><span>&#21;</span><span>8</span><span>&#1;</span><span>X</span><span>&#2;</span><span>&quot;</span><span>&#2;</span><span>1</span><span>&#30;</span><span>&lsaquo;</span><span>&#8;</span><span>&ecirc;</span><span>&#1;&#7;&#1;</span><span>Calibri&Dagger;</span><span>&#20;</span><span>ıˇ &iquest;</span></td>\r\n&lt;!--EndFragment--&gt;\r\n</tr>\r\n</tbody>\r\n</table>\r\n<p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre><div style=\"color:Black;background-color:White\"><pre><pre><br>This is on a Mac OXS server running 10.5.4, running PHP 5.2.5  '--with-xml'<br><br>Ultimately I'd like to get one medical student record with all sessions grades in a single line.<br><br>Example<br><br>Student - Scott Smith<br>Course_Name - Molecular Basis of Medicine <br>Course Number - 571<br>Session Name - Sickle Cell Anemia<br>IRAT_Raw - <br>GRAT_Raw - <br>Appex_Raw -<br>Irat_Grade - <br>Grat_Grade - <br>AppEx_Grade -<br></pre>\r\n</pre>\r\n</div>\r\n</pre>\r\n</div>\r\n</p>\r\n<pre><pre><pre>Session Name - Hyperuriciemia<br>IRAT_Raw - <br>etc <br>etc<br><br>If anybody can get me on the right track I'd really appreciate it.  Been searching the forums and can't find any examples.</pre>\r\n</pre>\r\n</pre>\r\n<p>&nbsp;</p>",
    "PostedDate": "2009-11-06T12:05:13.11-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "254377",
    "ThreadId": "74354",
    "Html": "<p><em>&gt;&gt; All I get is garbage data.</em></p>\r\n<p>It is wise to first try to save Excel file on disk rather than sending output to browser.</p>\r\n<p>Try to change this</p>\r\n<p>&nbsp;</p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre>header(<span style=\"color:#A31515\">'Content-Type: application/vnd.ms-excel'</span>);\r\nheader(<span style=\"color:#A31515\">'Content-Disposition: attachment;filename=&quot;test-'</span>.date(<span style=\"color:#A31515\">'dMY'</span>).<span style=\"color:#A31515\">'.xls&quot;'</span>);\r\nheader(<span style=\"color:#A31515\">'Cache-Control: max-age=0'</span>);\r\n$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, <span style=\"color:#A31515\">'Excel5'</span>);\r\n$objWriter-&gt;save(<span style=\"color:#A31515\">'php://output'</span>);\r\n</pre>\r\n</div>\r\n<p><br>to this<br><br></p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre>$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, <span style=\"color:#A31515\">'Excel5'</span>);\r\n$objWriter-&gt;save(<span style=\"color:#A31515\">'test-'</span>.date(<span style=\"color:#A31515\">'dMY'</span>).<span style=\"color:#A31515\">'.xls'</span>);\r\n</pre>\r\n</div>\r\n<p>&nbsp;</p>\r\n<p>When you do that, how does the Excel file look when you open it? Still garbage data?</p>",
    "PostedDate": "2009-11-06T14:17:34.343-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "255513",
    "ThreadId": "74354",
    "Html": "<p>It wont open.</p>\r\n<p>&nbsp;</p>\r\n<p><strong></strong>\r\n<pre>Warning: fopen(test-10Nov2009.xls) [function.fopen]: failed to open stream: Permission denied in /Library/WebServer/Documents/xxxx/modules/Team_Learning/admin/PHPExcel/Shared/OLE/OLE_Root.php on line 109\r\n\r\nFatal error: Uncaught exception 'Exception' with message 'Can't open test-10Nov2009.xls. It may be in use or protected.' in /Library/WebServer/Documents/xxxx/modules/Team_Learning/admin/PHPExcel/Shared/OLE/OLE_Root.php:111 Stack trace: #0 /Library/WebServer/Documents/xxxx/modules/Team_Learning/admin/PHPExcel/Writer/Excel5.php(224): PHPExcel_Shared_OLE_PPS_Root-&gt;save('test-10Nov2009....') #1 /Library/WebServer/Documents/xxxx/modules/Team_Learning/admin/TLViewSpreadsheet.php(131): PHPExcel_Writer_Excel5-&gt;save('test-10Nov2009....') #2 /Library/WebServer/Documents/xxxx/modules/Team_Learning/admin/index.php(141): include('/Library/WebSer...') #3 /Library/WebServer/Documents/xxxx/modules/Team_Learning/admin/case.php(138): include('/Library/WebSer...') #4 /Library/WebServer/Documents/atlas/admin.php(491): include_once('/Library/WebSer...') #5 {main} thrown in /Library/WebServer/Documents/xxxx/modules/Team_Learning/admin/PHPExcel/Shared/OLE/OLE_Root.php on line 111<br><br>What privileges should my db user need to run PHPExcel?  I have SELECT, INSERT, UPDATE, DELETE, FILE<br><br>Does PHPExcel try to create a temp directory OLE_PPS_Root on my Mac server?  Could this be a permission issue at the server level?</pre>\r\n<strong></strong></p>",
    "PostedDate": "2009-11-10T06:56:26.587-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "255774",
    "ThreadId": "74354",
    "Html": "<p>Make sure that the server has write permission for the directory where you are saving test-10Nov2009.xls</p>\r\n<p>Try using chmod, I think this is the problem.</p>\r\n<p><a href=\"http://phpexcel.codeplex.com/Thread/View.aspx?ThreadId=47209\">http://phpexcel.codeplex.com/Thread/View.aspx?ThreadId=47209</a></p>\r\n<p>The database user privileges has nothing to do with PHPExcel. There cannot be any problem there.</p>\r\n<p>PHPExcel sometimes makes use of the system temp directory so if it is not set up correctly there will be problems, but it doesn't try to create new temp directories.</p>",
    "PostedDate": "2009-11-10T17:17:44.733-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1332815",
    "ThreadId": "74354",
    "Html": "How can I give permission to &quot;save ()&quot; to keep the server?<br />\n<pre><code>$objWriter = PHPExcel_IOFactory::createWriter($entitat, 'Excel2007'); \n$objWriter-&gt;save($rutaFinal.$data.&quot;.xls&quot;);</code></pre>\n\nHe gives me 644, and I can change and give you 755?<br />\n",
    "PostedDate": "2014-12-16T02:00:45.893-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]