[
  {
    "Id": "585227",
    "ThreadId": "250905",
    "Html": "\r\n<p>So, i REALLY need help ;(</p>\r\n<p>Im using the script that MarkBaker saying on the other discussion, but still i cant read the file:</p>\r\n<p></p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre>ini_set(<span style=\"color:#a31515\">&quot;memory_limit&quot;</span>,<span style=\"color:#a31515\">&quot;1024M&quot;</span>);\r\n\r\nset_time_limit(0);\r\n\r\nerror_reporting(E_ALL);\r\n\r\n<span style=\"color:blue\">require_once</span> <span style=\"color:#a31515\">'Classes/PHPExcel/IOFactory.php'</span>;\r\n\r\n<span style=\"color:blue\">class</span> chunkReadFilter <span style=\"color:blue\">implements</span> PHPExcel_Reader_IReadFilter\r\n{\r\n\r\n    <span style=\"color:blue\">private</span> $_startRow = 0;\r\n\r\n    <span style=\"color:blue\">private</span> $_endRow = 0;\r\n\r\n\r\n\r\n    <span style=\"color:blue\">public</span> <span style=\"color:blue\">function</span> setRows($startRow, $chunkSize)\r\n    {\r\n        $this-&gt;_startRow    = $startRow;\r\n        $this-&gt;_endRow      = $startRow &#43; $chunkSize;\r\n    }\r\n\r\n    <span style=\"color:blue\">public</span> <span style=\"color:blue\">function</span> readCell($column, $row, $worksheetName = <span style=\"color:#a31515\">''</span>)\r\n    {\r\n        <span style=\"color:green\">//  Only read the heading row, and the rows that are configured in $this-&gt;_startRow and $this-&gt;_endRow</span>\r\n        <span style=\"color:blue\">if</span> (($row == 1) || ($row &gt;= $this-&gt;_startRow &amp;&amp; $row &lt; $this-&gt;_endRow)) {\r\n            <span style=\"color:blue\">return</span> true;\r\n        }\r\n\r\n        <span style=\"color:blue\">return</span> false;\r\n    }\r\n}\r\n\r\n$inputFileType = <span style=\"color:#a31515\">'Excel5'</span>;\r\n$inputFileName = <span style=\"color:#a31515\">'teste_.xlsx'</span>;\r\n$sheetname = <span style=\"color:#a31515\">'DETALHADO'</span>;\r\n$chunkSize = 100;\r\n\r\n$objReader = <span style=\"color:blue\">new</span> PHPExcel_Reader_Excel2007();\r\n$chunkFilter = <span style=\"color:blue\">new</span> chunkReadFilter();\r\n$objReader-&gt;setReadFilter($chunkFilter);\r\n$objReader-&gt;setReadDataOnly(true);\r\n$objReader-&gt;setLoadSheetsOnly($sheetname);\r\n\r\n\r\n\r\n$array_data = <span style=\"color:blue\">array</span>();\r\n\r\n<span style=\"color:blue\">for</span> ($rowIndex = 2; $rowIndex &lt;= 500; $rowIndex &#43;= $chunkSize) {\r\n\r\n        $array_data[$rowIndex] = <span style=\"color:blue\">array</span>(\r\n            <span style=\"color:#a31515\">'localidade'</span>=&gt;<span style=\"color:#a31515\">''</span>, <span style=\"color:#a31515\">'impressora'</span>=&gt;<span style=\"color:#a31515\">''</span>,<span style=\"color:#a31515\">'cc'</span> =&gt;<span style=\"color:#a31515\">''</span>,<span style=\"color:#a31515\">'nomeCc'</span>=&gt;<span style=\"color:#a31515\">''</span>,\r\n            <span style=\"color:#a31515\">'nrImpressoes'</span>=&gt;<span style=\"color:#a31515\">''</span>, <span style=\"color:#a31515\">'valor'</span>=&gt;<span style=\"color:#a31515\">''</span>,<span style=\"color:#a31515\">'matricula'</span> =&gt;<span style=\"color:#a31515\">''</span>,<span style=\"color:#a31515\">'nome'</span>=&gt;<span style=\"color:#a31515\">''</span>,\r\n            <span style=\"color:#a31515\">'documento'</span>=&gt;<span style=\"color:#a31515\">''</span>, <span style=\"color:#a31515\">'dtImpressao'</span>=&gt;<span style=\"color:#a31515\">''</span>\r\n        );\r\n\r\n\t$chunkFilter-&gt;setRows($rowIndex,$chunkSize);\r\n\t$objPHPExcel = $objReader-&gt;load($inputFileName);\r\n        $sheet = $objPHPExcel-&gt;getActiveSheet();\r\n\t\r\n\t$cell = $sheet-&gt;getCell(<span style=\"color:#a31515\">'A'</span> . $rowIndex);\r\n        $array_data[$rowIndex][<span style=\"color:#a31515\">'localidade'</span>] = $cell-&gt;getValue();\r\n\r\n        $cell = $sheet-&gt;getCell(<span style=\"color:#a31515\">'B'</span> . $rowIndex);\r\n        $array_data[$rowIndex][<span style=\"color:#a31515\">'impressora'</span>] = $cell-&gt;getValue();\r\n\r\n     \r\n\t$objPHPExcel-&gt;disconnectWorksheets();\r\n\t<span style=\"color:blue\">unset</span>($objPHPExcel);\r\n\r\n\r\n}\r\n\r\n<span style=\"color:blue\">echo</span> <span style=\"color:#a31515\">&quot;&lt;pre&gt;&quot;</span>;\r\nprint_r($array_data);\r\n</pre>\r\n</div>\r\nI have like 150k of lines, in 10 columns(just put 2 on this code), any help? ;(\r\n<p></p>\r\n",
    "PostedDate": "2011-03-23T11:48:34.803-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]