[
  {
    "Id": "827757",
    "ThreadId": "353341",
    "Html": "\r\n<p><br>\r\nI m using PHPExcel (version 1.7.6) to read data from Excel sheet and store in mysql table, till now i m able to upload .xls as well as .xlsx file and after uploading the xls i got below table structure of data<br>\r\n<br>\r\nname&nbsp;&nbsp;&nbsp; start_date&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end_date&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; city<br>\r\none 11/25/2011 3:30:00 PM&nbsp;&nbsp; 11/29/2011 4:40:00 AM&nbsp;&nbsp; Jaipur<br>\r\ntwo 10/22/2011 5:30:00 PM&nbsp;&nbsp; 10/25/2011 6:30:00 AM&nbsp;&nbsp; Kota<br>\r\nthree&nbsp; 3/10/2011 2:30:00 PM 3/11/2011 12:30:00 AM&nbsp;&nbsp; Bikaner<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n chandigarh<br>\r\n<br>\r\nnow i have some problems, please suggest me the optimized method<br>\r\n<br>\r\n&nbsp;&nbsp;&nbsp; how do we get the sheet name ( bcoz in one excel there are 7 sheets )<br>\r\n<br>\r\n&nbsp;&nbsp;&nbsp; for now what i do to store these data into db, below is the code snippet<br>\r\n<br>\r\n&nbsp;&nbsp;&nbsp; $inputFileName = &quot;test.xls&quot;;&nbsp; <br>\r\n&nbsp;&nbsp;&nbsp; $inputFileType = PHPExcel_IOFactory::identify($inputFileName);&nbsp;\r\n<br>\r\n&nbsp;&nbsp;&nbsp; $objReader = PHPExcel_IOFactory::createReader($inputFileType);&nbsp;\r\n<br>\r\n&nbsp;&nbsp;&nbsp; $objReader-&gt;setReadDataOnly(true);&nbsp; <br>\r\n&nbsp;&nbsp;&nbsp; /**&nbsp; Load $inputFileName to a PHPExcel Object&nbsp; **/&nbsp;\r\n<br>\r\n&nbsp;&nbsp;&nbsp; $objPHPExcel = $objReader-&gt;load($inputFileName);&nbsp; <br>\r\n&nbsp;&nbsp;&nbsp; $total_sheets=$objPHPExcel-&gt;getSheetCount(); // here 4&nbsp;\r\n<br>\r\n&nbsp;&nbsp;&nbsp; $allSheetName=$objPHPExcel-&gt;getSheetNames(); // array ([0]=&gt;'student',[1]=&gt;'teacher',[2]=&gt;'school',[3]=&gt;'college')&nbsp;\r\n<br>\r\n&nbsp;&nbsp;&nbsp; $objWorksheet = $objPHPExcel-&gt;setActiveSheetIndex(0); // first sheet&nbsp;\r\n<br>\r\n&nbsp;&nbsp;&nbsp; $highestRow = $objWorksheet-&gt;getHighestRow(); // here 5&nbsp;\r\n<br>\r\n&nbsp;&nbsp;&nbsp; $highestColumn = $objWorksheet-&gt;getHighestColumn(); // here 'E'&nbsp;\r\n<br>\r\n&nbsp;&nbsp;&nbsp; $highestColumnIndex = PHPExcel_Cell::columnIndexFromString($highestColumn);&nbsp; // here 5&nbsp;\r\n<br>\r\n&nbsp;&nbsp;&nbsp; for ($row = 1; $row &lt;= $highestRow; &#43;&#43;$row) {&nbsp; <br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for ($col = 0; $col &lt;= $highestColumnIndex; &#43;&#43;$col) {&nbsp;\r\n<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $value=$objWorksheet-&gt;getCellByColumnAndRow($col, $row)-&gt;getValue();&nbsp;\r\n<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(is_array($arr_data) ) { $arr_data[$row-1][$col]=$value; }&nbsp;\r\n<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }&nbsp; <br>\r\n&nbsp;&nbsp;&nbsp; }<br>\r\n&nbsp;&nbsp;&nbsp; print_r($arr_data);</p>\r\n<p>&nbsp;</p>\r\n<p>and this returns<br>\r\n<br>\r\nArray<br>\r\n(<br>\r\n[0] =&gt; Array<br>\r\n&nbsp;&nbsp;&nbsp; (<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0] =&gt; name<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [1] =&gt; start_date<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2] =&gt; end_date<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [3] =&gt; city<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [4] =&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n<br>\r\n&nbsp;&nbsp;&nbsp; )<br>\r\n<br>\r\n[1] =&gt; Array<br>\r\n&nbsp;&nbsp;&nbsp; (<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0] =&gt; one&nbsp; <br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [1] =&gt; 40568.645833333<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2] =&gt; 40570.5<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [3] =&gt; Jaipur<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [4] =&gt; <br>\r\n&nbsp;&nbsp;&nbsp; )<br>\r\n[2] =&gt; Array<br>\r\n&nbsp;&nbsp;&nbsp; (<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0] =&gt; two <br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [1] =&gt; 40568.645833333<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2] =&gt; 40570.5<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [3] =&gt; Kota<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [4] =&gt; <br>\r\n&nbsp;&nbsp;&nbsp; )<br>\r\n[3] =&gt; Array<br>\r\n&nbsp;&nbsp;&nbsp; (<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0] =&gt; three<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [1] =&gt; 40568.645833333<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2] =&gt; 40570.5<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [3] =&gt; Bikaner<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [4] =&gt; <br>\r\n&nbsp;&nbsp;&nbsp;&nbsp; )<br>\r\n&nbsp; [4] =&gt; Array<br>\r\n&nbsp;&nbsp;&nbsp; (<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0] =&gt; <br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [1] =&gt; <br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [2] =&gt; <br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [3] =&gt; Chandigarh<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [4] =&gt; <br>\r\n&nbsp;&nbsp;&nbsp; )<br>\r\n<br>\r\n)</p>\r\n<p>&nbsp;</p>\r\n<p>i.e. desired array should look like<br>\r\n<br>\r\nArray&nbsp; <br>\r\n&nbsp;&nbsp;&nbsp; (&nbsp; <br>\r\n&nbsp;&nbsp;&nbsp; [0] =&gt; Array&nbsp; <br>\r\n&nbsp;&nbsp;&nbsp; (&nbsp; <br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [name] =&gt; one&nbsp; <br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [start_date] =&gt; 11/25/2011 3:30:00 PM&nbsp; <br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [end_date] =&gt; 11/29/2011 4:40:00 AM&nbsp; <br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [city] =&gt; Jaipur&nbsp; <br>\r\n&nbsp;&nbsp;&nbsp; )&nbsp; <br>\r\n&nbsp;&nbsp;&nbsp; [1] =&gt; Array&nbsp; <br>\r\n&nbsp;&nbsp;&nbsp; (&nbsp; <br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [name] =&gt; two&nbsp; <br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [start_date] =&gt; 10/22/2011 5:30:00 PM&nbsp; <br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [end_date] =&gt; 10/25/2011 6:30:00 AM&nbsp; <br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [city] =&gt; Kota&nbsp; <br>\r\n&nbsp;&nbsp;&nbsp; )&nbsp; <br>\r\n&nbsp;&nbsp;&nbsp; [2] =&gt; Array&nbsp; <br>\r\n&nbsp;&nbsp;&nbsp; (&nbsp; <br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [name] =&gt; three&nbsp; <br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [start_date] =&gt; 3/10/2011 2:30:00 PM&nbsp; <br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [end_date] =&gt; 3/11/2011 12:30:00 AM&nbsp; <br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [city] =&gt; Bikaner&nbsp; <br>\r\n&nbsp;&nbsp;&nbsp; )&nbsp; <br>\r\n)</p>\r\n<p>Please give solution for above result.</p>\r\n<p>Thanks</p>\r\n<p>Ragav</p>\r\n",
    "PostedDate": "2012-04-24T02:05:58.63-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "827959",
    "ThreadId": "353341",
    "Html": "<p>Those numeric values are the actual Excel timestamp values for those dates. You can use the&nbsp;date manipulation functions in PHPExcel_Shared_Date to convert to&nbsp;PHP date/timestamps or&nbsp;PHP DateTime objects and then use PHP's date-formatting functions to make them human-readable; use getFormattedValue() to retrieve the cell value; or look at using the Worksheets toArray(), rangeToArray() or similar methods that offer a formatted argument.</p>",
    "PostedDate": "2012-04-24T09:59:36.727-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]