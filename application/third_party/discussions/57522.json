[
  {
    "Id": "194436",
    "ThreadId": "57522",
    "Html": "<p>Hi,</p>\r\n<p>Is there a way provided by this class to detect if an excel file has a header or not?<br>A header is nothing more than a column's name followed by the column's data below, that's why it is pretty odd to consider it a header or not. Usually it takes first row of the file.<br>Also, it there an API to detect the cell value type, e.g. 123 is number, abc is text and so on...?</p>\r\n<p>Thanks</p>",
    "PostedDate": "2009-05-26T12:00:04.617-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "194462",
    "ThreadId": "57522",
    "Html": "<p><em>&gt; Is there a way provided by this class to detect if an excel file has a header or not?</em><br>Not really sure what you mean. Do you have some example? Are you trying to read some CSV-like Excel file?<br> <br> <em>&gt; Also, it there an API to detect the cell value type, e.g. 123 is number, abc is text and so on...?</em><br> You can look at this. If you only need to check whether e.g. a cell is a number or text, you can reduce the code.<br> <span style=\"font-family:Courier New\"><br> $coordinate = 'A1';</span><br style=\"font-family:Courier New\"> <span style=\"font-family:Courier New\">if ($objWorksheet-&gt;cellExists($coordinate)) {</span><br style=\"font-family:Courier New\"> <span style=\"font-family:Courier New\">&nbsp;&nbsp;&nbsp; echo 'Cell exists. ';</span><br style=\"font-family:Courier New\"> <span style=\"font-family:Courier New\">&nbsp;&nbsp;&nbsp; $cell = $sheet-&gt;getCell($coordinate);</span><br style=\"font-family:Courier New\"> <span style=\"font-family:Courier New\">&nbsp;&nbsp;&nbsp; </span><br style=\"font-family:Courier New\"> <span style=\"font-family:Courier New\">&nbsp;&nbsp;&nbsp; switch ($cell-&gt;getDataType()) {</span><br style=\"font-family:Courier New\"> <span style=\"font-family:Courier New\">&nbsp;&nbsp;&nbsp; </span><br style=\"font-family:Courier New\"> <span style=\"font-family:Courier New\">&nbsp;&nbsp;&nbsp; case PHPExcel_Cell_DataType::TYPE_BOOL:</span><br style=\"font-family:Courier New\"> <span style=\"font-family:Courier New\">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; echo 'Boolean value. (TRUE or FALSE)';</span><br style=\"font-family:Courier New\"> <span style=\"font-family:Courier New\">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; break;</span><br style=\"font-family:Courier New\"> <br style=\"font-family:Courier New\"> <span style=\"font-family:Courier New\">&nbsp;&nbsp;&nbsp; case PHPExcel_Cell_DataType::TYPE_FORMULA:</span><br style=\"font-family:Courier New\"> <span style=\"font-family:Courier New\">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; echo 'Formula.';</span><br style=\"font-family:Courier New\"> <span style=\"font-family:Courier New\">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; break;</span><br style=\"font-family:Courier New\"> <br style=\"font-family:Courier New\"> <span style=\"font-family:Courier New\">&nbsp;&nbsp;&nbsp; case PHPExcel_Cell_DataType::TYPE_NUMERIC:</span><br style=\"font-family:Courier New\"> <span style=\"font-family:Courier New\">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; echo 'Number. (This includes dates and times.)';</span><br style=\"font-family:Courier New\"> <span style=\"font-family:Courier New\">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; break;</span><br style=\"font-family:Courier New\"> <br style=\"font-family:Courier New\"> <span style=\"font-family:Courier New\">&nbsp;&nbsp;&nbsp; case PHPExcel_Cell_DataType::TYPE_STRING:</span><br style=\"font-family:Courier New\"> <span style=\"font-family:Courier New\">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; echo 'Cell contains (shared) string or is blank.';</span><br style=\"font-family:Courier New\"> <br style=\"font-family:Courier New\"> <span style=\"font-family:Courier New\">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; if ($cell-&gt;getValue() instanceof PHPExcel_RichText) {</span><br style=\"font-family:Courier New\"> <span style=\"font-family:Courier New\">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; echo ' Actually, it is a Rich-Text string.';</span><br style=\"font-family:Courier New\"> <span style=\"font-family:Courier New\">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</span><br style=\"font-family:Courier New\"> <span style=\"font-family:Courier New\">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; </span><br style=\"font-family:Courier New\"> <span style=\"font-family:Courier New\">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; break;</span><br style=\"font-family:Courier New\"> <br style=\"font-family:Courier New\"> <span style=\"font-family:Courier New\">&nbsp;&nbsp;&nbsp; case PHPExcel_Cell_DataType::TYPE_INLINE:</span><br style=\"font-family:Courier New\"> <span style=\"font-family:Courier New\">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; echo 'Inline string. Rarely used by Excel as far as I know.';</span><br style=\"font-family:Courier New\"> <span style=\"font-family:Courier New\">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; break;</span><br style=\"font-family:Courier New\"> <br style=\"font-family:Courier New\"> <span style=\"font-family:Courier New\">&nbsp;&nbsp;&nbsp; case PHPExcel_Cell_DataType::TYPE_ERROR:</span><br style=\"font-family:Courier New\"> <span style=\"font-family:Courier New\">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; echo 'Error code.';</span><br style=\"font-family:Courier New\"> <span style=\"font-family:Courier New\">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; break;</span><br style=\"font-family:Courier New\"> <br style=\"font-family:Courier New\"> <span style=\"font-family:Courier New\">&nbsp;&nbsp;&nbsp; }</span><br style=\"font-family:Courier New\"> <span style=\"font-family:Courier New\">} else {</span><br style=\"font-family:Courier New\"> <span style=\"font-family:Courier New\">&nbsp;&nbsp;&nbsp; echo 'Cell does not exist';</span><br style=\"font-family:Courier New\"> <span style=\"font-family:Courier New\">}</span><br style=\"font-family:Courier New\"></p>",
    "PostedDate": "2009-05-26T12:35:42.813-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "194514",
    "ThreadId": "57522",
    "Html": "<p>Hi,</p>\r\n<p>Thanks for the fast reply.<br>Here is my situation, maybe you can understand me better.<br>I have a pretty large excel file (xls or xlsx, 3-5Mb) containg columns like 'firs_name', 'last_name', 'phone_no', etc...<br>On the other hand I have a template (a text which contains some variables&nbsp; like [first_name], [last_name],[phone_no], etc..)<br>I have to parse the excel file&nbsp; and replace the variables [] with the excel values.<br>Doing this just by reading the (large) file could get me some 'max_execution_time' errors, so I decided to export the excel data into a (MySql) database so I can use it later also..<br>My ideea to export the excel into Mysql is to parse it and add the data into database, here comes my questions:</p>\r\n<p>1. Would like to create the database table dynamically with the table columns having the same names as excel column name (that's why I asked for an excel header, maybe header is not the right term for this, is the first row of the file which is used as a data deader, e.g. 'name','lastname'....<br>2. Is there a better way to do this (than parsing the excel row by row and column by column)?<br>3. I can relay on Excel's data type in order to use it to generate the database data types? e.g. <span style=\"font-family:Courier New\">case PHPExcel_Cell_DataType::TYPE_STRING: =&gt; Mysql Varchar?<br><br>So my script which creates the mysql table should look like this:</span></p>\r\n<p><span style=\"font-family:Courier New\">CREATE TABLE 'XXX' (Excel_Column1_Name Excel_Column1_DATA_TYPE, </span><span style=\"font-family:Courier New\">Excel_Column2_Name Excel_Column2_DATA_TYPE,......</span><span style=\"font-family:Courier New\">Excel_ColumnN_Name Excel_ColumnN_DATA_TYPE)<br>Is this OK or can I solve my problem easier?</span></p>\r\n<p><span style=\"font-family:Courier New\">Thanks for the help!<br>Cristian</span></p>",
    "PostedDate": "2009-05-26T13:58:14.427-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "194523",
    "ThreadId": "57522",
    "Html": "<p>Your explanation helps giving a better idea what you are trying. My first thought was whether the dynamic creation of the table is necessary. If your Excel file has fixed columns, would it not be possible to design the database table in advance and just insert rows as you read the Excel file?<br> <br> I guess you have a reason for trying a more generalized approach creating database table on the fly. We have not seen examples of this before, but I don't see why it should not be possible. It sounds like you are on the right track.<br> <br> <em>&gt; Is there a better way to do this (than parsing the excel row by row and column by column)?</em><em><br> </em>This is the simplest, and I would just stick with that. There are methods <span style=\"font-family:Courier New\">$objWorksheet-&gt;getHighestColumn(), $objWorksheet-&gt;getHighestRow()</span> to make things easier.<br> <em><br> &gt; I can relay on Excel's data type in order to use it to generate the database data types?</em><br> In simple cases, yes. There will be problems for advanced Excel data, but if it is just a list of business contacts, it should be fine.<br> <br> To start with, you could perhaps also just store everything as text (including numbers) in the database, and keep one column for the datatype.</p>",
    "PostedDate": "2009-05-26T14:34:31.557-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "194702",
    "ThreadId": "57522",
    "Html": "<p>Hi,</p>\r\n<p>Thanks for the reply. Unfortunately the excel file may differ from user to user (these files are uploaded by users) and I don't know their format (how many columns or rows) before creating the database, that's why I have to create it 'on the fly'.</p>\r\n<p>I will follow your toughts (which are mostly like mine).</p>\r\n<p>Thanks for the help!</p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2009-05-27T02:39:07.927-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]