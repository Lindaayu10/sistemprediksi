[
  {
    "Id": "571201",
    "ThreadId": "247341",
    "Html": "\r\n<p>Hi,<br>\r\nThanks for the great code. I just started with tests folder code.<br>\r\nI have a problem while save excel.<br>\r\nI don't know where I did mistake.<br>\r\n<br>\r\nEverything goes fine, when this line comes&nbsp;<br>\r\n$objWriter-&gt;save(str_replace('.php', '.xlsx', __FILE__));<br>\r\nbrowser displays &quot;This Page appears broken&quot;<br>\r\n<br>\r\nI'm using php5.2 and excel2007.<br>\r\n<br>\r\nThanks in advance,<br>\r\nThenndral</p>\r\n",
    "PostedDate": "2011-02-23T17:56:22.08-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "571800",
    "ThreadId": "247341",
    "Html": "<p>PHPExcel doesn't have any messages like&nbsp;\"This Page appears broken\", so I can't&nbsp;suggest much to help without knowing what your code might be doing.<br /><br /></p>",
    "PostedDate": "2011-02-24T14:15:52.953-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "571866",
    "ThreadId": "247341",
    "Html": "Hi Mark,\r\n<div><br>\r\n</div>\r\n<div>Thanks for your reply.</div>\r\n<div><br>\r\n</div>\r\n<div>I'm new to PHPExcel. So I try to use tests code.</div>\r\n<div><br>\r\n</div>\r\n<div>I didn't code newly. Please see below the code am using. I highlight the text where I got error.</div>\r\n<div><br>\r\n</div>\r\n<div>Please guide me. It's Really a urgent task for me.</div>\r\n<div><br>\r\n</div>\r\n<div><font color=\"#FF6666\"><b><u>01simple.php</u></b></font></div>\r\n<div><br>\r\n</div>\r\n<div>&lt;?php</div>\r\n<div>error_reporting(E_ALL);</div>\r\n<div><br>\r\n</div>\r\n<div>date_default_timezone_set('Europe/London');</div>\r\n<div><br>\r\n</div>\r\n<div>/** PHPExcel */</div>\r\n<div>//require_once '../Classes/PHPExcel.php';</div>\r\n<div>//Server root</div>\r\n<div>include_once($_SERVER['DOCUMENT_ROOT'].&quot;/../include/common_class.php&quot;);</div>\r\n<div>include_once(DOCUMENT_ROOT.&quot;/../include/db_class_mysqli.php&quot;);</div>\r\n<div>include_once(DOCUMENT_ROOT.&quot;/../Classes/PHPExcel.php&quot;);</div>\r\n<div><br>\r\n</div>\r\n<div>// Create new PHPExcel object</div>\r\n<div>echo date('H:i:s') . &quot; Create new PHPExcel object\\n&quot;;</div>\r\n<div>$objPHPExcel = new PHPExcel();</div>\r\n<div><br>\r\n</div>\r\n<div>// Set properties</div>\r\n<div>echo date('H:i:s') . &quot; Set properties\\n&quot;;</div>\r\n<div>$objPHPExcel-&gt;getProperties()-&gt;setCreator(&quot;Maarten Balliauw&quot;)</div>\r\n<div><span style=\"white-space:pre\"></span>-&gt;setLastModifiedBy(&quot;Maarten Balliauw&quot;)</div>\r\n<div><span style=\"white-space:pre\"></span>-&gt;setTitle(&quot;Office 2007 XLSX Test Document&quot;)</div>\r\n<div><span style=\"white-space:pre\"></span>-&gt;setSubject(&quot;Office 2007 XLSX Test Document&quot;)</div>\r\n<div><span style=\"white-space:pre\"></span>-&gt;setDescription(&quot;Test document for Office 2007 XLSX, generated using PHP classes.&quot;)</div>\r\n<div><span style=\"white-space:pre\"></span>-&gt;setKeywords(&quot;office 2007 openxml php&quot;)</div>\r\n<div><span style=\"white-space:pre\"></span>-&gt;setCategory(&quot;Test result file&quot;);</div>\r\n<div>// Add some data</div>\r\n<div>echo date('H:i:s') . &quot; Add some data\\n&quot;;</div>\r\n<div>$objPHPExcel-&gt;setActiveSheetIndex(0)</div>\r\n<div>-&gt;setCellValue('A1', 'Hello')</div>\r\n<div>-&gt;setCellValue('B2', 'world!')</div>\r\n<div>-&gt;setCellValue('C1', 'Hello')</div>\r\n<div>-&gt;setCellValue('D2', 'world!');</div>\r\n<div><br>\r\n</div>\r\n<div>// Miscellaneous glyphs, UTF-8</div>\r\n<div>$objPHPExcel-&gt;setActiveSheetIndex(0)</div>\r\n<div>-&gt;setCellValue('A4', 'Miscellaneous glyphs')</div>\r\n<div>-&gt;setCellValue('A5', 'éàèùâêîôûëïüÿäöüç');</div>\r\n<div><br>\r\n</div>\r\n<div>// Rename sheet</div>\r\n<div>echo date('H:i:s') . &quot; Rename sheet\\n&quot;;</div>\r\n<div>$objPHPExcel-&gt;getActiveSheet()-&gt;setTitle('Simple');</div>\r\n<div><br>\r\n</div>\r\n<div><br>\r\n</div>\r\n<div>// Set active sheet index to the first sheet, so Excel opens this as the first sheet</div>\r\n<div>$objPHPExcel-&gt;setActiveSheetIndex(0);</div>\r\n<div><br>\r\n</div>\r\n<div><br>\r\n</div>\r\n<div>// Save Excel 2007 file</div>\r\n<div>echo date('H:i:s') . &quot; Write to Excel2007 format\\n&quot;;</div>\r\n<div><br>\r\n</div>\r\n<div><br>\r\n</div>\r\n<div>$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, 'Excel2007');</div>\r\n<div>$objWriter -&gt;save(str_replace('.php','.xlsx',__FILE__)); // Here I got error. excel file not save.</div>\r\n<div><br>\r\n</div>\r\n<div>// Echo memory peak usage</div>\r\n<div>echo date('H:i:s') . &quot; Peak memory usage: &quot; . (memory_get_peak_usage(true) / 1024 / 1024) . &quot; MB\\r\\n&quot;;</div>\r\n<div><br>\r\n</div>\r\n<div><br>\r\n</div>\r\n<div>// Echo done</div>\r\n<div>echo date('H:i:s') . &quot; Done writing file.\\r\\n&quot;;</div>\r\n<div>exit;</div>\r\n<div>?&gt;</div>\r\n<div>\r\n<div>&lt;?php</div>\r\n<div>error_reporting(E_ALL);</div>\r\n<div><br>\r\n</div>\r\n<div>date_default_timezone_set('Europe/London');</div>\r\n<div><br>\r\n</div>\r\n<div>/** PHPExcel */</div>\r\n<div>//require_once '../Classes/PHPExcel.php';</div>\r\n<div>//Server root</div>\r\n<div>include_once($_SERVER['DOCUMENT_ROOT'].&quot;/../include/common_class.php&quot;);</div>\r\n<div>include_once(DOCUMENT_ROOT.&quot;/../include/db_class_mysqli.php&quot;);</div>\r\n<div>include_once(DOCUMENT_ROOT.&quot;/../Classes/PHPExcel.php&quot;);</div>\r\n<div><br>\r\n</div>\r\n<div>// Create new PHPExcel object</div>\r\n<div>echo date('H:i:s') . &quot; Create new PHPExcel object\\n&quot;;</div>\r\n<div>$objPHPExcel = new PHPExcel();</div>\r\n<div><br>\r\n</div>\r\n<div>// Set properties</div>\r\n<div>echo date('H:i:s') . &quot; Set properties\\n&quot;;</div>\r\n<div>$objPHPExcel-&gt;getProperties()-&gt;setCreator(&quot;Maarten Balliauw&quot;)</div>\r\n<div><span style=\"white-space:pre\"></span>-&gt;setLastModifiedBy(&quot;Maarten Balliauw&quot;)</div>\r\n<div><span style=\"white-space:pre\"></span>-&gt;setTitle(&quot;Office 2007 XLSX Test Document&quot;)</div>\r\n<div><span style=\"white-space:pre\"></span>-&gt;setSubject(&quot;Office 2007 XLSX Test Document&quot;)</div>\r\n<div><span style=\"white-space:pre\"></span>-&gt;setDescription(&quot;Test document for Office 2007 XLSX, generated using PHP classes.&quot;)</div>\r\n<div><span style=\"white-space:pre\"></span>-&gt;setKeywords(&quot;office 2007 openxml php&quot;)</div>\r\n<div><span style=\"white-space:pre\"></span>-&gt;setCategory(&quot;Test result file&quot;);</div>\r\n<div>// Add some data</div>\r\n<div>echo date('H:i:s') . &quot; Add some data\\n&quot;;</div>\r\n<div>$objPHPExcel-&gt;setActiveSheetIndex(0)</div>\r\n<div>-&gt;setCellValue('A1', 'Hello')</div>\r\n<div>-&gt;setCellValue('B2', 'world!')</div>\r\n<div>-&gt;setCellValue('C1', 'Hello')</div>\r\n<div>-&gt;setCellValue('D2', 'world!');</div>\r\n<div><br>\r\n</div>\r\n<div>// Miscellaneous glyphs, UTF-8</div>\r\n<div>$objPHPExcel-&gt;setActiveSheetIndex(0)</div>\r\n<div>-&gt;setCellValue('A4', 'Miscellaneous glyphs')</div>\r\n<div>-&gt;setCellValue('A5', 'éàèùâêîôûëïüÿäöüç');</div>\r\n<div><br>\r\n</div>\r\n<div>// Rename sheet</div>\r\n<div>echo date('H:i:s') . &quot; Rename sheet\\n&quot;;</div>\r\n<div>$objPHPExcel-&gt;getActiveSheet()-&gt;setTitle('Simple');</div>\r\n<div><br>\r\n</div>\r\n<div><br>\r\n</div>\r\n<div>// Set active sheet index to the first sheet, so Excel opens this as the first sheet</div>\r\n<div>$objPHPExcel-&gt;setActiveSheetIndex(0);</div>\r\n<div><br>\r\n</div>\r\n<div><br>\r\n</div>\r\n<div>// Save Excel 2007 file</div>\r\n<div>echo date('H:i:s') . &quot; Write to Excel2007 format\\n&quot;;</div>\r\n<div><br>\r\n</div>\r\n<div><br>\r\n</div>\r\n<div>$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, 'Excel2007');</div>\r\n<div><span style=\"background-color:rgb(255,255,153)\">$objWriter -&gt;save(str_replace('.php','.xlsx',__FILE__));</span>\r\n<font color=\"#FF0000\"><b>// Here I got error. excel file not save.</b></font></div>\r\n<div><br>\r\n</div>\r\n<div>// Echo memory peak usage</div>\r\n<div>echo date('H:i:s') . &quot; Peak memory usage: &quot; . (memory_get_peak_usage(true) / 1024 / 1024) . &quot; MB\\r\\n&quot;;</div>\r\n<div><br>\r\n</div>\r\n<div><br>\r\n</div>\r\n<div>// Echo done</div>\r\n<div>echo date('H:i:s') . &quot; Done writing file.\\r\\n&quot;;</div>\r\n<div>exit;</div>\r\n<div>?&gt;</div>\r\n<br>\r\n<div>On Fri, Feb 25, 2011 at 7:15 AM, MarkBaker <span dir=\"ltr\">&lt;<a href=\"mailto:notifications@codeplex.com\">notifications@codeplex.com</a>&gt;</span> wrote:<br>\r\n<blockquote style=\"margin:0 0 0 .8ex; border-left:1px #ccc solid; padding-left:1ex\">\r\n<div>\r\n<p>From: MarkBaker</p>\r\n<div>\r\n<p>PHPExcel doesn't have any messages like &quot;This Page appears broken&quot;, so I can't suggest much to help without knowing what your code might be doing.<br>\r\n<br>\r\n</p>\r\n</div>\r\n<div>\r\n<p>Read the <a href=\"http://phpexcel.codeplex.com/discussions/247341#post571800\" target=\"_blank\">\r\nfull discussion online</a>.</p>\r\n<p>To add a post to this discussion, reply to this email (<a href=\"mailto:PHPExcel@discussions.codeplex.com?subject=[PHPExcel:247341]\" target=\"_blank\">PHPExcel@discussions.codeplex.com</a>)</p>\r\n<p>To start a new discussion for this project, email <a href=\"mailto:PHPExcel@discussions.codeplex.com\" target=\"_blank\">\r\nPHPExcel@discussions.codeplex.com</a></p>\r\n<p>You are receiving this email because you subscribed to this discussion on CodePlex. You can\r\n<a href=\"https://phpexcel.codeplex.com/discussions/247341/unsubscribe/\" target=\"_blank\">\r\nunsubscribe</a> on CodePlex.com.</p>\r\n<p>Please note: Images and attachments will be removed from emails. Any posts to this discussion will also be available online at CodePlex.com</p>\r\n</div>\r\n</div>\r\n</blockquote>\r\n</div>\r\n<br>\r\n</div>\r\n",
    "PostedDate": "2011-02-24T16:58:18.04-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "572965",
    "ThreadId": "247341",
    "Html": "hello,\r\n<div><br>\r\n</div>\r\n<div>// $objWriter -&gt;save(str_replace('.php','.xlsx',__FILE__));</div>\r\n<div><br>\r\n</div>\r\n<div>I thought here &quot;__FILE__&quot; got error, so Is any configuration, I need to do in &quot;Excel2007.php&quot; near the top of the header.</div>\r\n<div><br>\r\n</div>\r\n<div>/** PHPExcel root directory */</div>\r\n<div>\r\n<div>if (!defined('PHPEXCEL_ROOT')) {</div>\r\n<div><span style=\"white-space:pre\"></span>/**</div>\r\n<div><span style=\"white-space:pre\"></span>* @ignore</div>\r\n<div><span style=\"white-space:pre\"></span>*/</div>\r\n<div><span style=\"white-space:pre\"></span>define('PHPEXCEL_ROOT', dirname(__FILE__) . '/../../');</div>\r\n<div><span style=\"white-space:pre\"></span>require(PHPEXCEL_ROOT . 'PHPExcel/Autoloader.php');</div>\r\n<div>}</div>\r\n<div><br>\r\n</div>\r\n<div>If so please let me the code. </div>\r\n<div><br>\r\n</div>\r\n<div>Thanks in advance,</div>\r\n<div>thenndral.</div>\r\n<br>\r\n<div>On Fri, Feb 25, 2011 at 9:58 AM, Thendral <span dir=\"ltr\">&lt;<a href=\"mailto:thenndral@gmail.com\">thenndral@gmail.com</a>&gt;</span> wrote:<br>\r\n<blockquote style=\"margin:0 0 0 .8ex; border-left:1px #ccc solid; padding-left:1ex\">\r\nHi Mark,\r\n<div><br>\r\n</div>\r\n<div>Thanks for your reply.</div>\r\n<div><br>\r\n</div>\r\n<div>I'm new to PHPExcel. So I try to use tests code.</div>\r\n<div><br>\r\n</div>\r\n<div>I didn't code newly. Please see below the code am using. I highlight the text where I got error.</div>\r\n<div><br>\r\n</div>\r\n<div>Please guide me. It's Really a urgent task for me.</div>\r\n<div><br>\r\n</div>\r\n<div><font color=\"#FF6666\"><b><u>01simple.php</u></b></font></div>\r\n<div><br>\r\n</div>\r\n<div>&lt;?php</div>\r\n<div>error_reporting(E_ALL);</div>\r\n<div><br>\r\n</div>\r\n<div>date_default_timezone_set('Europe/London');</div>\r\n<div><br>\r\n</div>\r\n<div>/** PHPExcel */</div>\r\n<div>//require_once '../Classes/PHPExcel.php';</div>\r\n<div>//Server root</div>\r\n<div>include_once($_SERVER['DOCUMENT_ROOT'].&quot;/../include/common_class.php&quot;);</div>\r\n<div>include_once(DOCUMENT_ROOT.&quot;/../include/db_class_mysqli.php&quot;);</div>\r\n<div>include_once(DOCUMENT_ROOT.&quot;/../Classes/PHPExcel.php&quot;);</div>\r\n<div><br>\r\n</div>\r\n<div>// Create new PHPExcel object</div>\r\n<div>echo date('H:i:s') . &quot; Create new PHPExcel object\\n&quot;;</div>\r\n<div>$objPHPExcel = new PHPExcel();</div>\r\n<div><br>\r\n</div>\r\n<div>// Set properties</div>\r\n<div>echo date('H:i:s') . &quot; Set properties\\n&quot;;</div>\r\n<div>$objPHPExcel-&gt;getProperties()-&gt;setCreator(&quot;Maarten Balliauw&quot;)</div>\r\n<div><span style=\"white-space:pre-wrap\"></span>-&gt;setLastModifiedBy(&quot;Maarten Balliauw&quot;)</div>\r\n<div><span style=\"white-space:pre-wrap\"></span>-&gt;setTitle(&quot;Office 2007 XLSX Test Document&quot;)</div>\r\n<div><span style=\"white-space:pre-wrap\"></span>-&gt;setSubject(&quot;Office 2007 XLSX Test Document&quot;)</div>\r\n<div><span style=\"white-space:pre-wrap\"></span>-&gt;setDescription(&quot;Test document for Office 2007 XLSX, generated using PHP classes.&quot;)</div>\r\n<div><span style=\"white-space:pre-wrap\"></span>-&gt;setKeywords(&quot;office 2007 openxml php&quot;)</div>\r\n<div><span style=\"white-space:pre-wrap\"></span>-&gt;setCategory(&quot;Test result file&quot;);</div>\r\n<div>// Add some data</div>\r\n<div>echo date('H:i:s') . &quot; Add some data\\n&quot;;</div>\r\n<div>$objPHPExcel-&gt;setActiveSheetIndex(0)</div>\r\n<div>-&gt;setCellValue('A1', 'Hello')</div>\r\n<div>-&gt;setCellValue('B2', 'world!')</div>\r\n<div>-&gt;setCellValue('C1', 'Hello')</div>\r\n<div>-&gt;setCellValue('D2', 'world!');</div>\r\n<div><br>\r\n</div>\r\n<div>// Miscellaneous glyphs, UTF-8</div>\r\n<div>$objPHPExcel-&gt;setActiveSheetIndex(0)</div>\r\n<div>-&gt;setCellValue('A4', 'Miscellaneous glyphs')</div>\r\n<div>-&gt;setCellValue('A5', 'éàèùâêîôûëïüÿäöüç');</div>\r\n<div><br>\r\n</div>\r\n<div>// Rename sheet</div>\r\n<div>echo date('H:i:s') . &quot; Rename sheet\\n&quot;;</div>\r\n<div>$objPHPExcel-&gt;getActiveSheet()-&gt;setTitle('Simple');</div>\r\n<div><br>\r\n</div>\r\n<div><br>\r\n</div>\r\n<div>// Set active sheet index to the first sheet, so Excel opens this as the first sheet</div>\r\n<div>$objPHPExcel-&gt;setActiveSheetIndex(0);</div>\r\n<div><br>\r\n</div>\r\n<div><br>\r\n</div>\r\n<div>// Save Excel 2007 file</div>\r\n<div>echo date('H:i:s') . &quot; Write to Excel2007 format\\n&quot;;</div>\r\n<div><br>\r\n</div>\r\n<div><br>\r\n</div>\r\n<div>$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, 'Excel2007');</div>\r\n<div>$objWriter -&gt;save(str_replace('.php','.xlsx',__FILE__)); // Here I got error. excel file not save.</div>\r\n<div><br>\r\n</div>\r\n<div>// Echo memory peak usage</div>\r\n<div>echo date('H:i:s') . &quot; Peak memory usage: &quot; . (memory_get_peak_usage(true) / 1024 / 1024) . &quot; MB\\r\\n&quot;;</div>\r\n<div><br>\r\n</div>\r\n<div><br>\r\n</div>\r\n<div>// Echo done</div>\r\n<div>echo date('H:i:s') . &quot; Done writing file.\\r\\n&quot;;</div>\r\n<div>exit;</div>\r\n<div>?&gt;</div>\r\n<div>\r\n<div>&lt;?php</div>\r\n<div>error_reporting(E_ALL);</div>\r\n<div><br>\r\n</div>\r\n<div>date_default_timezone_set('Europe/London');</div>\r\n<div><br>\r\n</div>\r\n<div>/** PHPExcel */</div>\r\n<div>//require_once '../Classes/PHPExcel.php';</div>\r\n<div>//Server root</div>\r\n<div>include_once($_SERVER['DOCUMENT_ROOT'].&quot;/../include/common_class.php&quot;);</div>\r\n<div>include_once(DOCUMENT_ROOT.&quot;/../include/db_class_mysqli.php&quot;);</div>\r\n<div>include_once(DOCUMENT_ROOT.&quot;/../Classes/PHPExcel.php&quot;);</div>\r\n<div><br>\r\n</div>\r\n<div>// Create new PHPExcel object</div>\r\n<div>echo date('H:i:s') . &quot; Create new PHPExcel object\\n&quot;;</div>\r\n<div>$objPHPExcel = new PHPExcel();</div>\r\n<div><br>\r\n</div>\r\n<div>// Set properties</div>\r\n<div>echo date('H:i:s') . &quot; Set properties\\n&quot;;</div>\r\n<div>$objPHPExcel-&gt;getProperties()-&gt;setCreator(&quot;Maarten Balliauw&quot;)</div>\r\n<div><span style=\"white-space:pre-wrap\"></span>-&gt;setLastModifiedBy(&quot;Maarten Balliauw&quot;)</div>\r\n<div><span style=\"white-space:pre-wrap\"></span>-&gt;setTitle(&quot;Office 2007 XLSX Test Document&quot;)</div>\r\n<div><span style=\"white-space:pre-wrap\"></span>-&gt;setSubject(&quot;Office 2007 XLSX Test Document&quot;)</div>\r\n<div><span style=\"white-space:pre-wrap\"></span>-&gt;setDescription(&quot;Test document for Office 2007 XLSX, generated using PHP classes.&quot;)</div>\r\n<div><span style=\"white-space:pre-wrap\"></span>-&gt;setKeywords(&quot;office 2007 openxml php&quot;)</div>\r\n<div><span style=\"white-space:pre-wrap\"></span>-&gt;setCategory(&quot;Test result file&quot;);</div>\r\n<div>// Add some data</div>\r\n<div>echo date('H:i:s') . &quot; Add some data\\n&quot;;</div>\r\n<div>$objPHPExcel-&gt;setActiveSheetIndex(0)</div>\r\n<div>-&gt;setCellValue('A1', 'Hello')</div>\r\n<div>-&gt;setCellValue('B2', 'world!')</div>\r\n<div>-&gt;setCellValue('C1', 'Hello')</div>\r\n<div>-&gt;setCellValue('D2', 'world!');</div>\r\n<div><br>\r\n</div>\r\n<div>// Miscellaneous glyphs, UTF-8</div>\r\n<div>$objPHPExcel-&gt;setActiveSheetIndex(0)</div>\r\n<div>-&gt;setCellValue('A4', 'Miscellaneous glyphs')</div>\r\n<div>-&gt;setCellValue('A5', 'éàèùâêîôûëïüÿäöüç');</div>\r\n<div><br>\r\n</div>\r\n<div>// Rename sheet</div>\r\n<div>echo date('H:i:s') . &quot; Rename sheet\\n&quot;;</div>\r\n<div>$objPHPExcel-&gt;getActiveSheet()-&gt;setTitle('Simple');</div>\r\n<div><br>\r\n</div>\r\n<div><br>\r\n</div>\r\n<div>// Set active sheet index to the first sheet, so Excel opens this as the first sheet</div>\r\n<div>$objPHPExcel-&gt;setActiveSheetIndex(0);</div>\r\n<div><br>\r\n</div>\r\n<div><br>\r\n</div>\r\n<div>// Save Excel 2007 file</div>\r\n<div>echo date('H:i:s') . &quot; Write to Excel2007 format\\n&quot;;</div>\r\n<div><br>\r\n</div>\r\n<div><br>\r\n</div>\r\n<div>$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, 'Excel2007');</div>\r\n<div><span style=\"background-color:rgb(255,255,153)\">$objWriter -&gt;save(str_replace('.php','.xlsx',__FILE__));</span>\r\n<font color=\"#FF0000\"><b>// Here I got error. excel file not save.</b></font></div>\r\n<div><br>\r\n</div>\r\n<div>// Echo memory peak usage</div>\r\n<div>echo date('H:i:s') . &quot; Peak memory usage: &quot; . (memory_get_peak_usage(true) / 1024 / 1024) . &quot; MB\\r\\n&quot;;</div>\r\n<div><br>\r\n</div>\r\n<div><br>\r\n</div>\r\n<div>// Echo done</div>\r\n<div>echo date('H:i:s') . &quot; Done writing file.\\r\\n&quot;;</div>\r\n<div>exit;</div>\r\n<div>?&gt;</div>\r\n<div>\r\n<div></div>\r\n<div><br>\r\n<div>On Fri, Feb 25, 2011 at 7:15 AM, MarkBaker <span dir=\"ltr\">&lt;<a href=\"mailto:notifications@codeplex.com\" target=\"_blank\">notifications@codeplex.com</a>&gt;</span> wrote:<br>\r\n<blockquote style=\"margin:0 0 0 .8ex; border-left:1px #ccc solid; padding-left:1ex\">\r\n<div>\r\n<p>From: MarkBaker</p>\r\n<div>\r\n<p>PHPExcel doesn't have any messages like &quot;This Page appears broken&quot;, so I can't suggest much to help without knowing what your code might be doing.<br>\r\n<br>\r\n</p>\r\n</div>\r\n<div>\r\n<p>Read the <a href=\"http://phpexcel.codeplex.com/discussions/247341#post571800\" target=\"_blank\">\r\nfull discussion online</a>.</p>\r\n<p>To add a post to this discussion, reply to this email (<a href=\"mailto:PHPExcel@discussions.codeplex.com?subject=[PHPExcel:247341]\" target=\"_blank\">PHPExcel@discussions.codeplex.com</a>)</p>\r\n<p>To start a new discussion for this project, email <a href=\"mailto:PHPExcel@discussions.codeplex.com\" target=\"_blank\">\r\nPHPExcel@discussions.codeplex.com</a></p>\r\n<p>You are receiving this email because you subscribed to this discussion on CodePlex. You can\r\n<a href=\"https://phpexcel.codeplex.com/discussions/247341/unsubscribe/\" target=\"_blank\">\r\nunsubscribe</a> on CodePlex.com.</p>\r\n<p>Please note: Images and attachments will be removed from emails. Any posts to this discussion will also be available online at CodePlex.com</p>\r\n</div>\r\n</div>\r\n</blockquote>\r\n</div>\r\n<br>\r\n</div>\r\n</div>\r\n</div>\r\n</blockquote>\r\n</div>\r\n<br>\r\n</div>\r\n",
    "PostedDate": "2011-02-27T17:36:09.543-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "573020",
    "ThreadId": "247341",
    "Html": "Hi,\r\n<div><br>\r\n</div>\r\n<div>I think , close to find out the error where it is happening.</div>\r\n<div>when use the following code, ini_set('display_errors', 1); </div>\r\n<div>browser displays the following error. the error is could not close zip file.</div>\r\n<div><br>\r\n</div>\r\n<div>how to resolve this error? where I did mistake? please let me know.</div>\r\n<div><br>\r\n</div>\r\n<div>\r\n<div>Fatal error: Uncaught exception 'Exception' with message 'Could not close zip file /home/swa/<a href=\"http://ads.photo.co.kr/htdocs/test/excel/Tests/01simple.xlsx\">ads.photo.co.kr/htdocs/test/excel/Tests/01simple.xlsx</a>.' in /home/swa/<a href=\"http://ads.photo.co.kr/Classes/PHPExcel/Writer/Excel2007.php:344\">ads.photo.co.kr/Classes/PHPExcel/Writer/Excel2007.php:344</a>\r\n Stack trace: #0 /home/swa/<a href=\"http://ads.photo.co.kr/htdocs/test/excel/Tests/01simple.php(85)\">ads.photo.co.kr/htdocs/test/excel/Tests/01simple.php(85)</a>: PHPExcel_Writer_Excel2007-&gt;save('/home/swa/ads....') #1 {main} thrown in /home/swa/<a href=\"http://ads.photo.co.kr/Classes/PHPExcel/Writer/Excel2007.php\">ads.photo.co.kr/Classes/PHPExcel/Writer/Excel2007.php</a>\r\n on line 344</div>\r\n<div><br>\r\n</div>\r\n<div>Thanks in advance,</div>\r\n<div>thenndral</div>\r\n<br>\r\n<div>On Mon, Feb 28, 2011 at 10:35 AM, Thendral <span dir=\"ltr\">&lt;<a href=\"mailto:thenndral@gmail.com\">thenndral@gmail.com</a>&gt;</span> wrote:<br>\r\n<blockquote style=\"margin:0 0 0 .8ex; border-left:1px #ccc solid; padding-left:1ex\">\r\nhello,\r\n<div><br>\r\n</div>\r\n<div>// $objWriter -&gt;save(str_replace('.php','.xlsx',__FILE__));</div>\r\n<div><br>\r\n</div>\r\n<div>I thought here &quot;__FILE__&quot; got error, so Is any configuration, I need to do in &quot;Excel2007.php&quot; near the top of the header.</div>\r\n<div><br>\r\n</div>\r\n<div>/** PHPExcel root directory */</div>\r\n<div>\r\n<div>if (!defined('PHPEXCEL_ROOT')) {</div>\r\n<div><span style=\"white-space:pre-wrap\"></span>/**</div>\r\n<div><span style=\"white-space:pre-wrap\"></span>* @ignore</div>\r\n<div><span style=\"white-space:pre-wrap\"></span>*/</div>\r\n<div><span style=\"white-space:pre-wrap\"></span>define('PHPEXCEL_ROOT', dirname(__FILE__) . '/../../');</div>\r\n<div><span style=\"white-space:pre-wrap\"></span>require(PHPEXCEL_ROOT . 'PHPExcel/Autoloader.php');</div>\r\n<div>}</div>\r\n<div><br>\r\n</div>\r\n<div>If so please let me the code. </div>\r\n<div><br>\r\n</div>\r\n<div>Thanks in advance,</div>\r\n<div>thenndral.</div>\r\n<div>\r\n<div></div>\r\n<div><br>\r\n<div>On Fri, Feb 25, 2011 at 9:58 AM, Thendral <span dir=\"ltr\">&lt;<a href=\"mailto:thenndral@gmail.com\" target=\"_blank\">thenndral@gmail.com</a>&gt;</span> wrote:<br>\r\n<blockquote style=\"margin:0 0 0 .8ex; border-left:1px #ccc solid; padding-left:1ex\">\r\nHi Mark,\r\n<div><br>\r\n</div>\r\n<div>Thanks for your reply.</div>\r\n<div><br>\r\n</div>\r\n<div>I'm new to PHPExcel. So I try to use tests code.</div>\r\n<div><br>\r\n</div>\r\n<div>I didn't code newly. Please see below the code am using. I highlight the text where I got error.</div>\r\n<div><br>\r\n</div>\r\n<div>Please guide me. It's Really a urgent task for me.</div>\r\n<div><br>\r\n</div>\r\n<div><font color=\"#FF6666\"><b><u>01simple.php</u></b></font></div>\r\n<div><br>\r\n</div>\r\n<div>&lt;?php</div>\r\n<div>error_reporting(E_ALL);</div>\r\n<div><br>\r\n</div>\r\n<div>date_default_timezone_set('Europe/London');</div>\r\n<div><br>\r\n</div>\r\n<div>/** PHPExcel */</div>\r\n<div>//require_once '../Classes/PHPExcel.php';</div>\r\n<div>//Server root</div>\r\n<div>include_once($_SERVER['DOCUMENT_ROOT'].&quot;/../include/common_class.php&quot;);</div>\r\n<div>include_once(DOCUMENT_ROOT.&quot;/../include/db_class_mysqli.php&quot;);</div>\r\n<div>include_once(DOCUMENT_ROOT.&quot;/../Classes/PHPExcel.php&quot;);</div>\r\n<div><br>\r\n</div>\r\n<div>// Create new PHPExcel object</div>\r\n<div>echo date('H:i:s') . &quot; Create new PHPExcel object\\n&quot;;</div>\r\n<div>$objPHPExcel = new PHPExcel();</div>\r\n<div><br>\r\n</div>\r\n<div>// Set properties</div>\r\n<div>echo date('H:i:s') . &quot; Set properties\\n&quot;;</div>\r\n<div>$objPHPExcel-&gt;getProperties()-&gt;setCreator(&quot;Maarten Balliauw&quot;)</div>\r\n<div><span style=\"white-space:pre-wrap\"></span>-&gt;setLastModifiedBy(&quot;Maarten Balliauw&quot;)</div>\r\n<div><span style=\"white-space:pre-wrap\"></span>-&gt;setTitle(&quot;Office 2007 XLSX Test Document&quot;)</div>\r\n<div><span style=\"white-space:pre-wrap\"></span>-&gt;setSubject(&quot;Office 2007 XLSX Test Document&quot;)</div>\r\n<div><span style=\"white-space:pre-wrap\"></span>-&gt;setDescription(&quot;Test document for Office 2007 XLSX, generated using PHP classes.&quot;)</div>\r\n<div><span style=\"white-space:pre-wrap\"></span>-&gt;setKeywords(&quot;office 2007 openxml php&quot;)</div>\r\n<div><span style=\"white-space:pre-wrap\"></span>-&gt;setCategory(&quot;Test result file&quot;);</div>\r\n<div>// Add some data</div>\r\n<div>echo date('H:i:s') . &quot; Add some data\\n&quot;;</div>\r\n<div>$objPHPExcel-&gt;setActiveSheetIndex(0)</div>\r\n<div>-&gt;setCellValue('A1', 'Hello')</div>\r\n<div>-&gt;setCellValue('B2', 'world!')</div>\r\n<div>-&gt;setCellValue('C1', 'Hello')</div>\r\n<div>-&gt;setCellValue('D2', 'world!');</div>\r\n<div><br>\r\n</div>\r\n<div>// Miscellaneous glyphs, UTF-8</div>\r\n<div>$objPHPExcel-&gt;setActiveSheetIndex(0)</div>\r\n<div>-&gt;setCellValue('A4', 'Miscellaneous glyphs')</div>\r\n<div>-&gt;setCellValue('A5', 'éàèùâêîôûëïüÿäöüç');</div>\r\n<div><br>\r\n</div>\r\n<div>// Rename sheet</div>\r\n<div>echo date('H:i:s') . &quot; Rename sheet\\n&quot;;</div>\r\n<div>$objPHPExcel-&gt;getActiveSheet()-&gt;setTitle('Simple');</div>\r\n<div><br>\r\n</div>\r\n<div><br>\r\n</div>\r\n<div>// Set active sheet index to the first sheet, so Excel opens this as the first sheet</div>\r\n<div>$objPHPExcel-&gt;setActiveSheetIndex(0);</div>\r\n<div><br>\r\n</div>\r\n<div><br>\r\n</div>\r\n<div>// Save Excel 2007 file</div>\r\n<div>echo date('H:i:s') . &quot; Write to Excel2007 format\\n&quot;;</div>\r\n<div><br>\r\n</div>\r\n<div><br>\r\n</div>\r\n<div>$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, 'Excel2007');</div>\r\n<div>$objWriter -&gt;save(str_replace('.php','.xlsx',__FILE__)); // Here I got error. excel file not save.</div>\r\n<div><br>\r\n</div>\r\n<div>// Echo memory peak usage</div>\r\n<div>echo date('H:i:s') . &quot; Peak memory usage: &quot; . (memory_get_peak_usage(true) / 1024 / 1024) . &quot; MB\\r\\n&quot;;</div>\r\n<div><br>\r\n</div>\r\n<div><br>\r\n</div>\r\n<div>// Echo done</div>\r\n<div>echo date('H:i:s') . &quot; Done writing file.\\r\\n&quot;;</div>\r\n<div>exit;</div>\r\n<div>?&gt;</div>\r\n<div>\r\n<div>&lt;?php</div>\r\n<div>error_reporting(E_ALL);</div>\r\n<div><br>\r\n</div>\r\n<div>date_default_timezone_set('Europe/London');</div>\r\n<div><br>\r\n</div>\r\n<div>/** PHPExcel */</div>\r\n<div>//require_once '../Classes/PHPExcel.php';</div>\r\n<div>//Server root</div>\r\n<div>include_once($_SERVER['DOCUMENT_ROOT'].&quot;/../include/common_class.php&quot;);</div>\r\n<div>include_once(DOCUMENT_ROOT.&quot;/../include/db_class_mysqli.php&quot;);</div>\r\n<div>include_once(DOCUMENT_ROOT.&quot;/../Classes/PHPExcel.php&quot;);</div>\r\n<div><br>\r\n</div>\r\n<div>// Create new PHPExcel object</div>\r\n<div>echo date('H:i:s') . &quot; Create new PHPExcel object\\n&quot;;</div>\r\n<div>$objPHPExcel = new PHPExcel();</div>\r\n<div><br>\r\n</div>\r\n<div>// Set properties</div>\r\n<div>echo date('H:i:s') . &quot; Set properties\\n&quot;;</div>\r\n<div>$objPHPExcel-&gt;getProperties()-&gt;setCreator(&quot;Maarten Balliauw&quot;)</div>\r\n<div><span style=\"white-space:pre-wrap\"></span>-&gt;setLastModifiedBy(&quot;Maarten Balliauw&quot;)</div>\r\n<div><span style=\"white-space:pre-wrap\"></span>-&gt;setTitle(&quot;Office 2007 XLSX Test Document&quot;)</div>\r\n<div><span style=\"white-space:pre-wrap\"></span>-&gt;setSubject(&quot;Office 2007 XLSX Test Document&quot;)</div>\r\n<div><span style=\"white-space:pre-wrap\"></span>-&gt;setDescription(&quot;Test document for Office 2007 XLSX, generated using PHP classes.&quot;)</div>\r\n<div><span style=\"white-space:pre-wrap\"></span>-&gt;setKeywords(&quot;office 2007 openxml php&quot;)</div>\r\n<div><span style=\"white-space:pre-wrap\"></span>-&gt;setCategory(&quot;Test result file&quot;);</div>\r\n<div>// Add some data</div>\r\n<div>echo date('H:i:s') . &quot; Add some data\\n&quot;;</div>\r\n<div>$objPHPExcel-&gt;setActiveSheetIndex(0)</div>\r\n<div>-&gt;setCellValue('A1', 'Hello')</div>\r\n<div>-&gt;setCellValue('B2', 'world!')</div>\r\n<div>-&gt;setCellValue('C1', 'Hello')</div>\r\n<div>-&gt;setCellValue('D2', 'world!');</div>\r\n<div><br>\r\n</div>\r\n<div>// Miscellaneous glyphs, UTF-8</div>\r\n<div>$objPHPExcel-&gt;setActiveSheetIndex(0)</div>\r\n<div>-&gt;setCellValue('A4', 'Miscellaneous glyphs')</div>\r\n<div>-&gt;setCellValue('A5', 'éàèùâêîôûëïüÿäöüç');</div>\r\n<div><br>\r\n</div>\r\n<div>// Rename sheet</div>\r\n<div>echo date('H:i:s') . &quot; Rename sheet\\n&quot;;</div>\r\n<div>$objPHPExcel-&gt;getActiveSheet()-&gt;setTitle('Simple');</div>\r\n<div><br>\r\n</div>\r\n<div><br>\r\n</div>\r\n<div>// Set active sheet index to the first sheet, so Excel opens this as the first sheet</div>\r\n<div>$objPHPExcel-&gt;setActiveSheetIndex(0);</div>\r\n<div><br>\r\n</div>\r\n<div><br>\r\n</div>\r\n<div>// Save Excel 2007 file</div>\r\n<div>echo date('H:i:s') . &quot; Write to Excel2007 format\\n&quot;;</div>\r\n<div><br>\r\n</div>\r\n<div><br>\r\n</div>\r\n<div>$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, 'Excel2007');</div>\r\n<div><span style=\"background-color:rgb(255,255,153)\">$objWriter -&gt;save(str_replace('.php','.xlsx',__FILE__));</span>\r\n<font color=\"#FF0000\"><b>// Here I got error. excel file not save.</b></font></div>\r\n<div><br>\r\n</div>\r\n<div>// Echo memory peak usage</div>\r\n<div>echo date('H:i:s') . &quot; Peak memory usage: &quot; . (memory_get_peak_usage(true) / 1024 / 1024) . &quot; MB\\r\\n&quot;;</div>\r\n<div><br>\r\n</div>\r\n<div><br>\r\n</div>\r\n<div>// Echo done</div>\r\n<div>echo date('H:i:s') . &quot; Done writing file.\\r\\n&quot;;</div>\r\n<div>exit;</div>\r\n<div>?&gt;</div>\r\n<div>\r\n<div></div>\r\n<div><br>\r\n<div>On Fri, Feb 25, 2011 at 7:15 AM, MarkBaker <span dir=\"ltr\">&lt;<a href=\"mailto:notifications@codeplex.com\" target=\"_blank\">notifications@codeplex.com</a>&gt;</span> wrote:<br>\r\n<blockquote style=\"margin:0 0 0 .8ex; border-left:1px #ccc solid; padding-left:1ex\">\r\n<div>\r\n<p>From: MarkBaker</p>\r\n<div>\r\n<p>PHPExcel doesn't have any messages like &quot;This Page appears broken&quot;, so I can't suggest much to help without knowing what your code might be doing.<br>\r\n<br>\r\n</p>\r\n</div>\r\n<div>\r\n<p>Read the <a href=\"http://phpexcel.codeplex.com/discussions/247341#post571800\" target=\"_blank\">\r\nfull discussion online</a>.</p>\r\n<p>To add a post to this discussion, reply to this email (<a href=\"mailto:PHPExcel@discussions.codeplex.com?subject=[PHPExcel:247341]\" target=\"_blank\">PHPExcel@discussions.codeplex.com</a>)</p>\r\n<p>To start a new discussion for this project, email <a href=\"mailto:PHPExcel@discussions.codeplex.com\" target=\"_blank\">\r\nPHPExcel@discussions.codeplex.com</a></p>\r\n<p>You are receiving this email because you subscribed to this discussion on CodePlex. You can\r\n<a href=\"https://phpexcel.codeplex.com/discussions/247341/unsubscribe/\" target=\"_blank\">\r\nunsubscribe</a> on CodePlex.com.</p>\r\n<p>Please note: Images and attachments will be removed from emails. Any posts to this discussion will also be available online at CodePlex.com</p>\r\n</div>\r\n</div>\r\n</blockquote>\r\n</div>\r\n<br>\r\n</div>\r\n</div>\r\n</div>\r\n</blockquote>\r\n</div>\r\n<br>\r\n</div>\r\n</div>\r\n</div>\r\n</blockquote>\r\n</div>\r\n<br>\r\n</div>\r\n",
    "PostedDate": "2011-02-27T20:25:48.997-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "573132",
    "ThreadId": "247341",
    "Html": "Hi,\r\n<div><br>\r\n</div>\r\n<div>I figure it out.</div>\r\n<div><br>\r\n</div>\r\n<div>I give permission to my folder. It works fine, while save in server folder.</div>\r\n<div><br>\r\n</div>\r\n<div>but its not working for client server side. junk data save in excel sheet.</div>\r\n<div><br>\r\n</div>\r\n<div>Herewith i attach the excel file, please have a look. and please guide me.</div>\r\n<div><br>\r\n</div>\r\n<div><br>\r\n</div>\r\n<div>thanks<br>\r\nthenndral.</div>\r\n<div><br>\r\n<div>On Mon, Feb 28, 2011 at 1:25 PM, Thendral <span dir=\"ltr\">&lt;<a href=\"mailto:thenndral@gmail.com\" target=\"_blank\">thenndral@gmail.com</a>&gt;</span> wrote:<br>\r\n<blockquote style=\"margin:0 0 0 .8ex; border-left:1px #ccc solid; padding-left:1ex\">\r\nHi,\r\n<div><br>\r\n</div>\r\n<div>I think , close to find out the error where it is happening.</div>\r\n<div>when use the following code, ini_set('display_errors', 1); </div>\r\n<div>browser displays the following error. the error is could not close zip file.</div>\r\n<div><br>\r\n</div>\r\n<div>how to resolve this error? where I did mistake? please let me know.</div>\r\n<div><br>\r\n</div>\r\n<div>\r\n<div>Fatal error: Uncaught exception 'Exception' with message 'Could not close zip file /home/swa/<a href=\"http://ads.photo.co.kr/htdocs/test/excel/Tests/01simple.xlsx\" target=\"_blank\">ads.photo.co.kr/htdocs/test/excel/Tests/01simple.xlsx</a>.' in /home/swa/<a href=\"http://ads.photo.co.kr/Classes/PHPExcel/Writer/Excel2007.php:344\" target=\"_blank\">ads.photo.co.kr/Classes/PHPExcel/Writer/Excel2007.php:344</a>\r\n Stack trace: #0 /home/swa/<a href=\"http://ads.photo.co.kr/htdocs/test/excel/Tests/01simple.php(85)\" target=\"_blank\">ads.photo.co.kr/htdocs/test/excel/Tests/01simple.php(85)</a>: PHPExcel_Writer_Excel2007-&gt;save('/home/swa/ads....') #1 {main} thrown in /home/swa/<a href=\"http://ads.photo.co.kr/Classes/PHPExcel/Writer/Excel2007.php\" target=\"_blank\">ads.photo.co.kr/Classes/PHPExcel/Writer/Excel2007.php</a>\r\n on line 344</div>\r\n<div><br>\r\n</div>\r\n<div>Thanks in advance,</div>\r\n<div>thenndral</div>\r\n<div>\r\n<div></div>\r\n<div><br>\r\n<div>On Mon, Feb 28, 2011 at 10:35 AM, Thendral <span dir=\"ltr\">&lt;<a href=\"mailto:thenndral@gmail.com\" target=\"_blank\">thenndral@gmail.com</a>&gt;</span> wrote:<br>\r\n<blockquote style=\"margin:0 0 0 .8ex; border-left:1px #ccc solid; padding-left:1ex\">\r\nhello,\r\n<div><br>\r\n</div>\r\n<div>// $objWriter -&gt;save(str_replace('.php','.xlsx',__FILE__));</div>\r\n<div><br>\r\n</div>\r\n<div>I thought here &quot;__FILE__&quot; got error, so Is any configuration, I need to do in &quot;Excel2007.php&quot; near the top of the header.</div>\r\n<div><br>\r\n</div>\r\n<div>/** PHPExcel root directory */</div>\r\n<div>\r\n<div>if (!defined('PHPEXCEL_ROOT')) {</div>\r\n<div><span style=\"white-space:pre-wrap\"></span>/**</div>\r\n<div><span style=\"white-space:pre-wrap\"></span>* @ignore</div>\r\n<div><span style=\"white-space:pre-wrap\"></span>*/</div>\r\n<div><span style=\"white-space:pre-wrap\"></span>define('PHPEXCEL_ROOT', dirname(__FILE__) . '/../../');</div>\r\n<div><span style=\"white-space:pre-wrap\"></span>require(PHPEXCEL_ROOT . 'PHPExcel/Autoloader.php');</div>\r\n<div>}</div>\r\n<div><br>\r\n</div>\r\n<div>If so please let me the code. </div>\r\n<div><br>\r\n</div>\r\n<div>Thanks in advance,</div>\r\n<div>thenndral.</div>\r\n<div>\r\n<div></div>\r\n<div><br>\r\n<div>On Fri, Feb 25, 2011 at 9:58 AM, Thendral <span dir=\"ltr\">&lt;<a href=\"mailto:thenndral@gmail.com\" target=\"_blank\">thenndral@gmail.com</a>&gt;</span> wrote:<br>\r\n<blockquote style=\"margin:0 0 0 .8ex; border-left:1px #ccc solid; padding-left:1ex\">\r\nHi Mark,\r\n<div><br>\r\n</div>\r\n<div>Thanks for your reply.</div>\r\n<div><br>\r\n</div>\r\n<div>I'm new to PHPExcel. So I try to use tests code.</div>\r\n<div><br>\r\n</div>\r\n<div>I didn't code newly. Please see below the code am using. I highlight the text where I got error.</div>\r\n<div><br>\r\n</div>\r\n<div>Please guide me. It's Really a urgent task for me.</div>\r\n<div><br>\r\n</div>\r\n<div><font color=\"#FF6666\"><b><u>01simple.php</u></b></font></div>\r\n<div><br>\r\n</div>\r\n<div>&lt;?php</div>\r\n<div>error_reporting(E_ALL);</div>\r\n<div><br>\r\n</div>\r\n<div>date_default_timezone_set('Europe/London');</div>\r\n<div><br>\r\n</div>\r\n<div>/** PHPExcel */</div>\r\n<div>//require_once '../Classes/PHPExcel.php';</div>\r\n<div>//Server root</div>\r\n<div>include_once($_SERVER['DOCUMENT_ROOT'].&quot;/../include/common_class.php&quot;);</div>\r\n<div>include_once(DOCUMENT_ROOT.&quot;/../include/db_class_mysqli.php&quot;);</div>\r\n<div>include_once(DOCUMENT_ROOT.&quot;/../Classes/PHPExcel.php&quot;);</div>\r\n<div><br>\r\n</div>\r\n<div>// Create new PHPExcel object</div>\r\n<div>echo date('H:i:s') . &quot; Create new PHPExcel object\\n&quot;;</div>\r\n<div>$objPHPExcel = new PHPExcel();</div>\r\n<div><br>\r\n</div>\r\n<div>// Set properties</div>\r\n<div>echo date('H:i:s') . &quot; Set properties\\n&quot;;</div>\r\n<div>$objPHPExcel-&gt;getProperties()-&gt;setCreator(&quot;Maarten Balliauw&quot;)</div>\r\n<div><span style=\"white-space:pre-wrap\"></span>-&gt;setLastModifiedBy(&quot;Maarten Balliauw&quot;)</div>\r\n<div><span style=\"white-space:pre-wrap\"></span>-&gt;setTitle(&quot;Office 2007 XLSX Test Document&quot;)</div>\r\n<div><span style=\"white-space:pre-wrap\"></span>-&gt;setSubject(&quot;Office 2007 XLSX Test Document&quot;)</div>\r\n<div><span style=\"white-space:pre-wrap\"></span>-&gt;setDescription(&quot;Test document for Office 2007 XLSX, generated using PHP classes.&quot;)</div>\r\n<div><span style=\"white-space:pre-wrap\"></span>-&gt;setKeywords(&quot;office 2007 openxml php&quot;)</div>\r\n<div><span style=\"white-space:pre-wrap\"></span>-&gt;setCategory(&quot;Test result file&quot;);</div>\r\n<div>// Add some data</div>\r\n<div>echo date('H:i:s') . &quot; Add some data\\n&quot;;</div>\r\n<div>$objPHPExcel-&gt;setActiveSheetIndex(0)</div>\r\n<div>-&gt;setCellValue('A1', 'Hello')</div>\r\n<div>-&gt;setCellValue('B2', 'world!')</div>\r\n<div>-&gt;setCellValue('C1', 'Hello')</div>\r\n<div>-&gt;setCellValue('D2', 'world!');</div>\r\n<div><br>\r\n</div>\r\n<div>// Miscellaneous glyphs, UTF-8</div>\r\n<div>$objPHPExcel-&gt;setActiveSheetIndex(0)</div>\r\n<div>-&gt;setCellValue('A4', 'Miscellaneous glyphs')</div>\r\n<div>-&gt;setCellValue('A5', 'éàèùâêîôûëïüÿäöüç');</div>\r\n<div><br>\r\n</div>\r\n<div>// Rename sheet</div>\r\n<div>echo date('H:i:s') . &quot; Rename sheet\\n&quot;;</div>\r\n<div>$objPHPExcel-&gt;getActiveSheet()-&gt;setTitle('Simple');</div>\r\n<div><br>\r\n</div>\r\n<div><br>\r\n</div>\r\n<div>// Set active sheet index to the first sheet, so Excel opens this as the first sheet</div>\r\n<div>$objPHPExcel-&gt;setActiveSheetIndex(0);</div>\r\n<div><br>\r\n</div>\r\n<div><br>\r\n</div>\r\n<div>// Save Excel 2007 file</div>\r\n<div>echo date('H:i:s') . &quot; Write to Excel2007 format\\n&quot;;</div>\r\n<div><br>\r\n</div>\r\n<div><br>\r\n</div>\r\n<div>$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, 'Excel2007');</div>\r\n<div>$objWriter -&gt;save(str_replace('.php','.xlsx',__FILE__)); // Here I got error. excel file not save.</div>\r\n<div><br>\r\n</div>\r\n<div>// Echo memory peak usage</div>\r\n<div>echo date('H:i:s') . &quot; Peak memory usage: &quot; . (memory_get_peak_usage(true) / 1024 / 1024) . &quot; MB\\r\\n&quot;;</div>\r\n<div><br>\r\n</div>\r\n<div><br>\r\n</div>\r\n<div>// Echo done</div>\r\n<div>echo date('H:i:s') . &quot; Done writing file.\\r\\n&quot;;</div>\r\n<div>exit;</div>\r\n<div>?&gt;</div>\r\n<div>\r\n<div>&lt;?php</div>\r\n<div>error_reporting(E_ALL);</div>\r\n<div><br>\r\n</div>\r\n<div>date_default_timezone_set('Europe/London');</div>\r\n<div><br>\r\n</div>\r\n<div>/** PHPExcel */</div>\r\n<div>//require_once '../Classes/PHPExcel.php';</div>\r\n<div>//Server root</div>\r\n<div>include_once($_SERVER['DOCUMENT_ROOT'].&quot;/../include/common_class.php&quot;);</div>\r\n<div>include_once(DOCUMENT_ROOT.&quot;/../include/db_class_mysqli.php&quot;);</div>\r\n<div>include_once(DOCUMENT_ROOT.&quot;/../Classes/PHPExcel.php&quot;);</div>\r\n<div><br>\r\n</div>\r\n<div>// Create new PHPExcel object</div>\r\n<div>echo date('H:i:s') . &quot; Create new PHPExcel object\\n&quot;;</div>\r\n<div>$objPHPExcel = new PHPExcel();</div>\r\n<div><br>\r\n</div>\r\n<div>// Set properties</div>\r\n<div>echo date('H:i:s') . &quot; Set properties\\n&quot;;</div>\r\n<div>$objPHPExcel-&gt;getProperties()-&gt;setCreator(&quot;Maarten Balliauw&quot;)</div>\r\n<div><span style=\"white-space:pre-wrap\"></span>-&gt;setLastModifiedBy(&quot;Maarten Balliauw&quot;)</div>\r\n<div><span style=\"white-space:pre-wrap\"></span>-&gt;setTitle(&quot;Office 2007 XLSX Test Document&quot;)</div>\r\n<div><span style=\"white-space:pre-wrap\"></span>-&gt;setSubject(&quot;Office 2007 XLSX Test Document&quot;)</div>\r\n<div><span style=\"white-space:pre-wrap\"></span>-&gt;setDescription(&quot;Test document for Office 2007 XLSX, generated using PHP classes.&quot;)</div>\r\n<div><span style=\"white-space:pre-wrap\"></span>-&gt;setKeywords(&quot;office 2007 openxml php&quot;)</div>\r\n<div><span style=\"white-space:pre-wrap\"></span>-&gt;setCategory(&quot;Test result file&quot;);</div>\r\n<div>// Add some data</div>\r\n<div>echo date('H:i:s') . &quot; Add some data\\n&quot;;</div>\r\n<div>$objPHPExcel-&gt;setActiveSheetIndex(0)</div>\r\n<div>-&gt;setCellValue('A1', 'Hello')</div>\r\n<div>-&gt;setCellValue('B2', 'world!')</div>\r\n<div>-&gt;setCellValue('C1', 'Hello')</div>\r\n<div>-&gt;setCellValue('D2', 'world!');</div>\r\n<div><br>\r\n</div>\r\n<div>// Miscellaneous glyphs, UTF-8</div>\r\n<div>$objPHPExcel-&gt;setActiveSheetIndex(0)</div>\r\n<div>-&gt;setCellValue('A4', 'Miscellaneous glyphs')</div>\r\n<div>-&gt;setCellValue('A5', 'éàèùâêîôûëïüÿäöüç');</div>\r\n<div><br>\r\n</div>\r\n<div>// Rename sheet</div>\r\n<div>echo date('H:i:s') . &quot; Rename sheet\\n&quot;;</div>\r\n<div>$objPHPExcel-&gt;getActiveSheet()-&gt;setTitle('Simple');</div>\r\n<div><br>\r\n</div>\r\n<div><br>\r\n</div>\r\n<div>// Set active sheet index to the first sheet, so Excel opens this as the first sheet</div>\r\n<div>$objPHPExcel-&gt;setActiveSheetIndex(0);</div>\r\n<div><br>\r\n</div>\r\n<div><br>\r\n</div>\r\n<div>// Save Excel 2007 file</div>\r\n<div>echo date('H:i:s') . &quot; Write to Excel2007 format\\n&quot;;</div>\r\n<div><br>\r\n</div>\r\n<div><br>\r\n</div>\r\n<div>$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, 'Excel2007');</div>\r\n<div><span style=\"background-color:rgb(255,255,153)\">$objWriter -&gt;save(str_replace('.php','.xlsx',__FILE__));</span>\r\n<font color=\"#FF0000\"><b>// Here I got error. excel file not save.</b></font></div>\r\n<div><br>\r\n</div>\r\n<div>// Echo memory peak usage</div>\r\n<div>echo date('H:i:s') . &quot; Peak memory usage: &quot; . (memory_get_peak_usage(true) / 1024 / 1024) . &quot; MB\\r\\n&quot;;</div>\r\n<div><br>\r\n</div>\r\n<div><br>\r\n</div>\r\n<div>// Echo done</div>\r\n<div>echo date('H:i:s') . &quot; Done writing file.\\r\\n&quot;;</div>\r\n<div>exit;</div>\r\n<div>?&gt;</div>\r\n<div>\r\n<div></div>\r\n<div><br>\r\n<div>On Fri, Feb 25, 2011 at 7:15 AM, MarkBaker <span dir=\"ltr\">&lt;<a href=\"mailto:notifications@codeplex.com\" target=\"_blank\">notifications@codeplex.com</a>&gt;</span> wrote:<br>\r\n<blockquote style=\"margin:0 0 0 .8ex; border-left:1px #ccc solid; padding-left:1ex\">\r\n<div>\r\n<p>From: MarkBaker</p>\r\n<div>\r\n<p>PHPExcel doesn't have any messages like &quot;This Page appears broken&quot;, so I can't suggest much to help without knowing what your code might be doing.<br>\r\n<br>\r\n</p>\r\n</div>\r\n<div>\r\n<p>Read the <a href=\"http://phpexcel.codeplex.com/discussions/247341#post571800\" target=\"_blank\">\r\nfull discussion online</a>.</p>\r\n<p>To add a post to this discussion, reply to this email (<a href=\"mailto:PHPExcel@discussions.codeplex.com?subject=[PHPExcel:247341]\" target=\"_blank\">PHPExcel@discussions.codeplex.com</a>)</p>\r\n<p>To start a new discussion for this project, email <a href=\"mailto:PHPExcel@discussions.codeplex.com\" target=\"_blank\">\r\nPHPExcel@discussions.codeplex.com</a></p>\r\n<p>You are receiving this email because you subscribed to this discussion on CodePlex. You can\r\n<a href=\"https://phpexcel.codeplex.com/discussions/247341/unsubscribe/\" target=\"_blank\">\r\nunsubscribe</a> on CodePlex.com.</p>\r\n<p>Please note: Images and attachments will be removed from emails. Any posts to this discussion will also be available online at CodePlex.com</p>\r\n</div>\r\n</div>\r\n</blockquote>\r\n</div>\r\n<br>\r\n</div>\r\n</div>\r\n</div>\r\n</blockquote>\r\n</div>\r\n<br>\r\n</div>\r\n</div>\r\n</div>\r\n</blockquote>\r\n</div>\r\n<br>\r\n</div>\r\n</div>\r\n</div>\r\n</blockquote>\r\n</div>\r\n<br>\r\n</div>\r\n",
    "PostedDate": "2011-02-28T01:47:39.323-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "573493",
    "ThreadId": "247341",
    "Html": "<p>Are you setting the correct headers when sending the file to the browser?</p>\r\n<p>Look at 01simple-download-xls.php and 01simple-download-xlsx.php for examples, and ensure that there are no echoes in your script</p>",
    "PostedDate": "2011-02-28T13:25:19.023-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "573629",
    "ThreadId": "247341",
    "Html": "Hello MarkBaker,\r\n<div><br>\r\n</div>\r\n<div>Thanks for your reply.</div>\r\n<div>This junk data save problem in 01simple-download-xls.php.</div>\r\n<div>I just change then root path.I didn't change any other code.</div>\r\n<div>Herewith i enclose my code. please check it out. and please guide me.</div>\r\n<div><br>\r\n</div>\r\n<div>thanks,</div>\r\n<div>thenndral<br>\r\n<br>\r\n</div>\r\n<div><br>\r\n</div>\r\n<div><br>\r\n<div>On Tue, Mar 1, 2011 at 6:25 AM, MarkBaker <span dir=\"ltr\">&lt;<a href=\"mailto:notifications@codeplex.com\">notifications@codeplex.com</a>&gt;</span> wrote:<br>\r\n<blockquote style=\"margin:0 0 0 .8ex; border-left:1px #ccc solid; padding-left:1ex\">\r\n<div>\r\n<p>From: MarkBaker</p>\r\n<div>\r\n<p>Are you setting the correct headers when sending the file to the browser?</p>\r\n<p>Look at 01simple-download-xls.php and 01simple-download-xlsx.php for examples, and ensure that there are no echoes in your script</p>\r\n</div>\r\n<div>\r\n<div>\r\n<p>Read the <a href=\"http://phpexcel.codeplex.com/discussions/247341#post573493\" target=\"_blank\">\r\nfull discussion online</a>.</p>\r\n<p>To add a post to this discussion, reply to this email (<a href=\"mailto:PHPExcel@discussions.codeplex.com?subject=[PHPExcel:247341]\" target=\"_blank\">PHPExcel@discussions.codeplex.com</a>)</p>\r\n<p>To start a new discussion for this project, email <a href=\"mailto:PHPExcel@discussions.codeplex.com\" target=\"_blank\">\r\nPHPExcel@discussions.codeplex.com</a></p>\r\n<p>You are receiving this email because you subscribed to this discussion on CodePlex. You can\r\n<a href=\"https://phpexcel.codeplex.com/discussions/247341/unsubscribe/\" target=\"_blank\">\r\nunsubscribe</a> on CodePlex.com.</p>\r\n<p>Please note: Images and attachments will be removed from emails. Any posts to this discussion will also be available online at CodePlex.com</p>\r\n</div>\r\n</div>\r\n</div>\r\n</blockquote>\r\n</div>\r\n<br>\r\n</div>\r\n",
    "PostedDate": "2011-02-28T18:57:59.197-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1210401",
    "ThreadId": "247341",
    "Html": "I got the same problem (ma not all the times...., so it cannot be a permission problem).\r<br />\nThe reason why we got &quot;This Page appears broken&quot; is that the script dies on the save.<br />\n<pre><code>    $objWriter = new PHPExcel_Writer_Excel2007($objPHPExcel);\n    $objWriter-&gt;setOffice2003Compatibility(true);\n    $objWriter-&gt;save($file_name . &quot;tmp&quot;);</code></pre>\n\nThanks for your help.<br />\n",
    "PostedDate": "2014-02-19T02:13:35.18-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1210402",
    "ThreadId": "247341",
    "Html": "By the way, is there any way to catch the error and then try to save file in other formats (for example?).\r<br />\nOtherwise all data are lost.... !!!!<br />\n",
    "PostedDate": "2014-02-19T02:15:10.54-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]