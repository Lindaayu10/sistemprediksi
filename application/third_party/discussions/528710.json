[
  {
    "Id": "1201965",
    "ThreadId": "528710",
    "Html": "Hi, \r<br />\n<br />\nI have a project were I'm trying to save posts from a wordpress database to a .xls File. \r<br />\n<br />\nAt first, I clone another xls file, which has 3 rows already filled with data<br />\n<pre><code>        require_once plugin_dir_path(__FILE__).'phpExcel/PHPExcel/IOFactory.php';\n            \n        $inputFileName = plugin_dir_path(__FILE__).'template.xls';\n        $objReader = new PHPExcel_Reader_Excel5();\n        $objPHPExcel = $objReader-&gt;load($inputFileName);            \n        \n        $objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, 'Excel5');  \n        $file = 'listing-'.time().'-'.uniqid().'.xls';\n        $objWriter-&gt;save( plugin_dir_path(__FILE__).'tmp/'.$file );</code></pre>\n\nI'm calling this code via ajax and retrieve the new filename. Now another script will write the posts from the database to the xls file. ( 130 posts with one row per post at the moment ). <br />\n<pre><code>function addPostsToFile(){\n                \n        ini_set('memory_limit', '92M');\n        \n        require_once plugin_dir_path(__FILE__).'phpExcel/PHPExcel/IOFactory.php';\n        require_once plugin_dir_path(__FILE__).'helperFunctions.php';\n            \n        $file = plugin_dir_path(__FILE__).'tmp/'.$_POST['file'];        \n        \n        $objReader = new PHPExcel_Reader_Excel5();\n        $objPHPExcel = $objReader-&gt;load($file);\n        \n        $objPHPExcel-&gt;setActiveSheetIndex(0);       \n            \n        foreach( $_POST['posts'] as $post_id ) {\n            add_Post_to_XLS( intval($post_id), $objPHPExcel);       \n        }\n        \n        $objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, 'Excel5');  \n        $objWriter-&gt;save( $file );\n        \n        die();\n    }</code></pre>\n\nThis works at least for now. But I already have a few thousands of database querys to get the data to fill in ( and it will be rapidly growing ). So I thought it is a good idea to add only one post at once.<br />\n<pre><code>\n    function addPostToFile(){\n        \n        ini_set('memory_limit', '92M');\n        \n        require_once plugin_dir_path(__FILE__).'phpExcel/PHPExcel/IOFactory.php';\n        require_once plugin_dir_path(__FILE__).'helperFunctions.php';\n            \n        $file = plugin_dir_path(__FILE__).'tmp/'.$_POST['file'];\n        \n        $objReader = new PHPExcel_Reader_Excel5();\n        $objPHPExcel = $objReader-&gt;load($file);\n        \n        $objPHPExcel-&gt;setActiveSheetIndex(0);\n            \n        add_Post_to_XLS( intval($_POST['post_id']), $objPHPExcel);      \n        \n        $objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, 'Excel5');  \n        $objWriter-&gt;save( $file );\n        \n        die();\n    }</code></pre>\n\nSo I loop my posts with ajax and call the function above, which is almost the same but of course the loading and saving of the xls file will be repeated for each post ( remember, 130 post atm). \r<br />\n<br />\nnow I have the strange problem, that this works great for the first 83 posts ( 86 rows filled ), but it always fails for each call after that ( no matter what individual post is added ). The new rows are successfully added to the $objPHPExcel, but after saving the .xls file just contains the 3 rows from the template. \r<br />\n<br />\nWhen I stop the script after 82 posts, the cells are filled as wanted. \r<br />\nWhen I add 2 rows per post the script fails at row 171 (even after saving 84 times).\r<br />\nWhen I change the sort order of my posts, I still fails at 84.\r<br />\n<br />\nPHPVersion 5.2.1\r<br />\nPHPExcel 1.7.9\r<br />\nI'm just using setCellValueByColumnAndRow to fill in the data, no calculations, style or something.\r<br />\n<br />\n<br />\nI have no more Idea where to search for the error. I guess it's a lack of basic understanding how phpExcel works?\r<br />\n<br />\nThanks for any advice!\r<br />\nbest regards from germany<br />\n",
    "PostedDate": "2014-02-03T01:41:33.807-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]