[
  {
    "Id": "446529",
    "ThreadId": "213605",
    "Html": "<p><span id=\"result_box\"><span>Hi, I  have that code, and it works, but I need to divide the articles by  category. </span><span>The result I want is this: Article 1,  Article2 ...<br></span><span>while I would:<br></span><span>name category1<br></span><span>article1, Article2<br><br></span><span>name category2<br></span><span>articolo3<br></span><span>articolo4 ...<br><br></span><span>How can I fix?</span></span></p>\r\n<p><span id=\"result_box\"><span>Here's  the code:</span></span></p>\r\n<p><span><span>\r\n<pre>$objPHPExcel-&gt;setActiveSheetIndex(0);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('A2', 'Modello');\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('B2', 'Descrizione');\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('C2', 'Prezzo');\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('D2', 'Disponibile');\t\t\t\t\t \r\n//contenuti cella\r\n$cnt=3;\r\n\r\n  //seleziono tutte le categorie dove sono presenti i prodotti\r\n  $sql1 = &quot;SELECT distinct * FROM products&quot;;\r\n  $r_sql1 = $db-&gt;query($sql1);\r\n  while($r_r1 = $db-&gt;fetch_array($r_sql1)){\r\n    $mast[] = $r_r1[master_categories_id];\r\n  }\r\n  $master = array_unique($mast);\r\n  \r\n  //cilco le categorie con prodotti\r\n  foreach($master as $m){\r\n \r\n    //seleziono id e nome categoria per il linguaggio italiano\r\n    $co = mysql_query(&quot;SELECT distinct * FROM categories_description WHERE categories_id = $m AND language_id = 2&quot;);\r\nwhile($ro = mysql_fetch_array($co)){\r\n  $c_id = $ro[categories_id];\t\r\n}\r\n\r\n\r\n\r\n$query = mysql_query(&quot;select p.products_model, SUBSTRING(d.products_name, 1, 100) as description, truncate(floor((p.products_price * 20 / 100 + p.products_price) * 100 + .55) /100, 2) as price, IF(p.products_quantity &gt; 0, 'Disponibile', 'Non Disponibile') as vero, c.categories_name from products as p, products_description as d, categories_description as c where master_categories_id = $c_id AND p.products_id = d.products_id AND d.language_id = 2 AND c.language_id = 2 AND c.categories_id = $c_id&quot;);\r\nwhile($row = mysql_fetch_array($query))\r\n{\r\n\r\n$objPHPExcel-&gt;setActiveSheetIndex(0);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('A1', $row[categories_name]);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('A'.$cnt, $row[products_model]);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('B'.$cnt, $row[description]);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('C'.$cnt, $row[price]);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('D'.$cnt, $row[vero]);\r\n\r\n$cnt++;\r\n}\r\n}\r\n<br><span id=\"result_box\"><span>Sorry  for my English<br><br></span><span>Thanks</span></span><br></pre>\r\n<br></span></span></p>",
    "PostedDate": "2010-05-24T01:15:38.987-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]