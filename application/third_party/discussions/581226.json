[
  {
    "Id": "1353535",
    "ThreadId": "581226",
    "Html": "HI , sorryfor english , i have make a db to test , it have 12 columns and 15 rows. \r<br />\n<br />\nThis is the code to import :<br />\n<pre><code>&lt;?php\n//include the following 2 files\nrequire 'Classes/PHPExcel.php';\nrequire_once 'Classes/PHPExcel/IOFactory.php';\n\n$conn = new mysqli('localhost', 'root', 'root', 'miodb');\n\n$path = &quot;Giocattoli.xls&quot;;\n\n$objPHPExcel = PHPExcel_IOFactory::load($path);\nforeach ($objPHPExcel-&gt;getWorksheetIterator() as $worksheet) {\n    $worksheetTitle     = $worksheet-&gt;getTitle();\n    $highestRow         = $worksheet-&gt;getHighestRow(); // e.g. 10\n    $highestColumn      = $worksheet-&gt;getHighestColumn(); // e.g 'F'\n    $highestColumnIndex = PHPExcel_Cell::columnIndexFromString($highestColumn);\n    $nrColumns = ord($highestColumn) - 60;\n    echo &quot;&lt;br&gt;The worksheet &quot;.$worksheetTitle.&quot; has &quot;;\n    echo $nrColumns . ' columns (A-' . $highestColumn . ') ';\n    echo ' and ' . $highestRow . ' row. &lt;br/&gt;';\n    \n   \nfor ($row = 1; $row &lt;= $highestRow ; ++ $row) {\n    $val=array();\n    for ($col = 0; $col &lt; $highestColumnIndex; ++ $col) {\n       $cell = $worksheet-&gt;getCellByColumnAndRow($col, $row);\n       $val[$col] = $cell-&gt;getValue();\n    }\n     \n     $sql=&quot;insert into giocattoli (codice,azienda,prodotto,iva,prezzopub,prezzoriv,sconto,disponibile)\n    VALUES ('&quot;.$val[0] . &quot;','&quot;.$val[1] . &quot;','&quot; . $val[2] . &quot;','&quot; . $val[3]. &quot;','&quot; . $val[4] . &quot;','&quot;  . $val[5] . &quot;','&quot; . $val[6] . &quot;','&quot; . $val[7] . &quot;')&quot;;\n    $insert_query=$conn -&gt;query($sql)        ;\n    if ($insert_query === TRUE) {\n               echo $sql;\n            } else {\n               $msg= &quot;Error: &quot; . $sql . &quot;&lt;br&gt;&quot; . $conn-&gt;error;\n            }\n }\n}\n?&gt;\n</code></pre>\n\nBut i have some error and in db i have two  empty rows :<br />\n<pre><code>\nThe worksheet Foglio1 has 12 columns (A-H) and 15 row.\ninsert into giocattoli (codice,azienda,prodotto,iva,prezzopub,prezzoriv,sconto,disponibile) VALUES ('103928038','SAMBA','Palla piccola ','22','10.5','6.56','37.5','1')insert into giocattoli (codice,azienda,prodotto,iva,prezzopub,prezzoriv,sconto,disponibile) VALUES ('103928040','SAMBA','Palla piccola 10 pz','22','110','68.75','37.5','1')insert into giocattoli (codice,azienda,prodotto,iva,prezzopub,prezzoriv,sconto,disponibile) VALUES ('102319011','SAMBA','racchetta ','22','22','13.75','37.5','1')insert into giocattoli (codice,azienda,prodotto,iva,prezzopub,prezzoriv,sconto,disponibile) VALUES ('104601012','SAMBA','bambola','22','12.5','8.2386363636364','34.090909090909','1')insert into giocattoli (codice,azienda,prodotto,iva,prezzopub,prezzoriv,sconto,disponibile) VALUES ('104287040','SAMBA','camion','22','16','10','37.5','1')insert into giocattoli (codice,azienda,prodotto,iva,prezzopub,prezzoriv,sconto,disponibile) VALUES ('104287065','SAMBA','macchina','22','130','81.25','37.5','1')insert into giocattoli (codice,azienda,prodotto,iva,prezzopub,prezzoriv,sconto,disponibile) VALUES ('104287077','SAMBA','aereo','22','29','18.125','37.5','1')insert into giocattoli (codice,azienda,prodotto,iva,prezzopub,prezzoriv,sconto,disponibile) VALUES ('101704043','SAMBA','elicottero','22','15','9.375','37.5','1')insert into giocattoli (codice,azienda,prodotto,iva,prezzopub,prezzoriv,sconto,disponibile) VALUES ('104563010','SAMBA','leone','22','55','34.375','37.5','1')insert into giocattoli (codice,azienda,prodotto,iva,prezzopub,prezzoriv,sconto,disponibile) VALUES ('101948014','SAMBA','tigre','22','12.5','7.8125','37.5','1')insert into giocattoli (codice,azienda,prodotto,iva,prezzopub,prezzoriv,sconto,disponibile) VALUES ('104323035','SAMBA','cane','22','38','23.75','37.5','1')insert into giocattoli (codice,azienda,prodotto,iva,prezzopub,prezzoriv,sconto,disponibile) VALUES ('104323199','SAMBA','gatto','22','76','47.5','37.5','1')insert into giocattoli (codice,azienda,prodotto,iva,prezzopub,prezzoriv,sconto,disponibile) VALUES ('104501010','SAMBA','pesce','22','21','13.125','37.5','1')insert into giocattoli (codice,azienda,prodotto,iva,prezzopub,prezzoriv,sconto,disponibile) VALUES ('104022013','SAMBA','fucile','22','14','8.75','37.5','1')insert into giocattoli (codice,azienda,prodotto,iva,prezzopub,prezzoriv,sconto,disponibile) VALUES ('104022025','SAMBA','mitre','22','20','12.5','37.5','1')\nThe worksheet Foglio2 has 5 columns (A-A) and 1 row.\n\nNotice: Undefined offset: 1 in /home/maria/localhost/letturaexcel/leggigiocattoli.php on line 30\n\nNotice: Undefined offset: 2 in /home/maria/localhost/letturaexcel/leggigiocattoli.php on line 30\n\nNotice: Undefined offset: 3 in /home/maria/localhost/letturaexcel/leggigiocattoli.php on line 30\n\nNotice: Undefined offset: 4 in /home/maria/localhost/letturaexcel/leggigiocattoli.php on line 30\n\nNotice: Undefined offset: 5 in /home/maria/localhost/letturaexcel/leggigiocattoli.php on line 30\n\nNotice: Undefined offset: 6 in /home/maria/localhost/letturaexcel/leggigiocattoli.php on line 30\n\nNotice: Undefined offset: 7 in /home/maria/localhost/letturaexcel/leggigiocattoli.php on line 30\ninsert into giocattoli (codice,azienda,prodotto,iva,prezzopub,prezzoriv,sconto,disponibile) VALUES ('','','','','','','','')\nThe worksheet Foglio3 has 5 columns (A-A) and 1 row.\n\nNotice: Undefined offset: 1 in /home/maria/localhost/letturaexcel/leggigiocattoli.php on line 30\n\nNotice: Undefined offset: 2 in /home/maria/localhost/letturaexcel/leggigiocattoli.php on line 30\n\nNotice: Undefined offset: 3 in /home/maria/localhost/letturaexcel/leggigiocattoli.php on line 30\n\nNotice: Undefined offset: 4 in /home/maria/localhost/letturaexcel/leggigiocattoli.php on line 30\n\nNotice: Undefined offset: 5 in /home/maria/localhost/letturaexcel/leggigiocattoli.php on line 30\n\nNotice: Undefined offset: 6 in /home/maria/localhost/letturaexcel/leggigiocattoli.php on line 30\n\nNotice: Undefined offset: 7 in /home/maria/localhost/letturaexcel/leggigiocattoli.php on line 30\ninsert into giocattoli (codice,azienda,prodotto,iva,prezzopub,prezzoriv,sconto,disponibile) VALUES ('','','','','','','','')</code></pre>\n\n",
    "PostedDate": "2015-02-17T13:07:15.743-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1474644",
    "ThreadId": "581226",
    "Html": "You loop only vals, not rows.\r<br />\n<br />\nFirst create loop for rows, then inside create loop for vals and query (inside too).<br />\n",
    "PostedDate": "2016-05-30T03:21:01.447-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]