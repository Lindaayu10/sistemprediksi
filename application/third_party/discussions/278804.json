[
  {
    "Id": "695661",
    "ThreadId": "278804",
    "Html": "<p>Hello all,</p>\n<p>I have a some problem with caching. Here is my code, input xls file have 5000 rows and 7 columns.</p>\n<p>&nbsp;</p>\n<div style=\"color: black; background-color: white;\">\n<pre>&lt;?php\n\n<span style=\"color: blue;\">echo</span> date(<span style=\"color: #a31515;\">'H:i:s'</span>) . <span style=\"color: #a31515;\">\" Write to CSV format\\n\"</span>;\n\nset_include_path(get_include_path() . PATH_SEPARATOR .\n<span style=\"color: #a31515;\">'/home/localhost/www/Classes/'</span>);\n\n<span style=\"color: blue;\">include_once</span> <span style=\"color: #a31515;\">'PHPExcel.php'</span>;\n<span style=\"color: blue;\">include_once</span> <span style=\"color: #a31515;\">'PHPExcel/IOFactory.php'</span>;\n\n$cacheMethod = PHPExcel_CachedObjectStorageFactory:: cache_to_phpTemp;\n$cacheSettings = <span style=\"color: blue;\">array</span>( <span style=\"color: #a31515;\">' memoryCacheSize '</span>  =&gt; <span style=\"color: #a31515;\">'8MB'</span> );\nPHPExcel_Settings::setCacheStorageMethod($cacheMethod, $cacheSettings);\n\n$objPHPExcel = PHPExcel_IOFactory::load(<span style=\"color: #a31515;\">\"xls/nprice.xls\"</span>);\n$objPHPExcel-&gt;setActiveSheetIndex(0);\n$aSheet = $objPHPExcel-&gt;getActiveSheet();\n\n$aSheet-&gt;removeColumn(<span style=\"color: #a31515;\">'D'</span>);\n$aSheet-&gt;removeColumn(<span style=\"color: #a31515;\">'E'</span>);\n$aSheet-&gt;removeColumn(<span style=\"color: #a31515;\">'F'</span>);\n$aSheet-&gt;removeColumn(<span style=\"color: #a31515;\">'H'</span>);\n$aSheet-&gt;removeColumn(<span style=\"color: #a31515;\">'D'</span>);\n\n$aSheet-&gt;setCellValue(<span style=\"color: #a31515;\">'A6'</span>, <span style=\"color: #a31515;\">\"product_sku\"</span>);\n$aSheet-&gt;setCellValue(<span style=\"color: #a31515;\">'B6'</span>, <span style=\"color: #a31515;\">\"product_s_desc\"</span>);\n$aSheet-&gt;setCellValue(<span style=\"color: #a31515;\">'C6'</span>, <span style=\"color: #a31515;\">\"product_price\"</span>);\n$aSheet-&gt;setCellValue(<span style=\"color: #a31515;\">'D6'</span>, <span style=\"color: #a31515;\">\"product_manufaqturer\"</span>);\n\n$aSheet-&gt;unmergeCells(<span style=\"color: #a31515;\">'A1:E1'</span>);\n$aSheet-&gt;unmergeCells(<span style=\"color: #a31515;\">'A2:E2'</span>);\n$aSheet-&gt;unmergeCells(<span style=\"color: #a31515;\">'A3:E3'</span>);\n$aSheet-&gt;unmergeCells(<span style=\"color: #a31515;\">'A4:E4'</span>);\n$aSheet-&gt;unmergeCells(<span style=\"color: #a31515;\">'A5:E5'</span>);\n\n$aSheet-&gt;removeRow(1);\n$aSheet-&gt;removeRow(1);\n$aSheet-&gt;removeRow(1);\n$aSheet-&gt;removeRow(1);\n$aSheet-&gt;removeRow(1);\n\n$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, <span style=\"color: #a31515;\">'CSV'</span>)\n    -&gt;setDelimiter(<span style=\"color: #a31515;\">'^'</span>)\n    -&gt;setEnclosure(<span style=\"color: #a31515;\">'~'</span>)\n    -&gt;setLineEnding(<span style=\"color: #a31515;\">\"\\r\\n\"</span>)\n    -&gt;setSheetIndex(0)\n    -&gt;save(str_replace(<span style=\"color: #a31515;\">'.php'</span>, <span style=\"color: #a31515;\">'.csv'</span>, <span style=\"color: blue;\">__FILE__</span>));\n    \n<span style=\"color: blue;\">echo</span> date(<span style=\"color: #a31515;\">'H:i:s'</span>) . <span style=\"color: #a31515;\">\" Done writing files.\\r\\n\"</span>;\n?&gt;\n</pre>\n</div>\n<p>&nbsp;</p>\n<p>But my browser writing an error:</p>\n<p><strong>Fatal error</strong>: Call to a member function getCellCacheController() on a non-object in <strong>W:\\home\\localhost\\www\\Classes\\PHPExcel\\Cell.php</strong> on line <strong> 107</strong></p>\n<p><strong>Whats wrong?</strong></p>",
    "PostedDate": "2011-11-08T22:29:05.51-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]