[
  {
    "Id": "851535",
    "ThreadId": "360311",
    "Html": "\r\n<p>I've used the latest develop branch Tests/33createchart example to create a phpexcel bar chart.</p>\r\n<p>My xlsx file is being opened successfully with MS Excel 2010, but with MS Excel 2007, it complains about it and does recover the file and finally removes the drawing!!!</p>\r\n<p>&nbsp;</p>\r\n<p>Have you tested phpexcel created&nbsp;charts in MS Excel 2007?</p>\r\n",
    "PostedDate": "2012-06-20T07:03:43.227-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "851645",
    "ThreadId": "360311",
    "Html": "<p>Yes, but and while there are always discrepancies any Excel2007 written file should open in both Excel2007 and in Excel2010. It could be that Excel2010 is being more forgiving than Excel2007 about something in the generated file. But without specifics, you've given me a question that's almost impossible to answer.</p>",
    "PostedDate": "2012-06-20T10:01:15.36-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "851658",
    "ThreadId": "360311",
    "Html": "<p>Thank you Mark,&nbsp;I will send you the code and a sample generated file on saturday.</p>",
    "PostedDate": "2012-06-20T10:26:28.447-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "852838",
    "ThreadId": "360311",
    "Html": "\r\n<p>This is the code that the <a href=\"http://ce.sharif.edu/~zari/chart.xlsx\" target=\"_blank\">\r\nchart.xls</a> file is generated by:</p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre>$objPHPExcel = <span style=\"color:blue\">new</span> PHPExcel();\n            $objPHPExcel-&gt;getProperties()-&gt;setCreator(<span style=\"color:#a31515\">&quot;AC&amp;C Basamad Co.&quot;</span>)\n                -&gt;setLastModifiedBy(<span style=\"color:#a31515\">&quot;AC&amp;C Basamad Co.&quot;</span>)\n                -&gt;setTitle(<span style=\"color:#a31515\">&quot;Office 2007 XLSX&quot;</span>)\n                -&gt;setSubject(<span style=\"color:#a31515\">&quot;Office 2007 XLSX&quot;</span>)\n                -&gt;setDescription(<span style=\"color:#a31515\">&quot;Test document for Office 2007 XLSX, generated using PHP classes.&quot;</span>);\n\n            <span style=\"color:green\">//        $objPHPExcel-&gt;setActiveSheetIndex( 0 )-&gt;setRightToLeft( true );</span>\n            $objPHPExcel-&gt;setActiveSheetIndex(0)\n                -&gt;setCellValue(<span style=\"color:#a31515\">'A1'</span>, <span style=\"color:#a31515\">'Media Type'</span>)\n                -&gt;setCellValue(<span style=\"color:#a31515\">'B1'</span>, <span style=\"color:#a31515\">'Success'</span>)\n                -&gt;setCellValue(<span style=\"color:#a31515\">'C1'</span>, <span style=\"color:#a31515\">'Notice'</span>)\n                -&gt;setCellValue(<span style=\"color:#a31515\">'D1'</span>, <span style=\"color:#a31515\">'Inprogress'</span>)\n                -&gt;setCellValue(<span style=\"color:#a31515\">'E1'</span>, <span style=\"color:#a31515\">'Error'</span>)\n                -&gt;setCellValue(<span style=\"color:#a31515\">'F1'</span>, <span style=\"color:#a31515\">'Failed'</span>)\n                -&gt;setCellValue(<span style=\"color:#a31515\">'G1'</span>, <span style=\"color:#a31515\">'Undefined'</span>);\n            $i = 2;\n            <span style=\"color:blue\">foreach</span>( $<span style=\"color:blue\">list</span> <span style=\"color:blue\">as</span> $statuses ) {\n                $objPHPExcel-&gt;setActiveSheetIndex(0)\n                    -&gt;setCellValue(<span style=\"color:#a31515\">'A'</span>.$i, $statuses-&gt;media )\n                    -&gt;setCellValue(<span style=\"color:#a31515\">'B'</span>.$i, $statuses-&gt;success )\n                    -&gt;setCellValue(<span style=\"color:#a31515\">'C'</span>.$i, $statuses-&gt;notice )\n                    -&gt;setCellValue(<span style=\"color:#a31515\">'D'</span>.$i, $statuses-&gt;inprogress )\n                    -&gt;setCellValue(<span style=\"color:#a31515\">'E'</span>.$i, $statuses-&gt;error )\n                    -&gt;setCellValue(<span style=\"color:#a31515\">'F'</span>.$i, $statuses-&gt;failed )\n                    -&gt;setCellValue(<span style=\"color:#a31515\">'G'</span>.$i, $statuses-&gt;undefined );\n                $i&#43;&#43;;\n            }\n            $i = $i-1;\n            <span style=\"color:green\">//\tSet the Labels for each dataset we want to plot</span>\n            $labels = <span style=\"color:blue\">array</span>(\n                <span style=\"color:blue\">new</span> PHPExcel_Chart_DataSeriesValues(<span style=\"color:#a31515\">'String'</span>, <span style=\"color:#a31515\">'Worksheet!$B$1'</span>, null, 1),\t<span style=\"color:green\">//\tSuccess</span>\n                <span style=\"color:blue\">new</span> PHPExcel_Chart_DataSeriesValues(<span style=\"color:#a31515\">'String'</span>, <span style=\"color:#a31515\">'Worksheet!$C$1'</span>, null, 1),\t<span style=\"color:green\">//\tNotice</span>\n                <span style=\"color:blue\">new</span> PHPExcel_Chart_DataSeriesValues(<span style=\"color:#a31515\">'String'</span>, <span style=\"color:#a31515\">'Worksheet!$D$1'</span>, null, 1),\t<span style=\"color:green\">//\tInprogress</span>\n                <span style=\"color:blue\">new</span> PHPExcel_Chart_DataSeriesValues(<span style=\"color:#a31515\">'String'</span>, <span style=\"color:#a31515\">'Worksheet!$E$1'</span>, null, 1),\t<span style=\"color:green\">//\tError</span>\n                <span style=\"color:blue\">new</span> PHPExcel_Chart_DataSeriesValues(<span style=\"color:#a31515\">'String'</span>, <span style=\"color:#a31515\">'Worksheet!$F$1'</span>, null, 1),\t<span style=\"color:green\">//\tFailed</span>\n                <span style=\"color:blue\">new</span> PHPExcel_Chart_DataSeriesValues(<span style=\"color:#a31515\">'String'</span>, <span style=\"color:#a31515\">'Worksheet!$G$1'</span>, null, 1),\t<span style=\"color:green\">//\tUndefined</span>\n            );\n            <span style=\"color:green\">//\tSet the X-Axis Labels</span>\n            $categories = <span style=\"color:blue\">array</span>(\n                <span style=\"color:blue\">new</span> PHPExcel_Chart_DataSeriesValues(<span style=\"color:#a31515\">'String'</span>, <span style=\"color:#a31515\">'Worksheet!$A$2:$A$'</span>.$i, null, 2),\t<span style=\"color:green\">//\tmedia types</span>\n            );\n            <span style=\"color:green\">//\tSet the Data values for each dataset we want to plot</span>\n            $values = <span style=\"color:blue\">array</span>(\n                <span style=\"color:blue\">new</span> PHPExcel_Chart_DataSeriesValues(<span style=\"color:#a31515\">'Number'</span>, <span style=\"color:#a31515\">'Worksheet!$B$2:$B$'</span>.$i, null, 2),\n                <span style=\"color:blue\">new</span> PHPExcel_Chart_DataSeriesValues(<span style=\"color:#a31515\">'Number'</span>, <span style=\"color:#a31515\">'Worksheet!$C$2:$C$'</span>.$i, null, 2),\n                <span style=\"color:blue\">new</span> PHPExcel_Chart_DataSeriesValues(<span style=\"color:#a31515\">'Number'</span>, <span style=\"color:#a31515\">'Worksheet!$D$2:$D$'</span>.$i, null, 2),\n                <span style=\"color:blue\">new</span> PHPExcel_Chart_DataSeriesValues(<span style=\"color:#a31515\">'Number'</span>, <span style=\"color:#a31515\">'Worksheet!$E$2:$E$'</span>.$i, null, 2),\n                <span style=\"color:blue\">new</span> PHPExcel_Chart_DataSeriesValues(<span style=\"color:#a31515\">'Number'</span>, <span style=\"color:#a31515\">'Worksheet!$F$2:$F$'</span>.$i, null, 2),\n                <span style=\"color:blue\">new</span> PHPExcel_Chart_DataSeriesValues(<span style=\"color:#a31515\">'Number'</span>, <span style=\"color:#a31515\">'Worksheet!$G$2:$G$'</span>.$i, null, 2),\n            );\n\n            <span style=\"color:green\">//\tBuild the dataseries</span>\n            $series = <span style=\"color:blue\">new</span> PHPExcel_Chart_DataSeries(\n                PHPExcel_Chart_DataSeries::TYPE_BARCHART,\t\t<span style=\"color:green\">// plotType</span>\n                PHPExcel_Chart_DataSeries::GROUPING_CLUSTERED,\t<span style=\"color:green\">// plotGrouping</span>\n                <span style=\"color:blue\">array</span>(0, 1, 2, 3, 4, 5),\t\t\t\t\t\t<span style=\"color:green\">// plotOrder</span>\n                $labels,\t\t\t\t\t\t\t\t\t\t<span style=\"color:green\">// plotLabel</span>\n                $categories,\t\t\t\t\t\t\t\t\t<span style=\"color:green\">// plotCategory</span>\n                $values\t\t\t\t\t\t\t\t\t\t\t<span style=\"color:green\">// plotValues</span>\n            );\n            <span style=\"color:green\">//\tSet additional dataseries parameters</span>\n            $series-&gt;setPlotDirection(PHPExcel_Chart_DataSeries::DIRECTION_COL);\n\n            <span style=\"color:green\">//\tSet the series in the plot area</span>\n            $plotarea = <span style=\"color:blue\">new</span> PHPExcel_Chart_PlotArea(null, <span style=\"color:blue\">array</span>($series));\n            <span style=\"color:green\">//\tSet the chart legend</span>\n            $legend = <span style=\"color:blue\">new</span> PHPExcel_Chart_Legend(PHPExcel_Chart_Legend::POSITION_RIGHT, null, false);\n\n            $title = <span style=\"color:blue\">new</span> PHPExcel_Chart_Title( $value  . <span style=\"color:#a31515\">' Messages'</span> );\n\n\n            <span style=\"color:green\">//\tCreate the chart</span>\n            $chart = <span style=\"color:blue\">new</span> PHPExcel_Chart(\n                <span style=\"color:#a31515\">'chart1'</span>,\t\t<span style=\"color:green\">// name</span>\n                $title,\t\t\t<span style=\"color:green\">// title</span>\n                $legend,\t\t<span style=\"color:green\">// legend</span>\n                $plotarea,\t\t<span style=\"color:green\">// plotArea</span>\n                true,\t\t\t<span style=\"color:green\">// plotVisibleOnly</span>\n                0,\t\t\t\t<span style=\"color:green\">// displayBlanksAs</span>\n                null,\t\t\t<span style=\"color:green\">// xAxisLabel</span>\n                null\t\t\t<span style=\"color:green\">// yAxisLabel</span>\n            );\n\n            <span style=\"color:green\">//\tSet the position where the chart should appear in the worksheet</span>\n            $chart-&gt;setTopLeftPosition(<span style=\"color:#a31515\">'A7'</span>);\n            $chart-&gt;setBottomRightPosition(<span style=\"color:#a31515\">'H20'</span>);\n\n            <span style=\"color:green\">//\tAdd the chart to the worksheet</span>\n            $objPHPExcel-&gt;setActiveSheetIndex(0)-&gt;addChart($chart);\n\n            header(<span style=\"color:#a31515\">'Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'</span>);\n            header(<span style=\"color:#a31515\">'Content-Disposition: attachment;filename=&quot;chart.xlsx&quot;'</span>);\n            header(<span style=\"color:#a31515\">'Cache-Control: max-age=0'</span>);\n\n            $objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, <span style=\"color:#a31515\">'Excel2007'</span>);\n            $objWriter-&gt;setIncludeCharts(TRUE);\n            $objWriter-&gt;save(<span style=\"color:#a31515\">'php://output'</span>);</pre>\r\n</div>\r\n",
    "PostedDate": "2012-06-23T00:36:11.457-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]