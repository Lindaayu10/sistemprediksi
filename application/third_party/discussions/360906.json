[
  {
    "Id": "853535",
    "ThreadId": "360906",
    "Html": "\r\n<p>I am trying to read only certain rows and columns.&nbsp; But when I loop through the worksheet, it is still pulling all the columns and rows.&nbsp; And how can I check if it is a date?&nbsp; I tried the PHPExcel_Shared_Date and it is not working.&nbsp; What\r\n am I doing wrong??&nbsp; Please help.</p>\r\n<p>$inputFileName = &quot;../files/sampleSheet.xlsx&quot;;<br>\r\n$sheetname = 'TestSheet1'; <br>\r\n<br>\r\n&nbsp;&nbsp;&nbsp; //file type<br>\r\n&nbsp;&nbsp;&nbsp; $inputFileType = 'Excel2007'; <br>\r\n&nbsp;&nbsp;&nbsp; <br>\r\n&nbsp;&nbsp;&nbsp; class MyReadFilter implements PHPExcel_Reader_IReadFilter<br>\r\n&nbsp;&nbsp;&nbsp; {<br>\r\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; public function readCell($column, $row, $worksheetName = '') {<br>\r\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; // Read row 8 to 12 and column T and U only<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ($row &gt;= 8 &amp;&amp; $row &lt;= 12) {\r\n<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (in_array($column,range('T','U'))) {\r\n<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return true;\r\n<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }\r\n<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } <br>\r\n<br>\r\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; return false;<br>\r\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<br>\r\n&nbsp;&nbsp;&nbsp; }<br>\r\n&nbsp;&nbsp;&nbsp; <br>\r\n&nbsp;&nbsp;&nbsp; $filterSubset = new MyReadFilter();<br>\r\n&nbsp;&nbsp;&nbsp; <br>\r\n&nbsp;&nbsp;&nbsp; /**&nbsp; Create a new Reader of the type defined in $inputFileType&nbsp; **/<br>\r\n&nbsp;&nbsp;&nbsp; $objReader = PHPExcel_IOFactory::createReader($inputFileType);<br>\r\n&nbsp;&nbsp;&nbsp; <br>\r\n<br>\r\n&nbsp;&nbsp;&nbsp; /**&nbsp; Advise the Reader of which WorkSheets we want to load&nbsp; **/\r\n<br>\r\n&nbsp;&nbsp;&nbsp; $objReader-&gt;setLoadSheetsOnly($sheetname);<br>\r\n&nbsp;&nbsp;&nbsp; <br>\r\n&nbsp;&nbsp;&nbsp; $objReader-&gt;setReadFilter($filterSubset);<br>\r\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <br>\r\n&nbsp;&nbsp;&nbsp; /** Load $inputFileName to a PHPExcel Object&nbsp; **/<br>\r\n&nbsp;&nbsp;&nbsp; $objPHPExcel = $objReader-&gt;load($inputFileName);</p>\r\n<p>&nbsp;&nbsp;&nbsp; <br>\r\n&nbsp;&nbsp;&nbsp; $objWorksheet = $objPHPExcel-&gt;setActiveSheetIndexByName($sheetname);<br>\r\n&nbsp;&nbsp;&nbsp; <br>\r\n&nbsp;&nbsp;&nbsp; <br>\r\n&nbsp;&nbsp;&nbsp; $i=0;<br>\r\n&nbsp;&nbsp;&nbsp; foreach ($objWorksheet-&gt;getRowIterator() as $row) <br>\r\n&nbsp;&nbsp;&nbsp; {<br>\r\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $cellIterator = $row-&gt;getCellIterator();<br>\r\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $cellIterator-&gt;setIterateOnlyExistingCells(false);<br>\r\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <br>\r\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <br>\r\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; if($i &lt;= 25)<br>\r\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {<br>\r\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; foreach ($cellIterator as $cell)\r\n<br>\r\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;\r\n<br>\r\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <br>\r\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $cellValue = trim($cell-&gt;getValue());<br>\r\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <br>\r\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; print &quot;&lt;p&gt;$cellValue&lt;/p&gt;&quot;;</p>\r\n<pre>       $dateValue = PHPExcel_Shared_Date::ExcelToPHP($cellValue);\r\n   <span style=\"color:blue\">    print &quot;date is &quot;.</span>date(<span style=\"color:#a31515\">'d-M-Y'</span>,$dateValue);</pre>\r\n<p><br>\r\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<br>\r\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<br>\r\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; else<br>\r\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {<br>\r\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; die(&quot;askjfksajfkfskajkfs&quot;);<br>\r\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<br>\r\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $i&#43;&#43;;<br>\r\n&nbsp;&nbsp;&nbsp; }&nbsp;</p>\r\n",
    "PostedDate": "2012-06-25T19:34:53.843-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "853598",
    "ThreadId": "360906",
    "Html": "<p>The iterators start at row&nbsp;1 and at column A by default</p>\r\n<p>To start a row iterator at row 10</p>\r\n<div style=\"color: black; background-color: white;\">\r\n<pre><span style=\"color: blue;\">foreach</span> ($objWorksheet-&gt;getRowIterator(10) <span style=\"color: blue;\">as</span> $row)\r\n</pre>\r\n</div>\r\n<p>The cell iterator doesn't support a start column, so you'll need to keep track of this yourself</p>\r\n<p>&nbsp;</p>\r\n<div style=\"color: black; background-color: white;\">\r\n<pre>$cellIterator-&gt;setIterateOnlyExistingCells(false);\r\n</pre>\r\n</div>\r\n<p><br />Tells the column iterator to return cells that don't exist, which includes columns A through S</p>\r\n<p>&nbsp;</p>\r\n<p>Does a cell contain an Excel&nbsp;date/time stamp?</p>\r\n<div style=\"color: black; background-color: white;\">\r\n<pre><span style=\"color: blue;\">if</span>(PHPExcel_Shared_Date::isDateTime($cell)) {\r\n    <span style=\"color: green;\">// value is an Excel date/time stamp</span>\r\n} <span style=\"color: blue;\">else</span> {\r\n    <span style=\"color: green;\">// value is not an Excel date/time stamp</span>\r\n}\r\n</pre>\r\n</div>\r\n<p>&nbsp;</p>",
    "PostedDate": "2012-06-25T23:43:30.517-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "853825",
    "ThreadId": "360906",
    "Html": "<p>Mark -- I want to thank you for such quick response.&nbsp; THANK YOU!!&nbsp; I am newbie to using phpExcel in terms of reading spreadsheet. And your solution works. However, I have a question.&nbsp; I can manipulate the date to return the correct date via php, but when I perform the date conversion, it is off by one day.&nbsp;</p>\r\n<p>For example, the date should be 9/30/2008 ... it is returning as 9/29/2008.&nbsp; The original excel date is 39721.&nbsp; Do you know what I might be doing wrong?</p>\r\n<p>Again, thank you for your help.</p>",
    "PostedDate": "2012-06-26T07:37:56.327-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]