[
  {
    "Id": "162342",
    "ThreadId": "48627",
    "Html": "<p>Hey,<br>\r\n<br>\r\nI want to replace some data when an excel is read. <br>\r\nThe numbers 1 to 10 is a field should be replaced by images. is this possible?<br>\r\n<br>\r\n<br>\r\n<br>\r\n/** Include path **/<br>\r\nini_set('include_path', ini_get('include_path').':/srv/www/htdocs/intranet/frsbe/life/includes/Classes/');</p>\r\n<p>#include 'PHPExcel.php';<br>\r\ninclude 'PHPExcel/IOFactory.php';</p>\r\n<p>$objReader = PHPExcel_IOFactory::createReader('Excel5');<br>\r\n$objReader-&gt;setReadDataOnly(true);<br>\r\n$objPHPExcel = $objReader-&gt;load($file);<br>\r\n$objWorksheet = $objPHPExcel-&gt;getSheetByName($sheet);</p>\r\n<p>$highestRow = $objWorksheet-&gt;getHighestRow(); // e.g. 10<br>\r\n$highestColumn = $objWorksheet-&gt;getHighestColumn(); // e.g 'F'</p>\r\n<p>$highestColumnIndex = PHPExcel_Cell::columnIndexFromString($highestColumn); // e.g. 5</p>\r\n<p>echo '&lt;table&gt;' . &quot;\\n&quot;;<br>\r\nfor ($row = 1; $row &lt;= $highestRow; ++$row) {<br>\r\necho '&lt;tr&gt;' . &quot;\\n&quot;;</p>\r\n<p>for ($col = 0; $col &lt;= $highestColumnIndex; ++$col) {<br>\r\necho '&lt;td&gt;' . $objWorksheet-&gt;getCellByColumnAndRow($col, $row)-&gt;getValue() . '&lt;/td&gt;' . &quot;\\n&quot;;<br>\r\n}</p>\r\n<p>echo '&lt;/tr&gt;' . &quot;\\n&quot;;<br>\r\n}<br>\r\necho '&lt;/table&gt;' . &quot;\\n&quot;;</p>\r\n<p> </p>\r\n<p>}</p>\r\n",
    "PostedDate": "2009-02-26T07:35:06.627-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "162349",
    "ThreadId": "48627",
    "Html": "Do you mean this?<br>\r\n<ol>\r\n    <li>In an Excel template file you type numbers 1-10 in some fields.</li>\r\n    <li>You need to generate an Excel file where numbers are replaced by images.</li>\r\n</ol>\r\nIf yes, you could load the Excel file and loop through all cells. Then let the script insert the appropriate image when it finds a number 1-10.<br>\r\n<br>\r\n",
    "PostedDate": "2009-02-26T07:48:08.53-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "162360",
    "ThreadId": "48627",
    "Html": "<table style=\"width:261pt;border-collapse:collapse\" cellspacing=0 cellpadding=0 width=347 border=0>\r\n    <colgroup><col style=\"width:97pt\" width=129><col style=\"width:78pt\" width=104><col style=\"width:86pt\" width=114></colgroup>\r\n    <tbody>\r\n        <tr style=\"height:13.5pt\" height=18>\r\n            <td style=\"border-right:windowtext 1pt solid;border-top:windowtext 1pt solid;border-left:windowtext 1pt solid;width:97pt;border-bottom:windowtext 1pt solid;height:13.5pt;background-color:aqua\" width=129 height=18><span style=\"font-size:13px;font-family:arial\"><i><span style=\"text-decoration:underline\"><b>1</b></span></i></span></td>\r\n            <td style=\"border-right:windowtext 1pt solid;border-top:windowtext 1pt solid;border-left:windowtext;width:78pt;border-bottom:windowtext 1pt solid;background-color:aqua\" width=104><span style=\"font-size:13px;font-family:arial\"><i><span style=\"text-decoration:underline\"><b>2</b></span></i></span></td>\r\n            <td style=\"border-right:windowtext 1pt solid;border-top:windowtext 1pt solid;border-left:windowtext;width:86pt;border-bottom:windowtext 1pt solid;background-color:aqua\" width=114><i><span style=\"font-size:13px;font-family:arial;text-decoration:underline\"><b>3</b></span></i></td>\r\n        </tr>\r\n        <tr style=\"height:12.75pt\" height=17>\r\n            <td style=\"border-right:windowtext 1pt solid;border-top:windowtext;border-left:windowtext 1pt solid;border-bottom:#e0dfe3;height:12.75pt;background-color:transparent\" height=17><span style=\"font-size:13px;font-family:arial\"><b>BRUCE SPRINGSTEEN</b></span></td>\r\n            <td style=\"border-right:windowtext 1pt solid;border-top:windowtext;border-left:windowtext;border-bottom:#e0dfe3;background-color:transparent\"><span style=\"font-size:13px;font-family:arial\"><b>FRANZ FERDINAND</b></span></td>\r\n            <td style=\"border-right:windowtext 1pt solid;border-top:windowtext;border-left:windowtext;border-bottom:#e0dfe3;background-color:transparent\"><span style=\"font-size:13px;font-family:arial\"><b>STAN VAN SAMANG</b></span></td>\r\n        </tr>\r\n        <tr style=\"height:13.5pt\" height=18>\r\n            <td style=\"border-right:windowtext 1pt solid;border-top:#e0dfe3;border-left:windowtext 1pt solid;border-bottom:windowtext 1pt solid;height:13.5pt;background-color:transparent\" height=18><span style=\"font-size:13px;font-family:arial\"><b>WORKING ON A (2CD)</b></span></td>\r\n            <td style=\"border-right:windowtext 1pt solid;border-top:#e0dfe3;border-left:windowtext;border-bottom:windowtext 1pt solid;background-color:transparent\"><span style=\"font-size:13px;font-family:arial\"><b>TONIGHT</b></span></td>\r\n            <td style=\"border-right:windowtext 1pt solid;border-top:#e0dfe3;border-left:windowtext;border-bottom:windowtext 1pt solid;background-color:transparent\"><span style=\"font-size:13px;font-family:arial\"><b>TAKE IT FROM ME</b></span></td>\r\n        </tr>\r\n        <tr style=\"height:12.75pt\" height=17>\r\n            <td style=\"border-right:windowtext 1pt solid;border-top:windowtext;border-left:windowtext 1pt solid;border-bottom:#e0dfe3;height:12.75pt;background-color:yellow\" height=17><span style=\"font-size:13px;font-family:arial\"><b>BRUCE SPRINGSTEEN</b></span></td>\r\n            <td style=\"border-right:windowtext 1pt solid;border-top:windowtext;border-left:windowtext;border-bottom:#e0dfe3;background-color:yellow\"><span style=\"font-size:13px;font-family:arial\"><b>FRANZ FERDINAND</b></span></td>\r\n            <td style=\"border-right:windowtext 1pt solid;border-top:windowtext;border-left:windowtext;border-bottom:#e0dfe3;background-color:transparent\"><span style=\"font-size:13px;font-family:arial\"><b>STAN VAN SAMANG</b></span></td>\r\n        </tr>\r\n        <tr style=\"height:13.5pt\" height=18>\r\n            <td style=\"border-right:windowtext 1pt solid;border-top:#e0dfe3;border-left:windowtext 1pt solid;border-bottom:windowtext 1pt solid;height:13.5pt;background-color:yellow\" height=18><span style=\"font-size:13px;font-family:arial\"><b>WORKING ON A DREAM</b></span></td>\r\n            <td style=\"border-right:windowtext 1pt solid;border-top:#e0dfe3;border-left:windowtext;border-bottom:windowtext 1pt solid;background-color:yellow\"><span style=\"font-size:13px;font-family:arial\"><b>TONIGHT (2cd)</b></span></td>\r\n            <td style=\"border-right:windowtext 1pt solid;border-top:#e0dfe3;border-left:windowtext;border-bottom:windowtext 1pt solid;background-color:transparent\"><span style=\"font-size:13px;font-family:arial\"><b>TAKE IT FROM ME</b></span></td>\r\n        </tr>\r\n        <tr style=\"height:12.75pt\" height=17>\r\n            <td style=\"border-right:windowtext 1pt solid;border-top:windowtext;border-left:windowtext 1pt solid;border-bottom:#e0dfe3;height:12.75pt;background-color:transparent\" height=17><span style=\"font-size:13px;font-family:arial\"><b>BRUCE SPRINGSTEEN</b></span></td>\r\n            <td style=\"border-right:windowtext 1pt solid;border-top:windowtext;border-left:windowtext;border-bottom:#e0dfe3;background-color:transparent\"><span style=\"font-size:13px;font-family:arial\"><b>FRANZ FERDINAND</b></span></td>\r\n            <td style=\"border-right:windowtext 1pt solid;border-top:windowtext;border-left:windowtext;border-bottom:#e0dfe3;background-color:transparent\"><span style=\"font-size:13px;font-family:arial\"><b>STAN VAN SAMANG</b></span></td>\r\n        </tr>\r\n        <tr style=\"height:13.5pt\" height=18>\r\n            <td style=\"border-right:windowtext 1pt solid;border-top:#e0dfe3;border-left:windowtext 1pt solid;border-bottom:windowtext 1pt solid;height:13.5pt;background-color:transparent\" height=18><span style=\"font-size:13px;font-family:arial\"><b>WORKING ON A (2CD)</b></span></td>\r\n            <td style=\"border-right:windowtext 1pt solid;border-top:#e0dfe3;border-left:windowtext;border-bottom:windowtext 1pt solid;background-color:transparent\"><span style=\"font-size:13px;font-family:arial\"><b>TONIGHT</b></span></td>\r\n            <td style=\"border-right:windowtext 1pt solid;border-top:#e0dfe3;border-left:windowtext;border-bottom:windowtext 1pt solid;background-color:transparent\"><b><span style=\"font-size:13px;font-family:arial\">TAKE IT FROM ME</span></b></td>\r\n        </tr>\r\n    </tbody>\r\n</table>\r\n<br>\r\n<br>\r\nThis is what the imput is .... an excel sheet with a chart.<br>\r\nI want to display this on a web site using phpexcel. I wonder if i can replace the 1 -2 - 3 in my phpcode <br>\r\n<br>\r\nsomething like <br>\r\n<br>\r\nif(is_number($field){<br>\r\necho &quot;&lt;img src\\&quot;./images/chart&quot;.$field.&quot;.png\\&quot;&gt; <br>\r\n}<br>\r\n<br>\r\n",
    "PostedDate": "2009-02-26T08:11:41.273-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "162368",
    "ThreadId": "48627",
    "Html": "You can type some strings e.g. _IMAGE1_, _IMAGE2_, etc in your Excel sheet, and then replace those strings (fields) with HTML tags after generating the table. Example:<br>\r\n<br>\r\n<code>\r\n$html = '&lt;table&gt;&lt;tr&gt;&lt;td&gt;_IMAGE1_&lt;/td&gt;&lt;/tr&gt;...&lt;/table&gt;';<br>\r\n<br>\r\nstr_replace('_IMAGE1_', '&lt;img src=&quot;image1.png&quot;&gt;', $html);<br>\r\n</code>\r\n<br>\r\nOnce you get this working you can make it more sophisticated by using replacements via regular expressions to automate for <em>n</em> images.<br>\r\n<br>\r\n",
    "PostedDate": "2009-02-26T08:26:39.15-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "162631",
    "ThreadId": "48627",
    "Html": "<p>hmmm was not wat i was looking for<br>\r\n<br>\r\nbut this works ;-)<br>\r\n</p>\r\n<p>echo &quot;&lt;table class=$type&gt;&quot;;<br>\r\nfor ($row = 1; $row &lt;= $highestRow; ++$row) {<br>\r\necho &quot;&lt;tr&gt;&quot;;</p>\r\n<p>for ($col = 0; $col &lt;= $highestColumnIndex; ++$col) {<br>\r\n$value= $objWorksheet-&gt;getCellByColumnAndRow($col, $row)-&gt;getValue();<br>\r\nif(is_numeric($value)){<br>\r\nif(in_array($value,$charts)){<br>\r\necho &quot;&lt;td div align=\\&quot;center\\&quot;&gt;&lt;img src=\\&quot;./images/&quot;.$value.&quot;-&quot;.$type.&quot;.png\\&quot;&gt;&lt;/td&gt;&quot;;<br>\r\n}<br>\r\nelse{<br>\r\necho &quot;&lt;td div align=\\&quot;center\\&quot;&gt;&quot; . $objWorksheet-&gt;getCellByColumnAndRow($col, $row)-&gt;getValue() . &quot;&lt;/td&gt;&quot;;<br>\r\n}<br>\r\n}<br>\r\nelse{<br>\r\necho &quot;&lt;td div align=\\&quot;center\\&quot;&gt;&quot; . $objWorksheet-&gt;getCellByColumnAndRow($col, $row)-&gt;getValue() . &quot;&lt;/td&gt;&quot;;<br>\r\n}<br>\r\n#if(is_numeric( $objWorksheet-&gt;getCellByColumnAndRow($col, $row)-&gt;getValue())<br>\r\n#{<br>\r\n# echo &quot;&lt;td div align=\\&quot;center\\&quot;&gt;&quot; . $objWorksheet-&gt;getCellByColumnAndRow($col, $row)-&gt;getValue() . &quot;i jaaaaaaaaa&lt;/td&gt;&quot;;<br>\r\n#}<br>\r\n#else{<br>\r\n#echo &quot;&lt;td div align=\\&quot;center\\&quot;&gt;&quot; . $objWorksheet-&gt;getCellByColumnAndRow($col, $row)-&gt;getValue() . &quot;&lt;/td&gt;&quot;;<br>\r\n#}<br>\r\n}<br>\r\necho &quot;&lt;/tr&gt;&quot;;<br>\r\n}<br>\r\necho &quot;&lt;/table&gt;&quot;;</p>\r\n",
    "PostedDate": "2009-02-27T00:19:13.27-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]