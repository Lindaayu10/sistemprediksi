[
  {
    "Id": "1278858",
    "ThreadId": "554533",
    "Html": "The hosted site I am on does not support Excel2007 writer for some options I want to do so I am using Excel5 but when I try to add a dropdown from a named range or cell range I just get a blank dropdown. and I am not sure what options I have since there are more than 265 characters in the list.\r<br />\n<br />\nI am using PHPExcel v. 1.8.0 with PHP version 5.2.9.\r<br />\n<br />\nI am using the following code and $dept_list is an array. I can verify that the data gets written correctly to the &quot;DATA&quot; sheet.\r<br />\n<br />\nThanks.\r<br />\n<br />\n$objWorksheet3 = $objPHPExcel-&gt;createSheet();<br />\n<pre><code>$objWorksheet3-&gt;setTitle('DATA');\n$objPHPExcel-&gt;setActiveSheetIndexByName('DATA');\n//Set sheet to very hidden (can only be undone programmically)\n$objPHPExcel-&gt;getActiveSheet()-&gt;setSheetState(PHPExcel_Worksheet::SHEETSTATE_VERYHIDDEN);\n//Write the dept list array to the sheet\n$objPHPExcel-&gt;getActiveSheet()-&gt;fromArray($dept_list, NULL, 'A1');  \n//Create a named range\n$objPHPExcel-&gt;addNamedRange( new PHPExcel_NamedRange('depts', $objPHPExcel-&gt;getActiveSheet(), 'A1:A23') );\n//Set the Bulk Order sheet to active\n$objPHPExcel-&gt;setActiveSheetIndexByName('Bulk Order');  \n\nfor($i=2;$i&lt;=25;$i++) {\n    //Add a dropdown box to row 5\n    $objValidation = $objPHPExcel-&gt;getActiveSheet()-&gt;getCellByColumnAndRow($i, 5)-&gt;getDataValidation();\n    $objValidation-&gt;setType( PHPExcel_Cell_DataValidation::TYPE_LIST );\n    $objValidation-&gt;setErrorStyle( PHPExcel_Cell_DataValidation::STYLE_INFORMATION );\n    $objValidation-&gt;setAllowBlank(false);\n    $objValidation-&gt;setShowInputMessage(true);\n    $objValidation-&gt;setShowErrorMessage(true);\n    $objValidation-&gt;setShowDropDown(true);\n    $objValidation-&gt;setErrorTitle('Input error');\n    $objValidation-&gt;setError('Value is not in list.');\n    $objValidation-&gt;setPromptTitle('Pick from list');\n    $objValidation-&gt;setPrompt('Please pick a value from the drop-down list.');\n    $objValidation-&gt;setFormula1('depts');               \n}</code></pre>\n\n",
    "PostedDate": "2014-07-29T11:08:53.56-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]