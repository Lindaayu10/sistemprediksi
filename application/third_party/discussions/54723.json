[
  {
    "Id": "184548",
    "ThreadId": "54723",
    "Html": "Hi,<br>\r\nI just upgraded to 1.6.7 and then some of my formatting was lost. When I revert to 1.6.6 i get the formatting back. <br>\r\n<br>\r\nIn my script I have created two excel sheets, which both have formatting correct. But this last script, which use does not receive the formatting correct. <br>\r\nAny ideas on where to search. Can there be a memory leak, or something else which mean that i should re-initialize the script. <br>\r\n<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $objPHPExcel = new PHPExcel();<br>\r\n<br>\r\n<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // metadata<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $objPHPExcel-&gt;getProperties()-&gt;setCreator(&quot;figaf&quot;);<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $objPHPExcel-&gt;getProperties()-&gt;setLastModifiedBy(&quot;figaf&quot;);<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $objPHPExcel-&gt;getProperties()-&gt;setTitle(&quot;PI Mapping diff&quot;);<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $objPHPExcel-&gt;getProperties()-&gt;setKeywords(&quot;pi mapping diff&quot;);<br>\r\n<br>\r\n<br>\r\n<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Set active sheet index to the first sheet, so Excel opens this as the first sheet<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $objPHPExcel-&gt;setActiveSheetIndex(0);<br>\r\n<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $objPHPExcel-&gt;getActiveSheet()-&gt;setTitle('Mapping difference');<br>\r\n<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //insert information about the mappping<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('A1', 'Mapping name');<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('C1', $oldMapInfo-&gt;getValue('NAME'));<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('D1', $newMapInfo-&gt;getValue('NAME'));<br>\r\n&nbsp; <br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $objPHPExcel-&gt;getActiveSheet()-&gt;mergeCells('A1:B1');<br>\r\n<br>\r\n&nbsp;$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('A1')-&gt;getFont()-&gt;setBold(true);<br>\r\n<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //format the top document this seems to work. <br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension('A')-&gt;setWidth(5);<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension('B')-&gt;setWidth(60);<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension('C')-&gt;setWidth(70);<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension('D')-&gt;setWidth(70);<br>\r\n<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('A'.(self::STARTLINE-1), 'Changed');<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('B'.(self::STARTLINE-1), 'Target');<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('C'.(self::STARTLINE-1), 'Old mapping');<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('D'.(self::STARTLINE-1), 'New Mapping');<br>\r\n<br>\r\n<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('A'.(self::STARTLINE-1))-&gt;getFont()-&gt;setBold(true);<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('A'.(self::STARTLINE-1))-&gt;getBorders()-&gt;getBottom()-&gt;setBorderStyle(PHPExcel_Style_Border::BORDER_THICK);<br>\r\n<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // write content<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, 'Excel2007');<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $objWriter-&gt;save($this-&gt;directory.'/diff.xlsx');<br>\r\n",
    "PostedDate": "2009-04-28T08:05:16.793-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "184681",
    "ThreadId": "54723",
    "Html": "I couldn't quite reconstruct your script because there are some unknown parameters. Not sure what changes in 1.6.7 compared to 1.6.6 could be causing this.<br>\r\n<br>\r\nI do see one thing in the code. When you apply styling to a merged range of cells, all of the cells in the range need the styling applied.<br>\r\n<br>\r\nInstead of this:<br>\r\n<br>\r\n<code>\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;mergeCells('A1:B1');<br>\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('A1')-&gt;getFont()-&gt;setBold(true);<br>\r\n</code>\r\n<br>\r\ndo like this:<br>\r\n<br>\r\n<code>\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;mergeCells('A1:B1');<br>\r\n$styleArray = array('font' =&gt; array('bold' =&gt; true));<br>\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;duplicateStyleArray($styleArray, 'A1:B1');<br>\r\n</code>\r\n<br>\r\nIf one forgets to apply the style to the entire range, borders may only show up partially in MS Office Excel.<br>\r\n",
    "PostedDate": "2009-04-28T13:05:39.057-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]