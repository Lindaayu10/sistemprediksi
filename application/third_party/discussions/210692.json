[
  {
    "Id": "435939",
    "ThreadId": "210692",
    "Html": "<p>Hi guys, im posting here quite often, sorry for that, just trying help you and myself.</p>\r\n<p>Now im having one problem with cell format when i create the file using PDF_Writer, with XLS its OK but PDF isnt, so im gonna post some information:</p>\r\n<p>PHPExcel Version: 1.7.2</p>\r\n<p>Database: MS SQL Server 2005</p>\r\n<p>PHP IDE: Komodo Edit 5.2</p>\r\n<p>Well ill insert some prints so you guys can check out the problem:</p>\r\n<p>Image with THE problem: http://i26.photobucket.com/albums/c110/nydiow/Riversoft/format_problem.png</p>\r\n<p>XLS: http://i26.photobucket.com/albums/c110/nydiow/xls.png</p>\r\n<p>How should be: http://i26.photobucket.com/albums/c110/nydiow/Riversoft/format.png</p>\r\n<p>I got those images with de same code, the unique difference between than is that i forced the code fill the page <span style=\"font-size:10pt\" lang=NL>horizontally (plus one year for example), so every time that i dont do that, i got this formating problem, and im quite sure that is a bug, and more, the </span>error_reporting(E_ALL); doesnt work so i MUST comment that to keep my code working (dont know why, i got a lot of errors such as <strong>Notice</strong>:  Undefined index:  TOTAL in <strong>C:\\Inetpub\\wwwroot\\STCPWEB_ADMIN-4_0_0-4057\\www\\list_est_xls_pdf.php</strong> on line <strong>295</strong>)</p>\r\n<p>Code:</p>\r\n<p><span style=\"font-size:10pt\" lang=NL>\r\n<div style=\"color:black;background-color:white\">\r\n<pre>&lt;?php\r\n<span style=\"color:green\">/**\r\n * PHPExcel\r\n *\r\n * Copyright (C) 2006 - 2010 PHPExcel\r\n *\r\n * This library is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU Lesser General Public\r\n * License as published by the Free Software Foundation; either\r\n * version 2.1 of the License, or (at your option) any later version.\r\n * \r\n * This library is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\r\n * Lesser General Public License for more details.\r\n * \r\n * You should have received a copy of the GNU Lesser General Public\r\n * License along with this library; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA\r\n *\r\n * @category   PHPExcel\r\n * @package    PHPExcel\r\n * @copyright  Copyright (c) 2006 - 2010 PHPExcel (http://www.codeplex.com/PHPExcel)\r\n * @license    http://www.gnu.org/licenses/old-licenses/lgpl-2.1.txt\tLGPL\r\n * @version    1.7.2, 2010-01-11\r\n * @File Encoding MUST be UTF-8\r\n */</span>\r\n\r\n<span style=\"color:blue\">require</span> ( <span style=\"color:#a31515\">&quot;./cgi-bin/stcpwebsup.php&quot;</span> );\r\n<span style=\"color:blue\">require</span> ( <span style=\"color:#a31515\">&quot;./cgi-bin/stcpwebses.php&quot;</span> );\r\n\r\n$de=$_GET[<span style=\"color:#a31515\">'de'</span>];\r\n$ate=$_GET[<span style=\"color:#a31515\">'ate'</span>];\r\n$idUser=$_GET[<span style=\"color:#a31515\">'idUser'</span>];\r\n$idSit=$_GET[<span style=\"color:#a31515\">'idSit'</span>];\r\n$idArq=$_GET[<span style=\"color:#a31515\">'idArq'</span>];\r\n\r\n$Datade = date(<span style=\"color:#a31515\">&quot;d/m/Y G:i:s&quot;</span>, strtotime($de));\r\n$Dataate = date(<span style=\"color:#a31515\">&quot;d/m/Y G:i:s&quot;</span>, strtotime($ate));\r\n\r\n$year = date(<span style=\"color:#a31515\">&quot;Y&quot;</span>, strtotime($ate));\r\n$year = $year - 2000;\r\n\r\n$s = count( $descEstat );\r\n<span style=\"color:green\">//echo &quot;&lt;br&gt;Contando array: &quot;.$s.&quot;&lt;br&gt;&lt;br&gt;&quot;;</span>\r\n\r\n$tit = $descEstat[$idSit] .<span style=\"color:#a31515\">&quot; - &quot;</span> . GetNomeServidorODETTE();\r\n    \r\n<span style=\"color:green\">//OBTEM RELATORIO</span>\r\n$arLinhas = GetRelatEstatisticaPDF( $de,$ate,$idUser,$idSit,$idArq );\r\n\r\n$s = count( $arLinhas );\r\n<span style=\"color:green\">//echo &quot;&lt;br&gt;Contando no Array GetRelatEstatistica: &quot; . $s.&quot;&lt;br&gt;&quot;;</span>\r\n\r\n<span style=\"color:green\">/** Error reporting */</span>\r\n<span style=\"color:green\">//error_reporting(E_ALL);</span>\r\n\r\n<span style=\"color:green\">/** PHPExcel */</span>\r\n<span style=\"color:blue\">require_once</span> <span style=\"color:#a31515\">'./Classes/PHPExcel.php'</span>;\r\n\r\n<span style=\"color:green\">/** PHPExcel_IOFactory */</span>\r\n<span style=\"color:blue\">require_once</span> <span style=\"color:#a31515\">'./Classes/PHPExcel/IOFactory.php'</span>;\r\n\r\n<span style=\"color:green\">// Create new PHPExcel object</span>\r\n$objPHPExcel = <span style=\"color:blue\">new</span> PHPExcel();\r\n\r\n<span style=\"color:green\">// Set properties</span>\r\n$objPHPExcel-&gt;getProperties()-&gt;setCreator(<span style=\"color:#a31515\">&quot;Riversoft&quot;</span>)\r\n\t\t\t\t\t\t\t -&gt;setLastModifiedBy(<span style=\"color:#a31515\">&quot;Riversoft&quot;</span>)\r\n\t\t\t\t\t\t\t -&gt;setTitle(<span style=\"color:#a31515\">&quot;Relat&oacute;rio - STCP OFTP Web Admin&quot;</span>)\r\n\t\t\t\t\t\t\t -&gt;setSubject(<span style=\"color:#a31515\">&quot;Relat&oacute;rio - STCP OFTP Web Admin&quot;</span>)\r\n\t\t\t\t\t\t\t -&gt;setDescription(<span style=\"color:#a31515\">&quot;Relat&oacute;rio - STCP OFTP Web Admin - Riversoft&quot;</span>)\r\n\t\t\t\t\t\t\t -&gt;setKeywords(<span style=\"color:#a31515\">&quot;Relat&oacute;rio&quot;</span>)\r\n\t\t\t\t\t\t\t -&gt;setCategory(<span style=\"color:#a31515\">&quot;Relat&oacute;rio&quot;</span>);\r\n                                                         \r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#a31515\">'B1'</span>)-&gt;getFont()-&gt;setName(<span style=\"color:#a31515\">'Arial'</span>);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#a31515\">'B1'</span>)-&gt;getFont()-&gt;setUnderline(PHPExcel_Style_Font::UNDERLINE_SINGLE);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#a31515\">'B1'</span>)-&gt;getFont()-&gt;setSize(14);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#a31515\">'B1'</span>)-&gt;getFont()-&gt;setBold(true);\r\n\r\n\r\n\r\n$objPHPExcel-&gt;setActiveSheetIndex(0)\r\n            -&gt;setCellValue(<span style=\"color:#a31515\">'B1'</span>, html_entity_decode(STCPWEB_MSG_5770,ENT_QUOTES,<span style=\"color:#a31515\">'UTF-8'</span>));\r\n\t    \r\n<span style=\"color:green\">// Rename sheet</span>\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setTitle(<span style=\"color:#a31515\">'Relat&oacute;rio'</span>);\r\n\r\n<span style=\"color:green\">// Set active sheet index to the first sheet, so Excel opens this as the first sheet</span>\r\n$objPHPExcel-&gt;setActiveSheetIndex(0);\r\n\r\n$objDrawing = <span style=\"color:blue\">new</span> PHPExcel_Worksheet_Drawing();\r\n$objDrawing-&gt;setName(<span style=\"color:#a31515\">'Riversoft logo'</span>);\r\n$objDrawing-&gt;setDescription(<span style=\"color:#a31515\">'Riversoft logo'</span>);\r\n$objDrawing-&gt;setPath(<span style=\"color:#a31515\">'./imagens/riverlogo.jpg'</span>);\r\n$objDrawing-&gt;setHeight(20);\r\n$objDrawing-&gt;setCoordinates(<span style=\"color:#a31515\">'A1'</span>);\r\n$objDrawing-&gt;setWorksheet($objPHPExcel-&gt;getActiveSheet());\r\n\r\n$objPHPExcel-&gt;setActiveSheetIndex(0)-&gt;setCellValue(<span style=\"color:#a31515\">'A3'</span>, html_entity_decode(STCPWEB_MSG_0066,ENT_QUOTES,<span style=\"color:#a31515\">'UTF-8'</span>).<span style=\"color:#a31515\">&quot; &quot;</span>. $Datade);\r\n$objPHPExcel-&gt;setActiveSheetIndex(0)-&gt;setCellValue(<span style=\"color:#a31515\">'B3'</span>, html_entity_decode(STCPWEB_MSG_0067,ENT_QUOTES,<span style=\"color:#a31515\">'UTF-8'</span>).<span style=\"color:#a31515\">&quot; &quot;</span>. $Dataate);\r\n$objPHPExcel-&gt;setActiveSheetIndex(0)-&gt;setCellValue(<span style=\"color:#a31515\">'A6'</span>, html_entity_decode($tit,ENT_QUOTES,<span style=\"color:#a31515\">'UTF-8'</span>));\r\n$objPHPExcel-&gt;setActiveSheetIndex(0)-&gt;setCellValue(<span style=\"color:#a31515\">'B4'</span>, html_entity_decode(STCPWEB_MSG_0258,ENT_QUOTES,<span style=\"color:#a31515\">'UTF-8'</span>).<span style=\"color:#a31515\">&quot;: &quot;</span>. $idArq);\r\n$objPHPExcel-&gt;setActiveSheetIndex(0)-&gt;setCellValue(<span style=\"color:#a31515\">'A4'</span>, html_entity_decode(STCPWEB_MSG_0064,ENT_QUOTES,<span style=\"color:#a31515\">'UTF-8'</span>).<span style=\"color:#a31515\">&quot;: &quot;</span>. $idUser);\r\n\r\n<span style=\"color:green\">/*$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('7')-&gt;getFont()-&gt;setSize(8);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('8')-&gt;getFont()-&gt;setSize(8);*/</span>\r\n\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#a31515\">'A3:B4'</span>)-&gt;getFont()-&gt;setSize(8);\r\n    \r\n$j=1;\r\n$letra = <span style=\"color:#a31515\">'B'</span>;\r\n    \r\n\r\n    $cont = 7;\r\n    \r\n    $objPHPExcel-&gt;getActiveSheet()-&gt;mergeCells(<span style=\"color:#a31515\">'B1:F1'</span>);\r\n    $objPHPExcel-&gt;getActiveSheet()-&gt;mergeCells(<span style=\"color:#a31515\">'B4:H4'</span>); <span style=\"color:green\">//File name</span>\r\n    $objPHPExcel-&gt;getActiveSheet()-&gt;mergeCells(<span style=\"color:#a31515\">'B3:C3'</span>);\r\n    \r\n    $objPHPExcel-&gt;setActiveSheetIndex(0)-&gt;setCellValue(<span style=\"color:#a31515\">'A7'</span>, html_entity_decode(STCPWEB_MSG_0052,ENT_QUOTES,<span style=\"color:#a31515\">'UTF-8'</span>).<span style=\"color:#a31515\">&quot;: &quot;</span>); \r\n    $objPHPExcel-&gt;setActiveSheetIndex(0)-&gt;setCellValue(<span style=\"color:#a31515\">'A8'</span>, html_entity_decode(STCPWEB_MSG_0053,ENT_QUOTES,<span style=\"color:#a31515\">'UTF-8'</span>).<span style=\"color:#a31515\">&quot;: &quot;</span>); \r\n    $objPHPExcel-&gt;setActiveSheetIndex(0)-&gt;setCellValue(<span style=\"color:#a31515\">'A9'</span>, html_entity_decode(STCPWEB_MSG_0054,ENT_QUOTES,<span style=\"color:#a31515\">'UTF-8'</span>).<span style=\"color:#a31515\">&quot;: &quot;</span>);\r\n    $objPHPExcel-&gt;setActiveSheetIndex(0)-&gt;setCellValue(<span style=\"color:#a31515\">'A10'</span>, html_entity_decode(STCPWEB_MSG_0059,ENT_QUOTES,<span style=\"color:#a31515\">'UTF-8'</span>).<span style=\"color:#a31515\">&quot;: &quot;</span>);\r\n    $objPHPExcel-&gt;setActiveSheetIndex(0)-&gt;setCellValue(<span style=\"color:#a31515\">'A11'</span>, html_entity_decode(STCPWEB_MSG_0055,ENT_QUOTES,<span style=\"color:#a31515\">'UTF-8'</span>).<span style=\"color:#a31515\">&quot;: &quot;</span>);\r\n    $objPHPExcel-&gt;setActiveSheetIndex(0)-&gt;setCellValue(<span style=\"color:#a31515\">'A12'</span>, html_entity_decode(STCPWEB_MSG_0056,ENT_QUOTES,<span style=\"color:#a31515\">'UTF-8'</span>).<span style=\"color:#a31515\">&quot;: &quot;</span>);\r\n    $objPHPExcel-&gt;setActiveSheetIndex(0)-&gt;setCellValue(<span style=\"color:#a31515\">'A13'</span>, html_entity_decode(STCPWEB_MSG_0057,ENT_QUOTES,<span style=\"color:#a31515\">'UTF-8'</span>).<span style=\"color:#a31515\">&quot;: &quot;</span>); \r\n    $objPHPExcel-&gt;setActiveSheetIndex(0)-&gt;setCellValue(<span style=\"color:#a31515\">'A14'</span>, html_entity_decode(STCPWEB_MSG_0058,ENT_QUOTES,<span style=\"color:#a31515\">'UTF-8'</span>).<span style=\"color:#a31515\">&quot;: &quot;</span>);\r\n    $objPHPExcel-&gt;setActiveSheetIndex(0)-&gt;setCellValue(<span style=\"color:#a31515\">'A15'</span>, html_entity_decode(STCPWEB_MSG_0060,ENT_QUOTES,<span style=\"color:#a31515\">'UTF-8'</span>).<span style=\"color:#a31515\">&quot;: &quot;</span>);\r\n    $objPHPExcel-&gt;setActiveSheetIndex(0)-&gt;setCellValue(<span style=\"color:#a31515\">'A16'</span>, html_entity_decode(STCPWEB_MSG_0061,ENT_QUOTES,<span style=\"color:#a31515\">'UTF-8'</span>).<span style=\"color:#a31515\">&quot;: &quot;</span>);\r\n    $objPHPExcel-&gt;setActiveSheetIndex(0)-&gt;setCellValue(<span style=\"color:#a31515\">'A17'</span>, html_entity_decode(STCPWEB_MSG_0062,ENT_QUOTES,<span style=\"color:#a31515\">'UTF-8'</span>).<span style=\"color:#a31515\">&quot;: &quot;</span>);\r\n    $objPHPExcel-&gt;setActiveSheetIndex(0)-&gt;setCellValue(<span style=\"color:#a31515\">'A18'</span>, html_entity_decode(STCPWEB_MSG_0063,ENT_QUOTES,<span style=\"color:#a31515\">'UTF-8'</span>).<span style=\"color:#a31515\">&quot;: &quot;</span>); \r\n\t\t\r\n    $objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimensionByColumn(0)-&gt;setWidth(33);\r\n    \r\n    $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#a31515\">'A6:B18'</span>)-&gt;getFont()-&gt;setSize(8);\r\n    $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#a31515\">'A6:A18'</span>)-&gt;getFont()-&gt;setBold(true);\r\n    $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#a31515\">'A7:A18'</span>)-&gt;getFont()-&gt;setUnderline(PHPExcel_Style_Font::UNDERLINE_SINGLE);\r\n    $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#a31515\">'A7:A18'</span>)-&gt;getFont()-&gt;getColor()-&gt;setARGB(PHPExcel_Style_Color::COLOR_WHITE);\r\n\t\r\n    $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#a31515\">'A7:A18'</span>)-&gt;getFill()-&gt;setFillType(PHPExcel_Style_Fill::FILL_SOLID);\r\n    $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#a31515\">'A7:A18'</span>)-&gt;getFill()-&gt;getStartColor()-&gt;setARGB(<span style=\"color:#a31515\">'FF808080'</span>);\r\n    \r\n    \r\n    <span style=\"color:blue\">for</span> ( $i = 0; $i &lt;= $year; $i++ )\r\n    {\r\n\t\t\r\n\t    <span style=\"color:green\">//Years logic (print 6 years horizontally and jump lines and restore column)</span>\r\n        <span style=\"color:blue\">if</span> ($i==6 || $i==12 || $i==18 || $i==24 || $i==30 || $i==36 || $i==42 || $i==48)\r\n        {\r\n            $letra = <span style=\"color:#a31515\">'B'</span>;\r\n            $j=$j-6;\r\n            $cont=$cont+14;\r\n            \r\n            $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValueByColumnAndRow(0, ($cont-1),html_entity_decode($tit,ENT_QUOTES,<span style=\"color:#a31515\">'UTF-8'</span>));\r\n            $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValueByColumnAndRow(0, ($cont),html_entity_decode(STCPWEB_MSG_0052,ENT_QUOTES,<span style=\"color:#a31515\">'UTF-8'</span>).<span style=\"color:#a31515\">&quot;: &quot;</span>);\r\n            $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValueByColumnAndRow(0, ($cont+1),html_entity_decode(STCPWEB_MSG_0053,ENT_QUOTES,<span style=\"color:#a31515\">'UTF-8'</span>).<span style=\"color:#a31515\">&quot;: &quot;</span>);\r\n            $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValueByColumnAndRow(0, ($cont+2),html_entity_decode(STCPWEB_MSG_0054,ENT_QUOTES,<span style=\"color:#a31515\">'UTF-8'</span>).<span style=\"color:#a31515\">&quot;: &quot;</span>);\r\n            $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValueByColumnAndRow(0, ($cont+3),html_entity_decode(STCPWEB_MSG_0059,ENT_QUOTES,<span style=\"color:#a31515\">'UTF-8'</span>).<span style=\"color:#a31515\">&quot;: &quot;</span>);\r\n            $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValueByColumnAndRow(0, ($cont+4),html_entity_decode(STCPWEB_MSG_0055,ENT_QUOTES,<span style=\"color:#a31515\">'UTF-8'</span>).<span style=\"color:#a31515\">&quot;: &quot;</span>);\r\n            $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValueByColumnAndRow(0, ($cont+5),html_entity_decode(STCPWEB_MSG_0056,ENT_QUOTES,<span style=\"color:#a31515\">'UTF-8'</span>).<span style=\"color:#a31515\">&quot;: &quot;</span>);\r\n            $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValueByColumnAndRow(0, ($cont+6),html_entity_decode(STCPWEB_MSG_0057,ENT_QUOTES,<span style=\"color:#a31515\">'UTF-8'</span>).<span style=\"color:#a31515\">&quot;: &quot;</span>);\r\n            $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValueByColumnAndRow(0, ($cont+7),html_entity_decode(STCPWEB_MSG_0058,ENT_QUOTES,<span style=\"color:#a31515\">'UTF-8'</span>).<span style=\"color:#a31515\">&quot;: &quot;</span>);\r\n            $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValueByColumnAndRow(0, ($cont+8),html_entity_decode(STCPWEB_MSG_0060,ENT_QUOTES,<span style=\"color:#a31515\">'UTF-8'</span>).<span style=\"color:#a31515\">&quot;: &quot;</span>);\r\n            $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValueByColumnAndRow(0, ($cont+9),html_entity_decode(STCPWEB_MSG_0061,ENT_QUOTES,<span style=\"color:#a31515\">'UTF-8'</span>).<span style=\"color:#a31515\">&quot;: &quot;</span>);\r\n            $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValueByColumnAndRow(0, ($cont+10),html_entity_decode(STCPWEB_MSG_0062,ENT_QUOTES,<span style=\"color:#a31515\">'UTF-8'</span>).<span style=\"color:#a31515\">&quot;: &quot;</span>);\r\n            $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValueByColumnAndRow(0, ($cont+11),html_entity_decode(STCPWEB_MSG_0063,ENT_QUOTES,<span style=\"color:#a31515\">'UTF-8'</span>).<span style=\"color:#a31515\">&quot;: &quot;</span>);\r\n                                    \r\n            $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#a31515\">'A'</span>.($cont-1).<span style=\"color:#a31515\">':A'</span>.($cont+11))-&gt;getFont()-&gt;setSize(8);\r\n            $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#a31515\">'A'</span>.($cont-1).<span style=\"color:#a31515\">':A'</span>.($cont+11))-&gt;getFont()-&gt;setBold(true);\r\n            $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#a31515\">'A'</span>.($cont).<span style=\"color:#a31515\">':A'</span>.($cont+11))-&gt;getFont()-&gt;setUnderline(PHPExcel_Style_Font::UNDERLINE_SINGLE);\r\n            $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#a31515\">'A'</span>.($cont).<span style=\"color:#a31515\">':A'</span>.($cont+11))-&gt;getFont()-&gt;getColor()-&gt;setARGB(PHPExcel_Style_Color::COLOR_WHITE);\r\n                        \r\n            $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#a31515\">'A'</span>.($cont).<span style=\"color:#a31515\">':A'</span>.($cont+11))-&gt;getFill()-&gt;setFillType(PHPExcel_Style_Fill::FILL_SOLID);\r\n            $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#a31515\">'A'</span>.($cont).<span style=\"color:#a31515\">':A'</span>.($cont+11))-&gt;getFill()-&gt;getStartColor()-&gt;setARGB(<span style=\"color:#a31515\">'FF808080'</span>);\r\n        }\r\n        \r\n            <span style=\"color:green\">// Seta array temporario</span>\r\n\t    <span style=\"color:blue\">for</span> ( $n = 0; $n &lt; 8; $n++ )\r\n\t\t$arTmp[$n] = $arLinhas[$n][$i];\r\n            \r\n            $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValueByColumnAndRow($j, ($cont-1), html_entity_decode(STCPWEB_MSG_0372,ENT_QUOTES,<span style=\"color:#a31515\">'UTF-8'</span>).<span style=\"color:#a31515\">&quot; &quot;</span> . ($i+2000));\r\n            $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle($letra.($cont-1))-&gt;getFont()-&gt;setBold(true);\r\n\t    \t    \r\n            $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle($letra.($cont-1))-&gt;getFont()-&gt;getColor()-&gt;setARGB(PHPExcel_Style_Color::COLOR_WHITE);\r\n            $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle($letra.($cont-1))-&gt;getFill()-&gt;setFillType(PHPExcel_Style_Fill::FILL_SOLID);\r\n            $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle($letra.($cont-1))-&gt;getFill()-&gt;getStartColor()-&gt;setARGB(<span style=\"color:#a31515\">'FF808080'</span>);\r\n            $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle($letra.($cont-1))-&gt;getFont()-&gt;setUnderline(PHPExcel_Style_Font::UNDERLINE_SINGLE);\r\n            \r\n            $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle($letra)-&gt;getFont()-&gt;setSize(8);\r\n            $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle($letra.($cont-1))-&gt;getFont()-&gt;setSize(8);\r\n        \r\n\t    <span style=\"color:green\">// Mostra Lista das estatisticas</span>\r\n        $Total    = ( $arTmp[1][<span style=\"color:#a31515\">'TOTAL'</span>] );\r\n        <span style=\"color:blue\">if</span>(!$Total)\r\n            $Total = 0;\r\n\t$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValueByColumnAndRow($j, $cont,<span style=\"color:#a31515\">&quot; &quot;</span>.$Total);\r\n\t$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimensionByColumn($j)-&gt;setWidth(13);\r\n        \r\n        \r\n        $Total  = ( $arTmp[1][<span style=\"color:#a31515\">'QTD'</span>] );\r\n        <span style=\"color:blue\">if</span>(!$Total)\r\n            $Total = 0;\r\n\t$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValueByColumnAndRow($j, ($cont+1),<span style=\"color:#a31515\">&quot; &quot;</span>.$Total);\r\n                \r\n        $Total   = ( $arTmp[1][<span style=\"color:#a31515\">'MEDIA'</span>] );\r\n        <span style=\"color:blue\">if</span>(!$Total)\r\n            $Total = 0;\r\n\t$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValueByColumnAndRow($j, ($cont+2),<span style=\"color:#a31515\">&quot; &quot;</span>.$Total);\r\n                    \r\n        $Total  = ( $arTmp[0][<span style=\"color:#a31515\">'TOTAL'</span>] );\r\n        <span style=\"color:blue\">if</span>(!$Total)\r\n            $Total = 0;\r\n\t$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValueByColumnAndRow($j, ($cont+3),<span style=\"color:#a31515\">&quot; &quot;</span>.$Total);\r\n                \r\n        $Total    = ( $arTmp[0][<span style=\"color:#a31515\">'QTD'</span>] );\r\n        <span style=\"color:blue\">if</span>(!$Total)\r\n            $Total = 0;\r\n\t$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValueByColumnAndRow($j, ($cont+4),<span style=\"color:#a31515\">&quot; &quot;</span>.$Total);\r\n                    \r\n        $Total  = ( $arTmp[0][<span style=\"color:#a31515\">'MEDIA'</span>] );\r\n        <span style=\"color:blue\">if</span>(!$Total)\r\n            $Total = 0;\r\n\t$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValueByColumnAndRow($j, ($cont+5),<span style=\"color:#a31515\">&quot; &quot;</span>.$Total);\r\n                   \r\n        $Total  = ( $arTmp[2][<span style=\"color:#a31515\">'QTD'</span>] );\r\n        <span style=\"color:blue\">if</span>(!$Total)\r\n            $Total = 0;\r\n\t$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValueByColumnAndRow($j, ($cont+6),<span style=\"color:#a31515\">&quot; &quot;</span>.$Total);\r\n                   \r\n            $Total    = ( $arTmp[3][<span style=\"color:#a31515\">'QTD'</span>] );\r\n        <span style=\"color:blue\">if</span>(!$Total)\r\n            $Total = 0;\r\n\t$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValueByColumnAndRow($j, ($cont+7),<span style=\"color:#a31515\">&quot; &quot;</span>.$Total);\r\n                   \r\n        $Total    = ( $arTmp[4][<span style=\"color:#a31515\">'QTD'</span>] );\r\n        <span style=\"color:blue\">if</span>(!$Total)\r\n\t    $Total = 0;\r\n        $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValueByColumnAndRow($j, ($cont+8),<span style=\"color:#a31515\">&quot; &quot;</span>.$Total);\r\n                   \r\n        $Total    = ( $arTmp[5][<span style=\"color:#a31515\">'QTD'</span>] );\r\n        <span style=\"color:blue\">if</span>(!$Total)\r\n            $Total = 0;\r\n\t$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValueByColumnAndRow($j, ($cont+9),<span style=\"color:#a31515\">&quot; &quot;</span>.$Total);\r\n                   \r\n        $Total    = ( $arTmp[6][<span style=\"color:#a31515\">'QTD'</span>] );\r\n        <span style=\"color:blue\">if</span>(!$Total)\r\n            $Total = 0;\r\n\t$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValueByColumnAndRow($j, ($cont+10),<span style=\"color:#a31515\">&quot; &quot;</span>.$Total);\r\n                   \r\n        $Total    = ( $arTmp[7][<span style=\"color:#a31515\">'QTD'</span>] );\r\n        <span style=\"color:blue\">if</span>(!$Total)\r\n            $Total = 0;\r\n\t$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValueByColumnAndRow($j, ($cont+11),<span style=\"color:#a31515\">&quot; &quot;</span>.$Total);\r\n\t\t\r\n\t$j++;\r\n\t$letra++;\r\n\t\r\n    }\r\n\r\n\r\n\r\n    \r\n<span style=\"color:green\">// Redirect output to a client&rsquo;s web browser (Excel5)</span>\r\nheader(<span style=\"color:#a31515\">&quot;Pragma: public&quot;</span>);\r\nheader(<span style=\"color:#a31515\">&quot;Expires: 0&quot;</span>);\r\nheader(<span style=\"color:#a31515\">&quot;Cache-Control: must-revalidate, post-check=0, pre-check=0&quot;</span>);\r\nheader(<span style=\"color:#a31515\">&quot;Content-type: application/pdf&quot;</span>);\r\nheader(<span style=\"color:#a31515\">&quot;Pragma: public&quot;</span>);\r\nheader(<span style=\"color:#a31515\">&quot;Cache-Control: must-revalidate, post-check=0, pre-check=0&quot;</span>);\t\t\r\nheader(<span style=\"color:#a31515\">&quot;Content-Disposition: attachment;filename=relatorio_est.xls&quot;</span>);\r\nheader(<span style=\"color:#a31515\">&quot;Content-Transfer-Encoding: binary &quot;</span>);\r\n\r\n$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, <span style=\"color:#a31515\">'PDF'</span>);\r\n$objWriter-&gt;save(<span style=\"color:#a31515\">'php://output'</span>); \r\n</pre>\r\n</div>\r\n</span></p>\r\n<p>Thanks,</p>\r\n<p>DioW</p>",
    "PostedDate": "2010-04-27T06:25:16.583-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]