[
  {
    "Id": "638272",
    "ThreadId": "264137",
    "Html": "<p>I am trying to upload a preexisting Excel file. My goal is to change the values of a bunch of cells in the spreadsheet, and potentially insert and delete rows.</p>\n<p>In just trying to load the sheet, I get the following error:</p>\n<p>&nbsp;</p>\n<pre>18:43:58 Create new PHPExcel object 18:43:58 Load Excel2007 template file�\nFatal error: Uncaught exception 'Exception' with message 'Merge must be set on a range of cells.' in&nbsp;</pre>\n<pre>'Classes/PHPExcel/Worksheet.php:1441 Stack trace: #0 /Classes/PHPExcel/Reader/Excel5.php(4100): PHPExcel_Worksheet-&gt;mergeCells('B20')&nbsp;</pre>\n<pre>#1 /Classes/PHPExcel/Reader/Excel5.php(801):&nbsp;PHPExcel_Reader_Excel5-&gt;_readMergedCells() #2 /Tests/27imagesexcel5.php(44): PHPExcel_Reader_Excel5-&gt;load('CCC.xls')&nbsp;</pre>\n<pre>#3 {main} thrown in�Classes/PHPExcel/Worksheet.php�on line�1441</pre>\n<p><strong>&nbsp;</strong></p>\n<p>&nbsp;</p>\n<p>[FYI: complete server path deleted]</p>\n<p>I'm using the following code, from the 27imagesexcel5.php file, to load the excel file:</p>\n<p>&nbsp;</p>\n<div style=\"color: black; background-color: white;\">\n<pre>&lt;?php\n<span style=\"color: green;\">/**\n * PHPExcel\n *\n * Copyright (C) 2006 - 2011 PHPExcel\n *\n * This library is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 2.1 of the License, or (at your option) any later version.\n *\n * This library is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public\n * License along with this library; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA\n *\n * @category   PHPExcel\n * @package    PHPExcel\n * @copyright  Copyright (c) 2006 - 2011 PHPExcel (http://www.codeplex.com/PHPExcel)\n * @license    http://www.gnu.org/licenses/old-licenses/lgpl-2.1.txt\tLGPL\n * @version    1.7.6, 2011-02-27\n */</span>\n\n<span style=\"color: green;\">/** Error reporting */</span>\nerror_reporting(E_ALL);\n\ndate_default_timezone_set(<span style=\"color: #a31515;\">'Europe/London'</span>);\n\n<span style=\"color: green;\">/** PHPExcel */</span>\n<span style=\"color: blue;\">require_once</span> <span style=\"color: #a31515;\">'../Classes/PHPExcel.php'</span>;\n\n\n<span style=\"color: green;\">// Create new PHPExcel object</span>\n<span style=\"color: blue;\">echo</span> date(<span style=\"color: #a31515;\">'H:i:s'</span>) . <span style=\"color: #a31515;\">\" Create new PHPExcel object\\n\"</span>;\n$objPHPExcel = <span style=\"color: blue;\">new</span> PHPExcel();\n\n<span style=\"color: green;\">// Read from Excel5 (.xls) template</span>\n<span style=\"color: blue;\">echo</span> date(<span style=\"color: #a31515;\">'H:i:s'</span>) . <span style=\"color: #a31515;\">\" Load Excel2007 template file\\n\"</span>;\n$objReader = PHPExcel_IOFactory::createReader(<span style=\"color: #a31515;\">'Excel5'</span>);\n$objPHPExcel = $objReader-&gt;load(<span style=\"color: #a31515;\">\"templates/CCC.xls\"</span>);\n\n<span style=\"color: green;\">// Export to Excel2007 (.xlsx)</span>\n<span style=\"color: blue;\">echo</span> date(<span style=\"color: #a31515;\">'H:i:s'</span>) . <span style=\"color: #a31515;\">\" Write to Excel5 format\\n\"</span>;\n$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, <span style=\"color: #a31515;\">'Excel2007'</span>);\n$objWriter-&gt;save(str_replace(<span style=\"color: #a31515;\">'.php'</span>, <span style=\"color: #a31515;\">'.xlsx'</span>, <span style=\"color: blue;\">__FILE__</span>));\n\n<span style=\"color: green;\">// Export to Excel5 (.xls)</span>\n<span style=\"color: blue;\">echo</span> date(<span style=\"color: #a31515;\">'H:i:s'</span>) . <span style=\"color: #a31515;\">\" Write to Excel5 format\\n\"</span>;\n$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, <span style=\"color: #a31515;\">'Excel5'</span>);\n$objWriter-&gt;save(str_replace(<span style=\"color: #a31515;\">'.php'</span>, <span style=\"color: #a31515;\">'.xls'</span>, <span style=\"color: blue;\">__FILE__</span>));\n\n\n<span style=\"color: green;\">// Echo memory peak usage</span>\n<span style=\"color: blue;\">echo</span> date(<span style=\"color: #a31515;\">'H:i:s'</span>) . <span style=\"color: #a31515;\">\" Peak memory usage: \"</span> . (memory_get_peak_usage(true) / 1024 / 1024) . <span style=\"color: #a31515;\">\" MB\\r\\n\"</span>;\n\n<span style=\"color: green;\">// Echo done</span>\n<span style=\"color: blue;\">echo</span> date(<span style=\"color: #a31515;\">'H:i:s'</span>) . <span style=\"color: #a31515;\">\" Done writing files.\\r\\n\"</span>;\n\n</pre>\n</div>\n<p>&nbsp;</p>\n<p>My server is running PHP 5.2.17. I'm being hosted on MediaTemple and I'm running Mac OS 10.6 (if that has anything to do with it...). The original file trying to be changed was saved in Excel in Office for Mac 2011, and it contains one image at the top and  a line of merged cells at the bottom.</p>\n<p>&nbsp;</p>\n<p>Thanks for any help!</p>",
    "PostedDate": "2011-07-06T10:54:32.627-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "816395",
    "ThreadId": "264137",
    "Html": "<p>you need check your code, if mergeCells('B20:B20) in your code, it doesn't work for read</p>",
    "PostedDate": "2012-03-28T00:14:19.097-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]