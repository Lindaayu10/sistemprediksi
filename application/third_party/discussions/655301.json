[
  {
    "Id": "1475293",
    "ThreadId": "655301",
    "Html": "I have 3 tables with name <code>tbl_m_name</code>, <code>tbl_m_office</code> and <code>tbl_m_misc</code>.\r<br />\n<br />\nIn <code>tbl_m_name</code> I have an auto increment id column named <code>id_name</code>.\r<br />\n<br />\nI want <code>id_name</code> value in every <code>tbl_m_office</code> and <code>tbl_m_misc</code> row but I don't know what should I do nor place should I insert the code\r<br />\n<br />\ntbh the code that I have is mostly modified copy-paste so I don't exactly know what every line means\r<br />\n<br />\nby that in mind please help me what should I do<br />\n<pre><code>&lt;?php\nclass Tools\n{\n    \n    function importdata($file,$table1,$table2,$table3,$startRow,$checkPrimary=FALSE)\n    {\n        $CI=&amp; get_instance();\n        $CI-&gt;load-&gt;database();\n        $CI-&gt;load-&gt;library('phpexcel');\n        $CI-&gt;load-&gt;library('PHPExcel/iofactory');\n        $objPHPExcel = new PHPExcel();\n        try{\n            $inputFileType = IOFactory::identify($file);\n            $objReader = IOFactory::createReader($inputFileType);\n            $objPHPExcel = $objReader-&gt;load($file);\n        } catch (Exception $ex) {\n            die(&quot;Tidak dapat mengakses file &quot;.$ex-&gt;getMessage());\n        }\n        \n        $sheet1 = $objPHPExcel-&gt;getSheet(0);\n        $highestRow = $sheet1-&gt;getHighestRow();\n        $highestColumn = $sheet1-&gt;getHighestColumn();\n        \n        for ($row = $startRow; $row &lt;= $highestRow; $row++){\n            $rowData = $sheet1-&gt;rangeToArray('A' . $row . ':' . $highestColumn . $row,NULL,TRUE,FALSE);\n            $startCol=0;\n            if($checkPrimary==TRUE)\n            {\n                $startCol=0;\n            }else{\n                $startCol=1;\n            }\n                    \n            $fields = $CI-&gt;db-&gt;list_fields('tbl_m_name');\n            $countfield=count($fields)-1;\n            \n            $datacol=array();\n            $dataxl=array();\n            $colXl=-1;\n            for($col=$startCol;$col&lt;=$countfield;$col++)\n            {\n                $colXl+=1;                \n                $datacol[]=$fields[$col];\n                $dataxl[]=$rowData[0][$colXl];\n            }\n            $data=array_combine($datacol,$dataxl);\n            $CI-&gt;db-&gt;insert($table1,$data);    \n        }\n\n        $sheet2 = $objPHPExcel-&gt;getSheet(1);\n        $highestRow = $sheet2-&gt;getHighestRow();\n        $highestColumn = $sheet2-&gt;getHighestColumn();\n        \n        for ($row = $startRow; $row &lt;= $highestRow; $row++){\n            $rowData = $sheet2-&gt;rangeToArray('A' . $row . ':' . $highestColumn . $row,NULL,TRUE,FALSE);\n            $startCol=0;\n            if($checkPrimary==TRUE)\n            {\n                $startCol=0;\n            }else{\n                $startCol=1;\n            }\n                    \n            $fields = $CI-&gt;db-&gt;list_fields('tbl_m_office');\n            $countfield=count($fields)-1;\n            \n            $datacol=array();\n            $dataxl=array();\n            $colXl=-1;\n            for($col=$startCol;$col&lt;=$countfield;$col++)\n            {\n                $colXl+=1;                \n                $datacol[]=$fields[$col];\n                $dataxl[]=$rowData[0][$colXl];\n            }\n            $data=array_combine($datacol,$dataxl);\n            $CI-&gt;db-&gt;insert($table2,$data);        \n        }\n\n        $sheet3 = $objPHPExcel-&gt;getSheet(2);\n        $highestRow = $sheet3-&gt;getHighestRow();\n        $highestColumn = $sheet3-&gt;getHighestColumn();\n        \n        for ($row = $startRow; $row &lt;= $highestRow; $row++){\n            $rowData = $sheet3-&gt;rangeToArray('A' . $row . ':' . $highestColumn . $row,NULL,TRUE,FALSE);\n            $startCol=0;\n            if($checkPrimary==TRUE)\n            {\n                $startCol=0;\n            }else{\n                $startCol=1;\n            }\n                    \n            $fields = $CI-&gt;db-&gt;list_fields('tbl_m_misc');\n            $countfield=count($fields)-1;\n            \n            $datacol=array();\n            $dataxl=array();\n            $colXl=-1;\n            for($col=$startCol;$col&lt;=$countfield;$col++)\n            {\n                $colXl+=1;                \n                $datacol[]=$fields[$col];\n                $dataxl[]=$rowData[0][$colXl];\n            }\n            $data=array_combine($datacol,$dataxl);\n            $CI-&gt;db-&gt;insert($table3,$data);        \n        }\n\n\n    }        \n}\n?&gt;</code></pre>\n\n",
    "PostedDate": "2016-06-07T01:27:39.18-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]