[
  {
    "Id": "956386",
    "ThreadId": "406843",
    "Html": "\r\n<p>&lt;?php<br>\r\n/* Error reporting */<br>\r\nerror_reporting(E_ALL);<br>\r\nini_set('display_errors', TRUE);<br>\r\nini_set('display_startup_errors', TRUE);<br>\r\ndate_default_timezone_set('Europe/London');<br>\r\n<br>\r\ndefine('EOL',(PHP_SAPI == 'cli') ? PHP_EOL : '<br>\r\n');<br>\r\n<br>\r\n//set_time_limit(0);<br>\r\n<br>\r\n<br>\r\n<br>\r\n/* Include PHPExcel */<br>\r\nrequire_once 'C:\\Zend\\Apache2\\htdocs\\magento\\report\\PHPExcel\\PHPExcel_1.7.8\\Classes\\PHPExcel.php';<br>\r\nrequire_once&nbsp; 'C:\\Zend\\Apache2\\htdocs\\magento\\report\\PHPExcel\\PHPExcel_1.7.8\\Classes\\PHPExcel\\IOFactory.php';<br>\r\n<br>\r\n// Create new PHPExcel object<br>\r\necho date('H:i:s') , &quot; Create new PHPExcel object&quot; , EOL;<br>\r\n$objPHPExcel = new PHPExcel();<br>\r\n$worksheet = $objPHPExcel-&gt;getActiveSheet();<br>\r\n<br>\r\n<br>\r\n<br>\r\n<br>\r\n<br>\r\n// Add some data<br>\r\n$testDates = array(&nbsp;&nbsp;&nbsp; array(3,15,10),&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; array(13,15,10),&nbsp;&nbsp;&nbsp; array(15,15,15),&nbsp;&nbsp;&nbsp; array(3,15,30),<br>\r\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; array(15,15,15),&nbsp;&nbsp;&nbsp; array(5,10,5),&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; array(9,15,0),&nbsp;&nbsp;&nbsp;\r\n<br>\r\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;\r\n<br>\r\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; );<br>\r\n$testDateCount = count($testDates);<br>\r\n<br>\r\n$worksheet-&gt;fromArray($testDates,NULL,'E2',true);<br>\r\n<br>\r\nfor ($row = 2; $row &lt;= $testDateCount; &#43;&#43;$row) {<br>\r\n&nbsp;&nbsp;&nbsp; $worksheet-&gt;setCellValue('H'.$row, '=TIME(E'.$row.',F'.$row.',G'.$row.')');<br>\r\n&nbsp;&nbsp;&nbsp; $worksheet-&gt;setCellValue('I'.$row, '=H'.$row);<br>\r\n}<br>\r\n$worksheet-&gt;getStyle('I1:I'.$testDateCount)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -&gt;getNumberFormat()<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -&gt;setFormatCode('hh:mm:ss');<br>\r\n<br>\r\n<br>\r\n<br>\r\n<br>\r\n<br>\r\n// Test the formulae<br>\r\n<br>\r\n&nbsp;&nbsp;&nbsp; for ($row = 2; $row &lt;= $testDateCount; &#43;&#43;$row) {<br>\r\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <br>\r\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$worksheet-&gt;getCell('E'.$row)-&gt;getFormattedValue() ;<br>\r\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; $worksheet-&gt;getCell('F'.$row)-&gt;getFormattedValue() ;<br>\r\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$worksheet-&gt;getCell('G'.$row)-&gt;getFormattedValue() ;<br>\r\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$worksheet-&gt;getCell('I'.$row)-&gt;getValue() ;<br>\r\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$worksheet-&gt;getCell('I'.$row)-&gt;getFormattedValue() ;<br>\r\n&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; $worksheet-&gt;getCell('H'.$row)-&gt;getFormattedValue() ;<br>\r\n<br>\r\n&nbsp;&nbsp;&nbsp; }<br>\r\n<br>\r\n&nbsp;&nbsp;&nbsp; <br>\r\n<br>\r\n&nbsp;&nbsp;&nbsp; <br>\r\n&nbsp;&nbsp;&nbsp; <br>\r\n&nbsp;&nbsp;&nbsp; <br>\r\n&nbsp;&nbsp;&nbsp; echo date('H:i:s') , &quot; Rename worksheet&quot; , EOL;<br>\r\n&nbsp;&nbsp;&nbsp; $objPHPExcel-&gt;getActiveSheet()-&gt;setTitle('Summary');<br>\r\n&nbsp;&nbsp;&nbsp; <br>\r\n&nbsp;&nbsp;&nbsp; <br>\r\n// Set active sheet index to the first sheet, so Excel opens this as the first sheet<br>\r\n&nbsp;&nbsp;&nbsp; $objPHPExcel-&gt;setActiveSheetIndex();<br>\r\n&nbsp;&nbsp;&nbsp; <br>\r\n// Save Excel 2007 file<br>\r\n&nbsp;&nbsp;&nbsp; echo date('H:i:s') , &quot; Write to Excel2007 format&quot; , EOL;<br>\r\n&nbsp;&nbsp;&nbsp; $objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, 'Excel2007');<br>\r\n&nbsp;&nbsp;&nbsp; $objWriter-&gt;save(str_replace('.php', '.xlsx', __FILE__));<br>\r\n&nbsp;&nbsp;&nbsp; echo date('H:i:s') , &quot; File written to &quot; , str_replace('.php', '.xlsx', pathinfo(__FILE__, PATHINFO_BASENAME)) , EOL;<br>\r\n// Save Excel5 file<br>\r\n&nbsp;&nbsp;&nbsp; echo date('H:i:s') , &quot; Write to Excel5 format&quot; , EOL;<br>\r\n&nbsp;&nbsp;&nbsp; $objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, 'Excel5');<br>\r\n&nbsp;&nbsp;&nbsp; $objWriter-&gt;save(str_replace('.php', '.xls', __FILE__));<br>\r\n&nbsp;&nbsp;&nbsp; echo date('H:i:s') , &quot; File written to &quot; , str_replace('.php', '.xls', pathinfo(__FILE__, PATHINFO_BASENAME)) , EOL;<br>\r\n&nbsp;&nbsp;&nbsp; <br>\r\n&nbsp;&nbsp;&nbsp; <br>\r\n// Echo memory peak usage<br>\r\n&nbsp;&nbsp;&nbsp; echo date('H:i:s') , &quot; Peak memory usage: &quot; , (memory_get_peak_usage(true) / 1024 / 1024) , &quot; MB&quot; , EOL;<br>\r\n&nbsp;&nbsp;&nbsp; <br>\r\n// Echo done<br>\r\n&nbsp;&nbsp;&nbsp; echo date('H:i:s') , &quot; Done writing files&quot; , EOL;<br>\r\n&nbsp;&nbsp;&nbsp; echo 'Files have been created in ' , getcwd() , EOL;<br>\r\n&nbsp;&nbsp;&nbsp; <br>\r\n?&gt;</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\" width=\"412\" height=\"187\">\r\n<colgroup><col width=\"64\"><col width=\"131\"><col width=\"170\"><col width=\"163\"><col width=\"95\"></colgroup>\r\n<tbody>\r\n<tr height=\"20\">\r\n<td width=\"64\" height=\"20\">Recorded Hours</td>\r\n<td width=\"131\">Recorded Minutes</td>\r\n<td width=\"170\">Adjusted Hours</td>\r\n<td width=\"163\">Adjusted Minutes</td>\r\n<td width=\"95\">Submitted</td>\r\n</tr>\r\n<tr height=\"20\">\r\n<td height=\"20\" align=\"right\">0</td>\r\n<td align=\"right\">1</td>\r\n<td align=\"right\">0</td>\r\n<td align=\"right\">1</td>\r\n<td align=\"right\">0:00:00</td>\r\n</tr>\r\n<tr height=\"20\">\r\n<td height=\"20\" align=\"right\">0</td>\r\n<td align=\"right\">1</td>\r\n<td align=\"right\">0</td>\r\n<td align=\"right\">1</td>\r\n<td align=\"right\">0:00:00</td>\r\n</tr>\r\n<tr height=\"20\">\r\n<td height=\"20\" align=\"right\">0</td>\r\n<td align=\"right\">4</td>\r\n<td align=\"right\">0</td>\r\n<td align=\"right\">4</td>\r\n<td align=\"right\">0:00:00</td>\r\n</tr>\r\n<tr height=\"20\">\r\n<td height=\"20\" align=\"right\">0</td>\r\n<td align=\"right\">8</td>\r\n<td align=\"right\">0</td>\r\n<td align=\"right\">8</td>\r\n<td align=\"right\">0:00:00</td>\r\n</tr>\r\n<tr height=\"20\">\r\n<td height=\"20\" align=\"right\">0</td>\r\n<td align=\"right\">10</td>\r\n<td align=\"right\">0</td>\r\n<td align=\"right\">10</td>\r\n<td align=\"right\">0:00:00</td>\r\n</tr>\r\n<tr height=\"20\">\r\n<td height=\"20\" align=\"right\">6</td>\r\n<td align=\"right\">52</td>\r\n<td align=\"right\">6</td>\r\n<td align=\"right\">52</td>\r\n<td align=\"right\">0:00:00</td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n",
    "PostedDate": "2012-12-14T22:11:19.227-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "957593",
    "ThreadId": "406843",
    "Html": "\r\n<p>&#65279;&#65279;&#65279;&#65279;&#65279;I'm not sure where is your problem...<br>\r\nIn Excel, hours, minutes, seconds format is something like h:mm:ss, if your time exceed 24 hours (**), adds the brackets ([h]:mm:ss). Remove ':ss' if you don't want seconds.<br>\r\nFor use with PHPExcel: </p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre>$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#a31515\">'A1'</span>)-&gt;getNumberFormat()-&gt;setFormatCode(<span style=\"color:#a31515\">'[h]:mm:ss'</span>);\r\n</pre>\r\n</div>\r\n<br>\r\n<br>\r\nYou will find many examples in the documentation in Chapter 4.6.19, as well as a trick to know a format from a model in Excel, the documentation of the API for the PHPExcel_Style_NumberFormat class will allow you to see all of the constants can be used as shortcuts.<br>\r\n<br>\r\n(**): Excel TIME function does not meet 24 hours (it returns the modulo 24), I have not tested PHPExcel, but it certainly does the same thing, if you need more, you have to change your method, a formula such as: =(A1/24) + (B1/(24*60)) + (C1 /(24*60*60)) will\r\n work, with the correct format.\r\n<p></p>\r\n",
    "PostedDate": "2012-12-18T05:07:00.253-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]