[
  {
    "Id": "1203220",
    "ThreadId": "529077",
    "Html": "I am using PHPExcel 1.7.9 and I used the test code in the examples to make my conditional formatting work. The only problem I have is that instead of RED it shows as GREEN... Since this is negative numbers... this poses a problem. \r<br />\n<br />\nHere's my code for the formatting.<br />\n<pre><code>// Negative numbers are red\n$objConditional2 = new PHPExcel_Style_Conditional();\n$objConditional2-&gt;setConditionType(PHPExcel_Style_Conditional::CONDITION_CELLIS)\n    -&gt;setOperatorType(PHPExcel_Style_Conditional::OPERATOR_LESSTHAN)\n    -&gt;addCondition('0');\n$objConditional2-&gt;getStyle()-&gt;getFont()-&gt;getColor()-&gt;setARGB(PHPExcel_Style_Color::COLOR_RED);\n$objConditional2-&gt;getStyle()-&gt;getFont()-&gt;setItalic(true);\n\n$conditionalStyles = $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(&quot;{$costColumn}2&quot;)-&gt;getConditionalStyles();\narray_push($conditionalStyles, $objConditional2);\n$editableSheet-&gt;getStyle(&quot;{$costColumn}2&quot;)-&gt;setConditionalStyles($conditionalStyles);\n$objPHPExcel-&gt;getActiveSheet()-&gt;duplicateConditionalStyle(\n    $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(&quot;{$costColumn}2&quot;)-&gt;getConditionalStyles(),\n    &quot;{$costColumn}2:{$profitPercentageColumn}{$lineNumber}&quot;\n);</code></pre>\n\nI do have this code above the conditional formatting in case it helps:<br />\n<pre><code>// Apply formats\n$editableSheet-&gt;getStyle(&quot;{$costColumn}2:{$priceColumn}{$lineNumber}&quot;)\n    -&gt;getNumberFormat()\n    -&gt;setFormatCode('$#,##0.000_-')\n;\n$editableSheet-&gt;getStyle(&quot;{$qtyShpColumn}2:{$qtyShpColumn}{$lineNumber}&quot;)\n    -&gt;getNumberFormat()\n    -&gt;setFormatCode('#,##0_-')\n;\n$editableSheet-&gt;getStyle(&quot;{$extPriceColumn}2:{$extPriceColumn}{$lineNumber}&quot;)\n    -&gt;getNumberFormat()\n    -&gt;setFormatCode('$#,##0.000_-')\n;\n$editableSheet-&gt;getStyle(&quot;{$profitPercentageColumn}2:{$profitPercentageColumn}{$lineNumber}&quot;)\n    -&gt;getNumberFormat()\n    -&gt;applyFromArray(\n        array(\n            'code' =&gt; PHPExcel_Style_NumberFormat::FORMAT_PERCENTAGE_00\n        )\n    )\n;</code></pre>\n\nEverything works as expected but the color for the conditional formatting shows as green... I only want red on negative.\r<br />\n<br />\nThanks for any input.\r<br />\nJeremy<br />\n",
    "PostedDate": "2014-02-05T14:22:55.183-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]