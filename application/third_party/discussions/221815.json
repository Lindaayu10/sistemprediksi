[
  {
    "Id": "474125",
    "ThreadId": "221815",
    "Html": "<p>Hi there</p>\r\n<p>i have problem with PHPExcel and Oci8 connection.</p>\r\n<p>I tried to link records fetched through an Oracle connection and phpExcel.</p>\r\n<p>The code seems to be correct, and the Excel is successfully&nbsp;created.</p>\r\n<p>When i open the file,&nbsp;it results malformed or corrupted.&nbsp;</p>\r\n<p>The data shown in the file, are correct but&nbsp;there are also a lot of cells full of&nbsp;strage chars,</p>\r\n<p>numbers and symbol.</p>\r\n<p>Here the code. It's quite simple, and looks like the examples packed in the PhpExcel zip.</p>\r\n<p>Thx in Advance. Studio148 : )</p>\r\n<p>&nbsp;</p>\r\n<div style=\"color:black;background-color:white\">\r\n<pre>&lt;?php\r\n\r\n  <span style=\"color:green\">/** Error reporting */</span>\r\n  error_reporting(E_ALL);\r\n  <span style=\"color:green\">/** PHPExcel */</span>\r\n  <span style=\"color:blue\">require_once</span> <span style=\"color:#a31515\">'../Classes/PHPExcel.php'</span>;\t\r\n  \r\n  \r\n  <span style=\"color:blue\">include</span>(<span style=\"color:#a31515\">&quot;connection.php&quot;</span>);\r\n \r\n\t<span style=\"color:green\">// Create new PHPExcel object</span>\r\n\t$objPHPExcel = <span style=\"color:blue\">new</span> PHPExcel();\r\n\r\n\t<span style=\"color:green\">// Set properties</span>\r\n\t$objPHPExcel-&gt;getProperties()-&gt;setCreator(<span style=\"color:#a31515\">&quot;Studio148&quot;</span>)\r\n\t\t\t\t\t\t\t -&gt;setLastModifiedBy(<span style=\"color:#a31515\">&quot;Studio148&quot;</span>)\r\n\t\t\t\t\t\t\t -&gt;setTitle(<span style=\"color:#a31515\">&quot;Office 2007 XLSX Test Document&quot;</span>)\r\n\t\t\t\t\t\t\t -&gt;setSubject(<span style=\"color:#a31515\">&quot;Office 2007 XLSX Test Document&quot;</span>)\r\n\t\t\t\t\t\t\t -&gt;setDescription(<span style=\"color:#a31515\">&quot;Test document for Office 2007 XLSX, generated using PHP classes.&quot;</span>)\r\n\t\t\t\t\t\t\t -&gt;setKeywords(<span style=\"color:#a31515\">&quot;office 2007 openxml php&quot;</span>)\r\n\t\t\t\t\t\t\t -&gt;setCategory(<span style=\"color:#a31515\">&quot;Test result file&quot;</span>);\r\n  \r\n  \r\n\t\r\n\t<span style=\"color:green\">// Create a first sheet</span>\r\n\r\n\t$objPHPExcel-&gt;setActiveSheetIndex(0);\r\n\t\r\n\t\r\n  \r\n    $stmt = oci_parse($conn, <span style=\"color:#a31515\">&quot;SELECT  TICKET_NO, DATA_NOTIFICA, STATO, INDIRIZZO, RIF_TELEFONICO, DATA_RISOLUZIONE, DATA_CHIUSURA FROM MHT_TICKET&quot;</span>);\r\n    oci_execute($stmt, OCI_DEFAULT);\r\n\r\n\t\r\n\t<span style=\"color:blue\">if</span>($stmt){\r\n\t\r\n\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#a31515\">'A1'</span>, <span style=\"color:#a31515\">'Ticket Number'</span>);\r\n\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#a31515\">'B1'</span>, <span style=\"color:#a31515\">'Data Notifica'</span>);\r\n\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#a31515\">'C1'</span>, <span style=\"color:#a31515\">'Stato'</span>);\r\n\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#a31515\">'D1'</span>, <span style=\"color:#a31515\">'Indirizzo'</span>);\r\n\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#a31515\">'E1'</span>, <span style=\"color:#a31515\">'Telefono'</span>);\r\n\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#a31515\">'F1'</span>, <span style=\"color:#a31515\">'Data Risoluzione'</span>);\r\n\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#a31515\">'G1'</span>, <span style=\"color:#a31515\">'Data Chiusura'</span>);\r\n\t\r\n\t\t$count = 1;\r\n\r\n\t\t$variabili = null;\r\n\t\t$variabili = Array(<span style=\"color:#a31515\">'TICKET_NO'</span>,<span style=\"color:#a31515\">'DATA_NOTIFICA'</span>,<span style=\"color:#a31515\">'STATO'</span>,<span style=\"color:#a31515\">'INDIRIZZO'</span>,<span style=\"color:#a31515\">'RIF_TELEFONICO'</span>,<span style=\"color:#a31515\">'DATA_RISOLUZIONE'</span>,<span style=\"color:#a31515\">'DATA_CHIUSURA'</span>);\r\n\r\n\t\t<span style=\"color:blue\">while</span> ( $entry=oci_fetch_array($stmt) ) {\r\n\t\t\r\n\t\t\t<span style=\"color:blue\">foreach</span>($variabili <span style=\"color:blue\">as</span> $variabile){\r\n\t\t\t\t$$variabile = $entry[$variabile];\r\n\t\t\t\t<span style=\"color:green\">//echo $entry[$variabile];</span>\r\n\t\t\t}\r\n\t\t\t$count++;\r\n\t\t\t\r\n\t\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#a31515\">'A'</span> . $count, $TICKET_NO);\r\n\t\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#a31515\">'B'</span> . $count, $DATA_NOTIFICA);\r\n\t\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#a31515\">'C'</span> . $count, $STATO);\r\n\t\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#a31515\">'D'</span> . $count, $INDIRIZZO);\r\n\t\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#a31515\">'E'</span> . $count, $RIF_TELEFONICO);\r\n\t\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#a31515\">'F'</span> . $count, $DATA_RISOLUZIONE);\r\n\t\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#a31515\">'G'</span> . $count, $DATA_CHIUSURA);\r\n\t\t\t\r\n\t\t}\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t}\r\n\t\r\n\t\r\n\toci_free_statement($stmt);\r\n\toci_close($conn);\r\n\t\r\n\t<span style=\"color:green\">// Set title row bold</span>\r\n\r\n\t$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#a31515\">'A1'</span>)-&gt;getFont()-&gt;setBold(true);\r\n\t$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#a31515\">'B1'</span>)-&gt;getFont()-&gt;setBold(true);\r\n\t$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#a31515\">'C1'</span>)-&gt;getFont()-&gt;setBold(true);\r\n\t$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#a31515\">'D1'</span>)-&gt;getFont()-&gt;setBold(true);\r\n\t$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#a31515\">'E1'</span>)-&gt;getFont()-&gt;setBold(true);\r\n\t$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#a31515\">'F1'</span>)-&gt;getFont()-&gt;setBold(true);\r\n\t$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#a31515\">'G1'</span>)-&gt;getFont()-&gt;setBold(true);\r\n\r\n\r\n\t<span style=\"color:green\">// Set active sheet index to the first sheet, so Excel opens this as the first sheet</span>\r\n\t$objPHPExcel-&gt;setActiveSheetIndex(0);\r\n\t\r\n\t<span style=\"color:green\">// Redirect output to a client&rsquo;s web browser (Excel5)</span>\r\n\theader(<span style=\"color:#a31515\">'Content-Type: application/vnd.ms-excel'</span>);\r\n\theader(<span style=\"color:#a31515\">'Content-Disposition: attachment;filename=&quot;01simple.xls&quot;'</span>);\r\n\theader(<span style=\"color:#a31515\">'Cache-Control: max-age=0'</span>);\r\n\r\n\t$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, <span style=\"color:#a31515\">'Excel5'</span>);\r\n\t$objWriter-&gt;save(<span style=\"color:#a31515\">'php://output'</span>);\r\n\t<span style=\"color:blue\">exit</span>;\r\n\t\r\n    \r\n?&gt;\r\n\r\n\r\n</pre>\r\n<pre>\r\n</pre>\r\n</div>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;&nbsp;</p>",
    "PostedDate": "2010-07-29T02:29:40.317-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "474717",
    "ThreadId": "221815",
    "Html": "<p>What character set are you using for the data in your Oracle database?</p>",
    "PostedDate": "2010-07-30T05:40:42.503-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "476136",
    "ThreadId": "221815",
    "Html": "Hi Mark and thx for your reply\r\n\r\nI solved !!\r\nOracle connection was ok so the character set used in the db.\r\nThe problem was this: \r\n\r\ninclude(&quot;connection.php&quot;);\r\n\r\nChanging this line of code with all the code in my &quot;connection.php&quot; file,  PHPExcel works properly.\r\nI don't understand why  include('...') generate this behaviour in PHPExcel O_O\r\n\r\nStudio148 : )    \r\n",
    "PostedDate": "2010-08-03T14:04:48.57-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]