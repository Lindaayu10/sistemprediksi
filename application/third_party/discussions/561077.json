[
  {
    "Id": "1289755",
    "ThreadId": "561077",
    "Html": "PHP 5.3.27\r<br />\nPHPExcel 1.7.9\r<br />\nWindows 7, 64-bit\r<br />\n<br />\nI have the following code:<br />\n<pre><code>PHPExcel_Settings::setZipClass( PHPExcel_Settings::PCLZIP );\n\n$filename = &quot;my_file_&quot; . date( &quot;Ymd_His&quot; ) . &quot;.xlsx&quot;;\n$objWriter = new \\PHPExcel_Writer_Excel2007( $objPHPExcel );\n$objWriter-&gt;setPreCalculateFormulas( false );\n$objWriter-&gt;setUseDiskCaching( true, sys_get_temp_dir() );\n$objWriter-&gt;save( &quot;$dir/$filename&quot; );\n$objPHPExcel-&gt;disconnectWorksheets();\nunset( $objWriter, $objPHPExcel );</code></pre>\n\nThe file is created properly, but the temp files are left behind.  There are warnings like this in the logs:<br />\n<pre><code>E_WARNING unlink(C:\\Windows\\Temp\\xmlC47.tmp) [&lt;a href='function.unlink'&gt;function.unlink&lt;/a&gt;]: Permission denied at C:\\code\\vendorlink\\vl\\dev\\docroot\\app\\includes\\phpexcel\\PHPExcel\\Shared\\XMLWriter.php:91\nE_WARNING unlink(C:\\Windows\\Temp\\xmlC58.tmp) [&lt;a href='function.unlink'&gt;function.unlink&lt;/a&gt;]: Permission denied at C:\\code\\vendorlink\\vl\\dev\\docroot\\app\\includes\\phpexcel\\PHPExcel\\Shared\\XMLWriter.php:91\nE_WARNING unlink(C:\\Windows\\Temp\\xmlC68.tmp) [&lt;a href='function.unlink'&gt;function.unlink&lt;/a&gt;]: Permission denied at C:\\code\\vendorlink\\vl\\dev\\docroot\\app\\includes\\phpexcel\\PHPExcel\\Shared\\XMLWriter.php:91\nE_WARNING unlink(C:\\Windows\\Temp\\xmlC79.tmp) [&lt;a href='function.unlink'&gt;function.unlink&lt;/a&gt;]: Permission denied at C:\\code\\vendorlink\\vl\\dev\\docroot\\app\\includes\\phpexcel\\PHPExcel\\Shared\\XMLWriter.php:91\nE_WARNING unlink(C:\\Windows\\Temp\\xmlC7A.tmp) [&lt;a href='function.unlink'&gt;function.unlink&lt;/a&gt;]: Permission denied at C:\\code\\vendorlink\\vl\\dev\\docroot\\app\\includes\\phpexcel\\PHPExcel\\Shared\\XMLWriter.php:91\nE_WARNING unlink(C:\\Windows\\Temp\\xmlC8A.tmp) [&lt;a href='function.unlink'&gt;function.unlink&lt;/a&gt;]: Permission denied at C:\\code\\vendorlink\\vl\\dev\\docroot\\app\\includes\\phpexcel\\PHPExcel\\Shared\\XMLWriter.php:91\nE_WARNING unlink(C:\\Windows\\Temp\\xmlCAB.tmp) [&lt;a href='function.unlink'&gt;function.unlink&lt;/a&gt;]: Permission denied at C:\\code\\vendorlink\\vl\\dev\\docroot\\app\\includes\\phpexcel\\PHPExcel\\Shared\\XMLWriter.php:91\nE_WARNING unlink(C:\\Windows\\Temp\\xmlF5A.tmp) [&lt;a href='function.unlink'&gt;function.unlink&lt;/a&gt;]: Permission denied at C:\\code\\vendorlink\\vl\\dev\\docroot\\app\\includes\\phpexcel\\PHPExcel\\Shared\\XMLWriter.php:91\nE_WARNING unlink(C:\\Windows\\Temp\\xmlFD8.tmp) [&lt;a href='function.unlink'&gt;function.unlink&lt;/a&gt;]: Permission denied at C:\\code\\vendorlink\\vl\\dev\\docroot\\app\\includes\\phpexcel\\PHPExcel\\Shared\\XMLWriter.php:91\nE_WARNING unlink(C:\\Windows\\Temp\\xmlFD9.tmp) [&lt;a href='function.unlink'&gt;function.unlink&lt;/a&gt;]: Permission denied at C:\\code\\vendorlink\\vl\\dev\\docroot\\app\\includes\\phpexcel\\PHPExcel\\Shared\\XMLWriter.php:91\nE_WARNING unlink(C:\\Windows\\Temp\\xml5A51.tmp) [&lt;a href='function.unlink'&gt;function.unlink&lt;/a&gt;]: Permission denied at C:\\code\\vendorlink\\vl\\dev\\docroot\\app\\includes\\phpexcel\\PHPExcel\\Shared\\XMLWriter.php:91</code></pre>\n\nAny ideas why unlink would have permission denied?\r<br />\n<br />\nThanks for your help.<br />\n",
    "PostedDate": "2014-08-13T10:42:30.757-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]