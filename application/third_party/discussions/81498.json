[
  {
    "Id": "279755",
    "ThreadId": "81498",
    "Html": "<p>Hello,</p>\r\n<p>I stumbled across your project when I searched for ways to share my data with other users online.&nbsp; I have created a spreadsheet to estimate paychecks for work (we have a rather confusing hourly system that has many pieces which leads to inconsistent paychecks).&nbsp; This was all to basically assist those of us who like to budget our money and try to plan.</p>\r\n<p>Anyway, the point is that I have an Excel 2007 spreadsheet with a lot of formulas and calculations in it.&nbsp; I have written a simple HTML form to ask for the user variables and then place those values into the spreadsheet in the appropriate cells.&nbsp; I want to then deliver the information to the user as webpages with specific paycheck information on them.&nbsp; As a test to see if I knew what I was doing, I just have it write the values and then save the entire spreadsheet to disk.</p>\r\n<p>It is giving me an error when it attempts to write to the disk.&nbsp; And I don't know why.&nbsp; I can't find any problem with my Excel file.</p>\r\n<p>Thanks for your help!</p>\r\n<p>&nbsp;</p>\r\n<p>I am using version 1.7.2</p>\r\n<p>An example spreadsheet is available from http://www.fastnovahomes.com/FirePay/source_files/ALS%20A-Shift%202010.xlsx</p>\r\n<p>The php that is running is</p>\r\n<p>&nbsp;</p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre>&lt;?php\r\n\r\nini_set(<span style=\"color:#A31515\">'memory_limit'</span>,<span style=\"color:#A31515\">'1024M'</span>);\r\nini_set(<span style=\"color:#A31515\">'max_execution_time'</span>,<span style=\"color:#A31515\">'600'</span>);\r\n\r\n<span style=\"color:Green\">/** Error reporting */</span>\r\nerror_reporting(E_ALL);\r\n\r\n<span style=\"color:Green\">/** PHPExcel */</span>\r\n<span style=\"color:Blue\">require_once</span> <span style=\"color:#A31515\">'Classes/PHPExcel.php'</span>;\r\n\r\n<span style=\"color:Green\">/** PHPExcel_IOFactory */</span>\r\n<span style=\"color:Blue\">require_once</span> <span style=\"color:#A31515\">'Classes/PHPExcel/IOFactory.php'</span>;\r\n\r\n<span style=\"color:Green\">/** Read in values **/</span>\r\n<span style=\"color:Blue\">&nbsp;</span><span style=\"color:Blue\">&nbsp;</span>$shift = <span style=\"color:#A31515\">&quot;A&quot;</span>;\r\n$year = 2010;\r\n<span style=\"color:Blue\">&nbsp;</span>$state = <span style=\"color:#A31515\">&quot;VA&quot;</span>;\r\n$isALS = 1;\r\n$payrate = 16.7849;\r\n$fedmarried = <span style=\"color:#A31515\">&quot;S&quot;</span>;\r\n$fedwithhold = 0;<br>$fedexemption = 5;\r\n$statemarried = <span style=\"color:#A31515\">&quot;S&quot;</span>;\r\n$statewithhold = 0;\r\n$stateexemption = 5;\r\n\r\n$deferred = <span style=\"color:Blue\">array</span>();\r\n$pretax = <span style=\"color:Blue\">array</span>();\r\n$posttax = <span style=\"color:Blue\">array</span>();\r\n$taxadd = <span style=\"color:Blue\">array</span>();\r\n\r\n$filename = <span style=\"color:#A31515\">&quot;source_files/ALS A-Shift 2010.xlsx&quot;</span>;\r\n<br><span style=\"color:Green\">/** Load the Base File **/</span>\r\n<span style=\"color:Blue\">echo</span> date(<span style=\"color:#A31515\">'H:i:s'</span>) . <span style=\"color:#A31515\">&quot; Loading the saved file $filename\\n&quot;</span>;\r\n$objPHPExcel = PHPExcel_IOFactory::load($filename);\r\n\r\n<span style=\"color:Green\">/** Set the values for our custom items **/</span>\r\n<span style=\"color:Blue\">echo</span> date(<span style=\"color:#A31515\">'H:i:s'</span>) . <span style=\"color:#A31515\">&quot; Setting your specified inputs\\n&quot;</span>;\r\n$objPHPExcel-&gt;setActiveSheetIndex(0);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#A31515\">'F1'</span>, $payrate);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#A31515\">'N22'</span>, $fedexemption);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#A31515\">'O22'</span>, $fedwithhold);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#A31515\">'P22'</span>, $fedmarried);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#A31515\">'N23'</span>, $stateexemption);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#A31515\">'O23'</span>, $statewithhold);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#A31515\">'P23'</span>, $statemarried);\r\n\r\n<span style=\"color:Blue\">for</span> ($i=0;$i&lt;9;$i++) {\r\n\t$currow = 21 + $i;\r\n\t$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#A31515\">'F'</span>.$currow, $pretax[$i][<span style=\"color:#A31515\">'name'</span>]);\r\n\t$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#A31515\">'G'</span>.$currow, $pretax[$i][<span style=\"color:#A31515\">'val'</span>]);\r\n\t$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#A31515\">'H'</span>.$currow, $posttax[$i][<span style=\"color:#A31515\">'name'</span>]);\r\n\t$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#A31515\">'I'</span>.$currow, $posttax[$i][<span style=\"color:#A31515\">'val'</span>]);\r\n\t$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#A31515\">'J'</span>.$currow, $taxadd[$i][<span style=\"color:#A31515\">'name'</span>]);\r\n\t$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#A31515\">'K'</span>.$currow, $taxadd[$i][<span style=\"color:#A31515\">'val'</span>]);\r\n}\r\n\r\n<span style=\"color:Blue\">for</span> ($i=0;$i&lt;3;$i++) {\r\n\t$currow = 31 + $i;\r\n\t$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#A31515\">'H'</span>.$currow, $deferred[$i][<span style=\"color:#A31515\">'name'</span>]);\r\n\t$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#A31515\">'I'</span>.$currow, $deferred[$i][<span style=\"color:#A31515\">'val'</span>]);\r\n}\r\n\r\n<span style=\"color:Blue\">print</span> <span style=\"color:#A31515\">&quot;First pay check regular earnings is: &quot;</span>;\r\n<span style=\"color:Blue\">print</span> $objPHPExcel-&gt;getActiveSheet()-&gt;getCell(<span style=\"color:#A31515\">'E22'</span>)-&gt;getCalculatedValue();\r\n<span style=\"color:Blue\">print</span> <span style=\"color:#A31515\">&quot;\\n&quot;</span>;\r\n\r\n<span style=\"color:Green\">/** Save the file **/</span>\r\n<span style=\"color:Blue\">echo</span> date(<span style=\"color:#A31515\">'H:i:s'</span>) . <span style=\"color:#A31515\">&quot; Saving your file as myfile.xlsx\\n&quot;</span>;\r\n\r\n$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, <span style=\"color:#A31515\">'Excel2007'</span>);\r\n\r\n$objWriter-&gt;save(<span style=\"color:#A31515\">'myfile.xlsx'</span>); \r\n\r\n<span style=\"color:Green\">// Echo memory peak usage</span>\r\n<span style=\"color:Blue\">echo</span> date(<span style=\"color:#A31515\">'H:i:s'</span>) . <span style=\"color:#A31515\">&quot; Peak memory usage: &quot;</span> . (memory_get_peak_usage(true) / 1024 / 1024) . <span style=\"color:#A31515\">&quot; MB\\r\\n&quot;</span>;\r\n\r\n<span style=\"color:Green\">// Echo done</span>\r\n<span style=\"color:Blue\">echo</span> date(<span style=\"color:#A31515\">'H:i:s'</span>) . <span style=\"color:#A31515\">&quot; Done writing file.\\r\\n&quot;</span>;\r\n?&gt;\r\n</pre>\r\n</div>\r\n<p>And the output from the script running is:</p>\r\n<pre id=line1>16:10:17 Loading the saved file source_files/ALS A-Shift 2010.xlsx<br>16:10:20 Setting your specified inputs<br>First pay check regular earnings is: 2101.488<br>16:10:20 Saving your file as myfile.xlsx<br>&lt;<span>br</span><span><span> /</span></span>&gt;<br>&lt;<span>b</span>&gt;Fatal error&lt;/<span>b</span>&gt;:  Uncaught exception 'Exception' with message 'Invalid cell coordinate.' in /home/content/64/4745964/html/FirePay/Classes/PHPExcel/Cell.php:519<br>Stack trace:<br>#0 /home/content/64/4745964/html/FirePay/Classes/PHPExcel/Cell.php(538): PHPExcel_Cell::coordinateFromString('A')<br>#1 /home/content/64/4745964/html/FirePay/Classes/PHPExcel/Writer/Excel2007/Workbook.php(351): PHPExcel_Cell::absoluteCoordinate('A')<br>#2 /home/content/64/4745964/html/FirePay/Classes/PHPExcel/Writer/Excel2007/Workbook.php(328): PHPExcel_Writer_Excel2007_Workbook-&amp;<span>gt;</span>_writeDefinedNameForNamedRange(Object(PHPExcel_Shared_XMLWriter), Object(PHPExcel_NamedRange))<br>#3 /home/content/64/4745964/html/FirePay/Classes/PHPExcel/Writer/Excel2007/Workbook.php(297): PHPExcel_Writer_Excel2007_Workbook-&amp;<span>gt;</span>_writeNamedRanges(Object(PHPExcel_Shared_XMLWriter), Object(PHPExcel))<br>#4 /home/content/64/4745964/html/FirePay/Classes/PHPExcel/Writer/Excel2007/Workbook.php(109): PHPExcel_Writer_Excel2007_Workbook-&amp;<span>gt;</span>_writeDefinedNames(Object(PHPExcel_Shared_XMLWriter), Object(PHPEx in &lt;<span>b</span>&gt;/home/content/64/4745964/html/FirePay/Classes/PHPExcel/Cell.php&lt;/<span>b</span>&gt; on line &lt;<span>b</span>&gt;519&lt;/<span>b</span>&gt;&lt;<span>br</span><span><span> /</span></span>&gt;<br><br></pre>\r\n<p>&nbsp;</p>",
    "PostedDate": "2010-01-20T15:14:14.11-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "279847",
    "ThreadId": "81498",
    "Html": "<p>I can confirm this error. There was a problem with Excel 2007 reader and defined names when there where multiple sheets in the workbook.</p>\r\n<p>Should now be fixed:</p>\r\n<p><a href=\"http://phpexcel.codeplex.com/WorkItem/View.aspx?WorkItemId=11571\">http://phpexcel.codeplex.com/WorkItem/View.aspx?WorkItemId=11571</a></p>",
    "PostedDate": "2010-01-20T20:46:27.723-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]