[
  {
    "Id": "220809",
    "ThreadId": "64837",
    "Html": "<p>I have PHP v5.3.0 installed on my Linux server.&nbsp; The settings are:</p>\r\n<p><strong>Configure Command</strong></p>\r\n<p>'./configure' '--build=i686-pc-linux-gnu' '--host=i686-pc-linux-gnu' '--target=i386-redhat-linux-gnu' '--program-prefix=' '--prefix=/usr' '--exec-prefix=/usr' '--bindir=/usr/bin' '--sbindir=/usr/sbin' '--sysconfdir=/etc' '--datadir=/usr/share' '--includedir=/usr/include' '--libdir=/usr/lib' '--libexecdir=/usr/libexec' '--localstatedir=/var' '--sharedstatedir=/usr/com' '--mandir=/usr/share/man' '--infodir=/usr/share/info' '--cache-file=../config.cache' '--with-libdir=lib' '--with-config-file-path=/etc' '--with-config-file-scan-dir=/etc/php.d' '--disable-debug' '--with-pic' '--disable-rpath' '--without-pear' '--with-bz2' '--with-curl' '--with-exec-dir=/usr/bin' '--with-freetype-dir=/usr' '--with-png-dir=/usr' '--enable-gd-native-ttf' '--without-gdbm' '--with-gettext' '--with-gmp' '--with-iconv' '--with-jpeg-dir=/usr' '--with-openssl' '--with-png' '--with-pspell' '--with-expat-dir=/usr' '--with-pcre-regex=/usr' '--with-zlib' '--with-layout=GNU' '--enable-exif' '--enable-ftp' '--enable-magic-quotes' '--enable-sockets' '--enable-sysvsem' '--enable-sysvshm' '--enable-sysvmsg' '--enable-track-vars' '--enable-trans-sid' '--enable-yp' '--enable-wddx' '--with-kerberos' '--with-unixODBC=shared,/usr' '--enable-memory-limit' '--enable-shmop' '--enable-calendar' '--enable-dbx' '--enable-dio' '--with-mime-magic=/usr/share/file/magic.mime' '--without-sqlite' '--with-libxml-dir=/usr' '--with-xml' '--enable-force-cgi-redirect' '--enable-pcntl' '--with-imap=shared' '--with-imap-ssl' '--enable-mbstring=shared' '--enable-mbstr-enc-trans' '--enable-mbregex' '--with-ncurses=shared' '--with-gd' '--enable-bcmath=shared' '--enable-dba=shared' '--with-db4=/usr' '--with-xmlrpc=shared' '--with-ldap=shared' '--with-mysql=shared,/usr' '--with-mysqli=shared,/usr/bin/mysql_config' '--enable-dom' '--with-dom-xslt=/usr' '--with-dom-exslt=/usr' '--with-pgsql=shared' '--enable-soap=shared' '--with-xsl=shared,/usr' '--enable-xmlreader' '--enable-xmlwriter' '--enable-fastcgi' '--enable-pdo=shared' '--with-pdo-odbc=shared,unixODBC,/usr' '--with-pdo-mysql=shared,/usr' '--with-pdo-pgsql=shared,/usr' '--with-pdo-sqlite=shared,/usr' '--with-readline' '--with-tidy' '--with-apxs2=/usr/sbin/apxs' '--enable-zip'</p>\r\n<p><strong>Additional .ini files parsed</strong></p>\r\n<p>/etc/php.d/bcmath.ini, /etc/php.d/dba.ini, /etc/php.d/dom.ini, /etc/php.d/gd.ini, /etc/php.d/imap.ini, /etc/php.d/ldap.ini, /etc/php.d/mbstring.ini, /etc/php.d/mysqli.ini, /etc/php.d/mysql.ini, /etc/php.d/ncurses.ini, /etc/php.d/odbc.ini, /etc/php.d/pdo.ini, /etc/php.d/pdo_mysql.ini, /etc/php.d/pdo_odbc.ini, /etc/php.d/pdo_pgsql.ini, /etc/php.d/pdo_sqlite.ini, /etc/php.d/pgsql.ini, /etc/php.d/soap.ini, /etc/php.d/xmlreader.ini, /etc/php.d/xmlrpc.ini, /etc/php.d/xmlwriter.ini, /etc/php.d/xsl.ini</p>\r\n<p><strong>Registered PHP Streams</strong></p>\r\n<p>https, ftps, compress.zlib, compress.bzip2, php, file, glob, data, http, ftp, phar, zip</p>\r\n<p><strong>Registered Stream Socket Transports</strong></p>\r\n<p>tcp, udp, unix, udg, ssl, sslv3, sslv2, tls</p>\r\n<p><strong>Registered Stream Filters</strong></p>\r\n<p>zlib.*, bzip2.*, convert.iconv.*, string.rot13, string.toupper, string.tolower, string.strip_tags, convert.*, consumed, dechunk</p>\r\n<p>&nbsp;</p>\r\n<hr>\r\n<p>&nbsp;</p>\r\n<p>When I run this script:</p>\r\n<p>&lt;?<br>/** Error reporting */<br>error_reporting(E_ALL);<br><br>/** Include path **/<br>ini_set('include_path',ini_get('include_path').PATH_SEPARATOR.'../private/utilities/PHPExcel/Classes/');<br><br>/** PHPExcel */<br>include 'PHPExcel.php';<br><br>/** PHPExcel_Writer_Excel2007 */<br>include 'PHPExcel/Writer/Excel2007.php';<br><br>// Create new PHPExcel object<br>//echo date('H:i:s').&quot; Create new PHPExcel object&lt;br&gt;&quot;;<br>$objPHPExcel = new PHPExcel();<br><br>// Set properties<br>//echo date('H:i:s').&quot; Set properties&lt;br&gt;&quot;;<br>$objPHPExcel-&gt;getProperties()-&gt;setCreator('Maarten Balliauw');<br>$objPHPExcel-&gt;getProperties()-&gt;setLastModifiedBy('Maarten Balliauw');<br>$objPHPExcel-&gt;getProperties()-&gt;setTitle('Office 2007 XLSX Test Document');<br>$objPHPExcel-&gt;getProperties()-&gt;setSubject('Office 2007 XLSX Test Document');<br>$objPHPExcel-&gt;getProperties()-&gt;setDescription('Test document for Office 2007 XLSX, generated using PHP classes.');<br><br>// Add some data<br>//echo date('H:i:s').&quot; Add some data&lt;br&gt;&quot;;<br>$objPHPExcel-&gt;setActiveSheetIndex(0);<br>$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue('A1','Hello');<br>$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue('B2','world!');<br>$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue('C1','Hello');<br>$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue('D2','world!');<br><br>// Rename sheet<br>//echo date('H:i:s').&quot; Rename sheet&lt;br&gt;&quot;;<br>$objPHPExcel-&gt;getActiveSheet()-&gt;setTitle('Simple');<br><br>// redirect output to client browser<br>header('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');<br>header('Content-Disposition: attachment;filename=&quot;myfile.xlsx&quot;');<br>header('Cache-Control: max-age=0');</p>\r\n<p>$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel,'Excel2007');<br>$objWriter-&gt;save('php://output');</p>\r\n<p>// Echo done<br>//echo date('H:i:s').' Done writing file.';<br>?&gt;</p>\r\n<p>It get an .xlsx file that gives this error when I try to open it in Excel 2007:</p>\r\n<p><em>Excel cannot open the file 'myfile.xlsx' because the file format or file extension is not valid.&nbsp; Verify that the file has not been corrupted and that the file extension matches the format of the file.</em></p>\r\n<p><em>\r\n<hr>\r\n</em></p>\r\n<p>First, let me say that for some reason almost all of the php scripts in the PHPExcel v1.6.7 release were missing the closing '?&gt;' tag.&nbsp; I added the closing tag to all of the scripts that were missing it.&nbsp; Even after doing that, I still have this problem with the corrupted file.&nbsp; The unaltered 'Hello World' script works.&nbsp; The file is saved on my server and, after downloading it to my local machine, it opens without error using Excel 2007.&nbsp; My only guess is that maybe one or more files have the BOM mentioned in 4.4.32.&nbsp; How can I check for this?&nbsp; Other than that, what might cause the redirected file to be corrupted?</p>\r\n<p>Thank you.</p>",
    "PostedDate": "2009-08-07T08:25:20.893-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "220842",
    "ThreadId": "64837",
    "Html": "<p><em>&gt;&gt; It get an .xlsx file that gives this error when I try to open it in Excel 2007</em><br><br>Is this only happening when the file is redirected to the client browser, or also when you save the Excel file normally to the disk on the server. I recommend that you first try to save the file normally on disk and get that working. <br><br><em>&gt;&gt; First, let me say that for some reason almost all of the php scripts<br>&gt;&gt; in the PHPExcel v1.6.7 release were missing the closing '?&gt;' tag.</em></p>\r\n<p>This is on purpose. The advantage leaving out ?&gt; is that you don't have to worry about whitespace making trouble after the ?&gt;<br><a href=\"http://php.net/basic-syntax.instruction-separation\">http://php.net/basic-syntax.instruction-separation</a><br><br><em>&gt;&gt; My only guess is that maybe one or more files have the BOM mentioned in 4.4.32.<br>&gt;&gt; How can I check for this?</em></p>\r\n<p>Open the downloaded Excel file in a HEX editor and see if file starts with EF BB BF (&iuml;&raquo;&iquest;). But since you have not included other files in your script I don't think this is the problem. None of the PHPExcel class files have BOM.<br><br><em>&gt;&gt; Other than that, what might cause the redirected file to be corrupted?</em></p>\r\n<p>Sometimes, it is because PHP memory has been exhausted. The file then just contains a PHP error message in plain text. Try to open the Excel file in a text editor and check.</p>",
    "PostedDate": "2009-08-07T09:31:06.83-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "220934",
    "ThreadId": "64837",
    "Html": "<p>As I mentioned, the unaltered 'Hello World' script works.&nbsp; The file is saved on my server and, after downloading it to my local machine, it opens without error using Excel 2007.&nbsp; I opened the download Excel file with a HEX editor and then with Notepad.&nbsp; You are right, it contained the error message below:</p>\r\n<p><strong>Fatal error</strong>:  Class 'PHPExcel_IOFactory' not found in <strong>/home/virtual/site1/fst/var/www/html/excel.php</strong> on line <strong>55</strong></p>\r\n<p>I included the file and it works.&nbsp; Thanks for your help.</p>",
    "PostedDate": "2009-08-07T14:07:09.637-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]