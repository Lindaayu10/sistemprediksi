[
  {
    "Id": "1363314",
    "ThreadId": "586308",
    "Html": "Hello everyone,<br />\n<br />\nI am using PHPExcel to generate large report files for customer orders. The script reads a CSV, inserts them into a database, then re-reads them, does the calculation and then writes the data row by row to a xlsx-file. We talk about 5000 to 7000 rows. The rows are inserted in a for-loop, which loops over all countries customers ordered from.<br />\n<br />\nDoing this <em>sometimes</em> works on my local apache, but running the script on production server causes a &quot;504 Gateway Timeout&quot;, after about 10 minutes of loading.<br />\n<br />\nI &quot;managed&quot; to crash my local apache to get some information with xdebug:<br />\n<br />\n<img src=\"http://i.imgur.com/ya9loN9.png\" alt=\"Image\" /><br />\n<br />\nThe following images are from a run where the script terminated:<br />\n<br />\n<img src=\"http://i.imgur.com/YV4jBOu.png\" alt=\"Image\" /><br />\n<br />\nAnd the number of calls:<br />\n<br />\n<img src=\"http://i.imgur.com/rvFFFsH.png\" alt=\"Image\" /><br />\n<br />\n<strong>(What is hidden in this pic: the save-function takes about 46% usage)</strong><br />\n<br />\nAs you can see, I call getActiveSheet() very often, because I write data to two different sheets at the same time. I do <strong>not</strong> do calculations or formulas with PHPExcel, this is done in the script, and PHPExcel writes only plain numbers.  After writing all rows, I do some formatting (column width, font, font size, table grids usw.).<br />\n<br />\nI am using the latest version of PHPExcel, 1.8.0.<br />\n<br />\nSpecs on the machines I tested the script on (with crashes)<br />\n<ul>\n<li>my local computer: Apache 2.4.9 with PHP 5.4.27 on Windows 8.1</li>\n<li>production server 1: Apache 2.4.7 with PHP 5.5.9 on Ubuntu</li>\n<li>\nproduction server 2: Apache ??? with PHP 5.3.3 on Linux (phpinfo() doesn't provide any more information..)<br />\n</li>\n</ul>\nThank you,<br />\n<br />\nDaniel<br />\n",
    "PostedDate": "2015-03-13T18:53:12.997-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]