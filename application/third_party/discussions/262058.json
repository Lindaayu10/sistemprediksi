[
  {
    "Id": "630217",
    "ThreadId": "262058",
    "Html": "<p>Hi,<br /> <br /> I have a problem with PHPExcel<br /> <br /> I'm creating several sheets in a workbook using a template.<br /> When I insert a sheet, I assign a new label for this new sheet.&nbsp; The problem is when the second sheet is inserted, the name of the previous sheet is changed with the name of the sheet in the template, then, when the third sheet is inserted occur an error, and  I think is because the name of the second sheet is changed with the name of the template's sheet and the worksheet don't allow to have two sheets with the same name.<br /> <br /> The problem is that I assign diferent names for each sheet, and I don't know why every time a insert a new sheet, the names of the previous sheet are changing.<br /> <br /> The same occurs when I insert an image in every sheet I'm creating.&nbsp;&nbsp; When a new sheet is created, the images in the previous sheets, disapear.<br /> <br /> To solve this, I had to rename every sheet after a new sheet was created, and when all sheets was created, I had to insert my image in every sheet in the document.</p>\n<p>This is what I did.</p>\n<p>$names = array();</p>\n<p>for($count=0; $count&lt;5; $count++){&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <br /> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $Template&nbsp;&nbsp; = $objReader-&gt;load(\"template.xlsx\");<br /> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $workSheet&nbsp;&nbsp;&nbsp; = $Template-&gt;getSheet(0);<br /> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $objPHPExcel-&gt;addExternalSheet($workSheet,0);<br /> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $objPHPExcel-&gt;setActiveSheetIndex($count);<br /> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $noms[$count]=\"sheetName_\".$count;<br /> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $objPHPExcel-&gt;getActiveSheet()-&gt;setTitle($names[$count]);&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;</p>\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // If I don't rename the label of the previous sheets, an error occurs because the previous labels are missing and the label of the original template is showed.</p>\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if($count&gt;0){<br /> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; for($i=0; $i&lt;$count; $i++){<br /> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $label=trim($names[$hoj]);<br /> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $objPHPExcel-&gt;setActiveSheetIndex($i);<br /> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $objPHPExcel-&gt;getActiveSheet()-&gt;setTitle($label);&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <br /> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }&nbsp;&nbsp;&nbsp; <br /> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <br /> }</p>\n<p>// Finaly, I tried to insert an image in the moment that a new sheet was inserted, but at the end, only the last sheet had the image.</p>\n<p>// Then I had to insert the image in every sheet when every sheets was created.</p>\n<p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; for($i=0;$i&lt;11;$i++){&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <br /> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $objDrawing = new PHPExcel_Worksheet_Drawing();<br /> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $objDrawing-&gt;setPath('logo.jpg');<br /> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $objDrawing-&gt;setCoordinates('B1');<br /> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $objDrawing-&gt;setName('logo');<br /> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $objDrawing-&gt;setDescription('logo');<br /> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $objDrawing-&gt;setHeight(65);<br /> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $objDrawing-&gt;setOffsetX(45);<br /> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $objDrawing-&gt;setOffsetY(4);<br /> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $objDrawing-&gt;setRotation(0);&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <br /> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $objPHPExcel-&gt;setActiveSheetIndex($i);<br /> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $objDrawing-&gt;setWorksheet($objPHPExcel-&gt;getActiveSheet());<br /> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</p>\n<p>&nbsp;</p>\n<p>Could anybody help me to find out if I am doing something wrong?, and what could be the right way to do this?.</p>\n<p>Thanks in advance.</p>\n<p>&nbsp;</p>\n<p>Regards.</p>\n<p>Alex.</p>",
    "PostedDate": "2011-06-20T12:42:48.03-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "631517",
    "ThreadId": "262058",
    "Html": "<p>Hi,</p>\r\n<p>I finaly found what the problem was.</p>\r\n<p>In the next line, I must put the index number of the sheet, insted the number zero.</p>\r\n<p>$objPHPExcel-&gt;addExternalSheet($workSheet,0);</p>\r\n<p>Correct:</p>\r\n<p>$objPHPExcel-&gt;addExternalSheet($workSheet,$count);</p>\r\n<p>&nbsp;</p>\r\n<p>Thanks anyway.</p>\r\n<p>Regards.</p>\r\n<p>A&ntilde;ex.</p>",
    "PostedDate": "2011-06-22T16:13:22.843-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]