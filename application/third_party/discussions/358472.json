[
  {
    "Id": "845181",
    "ThreadId": "358472",
    "Html": "\r\n<p>I have an application that takes user input and fills this data into the necessary cells of an Excel file template, once a submit button is clicked.&nbsp; This is done successfully using PHPExcel as follows:</p>\r\n<p></p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre>&lt;?php\r\n\r\n<span style=\"color:green\">/** Error reporting - report all - useful for troubleshooting PHP related errors */</span>\r\nerror_reporting(E_ALL);\r\n\r\n<span style=\"color:green\">/** Require once the IOFactory.php, this is a required line to make the loading of Excel workbook successful */</span>\r\n<span style=\"color:blue\">require_once</span> <span style=\"color:#a31515\">'../../Classes/PHPExcel/IOFactory.php'</span>;\r\n<span style=\"color:blue\">require_once</span> <span style=\"color:#a31515\">'../../Classes/PHPExcel.php'</span>;\r\n\r\n<span style=\"color:blue\">if</span> (!file_exists(<span style=\"color:#a31515\">&quot;sim1.xlsx&quot;</span>)) \r\n{\r\n\t<span style=\"color:blue\">exit</span>(<span style=\"color:#a31515\">&quot;Error - file does not exist in directory.\\n&quot;</span>);\r\n}\r\n\r\n$Reader = PHPExcel_IOFactory::createReader(<span style=\"color:#a31515\">'Excel2007'</span>);\r\n$Reader-&gt;setReadDataOnly(true);\r\n$excel2 = $Reader-&gt;load(<span style=\"color:#a31515\">'sim1.xlsx'</span>); <span style=\"color:green\">// Empty Sheet</span>\r\n$excel2-&gt;setActiveSheetIndex(0);\r\n\r\n$excel2-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#a31515\">'B1000'</span>, $phVali)\r\n        -&gt;setCellValue(<span style=\"color:#a31515\">'B1009'</span>, $geVali)\r\n        -&gt;setCellValue(<span style=\"color:#a31515\">'B1013'</span>, $ppOpti)\r\n\t-&gt;setCellValue(<span style=\"color:#a31515\">'B1016'</span>, $priceVal)\r\n\t-&gt;setCellValue(<span style=\"color:#a31515\">'B1021'</span>, $podBAvail)\r\n\t-&gt;setCellValue(<span style=\"color:#a31515\">'B1022'</span>, $phValiB)\r\n\t-&gt;setCellValue(<span style=\"color:#a31515\">'B1031'</span>, $geValiB)\r\n\t-&gt;setCellValue(<span style=\"color:#a31515\">'B1035'</span>, $ppOptiB)\r\n\t-&gt;setCellValue(<span style=\"color:#a31515\">'B1038'</span>, $priceValB)\r\n\t-&gt;setCellValue(<span style=\"color:#a31515\">'B1040'</span>, $podCAvail)\r\n\t-&gt;setCellValue(<span style=\"color:#a31515\">'B1041'</span>, $phValiC)\r\n\t-&gt;setCellValue(<span style=\"color:#a31515\">'B1050'</span>, $geValiC)\r\n\t-&gt;setCellValue(<span style=\"color:#a31515\">'B1054'</span>, $ppOptiC)\r\n\t-&gt;setCellValue(<span style=\"color:#a31515\">'B1057'</span>, $priceValC)\r\n\t-&gt;setCellValue(<span style=\"color:#a31515\">'B1059'</span>, $podDAvail)\r\n\t-&gt;setCellValue(<span style=\"color:#a31515\">'B1060'</span>, $phValiD)\r\n\t-&gt;setCellValue(<span style=\"color:#a31515\">'B1069'</span>, $geValiD)\r\n\t-&gt;setCellValue(<span style=\"color:#a31515\">'B1073'</span>, $ppOptiD)\r\n\t-&gt;setCellValue(<span style=\"color:#a31515\">'B1076'</span>, $priceValD)\r\n\t-&gt;setCellValue(<span style=\"color:#a31515\">'B1078'</span>, $podEAvail)\r\n\t-&gt;setCellValue(<span style=\"color:#a31515\">'B1079'</span>, $phValiE)\r\n\t-&gt;setCellValue(<span style=\"color:#a31515\">'B1088'</span>, $geValiE)\r\n\t-&gt;setCellValue(<span style=\"color:#a31515\">'B1092'</span>, $ppOptiE)\r\n\t-&gt;setCellValue(<span style=\"color:#a31515\">'B1095'</span>, $priceValE);\r\n\t\r\n$objWriter = PHPExcel_IOFactory::createWriter($excel2, <span style=\"color:#a31515\">'Excel2007'</span>);  <span style=\"color:green\">&nbsp;</span>\r\n\r\n$objWriter-&gt;save(<span style=\"color:#a31515\">'newsim1.xlsx'</span>);\r\n\r\n$excel2-&gt;disconnectWorksheets();\r\n<span style=\"color:blue\">unset</span>($excel2);\r\n\r\n?&gt;<br>&nbsp;</pre>\r\n</div>\r\n<p></p>\r\n<p>&nbsp;</p>\r\n<p><span style=\"text-decoration:underline\">My goal is to then open &amp; read the newly created excel file (<strong>newsim1.xlsx</strong>) and grab the values of a few\r\n<em>AVERAGE </em>formula cells (calculated based off the user's input) and display them in a HTML table\r\n</span></p>\r\n<p></p>\r\n<pre>Example: =AVERAGE(AJ3:AJ211)</pre>\r\n<p></p>\r\n<p>&nbsp;</p>\r\n<p>When I echo the results of the new cell values for the cells I just altered, I am given the correct values.&nbsp; This test ensures that the values for being written to the file successfully. &nbsp;&nbsp;</p>\r\n<p><span style=\"color:#ff0000\"><strong>However</strong></span>, the cells with the\r\n<em>AVERAGE</em> formulas do not echo the correct values (echo a very different value than the ones shown if I open up the newly created spreadsheet in the directory).&nbsp;</p>\r\n<p>&nbsp;</p>\r\n<p></p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre>&lt;?php\r\n\r\n$objReader = PHPExcel_IOFactory::createReader(<span style=\"color:#a31515\">'Excel2007'</span>);\r\n$objPHPExcel = $objReader-&gt;load(<span style=\"color:#a31515\">&quot;newsim1.xlsx&quot;</span>);\r\n$objPHPExcel-&gt;setActiveSheetIndex(0);\r\n\r\n$objWorksheet = $objPHPExcel-&gt;getActiveSheet();\r\n\r\n$podAshare = $objWorksheet-&gt;getCell(<span style=\"color:#a31515\">'AJ1106'</span>)-&gt;getCalculatedValue();\r\n$podAshare1 = round($podAshare * 100, 1) . <span style=\"color:#a31515\">'%'</span>;\r\n\r\n$podBshare = $objWorksheet-&gt;getCell(<span style=\"color:#a31515\">'AK1106'</span>)-&gt;getCalculatedValue();\r\n$podBshare1 = round($podBshare * 100, 1) . <span style=\"color:#a31515\">'%'</span>;\r\n\r\n$podCshare = $objWorksheet-&gt;getCell(<span style=\"color:#a31515\">'AL1106'</span>)-&gt;getCalculatedValue();\r\n$podCshare1 = round($podCshare * 100, 1) . <span style=\"color:#a31515\">'%'</span>;\r\n\r\n$podDshare = $objWorksheet-&gt;getCell(<span style=\"color:#a31515\">'AM1106'</span>)-&gt;getCalculatedValue();\r\n$podDshare1 = round($podDshare * 100, 1) . <span style=\"color:#a31515\">'%'</span>;\r\n\r\n$podEshare = $objWorksheet-&gt;getCell(<span style=\"color:#a31515\">'AN1106'</span>)-&gt;getCalculatedValue();\r\n$podEshare1 = round($podEshare * 100, 1) . <span style=\"color:#a31515\">'%'</span>;\r\n\r\n$podNshare = $objWorksheet-&gt;getCell(<span style=\"color:#a31515\">'AO1106'</span>)-&gt;getCalculatedValue();\r\n$podNshare1 = round($podNshare * 100, 1) . <span style=\"color:#a31515\">'%'</span>;\r\n\r\n?&gt;\r\n</pre>\r\n</div>\r\n<p></p>\r\n<p>I'm not sure what I'm doing wrong or where the values it is displaying are coming from.&nbsp; Any help would be greatly appreciated!</p>\r\n<p>Greg</p>\r\n",
    "PostedDate": "2012-06-05T13:45:44.747-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "845218",
    "ThreadId": "358472",
    "Html": "<p>Can you please indicate the formula, the values involved (from the cells referenced in the formula), the expected result and the actual result. AVERAGE is a pretty basic function, and I've never had any problems with it before</p>",
    "PostedDate": "2012-06-05T14:46:17.247-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]