[
  {
    "Id": "1122517",
    "ThreadId": "468299",
    "Html": "Hello, first of all let me say PHPExcel is a great library!  Thanks to everyone who has worked on it!<br />\n<br />\nPHPExcel version: latest 1.7.9<br />\nApache 2.2.15/PHP 5.3.3<br />\n<br />\nI am having a problem attempting to output to HTML.  The data in the cells is correct, but when otuput to HTML, the values are changed!  This is not a formatting or number range issue, but it appears rather the HTML writer is writing the wrong values to the cells.  For example, the value of a cell should be 0.28 but instead the rendered cell contains &quot;600&quot;, or possibly the value of a cell nearby.<br />\n<br />\nIf I write the PHPExcel object to an XLSX file instead of HTML, the values are correct.<br />\n<br />\nI used the following code to test.  C9 contains a simple formula: =B9/B12.  The correct answer is approximately 0.28 to 0.30.   However, when rendering to HTML, the cell contains the value 266, which is actually the value of cell B9 in this case.<br />\nOn another test, the cell contained the value 900, which was actually the value of cell B12.<br />\n<pre><code>$sheet = $excel-&gt;setActiveSheetIndex(1);\n    $formula = $sheet-&gt;getCell('C9')-&gt;getValue();\n    $log-&gt;write(&quot;Calculating C9...&quot;);\n    $log-&gt;write (&quot;Cell formula is : $formula&quot;);\n    $log-&gt;write (&quot;Old value was: &quot; . $sheet-&gt;getCell('C9')-&gt;getOldCalculatedValue());\n    $tokens = PHPExcel_Calculation::getInstance()-&gt;parseFormula($formula, $sheet-&gt;getCell('C9'));\n    $log-&gt;write(&quot;Tokens:&quot;);\n    $log-&gt;write(var_export($tokens, true));\n    $log-&gt;write(&quot;Debug log: &quot;);\n    //$log-&gt;write(var_export(PHPExcel_Calculation::getInstance()-&gt;debugLog));\n    $log-&gt;write(&quot;New value: &quot; . $sheet-&gt;getCell('C9')-&gt;getCalculatedValue());</code></pre>\n\nHere is the excerpt from the log file generated by this code:<br />\n<pre><code>11/12/2013 15:05:54 /home/public_html/content/bip_ajax.php(126) - Calculating C9...\n11/12/2013 15:05:54 /home/public_html/content/bip_ajax.php(127) - Cell formula is : =B9/B12\n11/12/2013 15:05:54 /home/public_html/content/bip_ajax.php(128) - Old value was: 0.2819047619047619\n11/12/2013 15:05:54 /home/public_html/content/bip_ajax.php(130) - Tokens:\n11/12/2013 15:05:54 /home/public_html/content/bip_ajax.php(131) - array (\n  0 =&gt; \n  array (\n    'type' =&gt; 'Cell Reference',\n    'value' =&gt; 'B9',\n    'reference' =&gt; 'B9',\n  ),\n  1 =&gt; \n  array (\n    'type' =&gt; 'Cell Reference',\n    'value' =&gt; 'B12',\n    'reference' =&gt; 'B12',\n  ),\n  2 =&gt; \n  array (\n    'type' =&gt; 'Binary Operator',\n    'value' =&gt; '/',\n    'reference' =&gt; NULL,\n  ),\n)\n11/12/2013 15:05:54 /home/public_html/content/bip_ajax.php(132) - Debug log: \n11/12/2013 15:05:54 /home/public_html/content/bip_ajax.php(134) - New value: 0.2955555555555556\n</code></pre>\n\nYou can clearly see the calculated new value of C9 is approximately 0.295...<br />\nImmediately after this code, I create the HTML file by executing this code:<br />\n<pre><code>$filename = &quot;temp_dir/bip_temp/&quot; . microtime();\n$excel_writer = PHPExcel_IOFactory::createWriter($excel, 'HTML');\n$excel_writer-&gt;writeAllSheets();\n$excel_writer -&gt; save(SERVER_DIR . CONTENT_DIR . $filename . &quot;.html&quot;);</code></pre>\n\nHowever, here is a screenshot of the HTML file: <a href=\"http://imgur.com/inxPzdJ\" rel=\"nofollow\">http://imgur.com/inxPzdJ</a><br />\n<br />\nIf I then proceed to write the PHPExcel object to a XLSX file, the <em>correct</em> values appear in all cells.<br />\n<br />\nI even tried opening this generated XLSX file and writing it to HTML, and the same problem occurs. :P<br />\n<br />\n<br />\nUnfortunately I can't share the original XLSX file, because it is a confidential business document.  However it's just a simple three-sheet worksheet with SUM's and basic math calculations.<br />\n<br />\nAny insight/help/suggestions appreciated!<br />\n<br />\nThanks,<br />\n<br />\nRyan<br />\n",
    "PostedDate": "2013-11-12T12:26:29.563-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1123356",
    "ThreadId": "468299",
    "Html": "Yup, same problem here!\r<br />\nI've posted an issue <a href=\"https://phpexcel.codeplex.com/workitem/20416\" rel=\"nofollow\">https://phpexcel.codeplex.com/workitem/20416</a>\r<br />\nAs a side note in PhpExcel 1.7.8 it worked fine.<br />\n",
    "PostedDate": "2013-11-14T01:58:09.893-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1238551",
    "ThreadId": "468299",
    "Html": "Dear gremki, you made my day!<br />\n<br />\nI've been struggling with this for about a week.<br />\nJust rolled back from 1.8.0 to 1.7.8 and HTML is now filled with all values properly!<br />\n<br />\nThank you very much!<br />\n<br />\nI believe this anyways needs to be addressed in future release.<br />\n",
    "PostedDate": "2014-04-27T11:02:50.4-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]