[
  {
    "Id": "515312",
    "ThreadId": "233008",
    "Html": "\r\n<p>I have this php file</p>\r\n<p>&lt;?php$connectionInfo_hq = array('Database'=&gt;'xxx', 'ReturnDatesAsStrings'=&gt; true,'UID'=&gt;'xxx', 'PWD'=&gt;'xxx', 'CharacterSet'=&gt;'UTF-8');$conn = sqlsrv_connect('xxx , 1433', $connectionInfo_hq);<br>\r\n// SQL$tsql = 'select * from customer order by first_name';<br>\r\n$stmt = sqlsrv_query( $conn, $tsql);<br>\r\n/** Error reporting */error_reporting(E_ALL);<br>\r\ndate_default_timezone_set('Europe/London');<br>\r\n/** PHPExcel */require_once '../Classes/PHPExcel.php';<br>\r\n<br>\r\n// Create new PHPExcel object$objPHPExcel = new PHPExcel();<br>\r\n// Set properties$objPHPExcel-&gt;getProperties()-&gt;setCreator(&quot;Maarten Balliauw&quot;)<span>\r\n</span>-&gt;setLastModifiedBy(&quot;Maarten Balliauw&quot;)<span> </span>-&gt;setTitle(&quot;Office 2007 XLSX Test Document&quot;)<span>\r\n</span>-&gt;setSubject(&quot;Office 2007 XLSX Test Document&quot;)<span> </span>-&gt;setDescription(&quot;Test document for Office 2007 XLSX, generated using PHP classes.&quot;)<span>\r\n</span>-&gt;setKeywords(&quot;office 2007 openxml php&quot;)<span> </span>-&gt;setCategory(&quot;Test result file&quot;);<br>\r\n<br>\r\n// Add some data$objPHPExcel-&gt;setActiveSheetIndex(0)&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;-&gt;setCellValue('A1', 'customernr')&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;-&gt;setCellValue('B1', 'first_name')&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;\r\n &nbsp; &nbsp;-&gt;setCellValue('C1', 'Last_name')<br>\r\n$i = 2;<br>\r\n$objPHPExcel-&gt;setActiveSheetIndex(0)<br>\r\nwhile( $row = sqlsrv_fetch_array( $stmt, SQLSRV_FETCH_ASSOC)) {<br>\r\n&nbsp;-&gt;setCellValue('A' . $i, &quot;$row[customernr]&quot;)-&gt;setCellValue('B' . $i, &quot;$row[first_name]&quot;)-&gt;setCellValue('C' . $i, &quot;$[last_name]&quot;)<br>\r\n$i = $i &#43; 1;<br>\r\n}<br>\r\n// Rename sheet$objPHPExcel-&gt;getActiveSheet()-&gt;setTitle('Simple');<br>\r\n<br>\r\n// Set active sheet index to the first sheet, so Excel opens this as the first sheet$objPHPExcel-&gt;setActiveSheetIndex(0);<br>\r\n<br>\r\n// Redirect output to a client&rsquo;s web browser (Excel2007)header('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');header('Content-Disposition: attachment;filename=&quot;01simple.xlsx&quot;');header('Cache-Control: max-age=0');<br>\r\n$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, 'Excel2007');$objWriter-&gt;save('php://output');exit;<br>\r\n?&gt;</p>\r\n<p><span>When I download the file can not be opened in Excel 2007 and 2010.&nbsp;</span><span>But if I delete &quot;while( $row = sqlsrv_fetch_array( $stmt, SQLSRV_FETCH_ASSOC)) {&quot;<br>\r\n</span><span>the file can be downloaded just fine but no data.&nbsp;</span><span>Someone who can help with this error?</span></p>\r\n",
    "PostedDate": "2010-11-01T01:17:01.22-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "515623",
    "ThreadId": "233008",
    "Html": "\r\n<div style=\"color:black; background-color:white\">\r\n<pre><span style=\"color:blue\">while</span>( $row = sqlsrv_fetch_array( $stmt, SQLSRV_FETCH_ASSOC)) {\r\n   -&gt;setCellValue(<span style=\"color:#a31515\">'A'</span> . $i, <span style=\"color:#a31515\">&quot;$row[customernr]&quot;</span>)-&gt;setCellValue(<span style=\"color:#a31515\">'B'</span> . $i, <span style=\"color:#a31515\">&quot;$row[first_name]&quot;</span>)-&gt;setCellValue(<span style=\"color:#a31515\">'C'</span> . $i, <span style=\"color:#a31515\">&quot;$[last_name]&quot;</span>)\r\n   $i = $i &#43; 1;\r\n}\r\n</pre>\r\n</div>\r\n<p>should give a&nbsp; PHP parse error because it isn't valid PHP.</p>\r\n<pre><span style=\"color:blue\">while</span>( $row = sqlsrv_fetch_array( $stmt, SQLSRV_FETCH_ASSOC)) {</pre>\r\n<pre>   $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#a31515\">'A'</span> . $i, <span style=\"color:#a31515\">$row[&quot;customernr&quot;]</span>)-&gt;setCellValue(<span style=\"color:#a31515\">'B'</span> . $i, <span style=\"color:#a31515\">$row[&quot;first_name&quot;]</span>)-&gt;setCellValue(<span style=\"color:#a31515\">'C'</span> . $i, <span style=\"color:#a31515\">$[&quot;last_name&quot;]</span>);</pre>\r\n<pre>   $i = $i &#43; 1; </pre>\r\n<pre>}</pre>\r\n<p>might resolve your issue</p>\r\n",
    "PostedDate": "2010-11-01T15:14:01.687-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "515759",
    "ThreadId": "233008",
    "Html": "\r\n<p>Hey Mark,</p>\r\n<p>No, it gives the same error when I open the file in Excel.</p>\r\n<p>My code :</p>\r\n<p>// Add some data</p>\r\n<p>$objPHPExcel-&gt;setActiveSheetIndex(0)</p>\r\n<p>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;-&gt;setCellValue('A1', 'customernr')</p>\r\n<p>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;-&gt;setCellValue('B1', 'first_name')</p>\r\n<p>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;-&gt;setCellValue('C1', 'Last_name');<br>\r\n$i = 2;</p>\r\n<p>$objPHPExcel-&gt;setActiveSheetIndex(0);</p>\r\n<p>while( $row = sqlsrv_fetch_array( $stmt, SQLSRV_FETCH_ASSOC)) {<br>\r\n$objPHPExcel-&gt;getActiveSheet()<br>\r\n<span style=\"white-space:pre\"></span>-&gt;setCellValue('A' . $i, $row[&quot;customernr&quot;])</p>\r\n<p><span style=\"white-space:pre\"></span>-&gt;setCellValue('B' . $i, $row[&quot;first_name&quot;])</p>\r\n<p><span style=\"white-space:pre\"></span>-&gt;setCellValue('C' . $i, $row[&quot;last_name&quot;]);<br>\r\n&nbsp;&nbsp; $i = $i &#43; 1;&nbsp;</p>\r\n<p>}</p>\r\n<p>Hope you can help again ?</p>\r\n",
    "PostedDate": "2010-11-02T00:08:33.387-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]