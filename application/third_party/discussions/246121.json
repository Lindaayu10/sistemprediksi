[
  {
    "Id": "566515",
    "ThreadId": "246121",
    "Html": "\r\n<p>I'm completely new to this</p>\r\n<p>I'm using phpexcel 1.7.5 and want to achieve the following.</p>\r\n<p>I'm pulling data down from a mysql database using a form which then displays the total of the results on my site, but I want to be able to offer an xls download of the data.</p>\r\n<p>The problem I've got is the form can display a range of data rows, with a fixed number of columns, depending on the date range selected.</p>\r\n<p>I'll try and show in an example of how my data is stored on the database.</p>\r\n<p>Date:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Column 1:&nbsp;&nbsp;&nbsp;&nbsp; Column 2:&nbsp;&nbsp;&nbsp;&nbsp; Column 3:&nbsp;&nbsp;&nbsp;&nbsp; Column 4:&nbsp;&nbsp;&nbsp;&nbsp; Notes:<br>\r\n20/01/10 &nbsp;&nbsp;&nbsp; 123.45&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 432.45&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1234.23&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4321.34&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; test notes<br>\r\n23/02/10&nbsp;&nbsp; &nbsp; 432.54&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 876.76 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 9834.23 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1980.93<br>\r\n28/02/10&nbsp;&nbsp; &nbsp; 457.32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 9867.23&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1239.23&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 7653.23&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; notes test<br>\r\n08/03/10&nbsp;&nbsp; &nbsp; 4321.56&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 654.34 &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 5654.54 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2345.23&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; I'm a teapot</p>\r\n<p>And the select is either 1 or a range of dates.</p>\r\n<p>I want the xls to display it pretty much as above, but clueless how to achieve it using a variable number of rows.</p>\r\n<p>If someone could point me in the right direction, I'll figure the formatting out etc after, just need the basics of how to do it please.</p>\r\n<p>Many thanks</p>\r\n<p>usandstuff</p>\r\n",
    "PostedDate": "2011-02-15T07:46:42.387-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "566752",
    "ThreadId": "246121",
    "Html": "<p><code><span class=\"com\">\r\n<div style=\"color: black; background-color: white;\">\r\n<pre><span style=\"color: green;\">// connection with the database </span>\r\n$dbhost = <span style=\"color: #a31515;\">\"localhost\"</span>; \r\n$dbuser = <span style=\"color: #a31515;\">\"root\"</span>; \r\n$dbpass = <span style=\"color: #a31515;\">\"\"</span>; \r\n$dbname = <span style=\"color: #a31515;\">\"database\"</span>; \r\n \r\nmysql_connect($dbhost,$dbuser,$dbpass); \r\nmysql_select_db($dbname); \r\n \r\n<span style=\"color: green;\">// require the PHPExcel file </span>\r\n<span style=\"color: blue;\">require</span> <span style=\"color: #a31515;\">'Classes/PHPExcel.php'</span>; \r\n \r\n<span style=\"color: green;\">// simple query </span>\r\n \r\n$query = <span style=\"color: #a31515;\">\"SELECT id FROM users ORDER by id DESC\"</span>; \r\n \r\n<span style=\"color: blue;\">if</span> ($result = mysql_query($query) <span style=\"color: blue;\">or</span> <span style=\"color: blue;\">die</span>(mysql_error())) { \r\n    <span style=\"color: green;\">// Create a new PHPExcel object </span>\r\n   $objPHPExcel = <span style=\"color: blue;\">new</span> PHPExcel(); \r\n   $objPHPExcel-&gt;getActiveSheet()-&gt;setTitle(<span style=\"color: #a31515;\">'List of Cities'</span>); \r\n \r\n   <span style=\"color: green;\">// Loop through the result set </span>\r\n    $rowNumber = 1; \r\n    <span style=\"color: blue;\">while</span> ($row = mysql_fetch_row($result)) { \r\n       $col = <span style=\"color: #a31515;\">'A'</span>; \r\n       <span style=\"color: blue;\">foreach</span>($row <span style=\"color: blue;\">as</span> $cell) { \r\n          $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue($col.$rowNumber,$cell); \r\n          $col++; \r\n       } \r\n       $rowNumber++; \r\n   } \r\n   <span style=\"color: green;\">// Save as an Excel BIFF (xls) file </span>\r\n   $objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, <span style=\"color: #a31515;\">'Excel5'</span>); \r\n \r\n   header(<span style=\"color: #a31515;\">'Content-Type: application/vnd.ms-excel'</span>); \r\n   header(<span style=\"color: #a31515;\">'Content-Disposition: attachment;filename=\"myFile.xls\"'</span>); \r\n   header(<span style=\"color: #a31515;\">'Cache-Control: max-age=0'</span>); \r\n \r\n   $objWriter-&gt;save(<span style=\"color: #a31515;\">'php://output'</span>); \r\n   <span style=\"color: blue;\">exit</span>(); \r\n} \r\n<span style=\"color: blue;\">echo</span> <span style=\"color: #a31515;\">'a problem has occurred... no data retrieved from the database'</span>; \r\n</pre>\r\n</div>\r\n</span></code></p>\r\n<p><span class=\"pln\">alternatively:</span></p>\r\n<p><span class=\"pln\"><code><span class=\"com\">\r\n<div style=\"color: black; background-color: white;\">\r\n<pre><span style=\"color: green;\">// Loop through the result set </span>\r\n$rowNumber = 1; \r\n<span style=\"color: blue;\">while</span> ($row = mysql_fetch_row($result)) { \r\n    $objPHPExcel-&gt;getActiveSheet()-&gt;fromArray(<span style=\"color: blue;\">array</span>($row),NULL,<span style=\"color: #a31515;\">'A'</span>.$rowNumber++); \r\n} \r\n</pre>\r\n</div>\r\n</span></code></span></p>\r\n<p>To add a heading row.</p>\r\n<pre class=\"lang-php prettyprint\"><code><span class=\"pln\"><div style=\"color: black; background-color: white;\"><pre>$rowNumber = 1;\r\n$headings = <span style=\"color: blue;\">array</span>(<span style=\"color: #a31515;\">'Name'</span>,<span style=\"color: #a31515;\">'EMail'</span>,<span style=\"color: #a31515;\">'Phone'</span>); \r\n$objPHPExcel-&gt;getActiveSheet()-&gt;fromArray(<span style=\"color: blue;\">array</span>($headings),NULL,<span style=\"color: #a31515;\">'A'</span>.$rowNumber);  \r\n\r\n$rowNumber++  \r\n<span style=\"color: green;\">// Loop through the result set </span>\r\n<span style=\"color: blue;\">while</span> ($row = mysql_fetch_row($result)) {\r\n    $col = <span style=\"color: #a31515;\">'A'</span>;\r\n    <span style=\"color: blue;\">foreach</span>($row <span style=\"color: blue;\">as</span> $cell) {\r\n       $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue($col.$rowNumber,$cell);\r\n       $col++;\r\n    }\r\n    $rowNumber++; \r\n} \r\n</pre>\r\n</div>\r\n</span></code><span class=\"pln\">&nbsp;</span></pre>\r\n<p><span class=\"pln\">&nbsp;</span></p>\r\n<p><span class=\"pln\">&nbsp;</span></p>\r\n<p><code></code></p>",
    "PostedDate": "2011-02-15T13:57:10.543-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "566916",
    "ThreadId": "246121",
    "Html": "<p>Thanks for that mark, I'll have a play tonight and see what happens :)</p>",
    "PostedDate": "2011-02-15T21:46:00.563-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "568015",
    "ThreadId": "246121",
    "Html": "<p>that works a treat for one excel file :)</p>\n<p>Now I need to work out how to swap X&amp;Y so data populates down the rows instead of across the colums since there are 50+ fields in the database I want to pull in.</p>\n<p>&nbsp;</p>\n<p>Wohoo, sorted that ok, so now to work out formatting to make it look something like.</p>",
    "PostedDate": "2011-02-17T10:15:26.66-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]