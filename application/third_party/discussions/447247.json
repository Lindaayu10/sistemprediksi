[
  {
    "Id": "1057585",
    "ThreadId": "447247",
    "Html": "Hello,\r<br />\nI have a problem and hope, somone can help me... I create a EXCEL-File with PHP, save it then and send it to the browser. When I do this at home with xampp everything works fine. If I do this with my WebServer I receive the message &quot;File not found&quot; - or in German:\r<br />\n<br />\nFehler: Datei nicht gefunden\r<br />\nDie Dateien unter <a href=\"http://..../tagesplan_gesamt.php?Datum=03.06.2013&amp;OK=OK\" rel=\"nofollow\">http://..../tagesplan_gesamt.php?Datum=03.06.2013&OK=OK</a> konnten nicht gefunden werden.\r<br />\n<br />\nHere is the code:<br />\n<pre><code>&lt;?php\n\n// Header für Browser-Output\nheader('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');\nheader('Content-Disposition: attachment;filename=&quot;Tagesplan-Maschine.xlsx&quot;');\nheader('Cache-Control: max-age=0');\n\n// Einpflegen der Excel-Klassen\nrequire_once (&quot;../classes/PHPExcel.php&quot;);\n\n// Neues Objekt erstellen\n$objPHPExcel = new PHPExcel();\n\n// Eigenschafen des Dokuments\n$objPHPExcel-&gt;getProperties()-&gt;setCreator(&quot;HeliBlog 2.0&quot;)\n                             -&gt;setLastModifiedBy(&quot;HeliBlog 2.0&quot;)\n                             -&gt;setTitle(&quot;Tagesplan nach Immatrikulation&quot;)\n                             -&gt;setSubject(&quot;Tagesplan $Immatrikulation&quot;)\n                             -&gt;setDescription(&quot;Tagesplan nach Maschine HeliBlog 2.0&quot;)\n                             -&gt;setKeywords(&quot;Tagesplan Immatrikulation Maschine&quot;)\n                             -&gt;setCategory(&quot;Tagesplan&quot;);\n\n\n// Ausgabeformat auf DIN A4 festlegen\n$objPHPExcel-&gt;getActiveSheet()-&gt;getPageSetup()-&gt;setOrientation(PHPExcel_Worksheet_PageSetup::ORIENTATION_PORTRAIT);\n$objPHPExcel-&gt;getActiveSheet()-&gt;getPageSetup()-&gt;setPaperSize(PHPExcel_Worksheet_PageSetup::PAPERSIZE_A4);\n\n// Alles an eine Seite anpassen, solange keine Breaks definiert sind\n$objPHPExcel-&gt;getActiveSheet()-&gt;getPageSetup()-&gt;setFitToPage(false);\n$objPHPExcel-&gt;getActiveSheet()-&gt;getPageSetup()-&gt;setFitToWidth(1);\n$objPHPExcel-&gt;getActiveSheet()-&gt;getPageSetup()-&gt;setFitToHeight(25);\n\n// Tabelle auswählen\n$objPHPExcel-&gt;setActiveSheetIndex(0);\n\n// Header und Footer \n$objPHPExcel-&gt;getActiveSheet()-&gt;getHeaderFooter()-&gt;setOddHeader('&amp;CEinsatzplan für den '.$_GET[&quot;Datum&quot;].' - '.$_GET[&quot;Immatrikulation&quot;]);\n$objPHPExcel-&gt;getActiveSheet()-&gt;getHeaderFooter()-&gt;setOddFooter('&amp;L&amp;B' . $objPHPExcel-&gt;getProperties()-&gt;getTitle() . '&amp;RSeite &amp;P von &amp;N');\n\n// Spaltenbreiten einstellen\n$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension('A')-&gt;setWidth(20);\n$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension('B')-&gt;setWidth(50);\n\n// Zelleninhalte immer links - oben\n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('A')-&gt;getAlignment()-&gt;setVertical(PHPExcel_Style_Alignment::VERTICAL_TOP);\n\n// Zeilenumbrüche für die Spalte B\n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('B')-&gt;getAlignment()-&gt;setWrapText(true);\n\n// Überschriften definieren\n$styleArray_Font_Ueb1 = array( 'font' =&gt; array( 'name' =&gt; 'Arial', 'size' =&gt; '12' ) ); \n$styleArray_Font_Ueb2 = array( 'font' =&gt; array( 'name' =&gt; 'Arial', 'size' =&gt; '11' ) ); \n$styleArray_Font_Ueb3 = array( 'font' =&gt; array( 'name' =&gt; 'Arial', 'size' =&gt; '10' ) ); \n\n\n// Beginn der Schleife\n$Datum = date_german2mysql($_GET[&quot;Datum&quot;]);\n\n$query = &quot;SELECT * FROM flugplanung WHERE Flugdatum = '$Datum' AND Immatrikulation = '$Immatrikulation' ORDER BY Von, Crew_1&quot;;\n$result = mysql_query($query) or die(mysql_error());\n\n// Startpositionen\n$c = 0; $r = 1;\n$counter = 0;\n\nwhile($row = mysql_fetch_array($result)) {\n\n    // #################### Beginn des Blocks ####################\n\n    // Zähler\n    $counter++;\n    \n    if($counter == 1) { $r++; }\n    \n    // Zeile 1 - Einfärben\n    $default_border = array(\n        'style' =&gt; PHPExcel_Style_Border::BORDER_THIN,\n        'color' =&gt; array('rgb'=&gt;'CCCCCC')\n    );\n\n    $style_header = array(\n            'borders' =&gt; array(\n            'bottom' =&gt; $default_border,\n            'left' =&gt; $default_border,\n            'top' =&gt; $default_border,\n            'right' =&gt; $default_border,\n            ),\n    \n            'fill' =&gt; array(\n            'type' =&gt; PHPExcel_Style_Fill::FILL_SOLID,\n            'color' =&gt; array('rgb'=&gt;'E1E0F7')\n            ),\n            \n            'font' =&gt; array(\n            'bold' =&gt; true,\n            )\n    );\n \n    $colorbereich = &quot;A&quot;.$r.&quot;:B&quot;.$r;\n    $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle($colorbereich)-&gt;applyFromArray( $style_header );\n\n\n    // Zeile 1 - Auftragsnummer\n    $objPHPExcel-&gt;getActiveSheet()\n                -&gt;setCellValueByColumnAndRow($c, $r, &quot;Auftragsnummer:&quot;)         // A1\n                -&gt;setCellValueByColumnAndRow($c+1, $r, $row['Auftragsnummer']);         // B1\n                    \n                    \n    // Zeile 2 - Kunde\n    $r++;\n    $objPHPExcel-&gt;getActiveSheet();\n    $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValueByColumnAndRow($c, $r, 'Kunde:')\n                -&gt;setCellValueByColumnAndRow($c+1, $r, readCustomer($row[&quot;Kundennummer&quot;]));\n        \n    // Zeile 3 - Uhrzeit\n    $r++;\n    $objPHPExcel-&gt;getActiveSheet()\n                -&gt;setCellValueByColumnAndRow($c, $r, 'Einsatzzeit:')\n                -&gt;setCellValueByColumnAndRow($c+1, $r, date(&quot;H:i&quot;,strtotime($row[&quot;Von&quot;])).&quot; Uhr bis &quot;.date(&quot;H:i&quot;, strtotime($row[&quot;Bis&quot;])).&quot; Uhr&quot;.&quot;| Region: &quot;.$row[&quot;Region&quot;]);\n        \n    // Zeile 4 - Crew\n    $r++;\n    $objPHPExcel-&gt;getActiveSheet()\n                -&gt;setCellValueByColumnAndRow($c, $r, 'Crew:')\n                -&gt;setCellValueByColumnAndRow($c+1, $r, $row[&quot;Crew_1&quot;].&quot; &quot;.$row[&quot;Crew_2&quot;].&quot; &quot;.$row[&quot;Crew_3&quot;].&quot; &quot;.$row[&quot;Crew_4&quot;].&quot; &quot;.$row[&quot;Crew_5&quot;]);\n                    \n    // Zeile 5 - Start- Landeplatz\n    $r++;\n    $objPHPExcel-&gt;getActiveSheet()\n                -&gt;setCellValueByColumnAndRow($c, $r, 'Start / Landung:')\n                -&gt;setCellValueByColumnAndRow($c+1, $r, $row[&quot;Startplatz&quot;].&quot; &quot;.$row[&quot;Landeplatz&quot;]);\n                \n    // Zeile 6 - Auf- Abladeplatz\n    $r++;\n    $objPHPExcel-&gt;getActiveSheet()          \n                -&gt;setCellValueByColumnAndRow($c, $r, 'Auf- / Abladeplatz:')         \n                -&gt;setCellValueByColumnAndRow($c+1, $r, $row[&quot;Aufladeplatz&quot;].&quot; &quot;.$row[&quot;Abladeplatz&quot;]);\n    \n    // Zeile 7 - Material\n    $r++;\n    $objPHPExcel-&gt;getActiveSheet()\n                -&gt;setCellValueByColumnAndRow($c, $r, 'Material:')\n                -&gt;setCellValueByColumnAndRow($c+1, $r, $row[&quot;Material&quot;]);\n                \n    // Zeile 8 - Bemerkungen\n    $r++;\n    $objPHPExcel-&gt;getActiveSheet()\n                -&gt;setCellValueByColumnAndRow($c, $r, 'Bemerkungen:')\n                -&gt;setCellValueByColumnAndRow($c+1, $r, $row[&quot;Bemerkungen&quot;]);            \n    \n    // Zeile 9 - Infos für Rückfragen\n    $r++;\n    $objPHPExcel-&gt;getActiveSheet()\n                -&gt;setCellValueByColumnAndRow($c, $r, 'Verrechnungsbasis:')\n                -&gt;setCellValueByColumnAndRow($c+1, $r, $row[&quot;Verrechnungsbasis&quot;]);          \n    \n    // Zeile 10 - Leerzeile\n    $r++;\n    $objPHPExcel-&gt;getActiveSheet()\n                -&gt;setCellValueByColumnAndRow($c, $r, &quot;&quot;)\n                -&gt;setCellValueByColumnAndRow($c+1, $r, &quot;&quot;); \n                \n\n    // Seitenumbruch\n    if ($counter % 4 == 0) {\n        $breakpoint = &quot;A&quot;.$r;\n        $objPHPExcel-&gt;getActiveSheet()-&gt;setBreak( $breakpoint, PHPExcel_Worksheet::BREAK_ROW );\n    }\n\n    // Zähler der Zeilen um 1 erhöhen\n    $r = $r+1;  \n    \n    // #################### Ende des Blocks ####################\n\n}\n\n// Druckbereich muss festgelegt werden\n$druckbereich .= &quot;A1:B&quot;.$r;\n$objPHPExcel-&gt;getActiveSheet()-&gt;getPageSetup()-&gt;setPrintArea($druckbereich);\n\n// Korrekten Namen vergeben\n$objPHPExcel-&gt;getActiveSheet()-&gt;setTitle($Datum);\n\n// Speichern im Format 2007\n$callStartTime = microtime(true);\n\n$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, 'Excel2007');\n$objWriter-&gt;save(&quot;excel/&quot;.$Datum.&quot;-&quot;.$Immatrikulation.&quot;.xlsx&quot;);\n$callEndTime = microtime(true);\n$callTime = $callEndTime - $callStartTime;\n\n// Browserausgabe\n$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, 'Excel2007');\n$objWriter-&gt;save('php://output'); \n\n?&gt;</code></pre>\n\nBut the file &quot;tagesplan_gesamt.php&quot; is existing! What do I wrong? Thank you very much.\r<br />\n<br />\nTorsten<br />\n",
    "PostedDate": "2013-06-17T00:48:41.793-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1057594",
    "ThreadId": "447247",
    "Html": "OK - I found one interesting thing: the file is created. I can see it with FTP in the folder.<br />\n",
    "PostedDate": "2013-06-17T01:10:01.663-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1057612",
    "ThreadId": "447247",
    "Html": "The &quot;&quot; tagesplan_gesamt.php&quot;&quot; file contains the code listed above?\r<br />\nAlthough I do not think that the problem is there (although I wonder where does the content of the $Immatrikulation variable that is used in the query and the file name).\r<br />\nThe error message is probably generated by the Web server, not the script engine. If the file name is correct, the problem is the path: an error in the link or in the assessment of the path as sees the server...<br />\n",
    "PostedDate": "2013-06-17T01:52:58.633-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1057619",
    "ThreadId": "447247",
    "Html": "OK - Thank you very much. I will have a look. It seems, that the download of the file ist not starting. When I am home again I will see. I keep you informed. <br />\n",
    "PostedDate": "2013-06-17T02:07:56.51-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1057671",
    "ThreadId": "447247",
    "Html": "The path seen by the FTP server is not necessarily the same as seen by the Web server.\r<br />\nYou can try to replace your file by another with the same name but very simple content and check that the Navigator happens to get it by following the link.\r<br />\nLink to search carefully: a '.' or ' /' forgotten or too change the deal, not to mention the configuration of the servers Web (DocumentRoot, aliases...)<br />\n",
    "PostedDate": "2013-06-17T04:43:19.927-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]