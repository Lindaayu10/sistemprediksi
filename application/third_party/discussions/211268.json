[
  {
    "Id": "437949",
    "ThreadId": "211268",
    "Html": "<p>Hello</p>\r\n<p>I'm new to programming and have written a few basic php scripts. This discussion name is probably trivial to everyone but I hope someone has patience to help.</p>\r\n<p>I'm wanting to view an excel spreadsheet in browser with intereaction but without using excel application. I am hoping this prog will help. Configuration is:</p>\r\n<p>Xampp distribution 1.7.3 on windows</p>\r\n<p>PHP v5.3.1</p>\r\n<p>I can see php__gd2.dll and php_zip.dll are included in \\xampp\\php\\ext directory which I assume means they are activated.</p>\r\n<p>I cannot see php_xml anywhere and I don't know where to find and install this extension. Could someone help me with this?</p>\r\n<p>&nbsp;</p>\r\n<p>When I run 01simple.php through browser&nbsp;I get:</p>\r\n<p>09:52:27 Create new PHPExcel object 09:52:27 Set properties 09:52:27 Add some data 09:52:27 Rename sheet 09:52:27 Write to Excel2007 format 09:52:28 Peak memory usage: 8.25 MB 09:52:28 Done writing file.</p>\r\n<p>So I assume that&nbsp;things are working.</p>\r\n<p>If someone could help with viewing a spreadsheet that would be appreciated. Is the prob that I do not have php_xml.dll extension?</p>\r\n<p>&nbsp;</p>\r\n<p>Many thanks</p>\r\n<p>Jeff</p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2010-05-01T18:48:56.373-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "438007",
    "ThreadId": "211268",
    "Html": "<blockquote style=\"border:solid .1em #ccc;font-style:italic;margin:.25em 1em 0 1em;padding:0 .25em 0 .25em\"><strong>jeffoz1 wrote:</strong><br>\r\n<p>I can see php__gd2.dll and php_zip.dll are included in \\xampp\\php\\ext directory which I assume means they are activated.</p>\r\n<p>I cannot see php_xml anywhere and I don't know where to find and install this extension. Could someone help me with this?</p>\r\n</blockquote>\r\n<p>The ext directory&nbsp;is simply a set of files that <strong><em>can be </em></strong>enabled within xampp. The php.ini file identifies those modules that <strong><em>are enabled</em></strong>.&nbsp;If you run a script comprising</p>\r\n<div style=\"color:black;background-color:white\">\r\n<pre>&lt;?php\r\nphpinfo();\r\n?&gt;\r\n</pre>\r\n</div>\r\n<p>then you can see a lot of information about your installation, including the location of the php.ini file. php.ini contains a set of entries like:</p>\r\n<div style=\"color:black;background-color:white\">\r\n<pre>extension=php_gd2.dll\r\n;extension=php_zip.dll\r\n</pre>\r\n</div>\r\n<p>The ; at the beginning of a line is a comment marker, so that second line extension=php_zip.dll indicates that the php_zip extension isn't enabled, but can be enabled by uncommenting the line (deleting the ; character and restarting apache).</p>\r\n<p>For a xampp 1.7.3 install, it should be enough to ensure that gd2 and zip aren't commented out, without worrying about xml which is included in the PHP build automatically.</p>\r\n<p>&nbsp;</p>\r\n<blockquote style=\"border:solid .1em #ccc;font-style:italic;margin:.25em 1em 0 1em;padding:0 .25em 0 .25em\"><strong>jeffoz1 wrote:</strong><br>\r\n<p>When I run 01simple.php through browser&nbsp;I get:</p>\r\n<p>09:52:27 Create new PHPExcel object 09:52:27 Set properties 09:52:27 Add some data 09:52:27 Rename sheet 09:52:27 Write to Excel2007 format 09:52:28 Peak memory usage: 8.25 MB 09:52:28 Done writing file.</p>\r\n<p>So I assume that&nbsp;things are working.</p>\r\n</blockquote>\r\n<p>&nbsp;01simple.php creates a file on the webserver, in the same directory as the script itself, so you can find the file there. If you unzipped PHPExcel to C:\\xampp\\htdocs\\PHPExcel, then look for 01simple.xlsx in C:\\xampp\\htdocs\\PHPExcel\\Tests</p>\r\n<p>01simple-download-xlsx.php shows how the file can be sent directly to the browser rather than simply stored on the web server.</p>",
    "PostedDate": "2010-05-02T03:06:05.653-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "438144",
    "ThreadId": "211268",
    "Html": "<p>Thank you for your response Mark.</p>\r\n<p>Yes i see that the file is saved and when I use 01simple-download-xlsx.php the file is available through browser. However it still asks for excel to open it.&nbsp;Is there a way that I can view the content without requiring excel? if so, is it possible for there to be some ability for user data input?</p>\r\n<p>Much appreciated</p>\r\n<p>Cheers</p>\r\n<p>Jeff</p>",
    "PostedDate": "2010-05-02T18:27:34.89-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "438242",
    "ThreadId": "211268",
    "Html": "<blockquote style=\"border:solid .1em #ccc;font-style:italic;margin:.25em 1em 0 1em;padding:0 .25em 0 .25em\"><strong>jeffoz1 wrote:</strong><br>\r\n<p>Yes i see that the file is saved and when I use 01simple-download-xlsx.php the file is available through browser. However it still asks for excel to open it.&nbsp;Is there a way that I can view the content without requiring excel? if so, is it possible for there to be some ability for user data input?</p>\r\n</blockquote>\r\n<p>You can use the HTML writer to&nbsp;write each worksheet&nbsp;in HTML format.</p>\r\n<p>We do not provide any form of data input... but you can take data&nbsp;from an HTML form and insert that into cells.</p>",
    "PostedDate": "2010-05-03T02:04:20.26-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "438422",
    "ThreadId": "211268",
    "Html": "<p>Thanks again</p>\r\n<p>Is&nbsp;it possible for the html to be written back to the php file. What I am hoping to achieve is for the input spreadsheet to be visible in browser when the the php reader is opened, and for the changes to be seen when input data is 'submit' from html&nbsp;form in same php file.</p>\r\n<p>Sorry if&nbsp;this not clear? essentially the end result is to be able to view a predefined excel spreadsheet in browser which can take user input from a form, and when submitted, for the result with calculations&nbsp;to be reflected in real time. This would save me lot of time in not having to hard code the spreadsheet in php&nbsp;from scratch and style it.</p>\r\n<p>I don't know enough php yet to see from the examples how this might be done.&nbsp;Is it possible to get $objWriter to&nbsp;echo the html without saving it?</p>\r\n<p>Cheers</p>\r\n<p>jeff</p>",
    "PostedDate": "2010-05-03T09:21:00.88-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "438428",
    "ThreadId": "211268",
    "Html": "<blockquote style=\"border:solid .1em #ccc;font-style:italic;margin:.25em 1em 0 1em;padding:0 .25em 0 .25em\"><strong>jeffoz1 wrote:</strong><br>\r\n<p>Thanks again</p>\r\n<p>Is&nbsp;it possible for the html to be written back to the php file. What I am hoping to achieve is for the input spreadsheet to be visible in browser when the the php reader is opened, and for the changes to be seen when input data is 'submit' from html&nbsp;form in same php file.</p>\r\n<p>Sorry if&nbsp;this not clear? essentially the end result is to be able to view a predefined excel spreadsheet in browser which can take user input from a form, and when submitted, for the result with calculations&nbsp;to be reflected in real time. This would save me lot of time in not having to hard code the spreadsheet in php&nbsp;from scratch and style it.</p>\r\n<p>I don't know enough php yet to see from the examples how this might be done.&nbsp;Is it possible to get $objWriter to&nbsp;echo the html without saving it?</p>\r\n</blockquote>\r\n<p>If you want an HTML page that's editable as though it were a spreadsheet, then you're better off looking at Google Docs.... Google have large, fully paid teams of developers&nbsp; working on that.</p>\r\n<p>What you want is possible, but not without a lot of work on your part, and a good working knowledge of HTML/CSS/javascript. The following gives some indication of how it might work, but doesn't do all you want, and isn't production quality code.</p>\r\n<div style=\"color:black;background-color:white\">\r\n<pre>&lt;?php\r\n\r\n<span style=\"color:green\">/**\tError reporting\t\t**/</span>\r\nerror_reporting(E_ALL);\r\n\r\n\r\n<span style=\"color:green\">/**\tInclude path\t\t**/</span>\r\nset_include_path(get_include_path() . PATH_SEPARATOR . <span style=\"color:#a31515\">'PHPExcel_NewCalc/Classes/'</span>);\r\n\r\n\r\n$maxRow = 12;\r\n$maxCol = <span style=\"color:#a31515\">'F'</span>;\r\n\r\n\r\n$maxCol++;\r\n\r\n<span style=\"color:green\">/**\tIf the user has submitted the form, then we need to execute a calculation **/</span>\r\n<span style=\"color:blue\">if</span> (<span style=\"color:blue\">isset</span>($_POST[<span style=\"color:#a31515\">'submit'</span>])) {\r\n\t<span style=\"color:green\">/**\tSo we include PHPExcel to perform the calculations\t**/</span>\r\n\t<span style=\"color:blue\">include</span>(<span style=\"color:#a31515\">'PHPExcel.php'</span>);\r\n\r\n\t<span style=\"color:green\">/**\tAnd instantiate a new workbook in memory\t\t\t**/</span>\r\n\t$objPHPExcel = <span style=\"color:blue\">new</span> PHPExcel();\r\n\t$objPHPExcel-&gt;setActiveSheetIndex(0);\r\n}\r\n\r\n<span style=\"color:green\">/**\tSet values for each cell in the grid\t**/</span>\r\n<span style=\"color:blue\">for</span> ($column = <span style=\"color:#a31515\">'A'</span>; $column != $maxCol; ++$column) {\r\n\t<span style=\"color:blue\">for</span> ($row = 1; $row &lt;= $maxRow; ++$row) {\r\n\t\t$cellRef = $column.$row;\r\n\t\t$cellValueID = $cellRef.<span style=\"color:#a31515\">'_hidden'</span>;\r\n\t\t$cellCalcID = $cellRef.<span style=\"color:#a31515\">'_display'</span>;\r\n\t\t<span style=\"color:green\">//\tSet value in the form for redisplay</span>\r\n\t\t$$cellCalcID = $$cellValueID = (<span style=\"color:blue\">isset</span>($_POST[$cellValueID])) ? html_entity_decode($_POST[$cellValueID],ENT_QUOTES,<span style=\"color:#a31515\">'UTF-8'</span>) : <span style=\"color:#a31515\">''</span>;\r\n\t\t<span style=\"color:blue\">if</span> (get_magic_quotes_gpc()) { $$cellCalcID = stripcslashes($$cellCalcID); }\r\n\t\t<span style=\"color:blue\">if</span> (get_magic_quotes_gpc()) { $$cellValueID = stripcslashes($$cellValueID); }\r\n\t\t<span style=\"color:green\">/**\tIf the user has submitted the form, we populate the workbook as well\t**/</span>\r\n\t\t<span style=\"color:blue\">if</span> (<span style=\"color:blue\">isset</span>($_POST[<span style=\"color:#a31515\">'submit'</span>])) {\r\n\t\t\t<span style=\"color:green\">/**\tSet value in the worksheet for calculation\t**/</span>\r\n\t\t\t<span style=\"color:blue\">if</span> (is_numeric($$cellValueID)) { $$cellValueID = (float) $$cellValueID; }\r\n\t\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue($cellRef, $$cellValueID);\r\n\t\t}\r\n\t}\r\n}\r\n\r\n<span style=\"color:green\">/**\tPerform any calculations set in the grid\t**/</span>\r\n<span style=\"color:blue\">if</span> (<span style=\"color:blue\">isset</span>($_POST[<span style=\"color:#a31515\">'submit'</span>])) {\r\n\t<span style=\"color:green\">/**\tSet values for each cell in the grid\t**/</span>\r\n\t<span style=\"color:blue\">for</span> ($column = <span style=\"color:#a31515\">'A'</span>; $column != $maxCol; ++$column) {\r\n\t\t<span style=\"color:blue\">for</span> ($row = 1; $row &lt;= $maxRow; ++$row) {\r\n\t\t\t$cellRef = $column.$row;\r\n\t\t\t$cellCalcID = $cellRef.<span style=\"color:#a31515\">'_display'</span>;\r\n\t\t\t$$cellCalcID = $objPHPExcel-&gt;getActiveSheet()-&gt;getCell($cellRef)-&gt;getCalculatedValue();\r\n\t\t\t<span style=\"color:blue\">if</span> (is_bool($$cellCalcID)) {\r\n\t\t\t\t$$cellCalcID = ($$cellCalcID) ? <span style=\"color:#a31515\">'TRUE'</span> : <span style=\"color:#a31515\">'FALSE'</span>;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n$focusedCell = (<span style=\"color:blue\">isset</span>($_POST[<span style=\"color:#a31515\">'editingID'</span>])) ? $_POST[<span style=\"color:#a31515\">'editingID'</span>] : <span style=\"color:#a31515\">'A1'</span>;\r\n\r\n?&gt;\r\n&lt;html&gt;\r\n&lt;head&gt;\r\n&lt;meta http-equiv=<span style=\"color:#a31515\">&quot;Content-Type&quot;</span> content=<span style=\"color:#a31515\">&quot;text/html; charset=UTF-8&quot;</span> /&gt;\r\n\r\n&lt;title&gt;Worksheet Calculator&lt;/title&gt;\r\n\r\n&lt;style type=<span style=\"color:#a31515\">&quot;text/css&quot;</span>&gt;\r\n\t.unfocusedCell\t{ border-width: 1; border-style: solid; border-color: darkgrey; }\r\n\t.focusedCell\t{ border-width: 1; border-style: solid; border-color: red; }\r\n\t.cellTextBox\t{ border-width: 0; border-style: none; border-color: white; }\r\n\t.columnHeading\t{ border-width: 1; border-style: solid; border-color: darkgrey; background-color: silver; text-align: center; font-weight: bold; }\r\n\t.rowHeading\t\t{ border-width: 1; border-style: solid; border-color: darkgrey; background-color: silver; text-align: right; font-weight: bold; }\r\n&lt;/style&gt;\r\n\r\n&lt;script language=javascript type=<span style=\"color:#a31515\">'text/javascript'</span>&gt;\r\n\t<span style=\"color:blue\">var</span> currentCell = <span style=\"color:#a31515\">''</span>;\r\n\t<span style=\"color:blue\">var</span> currentCellValue = <span style=\"color:#a31515\">''</span>;\r\n\t<span style=\"color:blue\">var</span> currentCellCalcValue = <span style=\"color:#a31515\">''</span>;\r\n\t<span style=\"color:blue\">var</span> cellHasChanged = false;\r\n\r\n\t<span style=\"color:blue\">function</span> clearCellFocus() {\r\n\t\t<span style=\"color:blue\">if</span> (currentCell != <span style=\"color:#a31515\">''</span>) {\r\n\t\t\t<span style=\"color:blue\">var</span> previousCellName = currentCell+<span style=\"color:#a31515\">&quot;_hidden&quot;</span>;\r\n\t\t\t<span style=\"color:blue\">var</span> previousCell = document.getElementById(previousCellName);\r\n\t\t\tpreviousCell.parentNode.className = <span style=\"color:#a31515\">'unfocusedCell'</span>;\r\n\r\n\t\t\tcurrentCell = <span style=\"color:#a31515\">''</span>;\r\n\t\t\tcurrentCellValue = <span style=\"color:#a31515\">''</span>;\r\n\t\t\tcurrentCellCalcValue = <span style=\"color:#a31515\">''</span>;\r\n\r\n\t\t\t<span style=\"color:blue\">var</span> editingCellDest = document.getElementById(<span style=\"color:#a31515\">&quot;editingID&quot;</span>);\r\n\t\t\t<span style=\"color:blue\">var</span> editingValueDest = document.getElementById(<span style=\"color:#a31515\">&quot;editingValue&quot;</span>);\r\n\t\t\teditingCellDest.value = <span style=\"color:#a31515\">''</span>;\r\n\t\t\teditingValueDest.value = <span style=\"color:#a31515\">''</span>;\r\n\t\t}\r\n\t}\r\n\r\n\t<span style=\"color:blue\">function</span> setCellFocus(cellID) {\r\n\t\t<span style=\"color:blue\">var</span> newCellName = cellID+<span style=\"color:#a31515\">&quot;_hidden&quot;</span>;\r\n\t\t<span style=\"color:blue\">var</span> newCell = document.getElementById(newCellName);\r\n\t\tnewCell.parentNode.className = <span style=\"color:#a31515\">'focusedCell'</span>;\r\n\r\n\t\t<span style=\"color:blue\">var</span> dataSourceName = cellID+<span style=\"color:#a31515\">&quot;_hidden&quot;</span>;\r\n\t\t<span style=\"color:blue\">var</span> dataSource = document.getElementById(dataSourceName);\r\n\t\t<span style=\"color:blue\">var</span> dataValueName = cellID+<span style=\"color:#a31515\">&quot;_display&quot;</span>;\r\n\t\t<span style=\"color:blue\">var</span> dataValue = document.getElementById(dataValueName);\r\n\r\n\t\tcurrentCell = cellID;\r\n\t\tcurrentCellValue = dataSource.value;\r\n\t\tcurrentCellCalcValue = dataValue.value;\r\n\r\n\t\t<span style=\"color:blue\">var</span> editingCellDest = document.getElementById(<span style=\"color:#a31515\">&quot;editingID&quot;</span>);\r\n\t\t<span style=\"color:blue\">var</span> editingValueDest = document.getElementById(<span style=\"color:#a31515\">&quot;editingValue&quot;</span>);\r\n\t\teditingCellDest.value = cellID;\r\n\t\teditingValueDest.value = dataSource.value;\r\n\t}\r\n\r\n\t<span style=\"color:blue\">function</span> displayCellFocus(cellID) {\r\n\t\t<span style=\"color:blue\">var</span> displayCellName = cellID+<span style=\"color:#a31515\">&quot;_display&quot;</span>;\r\n\t\t<span style=\"color:blue\">var</span> displayCell = document.getElementById(displayCellName);\r\n\t\tdisplayCell.focus();\r\n\t}\r\n\r\n\t<span style=\"color:blue\">function</span> editCell(cellID) {\r\n\t\tclearCellFocus();\r\n\t\tsetCellFocus(cellID);\r\n\t}\r\n\r\n\t<span style=\"color:blue\">function</span> changeCellFromEditor(e) {\r\n\t\t<span style=\"color:blue\">var</span> keyCode = e.keyCode;\r\n\r\n\t\t<span style=\"color:blue\">if</span> (currentCell != <span style=\"color:#a31515\">''</span>) {\r\n\t\t\t<span style=\"color:blue\">if</span> ((keyCode == 16) || (keyCode == 44) || (keyCode == 17) ||\t\t<span style=\"color:green\">//\tSHIFT, SYS REQ, CONTROL or ALT GR</span>\r\n\t\t\t\t(keyCode == 20) || (keyCode == 144) || (keyCode == 145) ||\t\t<span style=\"color:green\">//\tCAPS LOCK, NUM LOCK, SCROLL LOCK</span>\r\n\t\t\t\t(keyCode == 45) || (keyCode == 46) ||\t\t\t\t\t\t\t<span style=\"color:green\">//\tINSERT, DELETE</span>\r\n\t\t\t\t(keyCode == 36) || (keyCode == 35) ||\t\t\t\t\t\t\t<span style=\"color:green\">//\tHOME, END</span>\r\n\t\t\t\t(keyCode == 33) || (keyCode == 34) ||\t\t\t\t\t\t\t<span style=\"color:green\">//\tPAGE UP, PAGE DOWN</span>\r\n\t\t\t\t(keyCode == 38) || (keyCode == 40) ||\t\t\t\t\t\t\t<span style=\"color:green\">//\tUP ARROW, DOWN ARROW</span>\r\n\t\t\t\t(keyCode == 39) || (keyCode == 37) ||\t\t\t\t\t\t\t<span style=\"color:green\">//\tRIGHT ARROW, LEFT ARROW</span>\r\n\t\t\t\t(keyCode == 18) || (keyCode == 19) ||\t\t\t\t\t\t\t<span style=\"color:green\">//\tALT, PAUSE/BREAK</span>\r\n\t\t\t\t(keyCode == 91) || (keyCode == 92)\t\t\t\t\t\t\t\t<span style=\"color:green\">//\tWINDOWS LEFT, WINDOWS RIGHT</span>\r\n<span style=\"color:green\">//\t93\tSELECT</span>\r\n<span style=\"color:green\">//\t112 - 123\tF1 - F12</span>\r\n\t\t\t\t) {\r\n\t\t\t\tnull;\r\n\t\t\t} <span style=\"color:blue\">else</span> <span style=\"color:blue\">if</span> ((keyCode == 9) || (keyCode == 13)) {\t\t<span style=\"color:green\">//\tTAB or ENTER</span>\r\n\t\t\t\trefreshForm();\r\n\t\t\t} <span style=\"color:blue\">else</span> <span style=\"color:blue\">if</span> (keyCode == 27) {\t\t\t\t\t\t\t<span style=\"color:green\">//\tESCAPE</span>\r\n\t\t\t\t<span style=\"color:blue\">var</span> editingValue = document.getElementById(<span style=\"color:#a31515\">&quot;editingValue&quot;</span>);\r\n\t\t\t\t<span style=\"color:blue\">var</span> cellValueName = currentCell+<span style=\"color:#a31515\">&quot;_hidden&quot;</span>;\r\n\t\t\t\t<span style=\"color:blue\">var</span> cellValue = document.getElementById(cellValueName);\r\n\t\t\t\tcellValue.value = currentCellValue;\r\n\t\t\t\t<span style=\"color:blue\">var</span> cellDisplayName = currentCell+<span style=\"color:#a31515\">&quot;_display&quot;</span>;\r\n\t\t\t\t<span style=\"color:blue\">var</span> cellDisplayValue = document.getElementById(cellDisplayName);\r\n\t\t\t\tcellDisplayValue.value = currentCellCalcValue;\r\n\t\t\t\tclearCellFocus();\r\n\t\t\t\tcellHasChanged = false;\r\n\t\t\t} <span style=\"color:blue\">else</span> {\r\n\t\t\t\t<span style=\"color:blue\">var</span> editingValue = document.getElementById(<span style=\"color:#a31515\">&quot;editingValue&quot;</span>);\r\n\t\t\t\t<span style=\"color:blue\">var</span> cellValueName = currentCell+<span style=\"color:#a31515\">&quot;_hidden&quot;</span>;\r\n\t\t\t\t<span style=\"color:blue\">var</span> cellValue = document.getElementById(cellValueName);\r\n\t\t\t\tcellValue.value = editingValue.value;\r\n\t\t\t\t<span style=\"color:blue\">var</span> cellDisplayName = currentCell+<span style=\"color:#a31515\">&quot;_display&quot;</span>;\r\n\t\t\t\t<span style=\"color:blue\">var</span> cellDisplayValue = document.getElementById(cellDisplayName);\r\n\t\t\t\tcellDisplayValue.value = editingValue.value;\r\n\t\t\t\t<span style=\"color:blue\">if</span> (cellValue.value !== currentCellCalcValue) {\r\n\t\t\t\t\tcellHasChanged = true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t<span style=\"color:blue\">function</span> changeCellFromCell(e) {\r\n\t\t<span style=\"color:blue\">var</span> keyCode = e.keyCode;\r\n\r\n\t\t<span style=\"color:blue\">if</span> (currentCell != <span style=\"color:#a31515\">''</span>) {\r\n\t\t\t<span style=\"color:blue\">if</span> ((keyCode == 16) || (keyCode == 44) || (keyCode == 17) ||\t\t<span style=\"color:green\">//\tSHIFT, SYS REQ, CONTROL or ALT GR</span>\r\n\t\t\t\t(keyCode == 20) || (keyCode == 144) || (keyCode == 145) ||\t\t<span style=\"color:green\">//\tCAPS LOCK, NUM LOCK, SCROLL LOCK</span>\r\n\t\t\t\t(keyCode == 45) || (keyCode == 46) ||\t\t\t\t\t\t\t<span style=\"color:green\">//\tINSERT, DELETE</span>\r\n\t\t\t\t(keyCode == 36) || (keyCode == 35) ||\t\t\t\t\t\t\t<span style=\"color:green\">//\tHOME, END</span>\r\n\t\t\t\t(keyCode == 33) || (keyCode == 34) ||\t\t\t\t\t\t\t<span style=\"color:green\">//\tPAGE UP, PAGE DOWN</span>\r\n\t\t\t\t(keyCode == 38) || (keyCode == 40) ||\t\t\t\t\t\t\t<span style=\"color:green\">//\tUP ARROW, DOWN ARROW</span>\r\n\t\t\t\t(keyCode == 39) || (keyCode == 37) ||\t\t\t\t\t\t\t<span style=\"color:green\">//\tRIGHT ARROW, LEFT ARROW</span>\r\n\t\t\t\t(keyCode == 18) || (keyCode == 19) ||\t\t\t\t\t\t\t<span style=\"color:green\">//\tALT, PAUSE/BREAK</span>\r\n\t\t\t\t(keyCode == 91) || (keyCode == 92)\t\t\t\t\t\t\t\t<span style=\"color:green\">//\tWINDOWS LEFT, WINDOWS RIGHT</span>\r\n\t\t\t\t) {\r\n\t\t\t\tnull;\r\n\t\t\t} <span style=\"color:blue\">else</span> <span style=\"color:blue\">if</span> ((keyCode == 9) || (keyCode == 13)) {\t\t<span style=\"color:green\">//\tTAB or ENTER</span>\r\n\t\t\t\trefreshForm();\r\n\t\t\t} <span style=\"color:blue\">else</span> <span style=\"color:blue\">if</span> (keyCode == 27) {\t\t\t\t\t\t\t<span style=\"color:green\">//\tESCAPE</span>\r\n\t\t\t\t<span style=\"color:blue\">var</span> editingValue = document.getElementById(<span style=\"color:#a31515\">&quot;editingValue&quot;</span>);\r\n\t\t\t\t<span style=\"color:blue\">var</span> cellValueName = currentCell+<span style=\"color:#a31515\">&quot;_hidden&quot;</span>;\r\n\t\t\t\t<span style=\"color:blue\">var</span> cellValue = document.getElementById(cellValueName);\r\n\t\t\t\tcellValue.value = currentCellValue;\r\n\t\t\t\t<span style=\"color:blue\">var</span> cellDisplayName = currentCell+<span style=\"color:#a31515\">&quot;_display&quot;</span>;\r\n\t\t\t\t<span style=\"color:blue\">var</span> cellDisplayValue = document.getElementById(cellDisplayName);\r\n\t\t\t\tcellDisplayValue.value = currentCellCalcValue;\r\n\t\t\t\teditCell(currentCell);\r\n\t\t\t\tcellHasChanged = false;\r\n\t\t\t} <span style=\"color:blue\">else</span> {\r\n\t\t\t\t<span style=\"color:blue\">var</span> editingValue = document.getElementById(<span style=\"color:#a31515\">&quot;editingValue&quot;</span>);\r\n\t\t\t\t<span style=\"color:blue\">var</span> cellDisplayName = currentCell+<span style=\"color:#a31515\">&quot;_display&quot;</span>;\r\n\t\t\t\t<span style=\"color:blue\">var</span> cellDisplayValue = document.getElementById(cellDisplayName);\r\n\t\t\t\teditingValue.value = cellDisplayValue.value;\r\n\t\t\t\t<span style=\"color:blue\">var</span> cellValueName = currentCell+<span style=\"color:#a31515\">&quot;_hidden&quot;</span>;\r\n\t\t\t\t<span style=\"color:blue\">var</span> cellValue = document.getElementById(cellValueName);\r\n\t\t\t\tcellValue.value = cellDisplayValue.value;\r\n\t\t\t\t<span style=\"color:blue\">if</span> (cellDisplayValue.value !== currentCellCalcValue) {\r\n\t\t\t\t\tcellHasChanged = true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t<span style=\"color:blue\">function</span> refreshForm() {\r\n\t\tdisplayCellFocus(currentCell);\r\n\t\t<span style=\"color:blue\">if</span> (cellHasChanged) {\r\n\t\t\t<span style=\"color:blue\">var</span> cellGrid = document.getElementById(<span style=\"color:#a31515\">&quot;cellGrid&quot;</span>);\r\n\t\t\tcellGrid.submit.click();\r\n\t\t}\r\n\t}\r\n&lt;/script&gt;\r\n&lt;/head&gt;\r\n&lt;body&gt;\r\n&lt;!--\tDisplay the Form\t--&gt;\r\n\r\n&lt;form id=<span style=\"color:#a31515\">&quot;cellGrid&quot;</span> action=<span style=\"color:#a31515\">&quot;gridCalculator.php&quot;</span> method=<span style=\"color:#a31515\">&quot;post&quot;</span>&gt;\r\n\t&lt;b&gt;Cell ID:&lt;/b&gt; &lt;input id=<span style=\"color:#a31515\">&quot;editingID&quot;</span> name=<span style=\"color:#a31515\">&quot;editingID&quot;</span> type=<span style=\"color:#a31515\">&quot;text&quot;</span> size=<span style=\"color:#a31515\">&quot;6&quot;</span> readonly tabIndex=<span style=\"color:#a31515\">&quot;99999&quot;</span> /&gt;\r\n\t&lt;b&gt;Cell Value:&lt;/b&gt; &lt;input id=<span style=\"color:#a31515\">&quot;editingValue&quot;</span> name=<span style=\"color:#a31515\">&quot;editingValue&quot;</span> type=<span style=\"color:#a31515\">&quot;text&quot;</span> size=<span style=\"color:#a31515\">&quot;40&quot;</span> onKeyUp=<span style=\"color:#a31515\">&quot;javascript:changeCellFromEditor(event);&quot;</span> onBlur=<span style=\"color:#a31515\">&quot;javascript:refreshForm()&quot;</span> tabIndex=<span style=\"color:#a31515\">&quot;99998&quot;</span> /&gt;\r\n\r\n\t&lt;table border=<span style=\"color:#a31515\">&quot;0&quot;</span> cellpadding=<span style=\"color:#a31515\">&quot;0&quot;</span> cellspacing=<span style=\"color:#a31515\">&quot;0&quot;</span>&gt;\r\n\t\t&lt;tr&gt;&lt;td <span style=\"color:blue\">class</span>=<span style=\"color:#a31515\">&quot;columnHeading&quot;</span>&gt;&amp;nbsp;&lt;/td&gt;\r\n&lt;?php\r\n\r\n<span style=\"color:blue\">for</span> ($column = <span style=\"color:#a31515\">'A'</span>; $column != $maxCol; $column++) {\r\n\t<span style=\"color:blue\">echo</span> <span style=\"color:#a31515\">'\t\t\t&lt;td class=&quot;columnHeading&quot;&gt;'</span>.$column.<span style=\"color:#a31515\">'&lt;/td&gt;'</span>.PHP_EOL;\r\n}\r\n<span style=\"color:blue\">echo</span> <span style=\"color:#a31515\">'\t\t&lt;/tr&gt;'</span>.PHP_EOL;\r\n\r\n<span style=\"color:blue\">for</span> ($row = 1; $row &lt;= $maxRow; ++$row) {\r\n\t<span style=\"color:blue\">echo</span> <span style=\"color:#a31515\">'\t\t&lt;tr&gt;&lt;td class=&quot;rowHeading&quot;&gt;&amp;nbsp;'</span>.$row.<span style=\"color:#a31515\">'&amp;nbsp;&lt;/td&gt;'</span>.PHP_EOL;\r\n\t<span style=\"color:blue\">for</span> ($column = <span style=\"color:#a31515\">'A'</span>; $column != $maxCol; ++$column) {\r\n\t\t$cellRef = $column.$row;\r\n\t\t$cellValueID = $cellRef.<span style=\"color:#a31515\">'_hidden'</span>;\r\n\t\t$cellCalcID = $cellRef.<span style=\"color:#a31515\">'_display'</span>;\r\n\t\t<span style=\"color:blue\">if</span> ($cellRef == $focusedCell) {\r\n\t\t\t<span style=\"color:blue\">echo</span> <span style=\"color:#a31515\">'\t\t\t&lt;td class=&quot;focusedCell&quot;&gt;'</span>;\r\n\t\t} <span style=\"color:blue\">else</span> {\r\n\t\t\t<span style=\"color:blue\">echo</span> <span style=\"color:#a31515\">'\t\t\t&lt;td class=&quot;unfocusedCell&quot;&gt;'</span>;\r\n\t\t}\r\n\t\t<span style=\"color:blue\">echo</span> <span style=\"color:#a31515\">'\t\t\t\t&lt;input name=&quot;'</span>.$cellValueID.<span style=\"color:#a31515\">'&quot; id=&quot;'</span>.$cellValueID.<span style=\"color:#a31515\">'&quot; type=&quot;hidden&quot; value=&quot;'</span>.htmlentities($$cellValueID).<span style=\"color:#a31515\">'&quot; /&gt;'</span>;\r\n\t\t<span style=\"color:blue\">echo</span> <span style=\"color:#a31515\">'\t\t\t\t&lt;input class=&quot;cellTextBox&quot; name=&quot;'</span>.$cellCalcID.<span style=\"color:#a31515\">'&quot; id=&quot;'</span>.$cellCalcID.<span style=\"color:#a31515\">'&quot; type=&quot;text&quot; size=&quot;14&quot; value=&quot;'</span>.htmlentities($$cellCalcID).<span style=\"color:#a31515\">'&quot; onKeyUp=&quot;javascript:changeCellFromCell(event);&quot; onFocus=&quot;javascript:editCell(\\''</span>.$cellRef.<span style=\"color:#a31515\">'\\');&quot; /&gt;'</span>;\r\n\t\t<span style=\"color:blue\">echo</span> <span style=\"color:#a31515\">'\t\t\t&lt;/td&gt;'</span>.PHP_EOL;\r\n\t}\r\n\t<span style=\"color:blue\">echo</span> <span style=\"color:#a31515\">'\t\t&lt;/tr&gt;'</span>.PHP_EOL;\r\n}\r\n\r\n?&gt;\r\n\t&lt;/table&gt;\r\n\t&lt;br /&gt;&lt;input name=<span style=\"color:#a31515\">&quot;submit&quot;</span> type=<span style=\"color:#a31515\">&quot;submit&quot;</span> value=<span style=\"color:#a31515\">&quot;calculate&quot;</span>&gt;\r\n&lt;/form&gt;\r\n\r\n\r\n&lt;script language=javascript type=<span style=\"color:#a31515\">'text/javascript'</span>&gt;\r\n\tsetCellFocus(<span style=\"color:#a31515\">'&lt;?php echo (isset($_POST['</span>editingID<span style=\"color:#a31515\">'])) ? $_POST['</span>editingID<span style=\"color:#a31515\">'] : '</span>A1<span style=\"color:#a31515\">'; ?&gt;'</span>);\r\n\tdisplayCellFocus(currentCell);\r\n&lt;/script&gt;\r\n\r\n&lt;/body&gt;\r\n&lt;/html&gt;\r\n\r\n</pre>\r\n</div>",
    "PostedDate": "2010-05-03T09:33:32.793-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "438445",
    "ThreadId": "211268",
    "Html": "<p>Yes i see. Well I will certainly play with what you have sent me. I'll check google docs out and see what it can do.</p>\r\n<p>thanks again</p>\r\n<p>Cheers</p>\r\n<p>jeff</p>",
    "PostedDate": "2010-05-03T10:23:42.123-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]