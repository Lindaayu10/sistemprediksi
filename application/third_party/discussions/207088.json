[
  {
    "Id": "422819",
    "ThreadId": "207088",
    "Html": "<p>I looked through the discussions to see if some reported this already, since it seems that someone would have run into this already. This is what I have from IOFactory.php:</p>\r\n<p style=\"padding-left:30px\">switch (strtolower($pathinfo['extension'])) {</p>\r\n<p style=\"padding-left:30px\">&nbsp;</p>\r\n<p style=\"padding-left:30px\">case 'xlsx': \t\t\t\t\t$reader = self::createReader('Excel2007'); \t\t\t\t\tbreak;</p>\r\n<p style=\"padding-left:30px\">case 'xls': \t\t\t\t\t$reader = self::createReader('Excel5'); \t\t\t\t\tbreak;</p>\r\n<p style=\"padding-left:30px\">case 'ods': \t\t\t\t\t$reader = self::createReader('OOCalc'); \t\t\t\t\tbreak;</p>\r\n<p style=\"padding-left:30px\">case 'slk': \t\t\t\t\t$reader = self::createReader('SYLK'); \t\t\t\t\tbreak;</p>\r\n<p style=\"padding-left:30px\">case 'xml': \t\t\t\t\t$reader = self::createReader('Excel2003XML'); \t\t\t\t\tbreak;</p>\r\n<p style=\"padding-left:30px\">case 'csv': \t\t\t\t\tbreak;</p>\r\n<p style=\"padding-left:30px\">default: \t\t\t\t\tbreak; \t\t\t}</p>\r\n<p style=\"padding-left:30px\">if ($reader-&gt;canRead($pFilename)) { \t\t\t\treturn $reader; \t\t\t}</p>\r\n<p style=\"padding-left:30px\">&nbsp;</p>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\"><span style=\"white-space:pre\"> </span>switch (strtolower($pathinfo['extension'])) {</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\"><span style=\"white-space:pre\"> </span>case 'xlsx':</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\"><span style=\"white-space:pre\"> </span>$reader = self::createReader('Excel2007');</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\"><span style=\"white-space:pre\"> </span>break;</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\"><span style=\"white-space:pre\"> </span>case 'xls':</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\"><span style=\"white-space:pre\"> </span>$reader = self::createReader('Excel5');</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\"><span style=\"white-space:pre\"> </span>break;</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\"><span style=\"white-space:pre\"> </span>case 'ods':</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\"><span style=\"white-space:pre\"> </span>$reader = self::createReader('OOCalc');</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\"><span style=\"white-space:pre\"> </span>break;</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\"><span style=\"white-space:pre\"> </span>case 'slk':</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\"><span style=\"white-space:pre\"> </span>$reader = self::createReader('SYLK');</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\"><span style=\"white-space:pre\"> </span>break;</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\"><span style=\"white-space:pre\"> </span>case 'xml':</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\"><span style=\"white-space:pre\"> </span>$reader = self::createReader('Excel2003XML');</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\"><span style=\"white-space:pre\"> </span>break;</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\"><span style=\"white-space:pre\"> </span>case 'csv':</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\"><span style=\"white-space:pre\"> </span>// Do nothing</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\"><span style=\"white-space:pre\"> </span>// We must not try to use CSV reader since it loads</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\"><span style=\"white-space:pre\"> </span>// all files including Excel files etc.</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\"><span style=\"white-space:pre\"> </span>break;</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\"><span style=\"white-space:pre\"> </span>default:</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\"><span style=\"white-space:pre\"> </span>break;</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\"><span style=\"white-space:pre\"> </span>}</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\"><span style=\"white-space:pre\"> </span>// Let's see if we are lucky</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\"><span style=\"white-space:pre\"> </span>if ($reader-&gt;canRead($pFilename)) {</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\"><span style=\"white-space:pre\"> </span>return $reader;</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\"><span style=\"white-space:pre\"> </span>}</div>\r\n<p>The problem is that if the extension is either .csv or isn't any of the above that create a reader then the reader won't be the appropriate object. Am I missing something here? I'm surprised that no one has run into this already. I don't have a good grasp of the code but it seems that the check should only occur if reader is actually an object. Inserting a $reader = false at the top of the function and then doing:</p>\r\n<p>if( $reader &amp;&amp; $reader-&gt;canRead) &nbsp;should fix the problem...</p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2010-03-23T16:38:15.653-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "423305",
    "ThreadId": "207088",
    "Html": "<p>Thanks for pointing this out.</p>\r\n<p>This fix has actually been made in the latest SVN code</p>",
    "PostedDate": "2010-03-24T16:35:15.957-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]