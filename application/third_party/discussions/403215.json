[
  {
    "Id": "941767",
    "ThreadId": "403215",
    "Html": "\r\n<p>Hi,</p>\r\n<p>I am using PHPExcel_Writer to write some data from a database into a spreadsheet for the user to edit. User downloads this spreadsheet from my website, fills it in and uploads the filled file onto the website.&nbsp; The file is then read by the server code\r\n using PHPExcel_Reader.&nbsp;</p>\r\n<p>The original spreadsheet contains 3 worksheets: first is editable by user; second and third are hidden.&nbsp; The second worksheet contains named ranges that correspond to database values (some contain special characters such as single quotes or commas).&nbsp;\r\n The third worksheet contains a hidden database identifier.</p>\r\n<p>The template can be downloaded and opened on the user's workstation just fine (tested on CentOS LibreOffice, Excel 2007&#43;2010 on Windows, and Excel 2008&#43;2011 on Mac).&nbsp;</p>\r\n<p>HOWEVER, after the sheet is saved, the following problems occur with LibreOffice and Excel2007 and 2008:</p>\r\n<p>1. If the file is saved on the user's workstation, filled, saved, closed (exit Excel) and reopened, the named ranges references are lost in LibreOffice on CentOS 6.2.</p>\r\n<p>2. The completed workbook can be uploaded onto the server BUT is not read by&nbsp; PHPExcel_Reader\r\n<strong>IFF Excel 2007 (win) or 2008 (mac) were used for editing</strong>:</p>\r\n<p>Code:</p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre>$objReader = PHPExcel_IOFactory::createReader(<span style=\"color:#a31515\">'Excel2007'</span>);<br><br>// alternatively, can use this - also works<br>// $objReader = new PHPExcel_Reader_Excel2007(); // this works too<br><br>$objReader-&gt;setReadDataOnly(true);\n\n$filename = $_FILES[<span style=\"color:#a31515\">&quot;my_file&quot;</span>][<span style=\"color:#a31515\">&quot;name&quot;</span>];\n\n$uploaddir = <span style=\"color:#a31515\">'mydir/'</span>;\n$uploadfile = $uploaddir . $filename;\n\n<span style=\"color:blue\">if</span> (move_uploaded_file($_FILES[<span style=\"color:#a31515\">&quot;my_file&quot;</span>][<span style=\"color:#a31515\">&quot;tmp_name&quot;</span>], $uploadfile))\n{\n       <span style=\"color:green\">// THIS WORKS FOR ALL</span>\n       <span style=\"color:blue\">echo</span> <span style=\"color:#a31515\">&quot;File is valid, and was successfully uploaded.\\n&quot;</span>;\n       <span style=\"color:blue\">echo</span> <span style=\"color:#a31515\">&quot;&lt;a href='&quot;</span> . $uploadfile . <span style=\"color:#a31515\">&quot;'&gt;file&quot;</span>;\n\n       <span style=\"color:blue\">try</span>\n       {\n               <span style=\"color:green\">// THIS WORKS</span>\n               $objPHPExcel = $objReader-&gt;load($uploadfile);\n\n               <span style=\"color:green\">// THIS FAILS ON EXCEL 2007 AND 2008, WORKS ON 2010</span>\n               $sheets = $objPHPExcel-&gt;getAllSheets();\n\n               $objWorksheet = $sheets[0];     <span style=\"color:green\">// NULL ON EXCEL 2007 AND 2008</span>\n       }<br>&nbsp;}\n</pre>\r\n</div>\r\n<p>Any help is appreciated!</p>\r\n",
    "PostedDate": "2012-11-14T11:25:26.793-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]