[
  {
    "Id": "558912",
    "ThreadId": "244194",
    "Html": "\r\n<p><span id=\"x_result_box\" lang=\"en\"><span title=\"Haz clic para obtener traducciones alternativas\">Hi</span><span title=\"Haz clic para obtener traducciones alternativas\">,</span>\r\n<span title=\"Haz clic para obtener traducciones alternativas\">I'm with</span> <span title=\"Haz clic para obtener traducciones alternativas\">\r\na</span> <span title=\"Haz clic para obtener traducciones alternativas\">problem I can not</span>\r\n<span title=\"Haz clic para obtener traducciones alternativas\">solve</span><span title=\"Haz clic para obtener traducciones alternativas\">.</span><br>\r\n<span title=\"Haz clic para obtener traducciones alternativas\">I have</span> <span title=\"Haz clic para obtener traducciones alternativas\">\r\nan</span> <span title=\"Haz clic para obtener traducciones alternativas\">excel</span>\r\n<span title=\"Haz clic para obtener traducciones alternativas\">file</span> <span title=\"Haz clic para obtener traducciones alternativas\">\r\nthat</span> <span title=\"Haz clic para obtener traducciones alternativas\">works</span>\r\n<span title=\"Haz clic para obtener traducciones alternativas\">well</span><span title=\"Haz clic para obtener traducciones alternativas\">.</span><br>\r\n<span title=\"Haz clic para obtener traducciones alternativas\">This file</span> <span title=\"Haz clic para obtener traducciones alternativas\">\r\nload</span> <span title=\"Haz clic para obtener traducciones alternativas\">on</span>\r\n<span title=\"Haz clic para obtener traducciones alternativas\">other</span> <span title=\"Haz clic para obtener traducciones alternativas\">\r\ncells</span> <span title=\"Haz clic para obtener traducciones alternativas\">in</span>\r\n<span title=\"Haz clic para obtener traducciones alternativas\">other</span> <span title=\"Haz clic para obtener traducciones alternativas\">\r\nbooksbooks</span> <span title=\"Haz clic para obtener traducciones alternativas\">and</span>\r\n<span title=\"Haz clic para obtener traducciones alternativas\">works</span> <span title=\"Haz clic para obtener traducciones alternativas\">\r\nok</span><span title=\"Haz clic para obtener traducciones alternativas\">.</span><br>\r\n<span title=\"Haz clic para obtener traducciones alternativas\">But</span> <span title=\"Haz clic para obtener traducciones alternativas\">\r\nthe</span> <span title=\"Haz clic para obtener traducciones alternativas\">problem</span>\r\n<span title=\"Haz clic para obtener traducciones alternativas\">is</span> <span title=\"Haz clic para obtener traducciones alternativas\">\r\nwhen I</span> <span title=\"Haz clic para obtener traducciones alternativas\">try</span>\r\n<span title=\"Haz clic para obtener traducciones alternativas\">to put</span> <span title=\"Haz clic para obtener traducciones alternativas\">\r\non</span> <span title=\"Haz clic para obtener traducciones alternativas\">a</span> <span title=\"Haz clic para obtener traducciones alternativas\">\r\ndevelopment</span> <span title=\"Haz clic para obtener traducciones alternativas\">\r\nin</span> <span title=\"Haz clic para obtener traducciones alternativas\">php</span><span title=\"Haz clic para obtener traducciones alternativas\">.</span>\r\n<span title=\"Haz clic para obtener traducciones alternativas\">The</span> <span title=\"Haz clic para obtener traducciones alternativas\">\r\nshooting</span> <span title=\"Haz clic para obtener traducciones alternativas\">error</span>\r\n<span title=\"Haz clic para obtener traducciones alternativas\">is: </span></span><strong>Fatal error</strong>: Uncaught exception 'Exception' with message 'Cotizador!AM8 -&gt; undefined variable ','' in C:\\wamp\\www\\cotizador\\Classes\\PHPExcel\\Cell.php:284 Stack\r\n trace: #0 C:\\wamp\\www\\cotizador\\index.php(29): PHPExcel_Cell-&gt;getCalculatedValue() #1 {main} thrown in\r\n<strong>C:\\wamp\\www\\cotizador\\Classes\\PHPExcel\\Cell.php</strong> on line <strong>\r\n284</strong></p>\r\n<p><span id=\"x_result_box\" lang=\"en\"><span title=\"Haz clic para obtener traducciones alternativas\">Now,</span>\r\n<span title=\"Haz clic para obtener traducciones alternativas\">if</span> <span title=\"Haz clic para obtener traducciones alternativas\">\r\nI do not use</span> <span title=\"Haz clic para obtener traducciones alternativas\">\r\nbooksbook</span> <span title=\"Haz clic para obtener traducciones alternativas\">and</span>\r\n<span title=\"Haz clic para obtener traducciones alternativas\">do it all</span> <span title=\"Haz clic para obtener traducciones alternativas\">\r\non</span> <span title=\"Haz clic para obtener traducciones alternativas\">the same</span>\r\n<span title=\"Haz clic para obtener traducciones alternativas\">worksheet,</span> <span title=\"Haz clic para obtener traducciones alternativas\">\r\nit works</span> <span title=\"Haz clic para obtener traducciones alternativas\">fine.</span><br>\r\n<span title=\"Haz clic para obtener traducciones alternativas\">Someone</span> <span title=\"Haz clic para obtener traducciones alternativas\">\r\ncan</span> <span title=\"Haz clic para obtener traducciones alternativas\">help</span>\r\n<span title=\"Haz clic para obtener traducciones alternativas\">me</span><span title=\"Haz clic para obtener traducciones alternativas\">?</span><br>\r\n<br>\r\n<span title=\"Haz clic para obtener traducciones alternativas\">Thanks</span><span title=\"Haz clic para obtener traducciones alternativas\">.</span><br>\r\n<span title=\"Haz clic para obtener traducciones alternativas\">Ariel</span><span title=\"Haz clic para obtener traducciones alternativas\">.</span></span></p>\r\n",
    "PostedDate": "2011-02-01T12:28:03.437-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "558952",
    "ThreadId": "244194",
    "Html": "\r\n<p>Can you please try this using the latest daily download, accessible from the &quot;Source Code&quot; tab.</p>\r\n",
    "PostedDate": "2011-02-01T13:19:22.907-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "559304",
    "ThreadId": "244194",
    "Html": "\r\n<p><span id=\"x_result_box\" lang=\"en\"><span title=\"Haz clic para obtener traducciones alternativas\">I tried</span>\r\n<span title=\"Haz clic para obtener traducciones alternativas\">with the</span> <span title=\"Haz clic para obtener traducciones alternativas\">\r\nlatest version</span> <span title=\"Haz clic para obtener traducciones alternativas\">\r\nand the problem</span> <span title=\"Haz clic para obtener traducciones alternativas\">\r\ncontinues.</span></span></p>\r\n<p>I think I found the problem:<br>\r\n<br>\r\nMy excel sheet has references to other worksheets and use the function &quot;IF&quot; that is where I have the problem.<br>\r\nIn Spanish the function &quot;IF&quot; is &quot;SI&quot;.<br>\r\n<br>\r\nThe function is: =(SI(Cotizador!AG8=&quot;TEST&quot;;Roseta!A10;Roseta!A11))&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; The error that appears is: Fatal error: Uncaught exception 'Exception' with message 'Cotizador!AM8 -&gt; undefined variable ','' in C:\\wamp\\www\\cotizador\\Classes\\PHPExcel\\Cell.php:284\r\n Stack trace: #0 C:\\wamp\\www\\cotizador\\index.php(29): PHPExcel_Cell-&gt;getCalculatedValue() #1 {main} thrown in C:\\wamp\\www\\cotizador\\Classes\\PHPExcel\\Cell.php on line 284<br>\r\n<br>\r\nNow if instead I refer to two cells within the same page works fine: =(SI(Cotizador!AG8=&quot;TEST&quot;;A1;A2))<br>\r\n<br>\r\nThank you very much for the help.<br>\r\n<br>\r\nAriel.</p>\r\n",
    "PostedDate": "2011-02-02T04:46:17.84-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "559531",
    "ThreadId": "244194",
    "Html": "\r\n<p>There is a complete section of the manual devoted to setting the locale for the calculation engine.</p>\r\n<p>Internally, the calculation engine uses English function names, in the same way as Excel itself. It also uses a comma (,) as the argument separator rather than a semi-colon (;). However, you can use the internal translation methods to convert between English\r\n and Spanish function names, and the semi-colon (;) as an argument separator, as long as you set the locale to Spanish.</p>\r\n<div>\r\n<div style=\"color:black; background-color:white\">\r\n<pre>$locale = <span style=\"color:#a31515\">'es'</span>;\r\n$validLocale = PHPExcel_Settings::setLocale($locale);\r\n<span style=\"color:blue\">if</span> (!$validLocale) {\r\n       <span style=\"color:blue\">echo</span> <span style=\"color:#a31515\">'Unable to set locale to '</span>.$locale.<span style=\"color:#a31515\">&quot; - reverting to en_us&lt;br /&gt;\\n&quot;</span>;\r\n}\r\n</pre>\r\n</div>\r\n<p><span lang=\"NL\" style=\"font-size:10pt\">Once you have set&nbsp;the locale, you can set a cell to contain a formula using:</span></p>\r\n</div>\r\n<div><span lang=\"RU\" style=\"font-size:9pt\">\r\n<div style=\"color:black; background-color:white\">\r\n<pre>$formula = <span style=\"color:#a31515\">'=SI(Cotizador!AG8=&quot;TEST&quot;;Roseta!A10;Roseta!A11)'</span>;\r\n$internalFormula = PHPExcel_Calculation::getInstance()-&gt;translateFormulaToEnglish($formula);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#a31515\">'B8'</span>,$internalFormula);\r\n</pre>\r\n</div>\r\n</span></div>\r\n<p>To read a formula from a cell (where it is stored in English) and translate it to the locale version:</p>\r\n<div><span style=\"color:#333333; font-size:9pt\">\r\n<div style=\"color:black; background-color:white\">\r\n<pre>$formula = $objPHPExcel-&gt;getActiveSheet()-&gt;getCell(<span style=\"color:#a31515\">'B8'</span>)-&gt;getValue();\r\n$translatedFormula =PHPExcel_Calculation::getInstance()-&gt;_translateFormulaToLocale($formula);\r\n</pre>\r\n</div>\r\n</span></div>\r\n<p>This only translates function names... it will not translate text strings like &quot;TEST&quot;, nor worksheet names like &quot;Roseta&quot;, etc, although it will allow the use of VERDADERO and FALSO for booleans TRUE and FALSE.</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n",
    "PostedDate": "2011-02-02T09:24:48.99-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "559576",
    "ThreadId": "244194",
    "Html": "\r\n<p>Dear Mark:</p>\r\n<p><span id=\"x_result_box\" lang=\"en\"><span title=\"Haz clic para obtener traducciones alternativas\">My code</span>\r\n<span title=\"Haz clic para obtener traducciones alternativas\">is part of<br>\r\n</span></span></p>\r\n<p><span lang=\"en\"><span title=\"Haz clic para obtener traducciones alternativas\">.</span></span></p>\r\n<p><span lang=\"en\"><span title=\"Haz clic para obtener traducciones alternativas\">.<br>\r\n</span></span></p>\r\n<p>$locale = 'es';<br>\r\n$validLocale = PHPExcel_Settings::setLocale($locale);<br>\r\nif (!$validLocale) {<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; echo 'Unable to set locale to '.$locale.&quot; - reverting to en_us&lt;br /&gt;\\n&quot;;<br>\r\n}</p>\r\n<p><span lang=\"en\"><span title=\"Haz clic para obtener traducciones alternativas\">.</span></span></p>\r\n<p><span lang=\"en\"><span title=\"Haz clic para obtener traducciones alternativas\">.</span></span></p>\r\n<p><span lang=\"en\"><span title=\"Haz clic para obtener traducciones alternativas\">.</span></span></p>\r\n<p>$formula = '=SI(Cotizador!AG8=&quot;TEST&quot;;Roseta!A10;Roseta!A11)';<br>\r\n$internalFormula = PHPExcel_Calculation::getInstance()-&gt;_translateFormulaToEnglish($formula);<br>\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('AM8',$internalFormula);<br>\r\n<br>\r\n$total= $objPHPExcel-&gt;getActiveSheet()-&gt;getCell('AM8')-&gt;getCalculatedValue();</p>\r\n<p>&nbsp;</p>\r\n<p><span id=\"x_result_box\" lang=\"en\"><span title=\"Haz clic para obtener traducciones alternativas\">...and</span>\r\n<span title=\"Haz clic para obtener traducciones alternativas\">still</span> <span title=\"Haz clic para obtener traducciones alternativas\">\r\nthe</span> <span title=\"Haz clic para obtener traducciones alternativas\">problem:\r\n</span></span><em><strong>Fatal error</strong>: Uncaught exception 'Exception' with message 'Cotizador!AM8 -&gt; undefined variable ','' in C:\\wamp\\www\\cotizador\\Classes\\PHPExcel\\Cell.php:284 Stack trace: #0 C:\\wamp\\www\\cotizador\\index.php(45): PHPExcel_Cell-&gt;getCalculatedValue()\r\n #1 {main} thrown in <strong>C:\\wamp\\www\\cotizador\\Classes\\PHPExcel\\Cell.php</strong> on line\r\n<strong>284</strong></em></p>\r\n<p><span id=\"x_result_box\" lang=\"en\"><span title=\"Haz clic para obtener traducciones alternativas\">What I</span>\r\n<span title=\"Haz clic para obtener traducciones alternativas\">need</span> <span title=\"Haz clic para obtener traducciones alternativas\">\r\nis to get</span> <span title=\"Haz clic para obtener traducciones alternativas\">the</span>\r\n<span title=\"Haz clic para obtener traducciones alternativas\">cell value</span> <span title=\"Haz clic para obtener traducciones alternativas\">\r\nAM8.</span></span></p>\r\n<p>&nbsp;</p>\r\n<p><span lang=\"en\"><span title=\"Haz clic para obtener traducciones alternativas\">Thank you.<br>\r\n</span></span></p>\r\n",
    "PostedDate": "2011-02-02T10:26:38.127-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "559603",
    "ThreadId": "244194",
    "Html": "\r\n<p>If this really is the case, then there's a major flaw in the Calculation Engine; although I'd have expected it to have appeared before now for such a simple formula. Is it possible to email me a copy of your workbook/code, or attach it to\r\n<a href=\"http://phpexcel.codeplex.com/workitem/10749?ProjectName=phpexcel\">Work Item 10749</a></p>\r\n",
    "PostedDate": "2011-02-02T10:59:31.68-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "559666",
    "ThreadId": "244194",
    "Html": "\r\n<p><span id=\"x_x_result_box\" lang=\"en\"><span title=\"Haz clic para obtener traducciones alternativas\">to</span>\r\n<span title=\"Haz clic para obtener traducciones alternativas\">send</span> <span title=\"Haz clic para obtener traducciones alternativas\">\r\nyour</span> <span title=\"Haz clic para obtener traducciones alternativas\">mail</span><span title=\"Haz clic para obtener traducciones alternativas\">?</span></span></p>\r\n",
    "PostedDate": "2011-02-02T12:26:40.59-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "559746",
    "ThreadId": "244194",
    "Html": "\r\n<p>I don't think the mail facility here on codeplex allows file attachments, so send to</p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre>define(<span style=\"color:#a31515\">'XX'</span>,<span style=\"color:#a31515\">'.'</span>);\r\ndefine(<span style=\"color:#a31515\">'YY'</span>,<span style=\"color:#a31515\">'@'</span>);\r\n<span style=\"color:blue\">echo</span> strrev(str_rot13(<span style=\"color:#a31515\">'xh'</span>).XX.str_rot13(<span style=\"color:#a31515\">'bp'</span>).XX.str_rot13(<span style=\"color:#a31515\">'abzrq'</span>).XX.str_rot13(<span style=\"color:#a31515\">'rtany'</span>).YY.str_rot13(<span style=\"color:#a31515\">'xenz'</span>));\r\n</pre>\r\n</div>\r\n",
    "PostedDate": "2011-02-02T14:33:10.837-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "560283",
    "ThreadId": "244194",
    "Html": "\r\n<p><span id=\"x_result_box\" lang=\"en\"><span title=\"Haz clic para obtener traducciones alternativas\">This</span>\r\n<span title=\"Haz clic para obtener traducciones alternativas\">morning</span> <span title=\"Haz clic para obtener traducciones alternativas\">\r\nI</span> <span title=\"Haz clic para obtener traducciones alternativas\">sent</span>\r\n<span title=\"Haz clic para obtener traducciones alternativas\">the mail</span><span title=\"Haz clic para obtener traducciones alternativas\">.</span>\r\n<span title=\"Haz clic para obtener traducciones alternativas\">Arrived?</span></span></p>\r\n",
    "PostedDate": "2011-02-03T09:58:00.973-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "560351",
    "ThreadId": "244194",
    "Html": "On 03/02/2011 17:58, averbner wrote:\r\n<blockquote type=\"cite\">\r\n<p>From: averbner</p>\r\n<div id=\"x_x_ThreadNotificationPostBody\">\r\n<p><span id=\"x_x_x_result_box\" lang=\"en\"><span title=\"Haz clic para\r\n              obtener traducciones alternativas\">This</span>\r\n<span title=\"Haz clic para obtener traducciones\r\n              alternativas\">morning</span>\r\n<span title=\"Haz clic para\r\n              obtener traducciones alternativas\">I</span>\r\n<span title=\"Haz clic para obtener traducciones\r\n              alternativas\">sent</span>\r\n<span title=\"Haz clic para obtener traducciones\r\n              alternativas\">the mail</span><span title=\"Haz clic para\r\n              obtener traducciones alternativas\">.</span>\r\n<span title=\"Haz clic para obtener traducciones\r\n              alternativas\">Arrived?</span></span></p>\r\n</div>\r\n</blockquote>\r\nReceived and looking at it.<br>\r\n<br>\r\n---<br>\r\nMark Baker<br>\r\n",
    "PostedDate": "2011-02-03T12:14:49.417-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "560784",
    "ThreadId": "244194",
    "Html": "\r\n<p><span id=\"x_result_box\" lang=\"en\"><span title=\"Haz clic para obtener traducciones alternativas\">Definitely</span>\r\n<span title=\"Haz clic para obtener traducciones alternativas\">the</span> <span title=\"Haz clic para obtener traducciones alternativas\">\r\nproblem</span> <span title=\"Haz clic para obtener traducciones alternativas\">is</span>\r\n<span title=\"Haz clic para obtener traducciones alternativas\">in</span> <span title=\"Haz clic para obtener traducciones alternativas\">\r\nthe</span> <span title=\"Haz clic para obtener traducciones alternativas\">arguments</span>\r\n<span title=\"Haz clic para obtener traducciones alternativas\">of the</span> <span title=\"Haz clic para obtener traducciones alternativas\">\r\nfunction</span> =IF<span title=\"Haz clic para obtener traducciones alternativas\">.</span>\r\n<span title=\"Haz clic para obtener traducciones alternativas\">If</span> <span title=\"Haz clic para obtener traducciones alternativas\">\r\nI make</span> <span title=\"Haz clic para obtener traducciones alternativas\">references found</span>\r\n<span title=\"Haz clic para obtener traducciones alternativas\">on</span> <span title=\"Haz clic para obtener traducciones alternativas\">\r\nthe same sheet</span><span title=\"Haz clic para obtener traducciones alternativas\">,</span>\r\n<span title=\"Haz clic para obtener traducciones alternativas\">without referring</span>\r\n<span title=\"Haz clic para obtener traducciones alternativas\">to</span> <span title=\"Haz clic para obtener traducciones alternativas\">\r\nanother</span> <span title=\"Haz clic para obtener traducciones alternativas\">(</span><span title=\"Haz clic para obtener traducciones alternativas\">nombre!</span><span title=\"Haz clic para obtener traducciones alternativas\">) works</span>\r\n<span title=\"Haz clic para obtener traducciones alternativas\">well.</span></span></p>\r\n",
    "PostedDate": "2011-02-04T06:59:06.773-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "562891",
    "ThreadId": "244194",
    "Html": "\r\n<p>The problem is actually in cell 'Configuracion'!C53 which is used within the calculation. The formula for that cell is ='[!CONTROL MANAGER.xls]DOT'!$I$7 which is a reference to an external workbook.</p>\r\n<p>The PHPExcel the calculation engine&nbsp;does not&nbsp;support references to external workbooks. There are currently two work items open for this issue: Work Items\r\n<a href=\"http://phpexcel.codeplex.com/workitem/15046\">15046</a> and <a href=\"http://phpexcel.codeplex.com/workitem/15184\">\r\n15184</a>.</p>\r\n<p>While I know (in theory) how to do this, it's a <strong>lot </strong>of work, and a big performance overhead whenever it encounters an external workbook reference, and the code still has to trap for situations where the external workbook is not available.\r\n What I will try to do sooner is to perform a trap for external workbook references and throw an exception when one is encountered, so that it can be handled cleanly. This change won't be in time for the next release, but I'm hoping to rework the structure\r\n of the calculation engine as part of the 1.7.7 release, and will target it as part of that change.</p>\r\n<p>In the interim, if you need to&nbsp;read the calculated value from the cell (as stored when the workbook was saved in MS Excel), you can use:</p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre>$objPHPExcel-&gt;getSheetByName(<span style=\"color:#a31515\">'Cotizador'</span>)-&gt;getCell(<span style=\"color:#a31515\">'AM8'</span>)-&gt;getOldCalculatedValue();\r\n</pre>\r\n</div>\r\n",
    "PostedDate": "2011-02-08T13:24:36.333-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "563331",
    "ThreadId": "244194",
    "Html": "\r\n<p><span id=\"x_result_box\" lang=\"en\"><span title=\"Haz clic para obtener traducciones alternativas\">Mark, thank you very much</span>\r\n<span title=\"Haz clic para obtener traducciones alternativas\">for the</span> <span title=\"Haz clic para obtener traducciones alternativas\">\r\nhelp</span> <span title=\"Haz clic para obtener traducciones alternativas\">and</span>\r\n<span title=\"Haz clic para obtener traducciones alternativas\">good</span> <span title=\"Haz clic para obtener traducciones alternativas\">\r\npredisposition</span><span title=\"Haz clic para obtener traducciones alternativas\">.</span>\r\n<span title=\"Haz clic para obtener traducciones alternativas\">You have</span> <span title=\"Haz clic para obtener traducciones alternativas\">\r\nbeen</span> <span title=\"Haz clic para obtener traducciones alternativas\">very helpful</span><span title=\"Haz clic para obtener traducciones alternativas\">.</span></span></p>\r\n",
    "PostedDate": "2011-02-09T07:03:17.833-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]