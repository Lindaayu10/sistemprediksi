[
  {
    "Id": "803899",
    "ThreadId": "346901",
    "Html": "\r\n<p>I'm trying to extend AdvancdValueBinder to include two more formats.</p>\r\n<p>The first one is for currency.&nbsp; It probably isn't perfect, but it works for my purposes:</p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre><span style=\"color:green\">// Check for currency</span>\r\n<span style=\"color:blue\">if</span> (preg_match(<span style=\"color:#a31515\">'/^\\$[0-9]{1,3}(,[0-9]{3})*(\\.[0-9]&#43;)?/'</span>, $value)) {\r\n<span style=\"color:green\">// Convert value to number</span>\r\n$value = str_replace(<span style=\"color:#a31515\">'$'</span>, <span style=\"color:#a31515\">''</span>, $value);\r\n$cell-&gt;setValueExplicit( (float)str_replace(<span style=\"color:#a31515\">','</span>, <span style=\"color:#a31515\">''</span>, $value) , PHPExcel_Cell_DataType::TYPE_NUMERIC);\r\n<span style=\"color:green\">// Set style</span>\r\n$cell-&gt;getParent()-&gt;getStyle( $cell-&gt;getCoordinate() )-&gt;getNumberFormat()-&gt;setFormatCode( PHPExcel_Style_NumberFormat::FORMAT_CURRENCY_USD );\r\n<span style=\"color:blue\">return</span> true; }\r\n</pre>\r\n</div>\r\n<p>However, I'm having a problem with the second one. I want a number string from formatted with a &#43; or - to display with the &#43; or - (e.g. &#43;21 or -5). The numbers are all 1 to 3 digits. I added this code to AdvancedValueBinder:</p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre>// Check for net score (&#43; or -)\r\nif (preg_match('/^(\\&#43;|\\-)[0-9]{1,3}/', $value)) {\r\n// Convert value to number\r\n$cell-&gt;setValueExplicit( (float)str_replace('&#43;', '', $value) , PHPExcel_Cell_DataType::TYPE_NUMERIC);\r\n// Set style\r\n$cell-&gt;getParent()-&gt;getStyle( $cell-&gt;getCoordinate() )-&gt;getNumberFormat()-&gt;setFormatCode('&#43;##0;-##0;0');\r\nreturn true;\r\n}\r\n</pre>\r\n</div>\r\n<p>I don't know why it isn't working. I checked the preg_match and it matches the numbers I provide, and I used the custom format string in Excel 2007 and it displays with a &#43; or -. When I check the generated Excel spreadsheet the cells where it should apply\r\n the custom format have a general number format.</p>\r\n<p>Thanks is advance.</p>\r\n",
    "PostedDate": "2012-03-01T10:39:27.253-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]