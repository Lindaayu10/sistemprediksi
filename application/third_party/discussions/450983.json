[
  {
    "Id": "1071984",
    "ThreadId": "450983",
    "Html": "and waiting and waiting and ... well, you get the idea.  I cobbled these two scripts from 05featuredemo.  When 'MonthlyReport.php' launches, the wheels keep spinning and spinning. I have the time limit set to four minutes and that is reached almost every time.  Here's the code:\r<br />\n<br />\nMonthlyReport.php<br />\n<pre><code>&lt;?php\nsession_name(&quot;PassTech&quot;);\nsession_start();\nset_time_limit (480);\nerror_reporting(E_ALL);\nini_set('display_errors', TRUE);\nini_set('display_startup_errors', TRUE);\n\n//error_reporting (E_ERROR | E_WARNING | E_PARSE | E_NOTICE);  \n\ngc_enable(); // Enable Garbage Collector\nvar_dump(gc_enabled()); // true\nvar_dump(gc_collect_cycles()); // # of elements cleaned up\ngc_disable(); // Disable Garbage Collecto\n\nob_end_clean();\n\n$BeginTime = date('H:i:s');\necho $BeginTime;\n\ndefine('EOL',(PHP_SAPI == 'cli') ? PHP_EOL : '&lt;br /&gt;');\n\n$SystemNum = $_SESSION['SystemNum'];\n\nfor($Joe = 0; $Joe &lt;= 75; $Joe++) { \n    if ($SystemNum == 0) {\n        $SystemNumEntry = $Joe;\n    }\n    \n    else $SystemNumEntry = $System;\n    echo '&lt;br&gt;Joe is here&lt;br&gt;' . $Joe . '&lt;br&gt;&lt;br&gt;';\n    \n    $_SESSION['SystemNumEntry'] = $SystemNumEntry;\n\ninclude &quot;ImportCSV.php&quot;;\n\n\n    \n        echo '&lt;br&gt;&lt;br&gt;' . $SystemNum . ' xx ' . $SystemNumEntry . '&lt;br&gt;&lt;br&gt;';\n\n\n\n$WriteFile = $_SESSION['FileName'];\n$Path = '/Users/tim/Sites/classes/MonthlyReports/';\n$FileOut = $Path . $WriteFile;\n\necho $FileOut . '&lt;br&gt;&lt;br&gt;';\n\n/** Include PHPExcel_IOFactory */\nrequire_once '../Classes/PHPExcel/IOFactory.php';\n\n\n// Save Excel 2007 file\necho date('H:i:s') , &quot; Write to Excel2007 format&quot; , EOL;\n$callStartTime = microtime(true);\n\n\n\n$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, 'Excel2007');\n//$objWriter-&gt;save(str_replace('.php', '.xlsx', __FILE__));\n\n$objWriter-&gt;save($FileOut, __FILE__);\n\n\n\n\n\n\n//$objWriter = new PHPExcel_Writer_Excel2007($objPHPExcel);\n//$objWriter-&gt;save($destination);\n\n\n\n\n$callEndTime = microtime(true);\n$callTime = $callEndTime - $callStartTime;\n\necho date('H:i:s') , &quot; File written to &quot; , $FileOut, pathinfo(__FILE__, PATHINFO_BASENAME) , EOL;\necho 'Call time to write Workbook was ' , sprintf('%.4f',$callTime) , &quot; seconds&quot; , EOL;\n// Echo memory usage\necho date('H:i:s') , ' Current memory usage: ' , (memory_get_usage(true) / 1024 / 1024) , &quot; MB&quot; , EOL;\n//$JustPeachey = str_replace('.php', '.xlsx', __FILE__);\n\n}\ndie ('wrote 2007');</code></pre>\n\nImportCSV.php:<br />\n<pre><code>&lt;?php\n\nset_time_limit (480);\n\n// error_reporting (E_ERROR | E_WARNING | E_PARSE | E_NOTICE);  \n\n\n\n//session_name(&quot;PassTech&quot;);\n//session_start();\n\n\n// set_time_limit (360);\n//gc_enable(); // Enable Garbage Collector\n//var_dump(gc_enabled()); // true\n//var_dump(gc_collect_cycles()); // # of elements cleaned up\n//gc_disable(); // Disable Garbage Collecto\n\n//ob_end_clean();\n\n\n//error_reporting(E_ALL);\n\nini_set('display_errors', FALSE);\nini_set('display_startup_errors', FALSE);\n\nset_include_path('/Users/tim/Sites/');\n\n\n\n\nini_set('memory_limit', '-1');\n$GrandWorkOrders = 0;\n$GrandCallCount = 0;\n\n$host=&quot;localhost&quot;;\n$user=&quot;root&quot;;\n$password=&quot;g1G3m#1989&quot;;\n$Dbname = &quot;calls_to_dispatch&quot;;\n\n$mysqli = new mysqli($host, $user, $password, $Dbname);\n\n// Check connection\nif ($mysqli-&gt;connect_errno) {\n    echo &quot;Hey dope!  Failed to connect to MySQL: (&quot; . $mysqli-&gt;connect_errno . &quot;) &quot; . $mysqli-&gt;connect_error;\n}\n\n\n\n\n$LastDate = $_SESSION['LastDate'];\n$TechNumEntry = $_SESSION['TechNum'];\n$SystemNum = $_SESSION['SystemNum'];\n$SystemNumEntry = $_SESSION['SystemNumEntry'];\n\n\necho $SystemNum . '&lt;br&gt;&lt;br&gt;';\n$iRow = 1;\n\n\n    $LastDateArray = explode(&quot;-&quot;, $LastDate);\n        \n        $EndMonth = $LastDateArray[0];\n        $EndDay = $LastDateArray[1];\n        $EndYear = $LastDateArray[2];\n        \n        $EndDate = $EndYear . '-' . $EndMonth . '-' . $EndDay;\n\n\n\n\n\n\n    $NumMonth = cal_days_in_month(CAL_GREGORIAN, $EndMonth, $EndYear);\n\n                $date = date_create($EndDate);\n                   \n\n                    $CommonEndDate = date_format($date, &quot;M d, Y&quot;);\n                    $EndMO = date_format($date, 'F, Y');\n                    $FileMonth = date_format($date, 'm-Y');\n                    \n                date_sub($date, date_interval_create_from_date_string($NumMonth - 1 . 'days'));\n                $StartDate = $EndYear . '-' . $EndMonth . '-01';\n\n\n                $date = date_create($StartDate);\n                    $StartDate = date_format($date, 'Y-m-d');\n                    $CommonStartDate = date_format($date, &quot;M d, Y&quot;);\n                    \n    \n        for ($counter=0; $counter &lt; $NumMonth; $counter++)\n            {\n                $date = date_create($StartDate);\n                date_add($date, date_interval_create_from_date_string($counter . 'days'));\n                \n                $W[$counter] = date_format($date, &quot;D&quot;);\n                $D[$counter] = date_format($date, &quot;n-j&quot;);\n                \n\n            }\n            \n\n\n\n/** Include PHPExcel */\nrequire_once dirname(__FILE__) . '/PHPExcel.php';\n\n\n\n\n// Create new PHPExcel object\necho date('H:i:s') , &quot; Create new PHPExcel object&quot; , EOL;\n$objPHPExcel = new PHPExcel();\n\n\n\n// Set document properties\necho date('H:i:s') , &quot; Set document properties&quot; , EOL;\n$objPHPExcel-&gt;getProperties()-&gt;setCreator(&quot;Timothy Stringer&quot;)\n                             -&gt;setLastModifiedBy(&quot;Mac the Knife&quot;)\n                             -&gt;setTitle(&quot;Office 2007 XLSX Test Document&quot;)\n                             -&gt;setSubject(&quot;Office 2007 XLSX Test Document&quot;)\n                             -&gt;setDescription(&quot;Test document for Office 2007 XLSX, generated using PHP classes.&quot;)\n                             -&gt;setKeywords(&quot;office 2007 openxml php&quot;)\n                             -&gt;setCategory(&quot;Test result file&quot;);\n                             \n                             \n\n\n\n\n\n                \n                ####open folder \n\n\n\n                \n\n// Create a first sheet, representing sales data\necho date('H:i:s') , &quot; Add some data&quot; , EOL;\n\n\n\n//set header\n$stmt = $mysqli-&gt;prepare(&quot;SELECT IdNum FROM TOAWorkOrdersNew WHERE WorkDate = ? AND TechNum = ?&quot;); \n$stmt2 = $mysqli-&gt;prepare(&quot;SELECT IdNum FROM CallVolume WHERE WorkDate = ? AND ANI = ?&quot;); \n\n$stmt-&gt;bind_param('ss', $IncDate, $TechNum); \n$stmt2-&gt;bind_param('ss', $IncDate, $CellNum); \n\n        \nif ($SystemNumEntry == 0) $Quest = &quot;SELECT * FROM Systems&quot;;\nelse $Quest = &quot;SELECT * FROM Systems WHERE SystemNum = $SystemNumEntry&quot;;\n\n$SystemResult = $mysqli-&gt;query($Quest) or die('Dipstick  can not query');\n        {\n         while ($row = $SystemResult-&gt;fetch_assoc()) \n                {\n        //      $SystemNum = $row[&quot;SystemNum&quot;];\n                $System = $row[&quot;System&quot;];\n                $LongSystem = $row[&quot;LongSystem&quot;];\n                $Contractor = $row[&quot;Contractor&quot;];\n\n\n                \n                $iRow = 1;\n\n                $EndCol = 'A'. chr($NumMonth+43);\n                $strRow = 'A' . $iRow  . ':' . $EndCol . $iRow;\n                \n                $fontRow = 'A' . $iRow;\n                \n                $ColorRow = 'A' . $iRow  . ':' . $EndCol . ($iRow+1);\n\n                \n                $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValueByColumnAndRow(0, $iRow, $LongSystem);\n    \n                $objPHPExcel-&gt;getActiveSheet()-&gt;mergeCells($strRow);\n                $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle($strRow)-&gt;getAlignment()-&gt;setVertical(PHPExcel_Style_Alignment::VERTICAL_CENTER);\n                $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle($strRow)-&gt;getAlignment()-&gt;setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_CENTER);\n                \n                $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle($strRow)-&gt;getFont()-&gt;setSize(20);\n            $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle($strRow)-&gt;getFont()-&gt;setName('Arial');\n            $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle($strRow)-&gt;getFont()-&gt;setBold(true);\n\n\n\n\n\n$iRow++;\n    $strRow = 'A' . $iRow  . ':' . $EndCol . $iRow;\n    $ColorRow = 'A' . $iRow  . ':' . $EndCol . ($iRow+1);\n    $fontRow = 'A' . $iRow;\n\n    $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValueByColumnAndRow(0, $iRow, $EndMO);\n    $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle($ColorRow)-&gt;getFont()-&gt;setSize(18);\n            $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle($ColorRow)-&gt;getFont()-&gt;setName('Arial');\n            $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle($ColorRow)-&gt;getFont()-&gt;setBold(true);\n    \n                \n    $iRow = $iRow + 2;\n        $ColorRow = 'A' . ($iRow + 1)  . ':' . $EndCol . ($iRow+2);\n    $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle($ColorRow)-&gt;getFill()-&gt;setFillType(PHPExcel_Style_Fill::FILL_SOLID);\n    $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle($ColorRow)-&gt;getFill()-&gt;getStartColor()-&gt;setARGB('DC2E25');\n    \n            \n                \n    \n        $objPHPExcel-&gt;getActiveSheet()-&gt;mergeCells($strRow);\n        $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle($strRow)-&gt;getAlignment()-&gt;setVertical(PHPExcel_Style_Alignment::VERTICAL_CENTER);\n        $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle($strRow)-&gt;getAlignment()-&gt;setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_CENTER);\n        $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle($fontRow)-&gt;getFont()-&gt;setSize(14);\n\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValueByColumnAndRow(0, $iRow+2, 'Tech Number');\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValueByColumnAndRow(1, $iRow+2, 'Name');\n\n\n$iRow++;\n\n$fontRow = 'A' . $iRow;\n\n\n\n        for ($counter = 0; $counter &lt; $NumMonth; $counter++)\n            {\n\n            $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValueByColumnAndRow($counter + 3, $iRow, $W[$counter]);\n            $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValueByColumnAndRow(($counter  + 3), $iRow, $D[$counter]);\n            $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValueByColumnAndRow($counter + 3, $iRow + 1, $W[$counter]);\n            }\n            \n            $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValueByColumnAndRow($counter + 3, $iRow + 1, 'Calls');\n            $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValueByColumnAndRow($counter + 4, $iRow, 'Work');\n            $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValueByColumnAnd</code></pre>\n\nI have put die traps and time traps, but I can't find where the scripts are hanging up.\r<br />\n<br />\nHelp?\r<br />\n<br />\ntim\r<br />\n<br />\n'If builders built buildings like programmers write programs, the first woodpecker to come along would wreck civilization.&quot;<br />\n",
    "PostedDate": "2013-07-23T14:46:43.92-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1071985",
    "ThreadId": "450983",
    "Html": "details, details, details.\r<br />\n<br />\n<br />\nMacBook Pro, OS 10.8.4, 2 GB RAM, 160 GB HD\r<br />\nPHP v 5.3.15\r<br />\nMySQL 5.7.1-m11\r<br />\nApache 2.2.22<br />\n",
    "PostedDate": "2013-07-23T14:51:34.98-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]