[
  {
    "Id": "429400",
    "ThreadId": "208868",
    "Html": "<p>Is there anyway to AutoSize the columns in a loop?&nbsp; I have some code below of what I was attempting.&nbsp; Version 3 is the code that works.&nbsp; I think that either Version 1 or 2 would be a good alternative.&nbsp; Are you not able to put php vars or functions in the PHPExcel code?</p>\r\n<p>I am trying to make a flexible exporter that can handle a variety of data, and was attempting to make a loop.&nbsp; My only other option might be to run AutoSize on like 15 columns and it would just be a little extra work.</p>\r\n<p>I am running Windows XP, PHP v5.2.12, and PHPExcel v1.7.2.</p>\r\n<p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre><span style=\"color:Green\">// Version 1</span>\r\n<span style=\"color:Blue\">for</span> ($col = <span style=\"color:#A31515\">'A'</span>; col &lt;= <span style=\"color:#A31515\">'I'</span>; $i++) {\r\n\t$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension($col)-&gt;setAutoSize(true);\r\n}\r\n<span style=\"color:Green\">// Version 2</span>\r\n<span style=\"color:Blue\">for</span> ($i = 0; $i &lt;= 9; $i++) {\r\n\t$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension(chr(65+$i))-&gt;setAutoSize(true);\r\n}\r\n<span style=\"color:Green\">// Version 3</span>\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension(<span style=\"color:#A31515\">'A'</span>)-&gt;setAutoSize(true);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension(<span style=\"color:#A31515\">'B'</span>)-&gt;setAutoSize(true);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension(<span style=\"color:#A31515\">'C'</span>)-&gt;setAutoSize(true);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension(<span style=\"color:#A31515\">'D'</span>)-&gt;setAutoSize(true);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension(<span style=\"color:#A31515\">'E'</span>)-&gt;setAutoSize(true);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension(<span style=\"color:#A31515\">'F'</span>)-&gt;setAutoSize(true);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension(<span style=\"color:#A31515\">'G'</span>)-&gt;setAutoSize(true);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension(<span style=\"color:#A31515\">'H'</span>)-&gt;setAutoSize(true);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension(<span style=\"color:#A31515\">'I'</span>)-&gt;setAutoSize(true);\r\n</pre>\r\n</div>\r\n</p>",
    "PostedDate": "2010-04-09T13:56:29.583-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "429519",
    "ThreadId": "208868",
    "Html": "<blockquote style=\"border:solid .1em #ccc;font-style:italic;margin:.25em 1em 0 1em;padding:0 .25em 0 .25em\"><strong>heavenswrath19 wrote:</strong><br>\r\n<p>Is there anyway to AutoSize the columns in a loop?&nbsp; I have some code below of what I was attempting.&nbsp; Version 3 is the code that works.&nbsp; I think that either Version 1 or 2 would be a good alternative.&nbsp; Are you not able to put php vars or functions in the PHPExcel code?</p>\r\n</blockquote>\r\n<p>Any of your three methods should work, though you may have some issues with the end test for your character incrementor.</p>\r\n<p>I prefer to use <span style=\"color:blue\">for</span> ($col = <span style=\"color:#a31515\">'A'</span>; $col != <span style=\"color:#a31515\">'J'</span>; $i++) which should work even when you have more than 26 columns. I assume you do have $col in your real code rather than col.</p>\r\n<p>PHPExcel is no different to any standard PHP: values passed to a function or method can be variables, constants, quoted strings, etc. Only methods/functions that require parameters passed by reference preclude the use of constants or quoted strings. I'll run some tests with all three methods, but I'd expect any of the three to work.</p>",
    "PostedDate": "2010-04-10T04:14:08.437-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "430132",
    "ThreadId": "208868",
    "Html": "<blockquote style=\"border:solid .1em #ccc;font-style:italic;margin:.25em 1em 0 1em;padding:0 .25em 0 .25em\"><strong>MarkBaker wrote:</strong><br>\r\n<blockquote style=\"border:solid .1em #ccc;font-style:italic;margin:.25em 1em 0 1em;padding:0 .25em 0 .25em\"><strong>heavenswrath19 wrote:</strong><br>\r\n<p>Is there anyway to AutoSize the columns in a loop?&nbsp; I have some code below of what I was attempting.&nbsp; Version 3 is the code that works.&nbsp; I think that either Version 1 or 2 would be a good alternative.&nbsp; Are you not able to put php vars or functions in the PHPExcel code?</p>\r\n</blockquote>\r\n<p>Any of your three methods should work, though you may have some issues with the end test for your character incrementor.</p>\r\n<p>I prefer to use <span style=\"color:blue\">for</span> ($col = <span style=\"color:#a31515\">'A'</span>; $col != <span style=\"color:#a31515\">'J'</span>; $i++) which should work even when you have more than 26 columns. I assume you do have $col in your real code rather than col.</p>\r\n<p>PHPExcel is no different to any standard PHP: values passed to a function or method can be variables, constants, quoted strings, etc. Only methods/functions that require parameters passed by reference preclude the use of constants or quoted strings. I'll run some tests with all three methods, but I'd expect any of the three to work.</p>\r\n</blockquote>\r\n<p>Mark,</p>\r\n<p>Thanks for the response, but I still seem to be struggling.&nbsp; I did have the code correct in my code, but it still won't work.&nbsp; Versions 1 and 2 both do not work on my example, even though Version 3 works fine.&nbsp; I experience a long &quot;loading&quot; period and then nothing outputs with the first two versions, versus a short load time and the browser asks where I want to save my file.&nbsp; I'm assuming it is creating an error, but I cannot figure it out.</p>\r\n<p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre><span style=\"color:Green\">// Version 4</span>\r\n<span style=\"color:Blue\">for</span> ($col = <span style=\"color:#A31515\">'A'</span>; $col != <span style=\"color:#A31515\">'J'</span>; $i++) {\r\n\t$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension($col)-&gt;setAutoSize(true);\r\n}\r\n</pre>\r\n</div>\r\nThe code you referred to is not working for me either (Version 4).&nbsp; It creates the same problems as Versions 1 and 2 above.&nbsp; I am a Java programmer at heart, so I might be misunderstanding PHP somewhere, but I don't know what is causing the problem.&nbsp; Could it be a problem with my PHP or PHPExcel versions?</p>",
    "PostedDate": "2010-04-12T11:30:53.803-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "430169",
    "ThreadId": "208868",
    "Html": "<p>Nevermind, I wrote out Version 4 incorrectly in my code.</p>\r\n<p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre><span style=\"color:Green\">// Version 4 fixed</span><br><span style=\"color:Blue\">for</span> ($col = <span style=\"color:#A31515\">'A'</span>; $col != <span style=\"color:#A31515\">'J'</span>; $col++) {\r\n\t$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension($col)-&gt;setAutoSize(true);\r\n}\r\n\r\n</pre>\r\n</div>\r\nThis works. Thanks again, Mark.&nbsp; I kept changing it so much, I did not keep track of all of the changes.&nbsp; To make it change then, I will simply change 'J' into a variable and have it be affected by the number of columns (or fields since I am using MYSQL).&nbsp; So I guess just Version 2 doesn't work, which must be something related to the chr function I am guessing.</p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2010-04-12T12:34:09.433-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]