[
  {
    "Id": "459749",
    "ThreadId": "217268",
    "Html": "<p>I am writting an Excel5 over an existing Excel file with PHPExcel. I need to upload that Excel to the Zoom website, so it can provide me with a list of tracking numbers. However, for some reason the library they are using to read the uploaded Excel files cannot read the rows written by PHPExcel and the only solution I've found so far is to manually copy the contents of my&nbsp;dynamically&nbsp;generated Excel to another document using MS Excel 2007.</p>\r\n<p>In other words, the Zoom website can read the rows in files written natively by Excel but not rows written by PHPExcel. My file has only one single sheet, and I can open it no problem with Excel 2007.&nbsp;</p>\r\n<p>Even if I manually add some rows to the template and then add more rows with PHPExcel, Zoom will read the rows written manually by me, but not the rows written by PHPExcel.</p>\r\n<p>This is how I am writting it:</p>\r\n<p><span> </span></p>\r\n<div style=\"color:black;background-color:white\">\r\n<pre><span style=\"color:green\">// Starting with the PHPExcel library</span>\r\n$this-&gt;load-&gt;library(<span style=\"color:#a31515\">'PHPExcel'</span>);\r\n$this-&gt;load-&gt;library(<span style=\"color:#a31515\">'PHPExcel/IOFactory'</span>);\r\n$template_file = <span style=\"color:#a31515\">'zoom_tracking_template.xls'</span>;\r\n$i = 3;\r\n\r\n$objReader = IOFactory::createReader(<span style=\"color:#a31515\">'Excel5'</span>);\r\n$objPHPExcel = $objReader-&gt;load($template_file);\r\n$objPHPExcel-&gt;setActiveSheetIndex(0);\r\n\r\n<span style=\"color:green\">// Fetching ML payments</span>\r\n<span style=\"color:blue\">foreach</span>($payments <span style=\"color:blue\">as</span> $row)\r\n{\r\n\t$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#a31515\">'A'</span>.$i, <span style=\"color:#a31515\">'VANESSA NEISZER'</span>);\r\n\t$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#a31515\">'B'</span>.$i, <span style=\"color:#a31515\">'02127616116'</span>);\r\n\t$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#a31515\">'C'</span>.$i, <span style=\"color:#a31515\">'1ER PISO MINITIENDAS 199 BLVD SABANA GRANDE, CRUCE C / CALLE NEGRIN'</span>);\r\n\t$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#a31515\">'D'</span>.$i, $row-&gt;mailing_city);\r\n\t$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#a31515\">'E'</span>.$i, $row-&gt;mailing_name);\r\n\t$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#a31515\">'F'</span>.$i, $row-&gt;mailing_name);\r\n\t$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#a31515\">'G'</span>.$i, $row-&gt;mailing_personal_id);\r\n\t$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#a31515\">'H'</span>.$i, $row-&gt;mailing_phone);\r\n\t$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#a31515\">'I'</span>.$i, $row-&gt;mailing_address1.<span style=\"color:#a31515\">' '</span>.$row-&gt;mailing_address2);\r\n\t$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#a31515\">'J'</span>.$i, $row-&gt;nickname);\r\n\t$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#a31515\">'K'</span>.$i, <span style=\"color:#a31515\">'1'</span>);\r\n\t$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#a31515\">'L'</span>.$i, <span style=\"color:#a31515\">'0.3'</span>);\r\n\t$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#a31515\">'M'</span>.$i, <span style=\"color:#a31515\">'M'</span>);\r\n\t$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#a31515\">'N'</span>.$i, <span style=\"color:#a31515\">'PRODUCTO'</span>);\r\n\t$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#a31515\">'O'</span>.$i, <span style=\"color:#a31515\">'0'</span>);\r\n\r\n\t$i++;\r\n}\r\n\r\n\r\n$objPHPExcel-&gt;setActiveSheetIndex(0);\r\n\t\t\r\n$objWriter = IOFactory::createWriter($objPHPExcel, <span style=\"color:#a31515\">'Excel5'</span>);\r\n\t\t\r\n<span style=\"color:green\">// Sending headers to force the user to download the file</span>\r\nheader(<span style=\"color:#a31515\">'Content-Type: application/vnd.ms-excel'</span>);\r\nheader(<span style=\"color:#a31515\">'Content-Disposition: attachment;filename=&quot;Envios'</span>.date(<span style=\"color:#a31515\">'dMy'</span>).<span style=\"color:#a31515\">'.xls&quot;'</span>);\r\nheader(<span style=\"color:#a31515\">'Cache-Control: max-age=0'</span>);\r\n\t\t\r\n$objWriter-&gt;save(<span style=\"color:#a31515\">'php://output'</span>);\r\n\r\n\r\n</pre>\r\n</div>\r\n<p>Does anyone have any idea of why this could be happening? I have no clue of what PHP library they are using to read Excel files and I am certain they wont tell me if I ask them. I know they use PHP, and their library only read Excel 2003 files, however, I don't know why they can't read my files but they can read other files written manually on MS Excel.</p>\r\n<p>Any clues, ideas or suggestions I could try would be greatly appreciated.</p>",
    "PostedDate": "2010-06-24T18:00:15-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]