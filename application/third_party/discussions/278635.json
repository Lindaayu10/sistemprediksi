[
  {
    "Id": "694926",
    "ThreadId": "278635",
    "Html": "\r\n<p>Hi,</p>\r\n<p>I've searched everywhere in the documentation but I can't seem to find the method for reading an excel file and then passing that information into MYSQL</p>\r\n<p>I'm going based on the following code found in the documentation.</p>\r\n<p>I am using PHPExcel version 1.7.6, and PHP 5.3.5</p>\r\n<p></p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre><span style=\"color:blue\">require_once</span> <span style=\"color:#a31515\">'PHPExcel.php'</span>;\r\n$inputFileType = <span style=\"color:#a31515\">'Excel2007'</span>;\r\n$inputFileName = $upload_path . $filename;\r\n\r\n<span style=\"color:green\">/**  Define a Read Filter class implementing PHPExcel_Reader_IReadFilter  */</span> \r\n<span style=\"color:blue\">class</span> chunkReadFilter <span style=\"color:blue\">implements</span> PHPExcel_Reader_IReadFilter \r\n{ \r\n    <span style=\"color:blue\">private</span> $_startRow = 0; \r\n    <span style=\"color:blue\">private</span> $_endRow   = 0; \r\n\r\n    <span style=\"color:green\">/**  Set the list of rows that we want to read  */</span> \r\n    <span style=\"color:blue\">public</span> <span style=\"color:blue\">function</span> setRows($startRow, $chunkSize) { \r\n        $this-&gt;_startRow = $startRow; \r\n        $this-&gt;_endRow   = $startRow &#43; $chunkSize; \r\n    } \r\n\r\n    <span style=\"color:blue\">public</span> <span style=\"color:blue\">function</span> readCell($column, $row, $worksheetName = <span style=\"color:#a31515\">''</span>) { \r\n        <span style=\"color:green\">//  Only read the heading row, and the configured rows </span>\r\n        <span style=\"color:blue\">if</span> (($row == 1) ||\r\n            ($row &gt;= $this-&gt;_startRow &amp;&amp; $row &lt; $this-&gt;_endRow)) { \r\n            <span style=\"color:blue\">return</span> true; \r\n        } \r\n        <span style=\"color:blue\">return</span> false; \r\n    } \r\n} \r\n\r\n\r\n<span style=\"color:green\">/**  Create a new Reader of the type defined in $inputFileType  **/</span> \r\n$objReader = PHPExcel_IOFactory::createReader($inputFileType); \r\n\r\n\r\n<span style=\"color:green\">/**  Define how many rows we want to read for each &quot;chunk&quot;  **/</span> \r\n$chunkSize = 2048; \r\n<span style=\"color:green\">/**  Create a new Instance of our Read Filter  **/</span> \r\n$chunkFilter = <span style=\"color:blue\">new</span> chunkReadFilter(); \r\n\r\n<span style=\"color:green\">/**  Tell the Reader that we want to use the Read Filter  **/</span> \r\n$objReader-&gt;setReadFilter($chunkFilter); \r\n\r\n<span style=\"color:green\">/**  Loop to read our worksheet in &quot;chunk size&quot; blocks  **/</span> \r\n<span style=\"color:blue\">for</span> ($startRow = 2; $startRow &lt;= 65536; $startRow &#43;= $chunkSize) { \r\n    <span style=\"color:green\">/**  Tell the Read Filter which rows we want this iteration  **/</span> \r\n    $chunkFilter-&gt;setRows($startRow,$chunkSize); \r\n    <span style=\"color:green\">/**  Load only the rows that match our filter  **/</span> \r\n    $objPHPExcel = $objReader-&gt;load($inputFileName); \r\n   \r\n <span style=\"color:green\">//    Need to pass the cell values into the variables</span>\r\n<span style=\"color:green\">/** This is where I need to use something like this\r\n</span></pre>\r\n</div>\r\n<p></p>\r\n<pre><span style=\"color:#b1b100\">for</span> <span style=\"color:#009900\">(</span><span style=\"color:#000088\">$x</span> <span style=\"color:#339933\">=</span> <span style=\"color:#cc66cc\">2</span><span style=\"color:#339933\">;</span> <span style=\"color:#000088\">$x</span> <span style=\"color:#339933\">&lt;</span> <span style=\"color:#339933\">=</span> <span style=\"color:#990000\">count</span><span style=\"color:#009900\">(</span><span style=\"color:#000088\">$data</span><span style=\"color:#339933\">-&gt;</span><span style=\"color:#004000\">sheets</span><span style=\"color:#009900\">[</span><span style=\"color:#cc66cc\">0</span><span style=\"color:#009900\">]</span><span style=\"color:#009900\">[</span><span style=\"color:#0000ff\">&quot;cells&quot;</span><span style=\"color:#009900\">]</span><span style=\"color:#009900\">)</span><span style=\"color:#339933\">;</span> <span style=\"color:#000088\">$x</span><span style=\"color:#339933\">&#43;&#43;</span><span style=\"color:#009900\">)</span> <span style=\"color:#009900\">{</span><span style=\"color:green\">\r\n    $item_number = $data-&gt;sheets[0][&quot;cells&quot;][$x][1];\r\n    $qty_sold = $data-&gt;sheets[0][&quot;cells&quot;][$x][2];\r\n    $cost_home = $data-&gt;sheets[0][&quot;cells&quot;][$x][3];\r\n\r\nwhich would work for phpexcelreader, but I just dont know which functions would do the same for phpExcel **/</span>\r\n\r\n<span style=\"color:green\">//here is where I would pass those values into MYSQL</span>\r\n\t\r\n$sql = &quot;INSERT INTO sales_report (`item_number`,`qty_sold`, `cost_home`) \r\n        VALUES (<span style=\"color:#a31515\">'$item_number'</span>,$qty_sold,<span style=\"color:#a31515\">'$cost_home'</span>)&quot;;\r\n\t\t <span style=\"color:blue\">echo</span> $sql.<span style=\"color:#a31515\">&quot;\\n&quot;</span>;\r\n    mysql_query($sql);\r\n} \r\n?&gt;\r\n</pre>\r\n<p>if you have any solutions to my problem your help would be most appreciated.</p>\r\n<p>&nbsp;</p>\r\n<p>Thank you very much.</p>\r\n",
    "PostedDate": "2011-11-07T12:59:59.797-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "694948",
    "ThreadId": "278635",
    "Html": "<p>It looks like what you're missing is just looping the cells.</p>\r\n<p>Look in \"Documentation/PHPExcel developer documentation.doc\" around page 12 for help.</p>",
    "PostedDate": "2011-11-07T13:40:48.01-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "694968",
    "ThreadId": "278635",
    "Html": "<p>Thanks for your response.</p>\r\n<p>I found the referenced documentation and did get it to output in html successfully, however i'm not sure how to use that loop to insert it into mysql.</p>\r\n<p>I guess I'm missing the php part that grabs that. Here is my code, I am absolutely certain that it is wrong in an embarrassing way.</p>\r\n<p>\r\n<div style=\"color: black; background-color: white;\">\r\n<pre><span style=\"color: blue;\">require_once</span> <span style=\"color: #a31515;\">'PHPExcel.php'</span>;\r\n$inputFileType = <span style=\"color: #a31515;\">'Excel2007'</span>;\r\n$inputFileName = $upload_path . $filename;\r\n$objReader = PHPExcel_IOFactory::createReader(<span style=\"color: #a31515;\">'Excel2007'</span>);\r\n$objReader-&gt;setReadDataOnly(true);\r\n$objPHPExcel = $objReader-&gt;load($inputFileName);\r\n$objWorksheet = $objPHPExcel-&gt;getActiveSheet();\r\n<span style=\"color: blue;\">foreach</span> ($objWorksheet-&gt;getRowIterator() <span style=\"color: blue;\">as</span> $row) {\r\n  $cellIterator = $row-&gt;getCellIterator();\r\n  $cellIterator-&gt;setIterateOnlyExistingCells(false); <span style=\"color: green;\">// This loops all cells,</span>\r\n                                                     <span style=\"color: green;\">// even if it is not set.</span>\r\n                                                     <span style=\"color: green;\">// By default, only cells</span>\r\n                                                     <span style=\"color: green;\">// that are set will be</span>\r\n                                                     <span style=\"color: green;\">// iterated.</span>\r\n  <span style=\"color: blue;\">foreach</span> ($cellIterator <span style=\"color: blue;\">as</span> $cell) {\r\n    $sql = <span style=\"color: #a31515;\">\"INSERT INTO sales_report (`item_number`,`qty_sold`, `cost_home`) VALUES ($row)\"</span>;\r\n         <span style=\"color: blue;\">echo</span> $sql.<span style=\"color: #a31515;\">\"\\n\"</span>;\r\n    mysql_query($sql);\r\n  }\r\n}\r\n?&gt;<br /><br />&nbsp;</pre>\r\n</div>\r\n</p>",
    "PostedDate": "2011-11-07T14:08:59.277-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "695296",
    "ThreadId": "278635",
    "Html": "<p>Well this is basically how I loop cells and get values in my app, and it was ported from phpexcelreader too, if this helps...</p>\n<div style=\"color: black; background-color: white;\">\n<pre><span style=\"color: blue;\">foreach</span> ($objWorksheet-&gt;getRowIterator() <span style=\"color: blue;\">as</span> $row) {\n\t$j = 1;\n\t\n\t$cellIterator = $row-&gt;getCellIterator();\n\t$cellIterator-&gt;setIterateOnlyExistingCells(false);\n\t\n\t<span style=\"color: blue;\">foreach</span> ($cellIterator <span style=\"color: blue;\">as</span> $cell) {\n\t\t$data-&gt;sheets[0][<span style=\"color: #a31515;\">'cells'</span>][$i][$j] = $cell-&gt;getValue();\n\t\t\n\t\t$j++;\n\t} <span style=\"color: green;\">// end cell getter</span>\n\t\n\t$i++;\n\t\n} <span style=\"color: green;\">// end row getter</span>\n</pre>\n</div>",
    "PostedDate": "2011-11-08T05:46:28.673-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "695379",
    "ThreadId": "278635",
    "Html": "<p>When I run the loop and try to insert it into mysql i don't get any errors but nothing gets inserted?</p>\r\n<p>\r\n<div style=\"color: black; background-color: white;\">\r\n<pre><span style=\"color: blue;\">foreach</span> ($objWorksheet-&gt;getRowIterator() <span style=\"color: blue;\">as</span> $row) {\r\n\t$j = 1;\r\n\t\r\n\t$cellIterator = $row-&gt;getCellIterator();\r\n\t$cellIterator-&gt;setIterateOnlyExistingCells(false);\r\n\t\r\n\t<span style=\"color: blue;\">foreach</span> ($cellIterator <span style=\"color: blue;\">as</span> $cell) {\r\n\t\t $sql[] = mysql_real_escape_string($data-&gt;sheets[0][<span style=\"color: #a31515;\">'cells'</span>][$i][$j] = $cell-&gt;getValue());\r\n\t\t\r\n\t\t$j++;\r\n\t} <span style=\"color: green;\">// end cell getter</span>\r\n\t\r\n\t$i++;\r\n\t\r\n} <span style=\"color: green;\">// end row getter</span>\r\n\r\n$query = <span style=\"color: #a31515;\">\"INSERT INTO `upload` VALUES (\"</span>.implode(<span style=\"color: #a31515;\">\"), (\"</span>, $sql). <span style=\"color: #a31515;\">\")\"</span>;\r\nmysql_query($query);\r\n</pre>\r\n</div>\r\n</p>",
    "PostedDate": "2011-11-08T08:37:03.063-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]