[
  {
    "Id": "415570",
    "ThreadId": "204223",
    "Html": "<p>Hello everyone,</p>\r\n<p>I'm trying to export the content of a MySQL table to a xls file. This works fine using XAMPP for testing, but when I uploaded the script containing the code to my webspace and tried to run it, it just opened an empty excel file, although the table was correctly exported locally on my computer (XAMPP).</p>\r\n<p>This function contains the code</p>\r\n<p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre><span style=\"color:Blue\">function</span> excel()\r\n{\r\n\t<span style=\"color:Blue\">global</span> $data, $tabl;\r\n\t<span style=\"color:Blue\">global</span> $show, $order;\r\n\t\r\n\t$filename = $data . <span style=\"color:#A31515\">'_'</span> . $tabl . <span style=\"color:#A31515\">'_'</span> . date(<span style=\"color:#A31515\">'Y-m-d-H-i-s'</span>) . <span style=\"color:#A31515\">'.xls'</span>;\r\n\theader(<span style=\"color:#A31515\">'Content-Type: application/vnd.ms-excel'</span>);\r\n\theader(<span style=\"color:#A31515\">'Content-Disposition: attachment;filename=&quot;'</span> . $filename . <span style=\"color:#A31515\">'&quot;'</span>);\r\n\theader(<span style=\"color:#A31515\">'Cache-Control: max-age=0'</span>);\r\n\r\n\t<span style=\"color:Blue\">require_once</span>(<span style=\"color:#A31515\">'PHPExcel 1.7.2/Classes/PHPExcel.php'</span>);\r\n\t<span style=\"color:Blue\">require_once</span>(<span style=\"color:#A31515\">'PHPExcel 1.7.2/Classes/PHPExcel/IOFactory.php'</span>);\r\n\t\r\n\t$objPHPExcel = <span style=\"color:Blue\">new</span> PHPExcel();\t<span style=\"color:Green\">//new PHPExcel object</span>\r\n\t\t\r\n\t$ci = <span style=\"color:Blue\">array</span>(<span style=\"color:#A31515\">'A'</span>, <span style=\"color:#A31515\">'B'</span>, <span style=\"color:#A31515\">'C'</span>, <span style=\"color:#A31515\">'D'</span>, <span style=\"color:#A31515\">'E'</span>, <span style=\"color:#A31515\">'F'</span>, <span style=\"color:#A31515\">'G'</span>, <span style=\"color:#A31515\">'H'</span>, <span style=\"color:#A31515\">'I'</span>, <span style=\"color:#A31515\">'J'</span>, <span style=\"color:#A31515\">'K'</span>, <span style=\"color:#A31515\">'L'</span>, <span style=\"color:#A31515\">'M'</span>, <span style=\"color:#A31515\">'N'</span>, <span style=\"color:#A31515\">'O'</span>, <span style=\"color:#A31515\">'P'</span>, <span style=\"color:#A31515\">'Q'</span>);\t<span style=\"color:Green\">//col index</span>\r\n\t$ri = 1;\t<span style=\"color:Green\">//row index</span>\r\n\t$cc = 0;\t<span style=\"color:Green\">//set col counter</span>\r\n\t\r\n\t$qry\t= <span style=\"color:#A31515\">&quot;SELECT &quot;</span>;\r\n\t<span style=\"color:Blue\">if</span>($_POST[<span style=\"color:#A31515\">'show_ln'</span>])\t{ $qry .= <span style=\"color:#A31515\">&quot;ln, &quot;</span>;\t$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue($ci[$cc] . <span style=\"color:#A31515\">'1'</span>, <span style=\"color:#A31515\">'Zeile'</span>);\t\t$cc++; }\r\n\t<span style=\"color:Blue\">if</span>($_POST[<span style=\"color:#A31515\">'show_datum'</span>]){ $qry .= <span style=\"color:#A31515\">&quot;datum, &quot;</span>;    $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue($ci[$cc] . <span style=\"color:#A31515\">'1'</span>, <span style=\"color:#A31515\">'Datum'</span>);\t\t$cc++; }\r\n\t<span style=\"color:Blue\">if</span>($_POST[<span style=\"color:#A31515\">'show_bad'</span>])\t{ $qry .= <span style=\"color:#A31515\">&quot;bad, &quot;</span>;\t$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue($ci[$cc] . <span style=\"color:#A31515\">'1'</span>, <span style=\"color:#A31515\">'Bad'</span>);\t\t$cc++; }\r\n\t<span style=\"color:Blue\">if</span>($_POST[<span style=\"color:#A31515\">'show_zeit'</span>])\t{ $qry .= <span style=\"color:#A31515\">&quot;zeit, &quot;</span>;\t$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue($ci[$cc] . <span style=\"color:#A31515\">'1'</span>, <span style=\"color:#A31515\">'Uhrzeit'</span>);\t$cc++; }\r\n\t<span style=\"color:Blue\">if</span>($_POST[<span style=\"color:#A31515\">'show_kurs'</span>])\t{ $qry .= <span style=\"color:#A31515\">&quot;kurs, &quot;</span>;\t$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue($ci[$cc] . <span style=\"color:#A31515\">'1'</span>, <span style=\"color:#A31515\">'Kurs'</span>);\t\t$cc++; }\r\n\t<span style=\"color:Blue\">if</span>($_POST[<span style=\"color:#A31515\">'show_nn'</span>])\t{ $qry .= <span style=\"color:#A31515\">&quot;nn, &quot;</span>;\t$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue($ci[$cc] . <span style=\"color:#A31515\">'1'</span>, <span style=\"color:#A31515\">'Nachname'</span>);\t$cc++; }\r\n\t<span style=\"color:Blue\">if</span>($_POST[<span style=\"color:#A31515\">'show_vn'</span>])\t{ $qry .= <span style=\"color:#A31515\">&quot;vn, &quot;</span>;\t$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue($ci[$cc] . <span style=\"color:#A31515\">'1'</span>, <span style=\"color:#A31515\">'Vorname'</span>);\t$cc++; }\r\n\t<span style=\"color:Blue\">if</span>($_POST[<span style=\"color:#A31515\">'show_geb'</span>])\t{ $qry .= <span style=\"color:#A31515\">&quot;geb, &quot;</span>;\t$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue($ci[$cc] . <span style=\"color:#A31515\">'1'</span>, <span style=\"color:#A31515\">'Geburtstag'</span>);\t$cc++; }\r\n\t<span style=\"color:Blue\">if</span>($_POST[<span style=\"color:#A31515\">'show_plz'</span>])\t{ $qry .= <span style=\"color:#A31515\">&quot;plz, &quot;</span>;\t$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue($ci[$cc] . <span style=\"color:#A31515\">'1'</span>, <span style=\"color:#A31515\">'PLZ'</span>);\t\t$cc++; }\r\n\t<span style=\"color:Blue\">if</span>($_POST[<span style=\"color:#A31515\">'show_ort'</span>])\t{ $qry .= <span style=\"color:#A31515\">&quot;ort, &quot;</span>;\t$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue($ci[$cc] . <span style=\"color:#A31515\">'1'</span>, <span style=\"color:#A31515\">'Wohnort'</span>);\t$cc++; }\r\n\t<span style=\"color:Blue\">if</span>($_POST[<span style=\"color:#A31515\">'show_tel'</span>])\t{ $qry .= <span style=\"color:#A31515\">&quot;tel, &quot;</span>;\t$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue($ci[$cc] . <span style=\"color:#A31515\">'1'</span>, <span style=\"color:#A31515\">'Tel.nummer'</span>);\t$cc++; }\r\n\t<span style=\"color:Blue\">if</span>($_POST[<span style=\"color:#A31515\">'show_email'</span>]){ $qry .= <span style=\"color:#A31515\">&quot;email, &quot;</span>;    $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue($ci[$cc] . <span style=\"color:#A31515\">'1'</span>, <span style=\"color:#A31515\">'E-Mail'</span>);\t\t$cc++; }\r\n\t<span style=\"color:Blue\">if</span>($_POST[<span style=\"color:#A31515\">'show_anm'</span>])\t{ $qry .= <span style=\"color:#A31515\">&quot;anm, &quot;</span>;\t$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue($ci[$cc] . <span style=\"color:#A31515\">'1'</span>, <span style=\"color:#A31515\">'Anmerkung'</span>);\t$cc++; }\r\n\t<span style=\"color:Blue\">if</span>($_POST[<span style=\"color:#A31515\">'show_start'</span>]){ $qry .= <span style=\"color:#A31515\">&quot;start, &quot;</span>;    $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue($ci[$cc] . <span style=\"color:#A31515\">'1'</span>, <span style=\"color:#A31515\">'Start'</span>);\t\t$cc++; }\r\n\t<span style=\"color:Blue\">if</span>($_POST[<span style=\"color:#A31515\">'show_an'</span>])\t{ $qry .= <span style=\"color:#A31515\">&quot;an, &quot;</span>;\t$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue($ci[$cc] . <span style=\"color:#A31515\">'1'</span>, <span style=\"color:#A31515\">'Anschrift'</span>);\t$cc++; }\r\n\t<span style=\"color:Blue\">if</span>($_POST[<span style=\"color:#A31515\">'show_zahl'</span>])\t{ $qry .= <span style=\"color:#A31515\">&quot;zahl, &quot;</span>;\t$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue($ci[$cc] . <span style=\"color:#A31515\">'1'</span>, <span style=\"color:#A31515\">'Zahlung'</span>);\t$cc++; }\r\n\t<span style=\"color:Blue\">if</span>($_POST[<span style=\"color:#A31515\">'show_bez'</span>])\t{ $qry .= <span style=\"color:#A31515\">&quot;bez, &quot;</span>;\t$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue($ci[$cc] . <span style=\"color:#A31515\">'1'</span>, <span style=\"color:#A31515\">'bezahlt'</span>);\t$cc++; }\r\n\t$qry = substr($qry, 0, -2);\t<span style=\"color:Green\">//cut off last comma</span>\r\n\t$qry\t.= <span style=\"color:#A31515\">&quot; FROM &quot;</span> . $tabl . $order;\r\n\r\n\t$res = mysql_query($qry) <span style=\"color:Blue\">or</span> <span style=\"color:Blue\">die</span>(mysql_error());\r\n\t\r\n\t<span style=\"color:Blue\">while</span>($row = mysql_fetch_row($res))\r\n\t{\r\n\t\t$ri++;\t\t<span style=\"color:Green\">//increase row index</span>\r\n\t\t$cc = 0;\t<span style=\"color:Green\">//set col counter</span>\r\n\t\t<span style=\"color:Blue\">foreach</span>($row <span style=\"color:Blue\">as</span> $val)\r\n\t\t{\t\t\t\r\n\t\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue($ci[$cc] . $ri, $val);\r\n\t\t\t\r\n\t\t\t$cc++;\t<span style=\"color:Green\">//increase col counter</span>\r\n\t\t}\r\n\t}\r\n\t\t\r\n\t$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, <span style=\"color:#A31515\">'Excel5'</span>);\r\n\t$objWriter-&gt;save(<span style=\"color:#A31515\">'php://output'</span>);\r\n\r\n\t<span style=\"color:Blue\">exit</span>();\r\n}\r\n</pre>\r\n</div>\r\n</p>\r\n<p>I don't know&nbsp; why this works well offline but doesn't do it online.</p>\r\n<p>Thanks for your help and best wishes,</p>\r\n<p>&nbsp; Fredl</p>",
    "PostedDate": "2010-03-08T10:46:08.707-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "417169",
    "ThreadId": "204223",
    "Html": "<p>Check if you have php-xml. I've got the same problem and after lot of debugging - I found that ExcelWriter crashes while creating new XMLWriter(). After installing php-xml - everything works OK for me.</p>",
    "PostedDate": "2010-03-11T13:52:04.967-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "417365",
    "ThreadId": "204223",
    "Html": "<p>Thanks for your help. However, I found the error in the meantime.</p>",
    "PostedDate": "2010-03-12T03:15:23.92-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]