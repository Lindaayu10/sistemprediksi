[
  {
    "Id": "1313849",
    "ThreadId": "569917",
    "Html": "Hello! How can I make it so that all groups were collapsed? Tried to use setCollapsed, but nothing came out. Save the document in Excel5 format.\r<br />\nThanks!<br />\n<div style=\"color:Black;background-color:White;\"><pre>\r\n<span style=\"color:Green;\">// ~~~ Grouping ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>\n        $Group = 0;\n\n        <span style=\"color:Green;\">// First group</span>\n        <span style=\"color:Blue;\">for</span> ($Row = 13; $Row &lt; ($iLastRow - 1); $Row++) {\n            $CellColor = $oSheet-&gt;getStyle(<span style=\"color:#A31515;\">&quot;A&quot;</span> . $Row)-&gt;getFill()-&gt;getStartColor()-&gt;getRGB();\n            <span style=\"color:Blue;\">if</span> ($CellColor == <span style=\"color:#A31515;\">&quot;333399&quot;</span>) {\n                <span style=\"color:Blue;\">if</span> ($Group &lt;&gt; 0) {\n                    <span style=\"color:Blue;\">for</span> ($RowG = $Group; $RowG &lt;= ($Row - 1); $RowG++) {\n                        $oSheet-&gt;getRowDimension($RowG)\n                                -&gt;setOutlineLevel(1)\n                                -&gt;setVisible(false);\n                    }\n                }\n                $Group = $Row + 1;\n            }\n        }\n\n        <span style=\"color:Green;\">// Second group</span>\n        <span style=\"color:Blue;\">for</span> ($Row = 13; $Row &lt; ($iLastRow - 1); $Row++) {\n            $CellColor = $oSheet-&gt;getStyle(<span style=\"color:#A31515;\">&quot;A&quot;</span> . $Row)-&gt;getFill()-&gt;getStartColor()-&gt;getRGB();\n            <span style=\"color:Blue;\">if</span> ($CellColor == <span style=\"color:#A31515;\">&quot;333399&quot;</span>) {\n                <span style=\"color:Blue;\">if</span> ($Group &lt;&gt; 0) {\n                    <span style=\"color:Blue;\">for</span> ($RowG = $Group; $RowG &lt;= ($Row - 1); $RowG++) {\n                        $oSheet-&gt;getRowDimension($RowG)\n                                -&gt;setOutlineLevel(2)\n                                -&gt;setVisible(false);\n                    }\n                }\n                $Group = 0;\n            } <span style=\"color:Blue;\">elseif</span> ($CellColor == <span style=\"color:#A31515;\">&quot;9999FF&quot;</span>) {\n                <span style=\"color:Blue;\">if</span> ($Group &lt;&gt; 0) {\n                    <span style=\"color:Blue;\">for</span> ($RowG = $Group; $RowG &lt;= ($Row - 1); $RowG++) {\n                        $oSheet-&gt;getRowDimension($RowG)\n                                -&gt;setOutlineLevel(2)\n                                -&gt;setVisible(false);\n                    }\n                }\n                $Group = $Row + 1;\n            }\n        }\n\n        <span style=\"color:Green;\">// Third group</span>\n        <span style=\"color:Blue;\">for</span> ($Row = 13; $Row &lt; ($iLastRow - 1); $Row++) {\n            $CellColor = $oSheet-&gt;getStyle(<span style=\"color:#A31515;\">&quot;A&quot;</span> . $Row)-&gt;getFill()-&gt;getStartColor()-&gt;getRGB();\n            <span style=\"color:Blue;\">if</span> ($CellColor == <span style=\"color:#A31515;\">&quot;808080&quot;</span>) {\n                <span style=\"color:Blue;\">if</span> ($Group &lt;&gt; 0) {\n                    <span style=\"color:Blue;\">for</span> ($RowG = $Group; $RowG &lt;= ($Row - 1); $RowG++) {\n                        $oSheet-&gt;getRowDimension($RowG)\n                                -&gt;setOutlineLevel(3)\n                                -&gt;setVisible(false);\n                    }\n                }\n                $Group = $Row + 1;\n            } <span style=\"color:Blue;\">elseif</span> ($CellColor == <span style=\"color:#A31515;\">&quot;333399&quot;</span>) {\n                <span style=\"color:Blue;\">if</span> ($Group &lt;&gt; 0) {\n                    <span style=\"color:Blue;\">for</span> ($RowG = $Group; $RowG &lt;= ($Row - 1); $RowG++) {\n                        $oSheet-&gt;getRowDimension($RowG)\n                                -&gt;setOutlineLevel(3)\n                                -&gt;setVisible(false);\n                    }\n                }\n                $Group = 0;\n            } <span style=\"color:Blue;\">elseif</span> ($CellColor == <span style=\"color:#A31515;\">&quot;9999FF&quot;</span>) {\n                <span style=\"color:Blue;\">if</span> ($Group &lt;&gt; 0) {\n                    <span style=\"color:Blue;\">for</span> ($RowG = $Group; $RowG &lt;= ($Row - 1); $RowG++) {\n                        $oSheet-&gt;getRowDimension($RowG)\n                                -&gt;setOutlineLevel(3)\n                                -&gt;setVisible(false);\n                    }\n                }\n                $Group = 0;\n            }\n        }\n        $oSheet-&gt;setShowSummaryBelow(false);\r\n</pre></div>",
    "PostedDate": "2014-10-15T23:55:58.203-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]