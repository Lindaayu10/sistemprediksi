[
  {
    "Id": "710224",
    "ThreadId": "282478",
    "Html": "\r\n<div>\r\n<p>Hi,</p>\r\n<p>I have a basic question. The script &nbsp;works like I want, but it is saving the export-file automatically.</p>\r\n<p>How can I let the user to choose in which directory he wants to save the file?</p>\r\n<p>thanks stanneo</p>\r\n<p>Now the script</p>\r\n<p></p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre>&lt;?php\r\nob_start();\r\n\r\n<span style=\"color:green\">/** Error reporting */</span>\r\nerror_reporting(E_ALL);\r\n\r\ndate_default_timezone_set(<span style=\"color:#a31515\">'Europe/London'</span>);\r\n\r\n<span style=\"color:green\">/** PHPExcel */</span>\r\n<span style=\"color:blue\">require_once</span> <span style=\"color:#a31515\">'Classes/PHPExcel.php'</span>;\r\n\r\n<span style=\"color:blue\">require_once</span> <span style=\"color:#a31515\">&quot;settings.php&quot;</span>;\r\n<span style=\"color:blue\">require_once</span> <span style=\"color:#a31515\">&quot;dbconnection.php&quot;</span>;\r\n\r\n\r\n\r\n<span style=\"color:green\">// Create new PHPExcel object</span>\r\n$objPHPExcel = <span style=\"color:blue\">new</span> PHPExcel();\r\n\r\n<span style=\"color:green\">// Set properties</span>\r\n$objPHPExcel-&gt;getProperties()-&gt;setCreator(<span style=\"color:#a31515\">&quot;TestOnly&quot;</span>)\r\n\t\t\t\t\t\t\t -&gt;setLastModifiedBy(<span style=\"color:#a31515\">&quot;TestOnly&quot;</span>)\r\n\t\t\t\t\t\t\t -&gt;setTitle(<span style=\"color:#a31515\">&quot;Office 2007 XLSX Test Document&quot;</span>)\r\n\t\t\t\t\t\t\t -&gt;setSubject(<span style=\"color:#a31515\">&quot;Office 2007 XLSX Test Document&quot;</span>)\r\n\t\t\t\t\t\t\t -&gt;setDescription(<span style=\"color:#a31515\">&quot;Test document for Office 2007 XLSX, generated using PHP classes.&quot;</span>)\r\n\t\t\t\t\t\t\t -&gt;setKeywords(<span style=\"color:#a31515\">&quot;office 2007 openxml php&quot;</span>)\r\n\t\t\t\t\t\t\t -&gt;setCategory(<span style=\"color:#a31515\">&quot;Test result file&quot;</span>);\r\n\r\n\t\t\t\r\n<span style=\"color:blue\">if</span> ($stmt =$mysqli-&gt;prepare(<span style=\"color:#a31515\">&quot;SELECT Id, A,B,C  FROM db1t1 order by Id DESC;&quot;</span>));\r\n$stmt-&gt;execute();\r\n$stmt-&gt;store_result();\r\n$stmt-&gt;bind_result($Id, $A, $B, $C);\r\n\t\t\t\t\t\t\t\t\r\n<span style=\"color:green\">// Add some data, we will use printing features</span>\r\n<span style=\"color:blue\">echo</span> date(<span style=\"color:#a31515\">'H:i:s'</span>) . <span style=\"color:#a31515\">&quot; Add some data\\n&quot;</span>;\r\n\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#a31515\">'A1'</span>,<span style=\"color:#a31515\">'Id'</span>);\r\n\t$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#a31515\">'B1'</span> ,<span style=\"color:#a31515\">'A'</span>);\r\n\t$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#a31515\">'C1'</span> ,<span style=\"color:#a31515\">'B'</span>);\r\n\t$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#a31515\">'D1'</span> ,<span style=\"color:#a31515\">'C'</span>);\r\n\r\n$i =2;\r\n\r\n<span style=\"color:blue\">while</span>($stmt-&gt;fetch())\r\n\r\n {\r\n\r\n\t$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#a31515\">'A'</span> . $i, $Id);\r\n\t$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#a31515\">'B'</span> . $i, $A);\r\n\t$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#a31515\">'C'</span> . $i, $B);\r\n\t$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(<span style=\"color:#a31515\">'C'</span> . $i, $C);\r\n\t\r\n\t$i&#43;&#43;;\r\n\r\n}\t\r\n\r\n<span style=\"color:green\">// Rename sheet</span>\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setTitle(<span style=\"color:#a31515\">'db1t1'</span>);\r\n\r\n\r\n\r\n<span style=\"color:green\">// Set active sheet index to the first sheet, so Excel opens this as the first sheet</span>\r\n$objPHPExcel-&gt;setActiveSheetIndex(0);\r\n\r\n\r\n<span style=\"color:green\">// Save Excel 2007 file</span>\r\n<span style=\"color:blue\">echo</span> date(<span style=\"color:#a31515\">'H:i:s'</span>) . <span style=\"color:#a31515\">&quot; Write to Excel2007 format\\n&quot;</span>;\r\n$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, <span style=\"color:#a31515\">'Excel2007'</span>);\r\n$objWriter-&gt;save(str_replace(<span style=\"color:#a31515\">'.php'</span>, <span style=\"color:#a31515\">'.xlsx'</span>, <span style=\"color:blue\">__FILE__</span>));\r\n\r\n\r\n<span style=\"color:green\">// Echo memory peak usage</span>\r\n<span style=\"color:blue\">echo</span> date(<span style=\"color:#a31515\">'H:i:s'</span>) . <span style=\"color:#a31515\">&quot; Peak memory usage: &quot;</span> . (memory_get_peak_usage(true) / 1024 / 1024) . <span style=\"color:#a31515\">&quot; MB\\r\\n&quot;</span>;\r\n\r\n<span style=\"color:green\">// Echo done</span>\r\n<span style=\"color:blue\">echo</span> date(<span style=\"color:#a31515\">'H:i:s'</span>) . <span style=\"color:#a31515\">&quot; Done writing file.\\r\\n&quot;</span>;\r\nob_end_flush();\r\n?&gt;\r\n</pre>\r\n</div>\r\n<p></p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n</div>\r\n",
    "PostedDate": "2011-12-10T03:02:54.74-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "712056",
    "ThreadId": "282478",
    "Html": "<p>$objWriter-&gt;save('/directory/where/I/want/to/save/the/file/filename.xlsx');</p>\n<p>for saving the directory on the server</p>\n<p>If you're talking about on a client PC, then use php://output as the save filename, and ensure you send the correct headings to the browser, as shown in /Tests/01simple-download-xlsx.php</p>",
    "PostedDate": "2011-12-14T04:05:45.097-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "712106",
    "ThreadId": "282478",
    "Html": "<blockquote style=\"border: solid .1em #ccc; font-style: italic; margin: .25em 1em 0 1em; padding: 0 .25em 0 .25em;\"><strong>MarkBaker wrote:</strong><br />\r\n<p>$objWriter-&gt;save('/directory/where/I/want/to/save/the/file/filename.xlsx');</p>\r\n<p>for saving the directory on the server</p>\r\n<p>If you're talking about on a client PC, then use php://output as the save filename, and ensure you send the correct headings to the browser, as shown in /Tests/01simple-download-xlsx.php</p>\r\n</blockquote>\r\n<p>thanks very much, I think it helps for the &nbsp;first&nbsp;</p>\r\n<p>but it is also possible to let the user to choose the saving &nbsp;directory like windows dialog \"saving under\" or at least as browser dialog \"saving under\"</p>\r\n<p>The php script, which I posted (ExcelExport.php)&nbsp;runs after klicking on a buttom \"Export in Excel\" in a diffrent &nbsp;site.</p>\r\n<p>'&lt;input type=button style=\"background-color:red\" &nbsp;value=\"Export in Excel\" onClick=\"javascript:popUp(\\'ExcelExport.php\\')\"&gt;',</p>\r\n<p>I hope, I can make clear what I means</p>\r\n<p>Thank you very much and greetings</p>\r\n<p>stanneo</p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2011-12-14T06:10:04.083-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]