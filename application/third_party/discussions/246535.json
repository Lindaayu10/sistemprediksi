[
  {
    "Id": "568091",
    "ThreadId": "246535",
    "Html": "\r\n<p>I've searched everywhere but can't seem to find any documentation or examples on how to use conditional formatting to test if a cell contains text.</p>\r\n<p>I'm assuming it's something like this:</p>\r\n<p></p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre>    $objConditional = <span style=\"color:blue\">new</span> PHPExcel_Style_Conditional();\r\n    $objConditional-&gt;setConditionType(PHPExcel_Style_Conditional::CONDITION_CONTAINSTEXT);\r\n    $objConditional-&gt;setOperatorType(PHPExcel_Style_Conditional::OPERATOR_CONTAINSTEXT);\r\n    $objConditional-&gt;addCondition(<span style=\"color:#a31515\">'?'</span>);\r\n</pre>\r\n</div>\r\n<p></p>\r\n<p>Its the addCondition part I'm unsure of, which is why there is a question mark there. If tried 1, 0, TRUE, a specific text value, and it just doesn't seem to work.</p>\r\n<p>&nbsp;</p>\r\n<p>Does anybody have an example of how to use conditional formatting with text?</p>\r\n",
    "PostedDate": "2011-02-17T11:51:04.523-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "568390",
    "ThreadId": "246535",
    "Html": "<p>Hi,</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;use the following code:</p>\r\n<p>\r\n<div style=\"color: black; background-color: white;\">\r\n<pre>                $conditional = <span style=\"color: blue;\">new</span> PHPExcel_Style_Conditional();                                                                                \r\n                $conditional-&gt;setConditionType(PHPExcel_Style_Conditional::CONDITION_CONTAINSTEXT);                                             \r\n                $conditional-&gt;setOperatorType(PHPExcel_Style_Conditional::OPERATOR_CONTAINSTEXT);                                               \r\n                $conditional-&gt;setText(<span style=\"color: #a31515;\">'OK'</span>);                                                                                                    \r\n                $conditional-&gt;getStyle()-&gt;getFont()-&gt;getColor()-&gt;setARGB(PHPExcel_Style_Color::COLOR_DARKGREEN);                                \r\n                $conditional-&gt;getStyle()-&gt;getFont()-&gt;setBold(true);  \r\n</pre>\r\n</div>\r\nThis works if the string in the cell contains the substring \"OK\".</p>",
    "PostedDate": "2011-02-18T01:08:42.32-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "568623",
    "ThreadId": "246535",
    "Html": "<p>Thanks for the reply, but that isn't working for me, here is exactly whats going on... Column H contains a formula that under one condition displays the word Neutral.</p>\r\n<p>\r\n<div style=\"color: black; background-color: white;\">\r\n<pre>$sheet-&gt;setCellValue(<span style=\"color: #a31515;\">\"H$r\"</span>, <span style=\"color: #a31515;\">\"=IF(AND(G$r&gt;=8%,G$r&lt;15%),\\\"Neutral\\\",IF(G$r&gt;=15%,((C$r/100)*50)*(15-(G$r*100)),IF(G$r&lt;=8%,((C$r/100)*50)*(8-(G$r*100)),0)))\"</span>);\r\n</pre>\r\n</div>\r\n</p>\r\n<p>Then I'm setting conditional formatting to do the following.</p>\r\n<ol>\r\n<li>If the result is negative the text is red with a gray background.</li>\r\n<li>If the result of the formula is a positive value, then the text is green with a gray background.</li>\r\n<li>If the result is the word Neutral, display black text with a white background.</li>\r\n</ol>\r\n<p>It seems that the greater than '0' is trumping the contains text.</p>\r\n<p>\r\n<div style=\"color: black; background-color: white;\">\r\n<pre>    $objConditional = <span style=\"color: blue;\">new</span> PHPExcel_Style_Conditional();\r\n    $objConditional-&gt;setConditionType(PHPExcel_Style_Conditional::CONDITION_CELLIS);\r\n    $objConditional-&gt;setOperatorType(PHPExcel_Style_Conditional::OPERATOR_LESSTHAN);\r\n    $objConditional-&gt;addCondition(<span style=\"color: #a31515;\">'0'</span>);\r\n    $objConditional-&gt;getStyle()-&gt;getFont()-&gt;getColor()-&gt;setRGB(<span style=\"color: #a31515;\">'FF0000'</span>);\r\n    $objConditional-&gt;getStyle()-&gt;getNumberFormat()-&gt;setFormatCode(PHPExcel_Style_NumberFormat::FORMAT_CURRENCY_USD_SIMPLE);\r\n    $objConditional-&gt;getStyle()-&gt;getFill()-&gt;setFillType(PHPExcel_Style_Fill::FILL_SOLID)-&gt;getEndColor()-&gt;setRGB(<span style=\"color: #a31515;\">'CFCFCF'</span>);\r\n\r\n    $objConditional2 = <span style=\"color: blue;\">new</span> PHPExcel_Style_Conditional();\r\n    $objConditional2-&gt;setConditionType(PHPExcel_Style_Conditional::CONDITION_CELLIS);\r\n    $objConditional2-&gt;setOperatorType(PHPExcel_Style_Conditional::OPERATOR_GREATERTHAN);\r\n    $objConditional2-&gt;addCondition(<span style=\"color: #a31515;\">'0'</span>);\r\n    $objConditional2-&gt;getStyle()-&gt;getFont()-&gt;getColor()-&gt;setRGB(<span style=\"color: #a31515;\">'00B050'</span>);\r\n    $objConditional2-&gt;getStyle()-&gt;getNumberFormat()-&gt;setFormatCode(PHPExcel_Style_NumberFormat::FORMAT_CURRENCY_USD_SIMPLE);\r\n    $objConditional2-&gt;getStyle()-&gt;getFill()-&gt;setFillType(PHPExcel_Style_Fill::FILL_SOLID)-&gt;getEndColor()-&gt;setRGB(<span style=\"color: #a31515;\">'CFCFCF'</span>);\r\n\r\n    $objConditional3 = <span style=\"color: blue;\">new</span> PHPExcel_Style_Conditional();\r\n    $objConditional3-&gt;setConditionType(PHPExcel_Style_Conditional::CONDITION_CONTAINSTEXT);\r\n    $objConditional3-&gt;setOperatorType(PHPExcel_Style_Conditional::OPERATOR_CONTAINSTEXT);\r\n    $objConditional3-&gt;setText(<span style=\"color: #a31515;\">'Neutral'</span>);\r\n    $objConditional3-&gt;getStyle()-&gt;getFont()-&gt;getColor()-&gt;setRGB(<span style=\"color: #a31515;\">'000000'</span>);\r\n    $objConditional3-&gt;getStyle()-&gt;getFill()-&gt;setFillType(PHPExcel_Style_Fill::FILL_SOLID)-&gt;getEndColor()-&gt;setRGB(<span style=\"color: #a31515;\">'FFFFFF'</span>);\r\n\r\n    $conditionalStyles = $sheet-&gt;getStyle(<span style=\"color: #a31515;\">'H'</span>.$reportStart.<span style=\"color: #a31515;\">':H'</span>.$r)-&gt;getConditionalStyles();\r\n    array_push($conditionalStyles, $objConditional);\r\n    array_push($conditionalStyles, $objConditional2);\r\n    array_push($conditionalStyles, $objConditional3);\r\n    $sheet-&gt;getStyle(<span style=\"color: #a31515;\">'H'</span>.$reportStart.<span style=\"color: #a31515;\">':H'</span>.$r)-&gt;setConditionalStyles($conditionalStyles);\r\n</pre>\r\n</div>\r\nAny suggestions? If I remove the other conditions, the Text condition works.</p>\r\n<p>That just gave me an Idea.....</p>\r\n<p>OK so I changed the order of the conditions and it works! I moved the Text condition first. Confessional debugging at it's best.</p>\r\n<p>\r\n<div style=\"color: black; background-color: white;\">\r\n<pre>    $conditionalStyles = $sheet-&gt;getStyle(<span style=\"color: #a31515;\">'H'</span>.$reportStart.<span style=\"color: #a31515;\">':H'</span>.$r)-&gt;getConditionalStyles();\r\n    array_push($conditionalStyles, $objConditional3);\r\n    array_push($conditionalStyles, $objConditional);\r\n    array_push($conditionalStyles, $objConditional2);\r\n    $sheet-&gt;getStyle(<span style=\"color: #a31515;\">'H'</span>.$reportStart.<span style=\"color: #a31515;\">':H'</span>.$r)-&gt;setConditionalStyles($conditionalStyles);\r\n</pre>\r\n</div>\r\nSo problem solved but I'm going to post anyways, someone else may be frustrated with the same problem in the future.</p>",
    "PostedDate": "2011-02-18T08:47:05.727-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]