[
  {
    "Id": "239466",
    "ThreadId": "70313",
    "Html": "<p>I tried to follow documentation 44:34 to redirect and save the files.</p>\r\n<p>I can't to get the right output, my excel2003 viewer can't view the document.</p>\r\n<p>Below are the code:</p>\r\n<p>&lt;?php<br>header('Content-Type: application/vnd.ms-excel');<br>header('Content-Disposition: attachment;filename=&quot;report.xls&quot;');<br>header('Cache-Control: max-age=0');<br><br><br>/** Error reporting */<br>error_reporting(E_ALL);<br><br>/** Include path **/<br>ini_set('include_path', ini_get('include_path').';/classes/');<br><br>/** PHPExcel */<br>include 'PHPExcel.php';<br><br>/** PHPExcel_Writer_Excel2007 */<br>include 'PHPExcel/Writer/Excel5.php';<br><br>// Create new PHPExcel object<br>echo date('H:i:s') . &quot; Create new PHPExcel object\\n&quot;;<br>$objPHPExcel = new PHPExcel();<br><br>// Set properties<br>echo date('H:i:s') . &quot; Set properties\\n&quot;;<br>$objPHPExcel-&gt;getProperties()-&gt;setCreator(&quot;Maarten Balliauw&quot;);<br>$objPHPExcel-&gt;getProperties()-&gt;setLastModifiedBy(&quot;Maarten Balliauw&quot;);<br>$objPHPExcel-&gt;getProperties()-&gt;setTitle(&quot;Office 2007 XLSX Test Document&quot;);<br>$objPHPExcel-&gt;getProperties()-&gt;setSubject(&quot;Office 2007 XLSX Test Document&quot;);<br>$objPHPExcel-&gt;getProperties()-&gt;setDescription(&quot;Test document for Office 2007 XLSX, generated using PHP classes.&quot;);<br><br><br>// Add some data<br>echo date('H:i:s') . &quot; Add some data\\n&quot;;<br>$objPHPExcel-&gt;setActiveSheetIndex(0);<br>$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue('A1', 'Hello');<br>$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue('B2', 'world!');<br>$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue('C1', 'Hello');<br>$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue('D2', 'world!');<br><br>// Rename sheet<br>echo date('H:i:s') . &quot; Rename sheet\\n&quot;;<br>$objPHPExcel-&gt;getActiveSheet()-&gt;setTitle('Simple');<br><br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;<br>// Save Excel 2007 file<br>echo date('H:i:s') . &quot; Write to Excel2007 format\\n&quot;;<br><br>$link = &quot;C:&quot;;<br>//$writer = new PHPExcel_Writer_Excel5($objPHPExcel);<br>//$writer-&gt;save('C:\\records.xls');<br><br><br>//$writer = new PHPExcel_Writer_Excel5($objPHPExcel);<br>//$writer-&gt;save('php://output');<br>$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, 'Excel5');<br>$objWriter-&gt;save('C:\\records.xls'); <br>?&gt;</p>\r\n<p>Anyone could help me out?</p>",
    "PostedDate": "2009-09-28T03:28:22.227-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "239514",
    "ThreadId": "70313",
    "Html": "<p>You need to remove all echo statements and save to <span style=\"font-family:Courier New\">php://output</span>. Here is a complete example:</p>\r\n<pre>&lt;?php<br>// 01simple.php -- Send output to client browser instead of saving to disk<br><br>error_reporting(E_ALL);<br>ini_set(<span style=\"color:#a31515\">'display_errors'</span>, <span style=\"color:#a31515\">'1'</span>);<br><br><span style=\"color:blue\">require_once</span> <span style=\"color:#a31515\">'../Classes/PHPExcel.php'</span>;<br><span style=\"color:blue\">require_once</span> <span style=\"color:#a31515\">'../Classes/PHPExcel/IOFactory.php'</span>;<br><br>$objPHPExcel = <span style=\"color:blue\">new</span> PHPExcel();<br>$objPHPExcel-&gt;getProperties()-&gt;setCreator(<span style=\"color:#a31515\">&quot;Maarten Balliauw&quot;</span>)<br>                             -&gt;setLastModifiedBy(<span style=\"color:#a31515\">&quot;Maarten Balliauw&quot;</span>)<br>                             -&gt;setTitle(<span style=\"color:#a31515\">&quot;Office 2007 XLSX Test Document&quot;</span>)<br>                             -&gt;setSubject(<span style=\"color:#a31515\">&quot;Office 2007 XLSX Test Document&quot;</span>)<br>                             -&gt;setDescription(<span style=\"color:#a31515\">&quot;Test document for Office 2007 XLSX, generated using PHP classes.&quot;</span>)<br>                             -&gt;setKeywords(<span style=\"color:#a31515\">&quot;office 2007 openxml php&quot;</span>)<br>                             -&gt;setCategory(<span style=\"color:#a31515\">&quot;Test result file&quot;</span>);<br><br>$objPHPExcel-&gt;setActiveSheetIndex(0)<br>            -&gt;setCellValue(<span style=\"color:#a31515\">'A1'</span>, <span style=\"color:#a31515\">'Hello'</span>)<br>            -&gt;setCellValue(<span style=\"color:#a31515\">'B2'</span>, <span style=\"color:#a31515\">'world!'</span>)<br>            -&gt;setCellValue(<span style=\"color:#a31515\">'C1'</span>, <span style=\"color:#a31515\">'Hello'</span>)<br>            -&gt;setCellValue(<span style=\"color:#a31515\">'D2'</span>, <span style=\"color:#a31515\">'world!'</span>);<br><br>$objPHPExcel-&gt;getActiveSheet()-&gt;setTitle(<span style=\"color:#a31515\">'Simple'</span>);<br><br>$objPHPExcel-&gt;setActiveSheetIndex(0);<br><br>header(<span style=\"color:#a31515\">'Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'</span>);<br>header(<span style=\"color:#a31515\">'Content-Disposition: attachment;filename=&quot;01simple.xlsx&quot;'</span>);<br>header(<span style=\"color:#a31515\">'Cache-Control: max-age=0'</span>);<br><br>$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, <span style=\"color:#a31515\">'Excel2007'</span>);<br>$objWriter-&gt;save(<span style=\"color:#a31515\">'p<a title=\"Linkification: http://output\" href=\"http://output/\">hp://output</a>'</span>);<br><span style=\"color:blue\">exit</span>;<br><br>?&gt;<br></pre>",
    "PostedDate": "2009-09-28T06:49:27.837-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "239517",
    "ThreadId": "70313",
    "Html": "<p>Thank you Koyama for showing me how to do it properly!</p>",
    "PostedDate": "2009-09-28T07:00:11.953-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]