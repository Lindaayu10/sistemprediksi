[
  {
    "Id": "292576",
    "ThreadId": "85927",
    "Html": "<p>Hello all,</p>\r\n<p>I have got a problem. I get a CSV file without enclosure character (eg. David;031234;Even street;5190 cause windows export without).</p>\r\n<p>I'd like to keep leading zeros. How can I do that ?</p>\r\n<p>For the moment I use getValue() method. Is there another method ? Is it possible to specify the format I want.</p>\r\n<p>Here my actual code :</p>\r\n<p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre>\t\t\t$objReader = PHPExcel_IOFactory::createReader(<span style=\"color:#A31515\">'CSV'</span>);\r\n\t\t\t$objReader-&gt;setInputEncoding(<span style=\"color:#A31515\">'ISO-8859-1'</span>);\r\n\t\t\t$objReader-&gt;setDelimiter(<span style=\"color:#A31515\">';'</span>);\r\n\t\t\t$objReader-&gt;setEnclosure(<span style=\"color:#A31515\">''</span>);\r\n\t\t\t$objReader-&gt;setLineEnding(<span style=\"color:#A31515\">&quot;\\r\\n&quot;</span>);\r\n\t\t\t$objReader-&gt;setSheetIndex(0);\r\n\t\t\t$objPHPExcel = $objReader-&gt;load($this-&gt;_filename);\r\n\t\t\t$objWorksheet = $objPHPExcel-&gt;getActiveSheet();\r\n\t\t\t$data = <span style=\"color:Blue\">array</span>();\r\n\t\t\t$firstline = true;\r\n\t\t\t<span style=\"color:Blue\">foreach</span> ($objWorksheet-&gt;getRowIterator() <span style=\"color:Blue\">as</span> $row)\r\n\t\t\t{\r\n\t\t\t\t$record = <span style=\"color:Blue\">array</span>();\r\n\t\t\t\t$cellIterator = $row-&gt;getCellIterator();\r\n\t\t\t\t$cellIterator-&gt;setIterateOnlyExistingCells(false);\r\n\t\t\t\t<span style=\"color:Blue\">foreach</span> ($cellIterator <span style=\"color:Blue\">as</span> $cell) {\r\n\t\t\t\t\t<span style=\"color:Blue\">if</span> (!<span style=\"color:Blue\">empty</span>($cell))\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t$record[] = $cell-&gt;getValue();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t<span style=\"color:Blue\">else</span>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t$record[] = <span style=\"color:#A31515\">'&quot;&quot;'</span>;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n</pre>\r\n</div>\r\n</p>\r\n<p>Tyvm</p>",
    "PostedDate": "2010-02-19T03:45:24.837-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "310298",
    "ThreadId": "85927",
    "Html": "<p>CSV reader uses the currently set value binder. Which means that you  can try to use a custom value binder like this:</p>\r\n<div style=\"color:black;background-color:white\">\r\n<pre><span style=\"background-color:#ffff00\">         </span><span style=\"background-color:#ffff00\">class</span><span style=\"background-color:#ffff00\"> TextValueBinder </span><span style=\"background-color:#ffff00\">implements</span><span style=\"background-color:#ffff00\"> PHPExcel_Cell_IValueBinder</span><br style=\"font-family:yui-tmp\"><span style=\"background-color:#ffff00\">            {</span><br style=\"font-family:yui-tmp\"><span style=\"background-color:#ffff00\">                </span><span style=\"background-color:#ffff00\">public</span><span style=\"background-color:#ffff00\"> </span><span style=\"background-color:#ffff00\">function</span><span style=\"background-color:#ffff00\"> bindValue(PHPExcel_Cell $cell, $value = null) {</span><br style=\"font-family:yui-tmp\"><span style=\"background-color:#ffff00\">                    $cell-&gt;setValueExplicit($value, PHPExcel_Cell_DataType::TYPE_STRING);</span><br style=\"font-family:yui-tmp\"><span style=\"background-color:#ffff00\">                    </span><span style=\"background-color:#ffff00\">return</span><span style=\"background-color:#ffff00\"> true;</span><br style=\"font-family:yui-tmp\"><span style=\"background-color:#ffff00\">                }</span><br style=\"font-family:yui-tmp\"><span style=\"background-color:#ffff00\">            }</span><br style=\"font-family:yui-tmp\"><br style=\"font-family:yui-tmp\"><span style=\"background-color:#ffff00\">            $savedValueBinder = PHPExcel_Cell::getValueBinder();</span><br style=\"font-family:yui-tmp\"><span style=\"background-color:#ffff00\">            PHPExcel_Cell::setValueBinder(</span><span style=\"background-color:#ffff00\">new</span><span style=\"background-color:#ffff00\"> TextValueBinder());</span><br><br>            $objReader = PHPExcel_IOFactory::createReader(<span style=\"color:#a31515\">'CSV'</span>);<br>            $objReader-&gt;setInputEncoding(<span style=\"color:#a31515\">'ISO-8859-1'</span>);<br>            $objReader-&gt;setDelimiter(<span style=\"color:#a31515\">';'</span>);<br>            $objReader-&gt;setEnclosure(<span style=\"color:#a31515\">''</span>);<br>            $objReader-&gt;setLineEnding(<span style=\"color:#a31515\">&quot;\\r\\n&quot;</span>);<br>            $objReader-&gt;setSheetIndex(0);<br>            <br>            <br>            $objPHPExcel = $objReader-&gt;load($this-&gt;_filename);<br><br><span style=\"background-color:#ffff00\">            PHPExcel_Cell::setValueBinder($savedValueBinder);</span><br><br>            $objWorksheet = $objPHPExcel-&gt;getActiveSheet();<br>            $data = <span style=\"color:blue\">array</span>();<br>            $firstline = true;<br>            <span style=\"color:blue\">foreach</span> ($objWorksheet-&gt;getRowIterator() <span style=\"color:blue\">as</span> $row)<br>            {<br>                $record = <span style=\"color:blue\">array</span>();<br>                $cellIterator = $row-&gt;getCellIterator();<br>                $cellIterator-&gt;setIterateOnlyExistingCells(false);<br>                <span style=\"color:blue\">foreach</span> ($cellIterator <span style=\"color:blue\">as</span> $cell) {<br>                    <span style=\"color:blue\">if</span> (!<span style=\"color:blue\">empty</span>($cell))<br>                    {<br>                        $record[] = $cell-&gt;getValue();<br>                    }<br>                    <span style=\"color:blue\">else</span><br>                    {<br>                        $record[] = <span style=\"color:#a31515\">'&quot;&quot;'</span>;<br>                    }<br>                }<br>            }<br></pre>\r\n</div>\r\n<p>&nbsp;</p>",
    "PostedDate": "2010-02-20T15:46:56.633-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]