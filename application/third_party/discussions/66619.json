[
  {
    "Id": "226396",
    "ThreadId": "66619",
    "Html": "<p>Hi Guys,</p>\r\n<p>I have a Problem with the encoding i think, because when i import csv files i get all values to an array which looks like that:</p>\r\n<pre><pre><pre>  1 <span style=\"color:#888a85\">=&gt;</span> <br>    <strong>array</strong><br>      0 <span style=\"color:#888a85\">=&gt;</span> &lt;small&gt;string&lt;/small&gt; <span style=\"color:#cc0000\">'Max                                         '</span> <em>(length=50)</em><br>      1 <span style=\"color:#888a85\">=&gt;</span> &lt;small&gt;string&lt;/small&gt; <span style=\"color:#cc0000\">'Mustermann                  '</span> <em>(length=25)</em><br>      2 <span style=\"color:#888a85\">=&gt;</span> &lt;small&gt;string&lt;/small&gt; <span style=\"color:#cc0000\">'198070'</span> <em>(length=6)</em><br>      3 <span style=\"color:#888a85\">=&gt;</span> &lt;small&gt;string&lt;/small&gt; <span style=\"color:#cc0000\">'13.05.2009'</span> <em>(length=10)</em><br>      4 <span style=\"color:#888a85\">=&gt;</span> &lt;small&gt;string&lt;/small&gt; <span style=\"color:#cc0000\">'xxxxxxxxxxx'</span> <em>(length=18)</em><br>      5 <span style=\"color:#888a85\">=&gt;</span> &lt;small&gt;string&lt;/small&gt; <span style=\"color:#cc0000\">'09.08.2009'</span> <em>(length=10)</em><br>      6 <span style=\"color:#888a85\">=&gt;</span> &lt;small&gt;string&lt;/small&gt; <span style=\"color:#cc0000\">'115,45'</span> <em>(length=6)</em><br>      7 <span style=\"color:#888a85\">=&gt;</span> &lt;small&gt;string&lt;/small&gt; <span style=\"color:#cc0000\">'j'</span> <em>(length=1)</em><br>      8 <span style=\"color:#888a85\">=&gt;</span> &lt;small&gt;string&lt;/small&gt; <span style=\"color:#cc0000\">'MAKxxxxxx                 '</span> <em>(length=25)</em><br>      9 <span style=\"color:#888a85\">=&gt;</span> &lt;small&gt;string&lt;/small&gt; <span style=\"color:#cc0000\">'3000'</span> <em>(length=4)</em><br>      10 <span style=\"color:#888a85\">=&gt;</span> &lt;small&gt;string&lt;/small&gt; <span style=\"color:#cc0000\">'Angebot'</span> <em>(length=7)</em><br>      11 <span style=\"color:#888a85\">=&gt;</span> &lt;small&gt;string&lt;/small&gt; <span style=\"color:#cc0000\">'146186'</span> <em>(length=6)</em></pre>\r\n</pre>\r\n<em><br>but i need this value (see 7. Element):<br><br></em>\r\n<pre>  1 <span style=\"color:#888a85\">=&gt;</span> <br>    <strong>array</strong><br>      0 <span style=\"color:#888a85\">=&gt;</span> &lt;small&gt;string&lt;/small&gt; <span style=\"color:#cc0000\">'Max                                         '</span> <em>(length=50)</em><br>      1 <span style=\"color:#888a85\">=&gt;</span> &lt;small&gt;string&lt;/small&gt; <span style=\"color:#cc0000\">'Mustermann                  '</span> <em>(length=25)</em><br>      2 <span style=\"color:#888a85\">=&gt;</span> &lt;small&gt;string&lt;/small&gt; <span style=\"color:#cc0000\">'198070'</span> <em>(length=6)</em><br>      3 <span style=\"color:#888a85\">=&gt;</span> &lt;small&gt;string&lt;/small&gt; <span style=\"color:#cc0000\">'13.05.2009'</span> <em>(length=10)</em><br>      4 <span style=\"color:#888a85\">=&gt;</span> &lt;small&gt;string&lt;/small&gt; <span style=\"color:#cc0000\">'xxxxxxxxxxx'</span> <em>(length=18)</em><br>      5 <span style=\"color:#888a85\">=&gt;</span> &lt;small&gt;string&lt;/small&gt; <span style=\"color:#cc0000\">'09.08.2009'</span> <em>(length=10)</em><br>      6 <span style=\"color:#888a85\">=&gt;</span> &lt;small&gt;string&lt;/small&gt; <span style=\"color:#cc0000\">'115,45'</span> <em>(length=6)</em><br>      7 <span style=\"color:#888a85\">=&gt;</span> &lt;small&gt;string&lt;/small&gt; <span style=\"color:#cc0000\">'j&auml;hrlich'</span> <em>(length=8)</em><br>      8 <span style=\"color:#888a85\">=&gt;</span> &lt;small&gt;string&lt;/small&gt; <span style=\"color:#cc0000\">'MAKxxxxxx                 '</span> <em>(length=25)</em><br>      9 <span style=\"color:#888a85\">=&gt;</span> &lt;small&gt;string&lt;/small&gt; <span style=\"color:#cc0000\">'3000'</span> <em>(length=4)</em><br>      10 <span style=\"color:#888a85\">=&gt;</span> &lt;small&gt;string&lt;/small&gt; <span style=\"color:#cc0000\">'Angebot'</span> <em>(length=7)</em><br>      11 <span style=\"color:#888a85\">=&gt;</span> &lt;small&gt;string&lt;/small&gt; <span style=\"color:#cc0000\">'146186'</span> <em>(length=6)</em><br></pre>\r\n</pre>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n<p>Can Someone please help me, because i don't know what to do?</p>\r\n<p>&nbsp;</p>\r\n<p>Thanks max</p>\r\n<p>&nbsp;</p>\r\n<p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre>\t\t<span style=\"color:Green\">// &Uuml;berpr&uuml;fen ob es sich um ein CSV File handelt</span>\r\n\t\t$dateityp = substr(strtolower($_FILES[$this-&gt;name_dateiupload_feld][<span style=\"color:#A31515\">'name'</span>]), -4);\r\n\t\t<span style=\"color:Blue\">if</span>($dateityp == <span style=\"color:#A31515\">&quot;.csv&quot;</span>){\r\n\t\t\t<span style=\"color:Green\">// Reader initalisieren</span>\r\n\t\t\t$objReader = PHPExcel_IOFactory::createReader(<span style=\"color:#A31515\">'CSV'</span>)\r\n    \t\t\t-&gt;setDelimiter(<span style=\"color:#A31515\">&quot;$this-&gt;import_csv_delimiter&quot;</span>)\r\n    \t\t\t-&gt;setEnclosure(<span style=\"color:#A31515\">&quot;$this-&gt;import_csv_enclosure&quot;</span>)\r\n    \t\t\t-&gt;setLineEnding(<span style=\"color:#A31515\">&quot;$this-&gt;import_csv_lineending&quot;</span>)\r\n    \t\t\t-&gt;setSheetIndex(<span style=\"color:#A31515\">&quot;$this-&gt;import_sheetindex&quot;</span>);\r\n    \t\t\t\r\n\t\t\t<span style=\"color:Green\">// &Uuml;berpr&uuml;fen ob alle CSV  Parameter gesetzt sind</span>\r\n\t\t\t<span style=\"color:Blue\">if</span>($objReader-&gt;getDelimiter() != <span style=\"color:#A31515\">&quot;;&quot;</span> &amp;&amp; $objReader-&gt;getDelimiter() != <span style=\"color:#A31515\">&quot;,&quot;</span>){\r\n\t\t\t\t$this-&gt;set_error(19);\r\n\t\t\t} <span style=\"color:Blue\">elseif</span>($objReader-&gt;getSheetIndex() == <span style=\"color:#A31515\">&quot;&quot;</span> &amp;&amp; $objReader-&gt;getSheetIndex() &lt; 0){\r\n\t\t\t\t$this-&gt;set_error(20);\r\n\t\t\t} <span style=\"color:Blue\">elseif</span>($objReader-&gt;getLineEnding() == <span style=\"color:#A31515\">&quot;&quot;</span>){\r\n\t\t\t\t$this-&gt;set_error(21);\r\n\t\t\t}\r\n\t\t} <span style=\"color:Blue\">else</span> {\r\n\t\t\t$this-&gt;set_error(23);\r\n\t\t}\r\n\t\t\r\n\t\t<span style=\"color:Blue\">if</span>($objReader-&gt;canRead($_FILES[$this-&gt;name_dateiupload_feld][<span style=\"color:#A31515\">'tmp_name'</span>])) {\r\n\r\n\t\t\t$objPHPExcelFromCSV = $objReader-&gt;load($_FILES[$this-&gt;name_dateiupload_feld][<span style=\"color:#A31515\">'tmp_name'</span>]);\r\n\t\t\t$objWorksheet = $objPHPExcelFromCSV-&gt;getActiveSheet();\r\n\r\n\t\t\t$<span style=\"color:Blue\">file</span> = $objWorksheet-&gt;toArray();\r\n</pre>\r\n</div>\r\n</p>",
    "PostedDate": "2009-08-21T09:21:24.257-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "226400",
    "ThreadId": "66619",
    "Html": "<p>Yes, it must be an encoding problem. PHPExcel assumes UTF-8 (without BOM). Your CSV file is probably encoded in ISO-8859-1.<br><br>What you need to do is to convert the file to UTF-8 (without BOM) before loading it into PHPExcel.<br><br>PHPExcel_Reader_CSV really needs an option for setting input encoding of the CSV file. I can see that. Will create a work item for that.</p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2009-08-21T09:35:19.957-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "226404",
    "ThreadId": "66619",
    "Html": "<p>ah okay i see!</p>\r\n<p>My english is not the best, so when i understand you right, you will code a function for that problem, or?</p>\r\n<p>&nbsp;</p>\r\n<p>But another question:</p>\r\n<p>When i do an excel import i get the following array back:</p>\r\n<pre>  1 <span style=\"color:#888a85\">=&gt;</span> <br>    <strong>array</strong><br>      0 <span style=\"color:#888a85\">=&gt;</span> &lt;small&gt;string&lt;/small&gt; <span style=\"color:#cc0000\">'xxxxxxx                                         '</span> <em>(length=50)</em><br>      1 <span style=\"color:#888a85\">=&gt;</span> &lt;small&gt;string&lt;/small&gt; <span style=\"color:#cc0000\">'xxxxxx                  '</span> <em>(length=25)</em><br>      2 <span style=\"color:#888a85\">=&gt;</span> &lt;small&gt;string&lt;/small&gt; <span style=\"color:#cc0000\">'[$-198070]General'</span> <em>(length=17) &lt;---- whats this??? the value 198070 is right but what is [$-xxxxx]General</em><br>      3 <span style=\"color:#888a85\">=&gt;</span> &lt;small&gt;string&lt;/small&gt; <span style=\"color:#cc0000\">'05-13-09'</span> <em>(length=8)</em><br>      4 <span style=\"color:#888a85\">=&gt;</span> &lt;small&gt;string&lt;/small&gt; <span style=\"color:#cc0000\">'Rechtsschutz Union'</span> <em>(length=18)</em><br>      5 <span style=\"color:#888a85\">=&gt;</span> &lt;small&gt;string&lt;/small&gt; <span style=\"color:#cc0000\">'09.08.2009'</span> <em>(length=10)</em><br>      6 <span style=\"color:#888a85\">=&gt;</span> &lt;small&gt;string&lt;/small&gt; <span style=\"color:#cc0000\">'165.45'</span> <em>(length=6)</em><br>      7 <span style=\"color:#888a85\">=&gt;</span> &lt;small&gt;string&lt;/small&gt; <span style=\"color:#cc0000\">'j&Atilde;&curren;hrlich'</span> <em>(length=9)</em>  &lt;------ Problem <br>      8 <span style=\"color:#888a85\">=&gt;</span> &lt;small&gt;string&lt;/small&gt; <span style=\"color:#cc0000\">'MAK20917                 '</span> <em>(length=25)</em><br>      9 <span style=\"color:#888a85\">=&gt;</span> &lt;small&gt;string&lt;/small&gt; <span style=\"color:#cc0000\">'3000'</span> <em>(length=4)</em><br>      10 <span style=\"color:#888a85\">=&gt;</span> &lt;small&gt;string&lt;/small&gt; <span style=\"color:#cc0000\">'Angebot'</span> <em>(length=7)</em><br>      11 <span style=\"color:#888a85\">=&gt;</span> &lt;small&gt;int&lt;/small&gt; <span style=\"color:#4e9a06\">14618691</span><br><br><br><br>How can i solve this Problem?<br><br><br></pre>",
    "PostedDate": "2009-08-21T09:44:26.363-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "226413",
    "ThreadId": "66619",
    "Html": "<p><em>&gt;&gt; you will code a function for that problem, or?</em></p>\r\n<p>Work item created for CSV reader input encoding:</p>\r\n<p><a href=\"http://phpexcel.codeplex.com/WorkItem/View.aspx?WorkItemId=10500\">http://phpexcel.codeplex.com/WorkItem/View.aspx?WorkItemId=10500</a></p>\r\n<p><em>&gt;&gt; But another question:</em></p>\r\n<pre>      7 <span style=\"color:#888a85\">=&gt;</span> &lt;small&gt;string&lt;/small&gt; <span style=\"color:#cc0000\">'j&Atilde;&curren;hrlich'</span> <em>(length=9)</em>  &lt;------ Problem </pre>\r\n<p>There is no problem here! It is encoded correctly as UTF-8. If you are viewing this dump text in the browser, make sure that encoding is set to UTF-8 in your browser:</p>\r\n<p><a href=\"http://img268.imageshack.us/img268/1429/ss20090821185851.png\"><img src=\"http://img268.imageshack.us/img268/1429/ss20090821185851.th.png\" border=0 alt=\"\"></a></p>",
    "PostedDate": "2009-08-21T10:03:18.517-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "227011",
    "ThreadId": "66619",
    "Html": "<p>A simple, but a little bit dirty workaround is to put the following code into line 193:</p>\r\n<p>&nbsp;</p>\r\n<p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre>         <span style=\"color:Blue\">foreach</span>($rowData <span style=\"color:Blue\">as</span> $key =&gt; $wert) {\r\n                $rowData[$key] = trim(iconv(<span style=\"color:#A31515\">&quot;ISO-8859-1&quot;</span>, <span style=\"color:#A31515\">&quot;UTF-8&quot;</span>, $wert));\r\n            }\r\n<br>greets max<br><br><br>@koyama: Thanks for the excellent support</pre>\r\n</div>\r\n</p>",
    "PostedDate": "2009-08-24T05:22:04.973-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]