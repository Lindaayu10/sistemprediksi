[
  {
    "Id": "136218",
    "ThreadId": "41074",
    "Html": "First thanks for the awesome library!!!<br>\r\n<br>\r\nA couple of other threads have touch on this issue but I have not been able to find a definitive answer to this question.&nbsp; When I create XLS files they are coming out 2-10 times larger than they should.&nbsp; To reproduce this:<br>\r\n- run the 14excel5.php test<br>\r\n- open the output file in Excel (2003 or 2007)<br>\r\n- slightly modify the spreadsheet<br>\r\n- save the changes<br>\r\n- note that the new file is about half the size of the original.<br>\r\n<br>\r\nCan anyone offer any suggestions as to why this may be happening and how I may be able to solve this problem?<br>\r\n<br>\r\nThanks and regards<br>\r\n<br>\r\nCory<br>\r\n",
    "PostedDate": "2008-11-29T00:06:20.16-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "136241",
    "ThreadId": "41074",
    "Html": "There may be no definitive answer what you can do about this. Library may need improvements, but the &quot;Save&quot; step in MS Office Excel could be a solution for some users.<br>\r\n<strong><br>\r\n1. Images</strong><br>\r\nThe main file size problem with output from PHPExcel_Writer_Excel5 (based on PEAR Spreadsheet_Excel_Writer) is when you have images. Images are always written as uncompressed bitmaps just like in the old BIFF5 format, that is Excel 5.0 - Excel 95. These occupy tons of space.<br>\r\n<br>\r\nIn the BIFF8 format (Excel 97 - Excel 2003), there is more flexibility, you can store images as e.g. JPEG, PNG which are compressed formats.<br>\r\n<br>\r\nThe solution to this would be to alter PHPExcel_Writer_Excel5 and store images the way the are stored in BIFF8. This would allow images to be stored as e.g. PNG resulting in much lower file size.<br>\r\n<br>\r\nMoreover, it may be pure luck that we even see the images when we open 14excel5.xls in MS Office Excel. It is a BIFF8 file with BIFF5 image records. I wouldn't call it a valid file. There is also the problem that this type of images are not supported by OpenOffice.org 3.<br>\r\n<br>\r\nThere is a work item that addresses these problems:<br>\r\n<a href=\"http://www.codeplex.com/PHPExcel/WorkItem/View.aspx?WorkItemId=7994\">http://www.codeplex.com/PHPExcel/WorkItem/View.aspx?WorkItemId=7994</a><br>\r\n<br>\r\nWhat complicates solving this is the poor documentation on the BIFF8 file format.<br>\r\n<br>\r\n<br>\r\n<strong>2. Strings</strong><br>\r\nThis may also have to do with file size being large in output produced by PHPExcel_Writer_Excel5. In Excel, strings are stored as UTF-16, but with a compression option for strings where all the high order bytes are 0. That would for example be strings with only English characters. This would allow for 50 percent reduction in space occupied by the strings.<br>\r\n<br>\r\nI believe PHPExcel_Writer_Excel5 never uses this compression option.<br>\r\n<br>\r\n<br>\r\n<strong>3. &quot;Save&quot; in MS Office Excel after generation</strong><br>\r\nFor the above reasons, if your Excel files are intended for long term use, I recommend, after generating your spreadsheet using PHPExcel_Writer_Excel5, that you open it in MS Office Excel (preferably, version 2003) and do a plain save of the file. That is if you have the chance, of course.<br>\r\n<br>\r\nThere are also other problems that will be solved, e.g. problems with collapsed row height when opening in OpenOffice.org.<br>\r\n<br>\r\nThis will also safe-guard you against lack of forward compatibility with future applications for handling xls files. If you look at the past, files in circulation that were generated by PEAR Spreadsheet_Excel_Writer would open fine in MS Office Excel 2003, but would no longer open correctly in MS Office Excel 2003 SP3 and MS Office Excel 2007.<br>\r\n",
    "PostedDate": "2008-11-29T06:23:15.927-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]