[
  {
    "Id": "831637",
    "ThreadId": "354404",
    "Html": "\r\n<p>Hi,</p>\r\n<p>I have big bug in php excel when I create a document with 4 sheets.</p>\r\n<p>for example:</p>\r\n<p>&nbsp;</p>\r\n<p></p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre>\r\n\r\n<span style=\"color:blue\">include</span>(<span style=\"color:#a31515\">&quot;header.php&quot;</span>);\r\n<span style=\"color:blue\">include</span>(<span style=\"color:#a31515\">&quot;menu.php&quot;</span>);\r\n<span style=\"color:blue\">include</span>(<span style=\"color:#a31515\">&quot;connection.php&quot;</span>);\r\n\r\n\r\n<span style=\"color:blue\">require_once</span> <span style=\"color:#a31515\">'../Classes/PHPExcel.php'</span>;\t\r\n\r\n<span style=\"color:blue\">function</span> age ($dateNaiss)\r\n{\r\n<span style=\"color:blue\">list</span>($year,$month,$day) = explode(<span style=\"color:#a31515\">&quot;-&quot;</span>,$dateNaiss);\r\n$year_diff = date(<span style=\"color:#a31515\">&quot;Y&quot;</span>) - $year;\r\n$month_diff = date(<span style=\"color:#a31515\">&quot;m&quot;</span>) - $month;\r\n$day_diff = date(<span style=\"color:#a31515\">&quot;d&quot;</span>) - $day;\r\n<span style=\"color:blue\">if</span> ($month_diff &lt; 0) $year_diff--;\r\n<span style=\"color:blue\">elseif</span> (($month_diff==0) &amp;&amp; ($day_diff &lt; 0)) $year_diff--;\r\n<span style=\"color:blue\">return</span> $year_diff;\r\n}\r\n\r\n<span style=\"color:blue\">function</span> DateForm($date)\r\n{\r\n\t<span style=\"color:blue\">list</span>($year,$month,$day) = explode(<span style=\"color:#a31515\">&quot;-&quot;</span>,$date);\r\n\t<span style=\"color:blue\">return</span> <span style=\"color:#a31515\">&quot;$day-$month-$year&quot;</span>;\r\n}\r\n\t\r\n\t<span style=\"color:green\">// Create new PHPExcel object</span>\r\n<span style=\"color:blue\">echo</span> date(<span style=\"color:#a31515\">'H:i:s'</span>) . <span style=\"color:#a31515\">&quot; Create new PHPExcel object\\n&quot;</span>;\r\n$objPHPExcel = <span style=\"color:blue\">new</span> PHPExcel();\r\n\r\n<span style=\"color:green\">// Set properties</span>\r\n<span style=\"color:blue\">echo</span> date(<span style=\"color:#a31515\">'H:i:s'</span>) . <span style=\"color:#a31515\">&quot; Set properties\\n&quot;</span>;\r\n$objPHPExcel-&gt;getProperties()-&gt;setCreator(<span style=\"color:#a31515\">&quot;Maarten Balliauw&quot;</span>)\r\n\t\t\t\t\t\t\t -&gt;setLastModifiedBy(<span style=\"color:#a31515\">&quot;Maarten Balliauw&quot;</span>)\r\n\t\t\t\t\t\t\t -&gt;setTitle(<span style=\"color:#a31515\">&quot;Office 2007 XLSX Test Document&quot;</span>)\r\n\t\t\t\t\t\t\t -&gt;setSubject(<span style=\"color:#a31515\">&quot;Office 2007 XLSX Test Document&quot;</span>)\r\n\t\t\t\t\t\t\t -&gt;setDescription(<span style=\"color:#a31515\">&quot;Test document for Office 2007 XLSX, generated using PHP classes.&quot;</span>)\r\n\t\t\t\t\t\t\t -&gt;setKeywords(<span style=\"color:#a31515\">&quot;office 2010 openxml php&quot;</span>)\r\n\t\t\t\t\t\t\t -&gt;setCategory(<span style=\"color:#a31515\">&quot;Test result file&quot;</span>);\r\n\r\n\r\n\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension(<span style=\"color:#a31515\">'A'</span>)-&gt;setAutoSize(true);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension(<span style=\"color:#a31515\">'B'</span>)-&gt;setAutoSize(true);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension(<span style=\"color:#a31515\">'C'</span>)-&gt;setAutoSize(true);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension(<span style=\"color:#a31515\">'D'</span>)-&gt;setAutoSize(true);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension(<span style=\"color:#a31515\">'E'</span>)-&gt;setAutoSize(true);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension(<span style=\"color:#a31515\">'F'</span>)-&gt;setAutoSize(true);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension(<span style=\"color:#a31515\">'G'</span>)-&gt;setAutoSize(true);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension(<span style=\"color:#a31515\">'H'</span>)-&gt;setAutoSize(true);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension(<span style=\"color:#a31515\">'I'</span>)-&gt;setAutoSize(true);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension(<span style=\"color:#a31515\">'J'</span>)-&gt;setAutoSize(true);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension(<span style=\"color:#a31515\">'K'</span>)-&gt;setAutoSize(true);\r\n\r\n\r\n\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#a31515\">'A'</span>)-&gt;getFont()-&gt;setSize(14);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#a31515\">'B'</span>)-&gt;getFont()-&gt;setSize(14);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#a31515\">'C'</span>)-&gt;getFont()-&gt;setSize(14);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#a31515\">'D'</span>)-&gt;getFont()-&gt;setSize(14);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#a31515\">'E'</span>)-&gt;getFont()-&gt;setSize(14);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#a31515\">'F'</span>)-&gt;getFont()-&gt;setSize(14);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#a31515\">'G'</span>)-&gt;getFont()-&gt;setSize(14);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#a31515\">'H'</span>)-&gt;getFont()-&gt;setSize(14);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#a31515\">'I'</span>)-&gt;getFont()-&gt;setSize(14);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#a31515\">'J'</span>)-&gt;getFont()-&gt;setSize(14);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#a31515\">'K'</span>)-&gt;getFont()-&gt;setSize(14);\r\n\r\n\r\n$objPHPExcel-&gt;setActiveSheetIndex(0)\r\n            -&gt;setCellValue(<span style=\"color:#a31515\">'A2'</span>, <span style=\"color:#a31515\">&quot;Date Entrï¿½e&quot;</span>)\r\n            -&gt;setCellValue(<span style=\"color:#a31515\">'B2'</span>, <span style=\"color:#a31515\">&quot;Nom&quot;</span>)\r\n            -&gt;setCellValue(<span style=\"color:#a31515\">'C2'</span>, <span style=\"color:#a31515\">&quot;Situation administrative&quot;</span>)\r\n            -&gt;setCellValue(<span style=\"color:#a31515\">'D2'</span>, <span style=\"color:#a31515\">&quot;Sortie&quot;</span>)\r\n            -&gt;setCellValue(<span style=\"color:#a31515\">'E2'</span>, <span style=\"color:#a31515\">&quot;Hotel&quot;</span>);\r\n\r\n\r\n$sql=&quot;SELECT f.idFamille,f.nomFamille,f.nbEnfants,f.Couples,h.libelle,s.libelle\r\nFROM famille f, hotel h, situationadministrative s\r\nWHERE f.pec=1\r\nAND s.IdSituationAdmi=SituationAdmi\r\nAnd h.idHotel=hotel\r\nAnd paiement=1\r\nAnd f.Archivage=0&quot;;\r\n\r\n\r\n$requete=mysql_query($sql) <span style=\"color:blue\">or</span> <span style=\"color:blue\">die</span> (mysql_error());\r\n$i=3;\r\n<span style=\"color:blue\">while</span>($val=mysql_fetch_array($requete))\r\n{\r\n\t$j=1;\r\n\t$id=$val[0];\r\n\t$sitfam=<span style=\"color:#a31515\">&quot;&quot;</span>;\r\n\t$color=<span style=\"color:#a31515\">&quot;&quot;</span>;\r\n\t$couple=$val[3];\r\n\t$enfant=$val[2];\r\n\t$tabAgeEnfant=<span style=\"color:blue\">array</span>();\r\n\t<span style=\"color:blue\">if</span>($couple==0)\r\n\t\t\t$couple=2;\r\n\t$nb=$couple&#43;$enfant;\r\n\t<span style=\"color:blue\">if</span>($couple==2 &amp;&amp; $nb&gt;2)\r\n\t{\r\n\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#a31515\">&quot;A$i:E$i&quot;</span>)-&gt;getFill()-&gt;setFillType(PHPExcel_Style_Fill::FILL_SOLID);\r\n\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#a31515\">&quot;A$i:E$i&quot;</span>)-&gt;getFill()-&gt;getStartColor()-&gt;setARGB(<span style=\"color:#a31515\">'FF90EE90'</span>);\r\n\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#a31515\">&quot;A$i:E$i&quot;</span>)-&gt;getFont()-&gt;setSize(14);\r\n\t\t$sitfam=<span style=\"color:#a31515\">&quot;famille avec enfants&quot;</span>;\r\n\t}\r\n\t\r\n\t<span style=\"color:blue\">else</span> <span style=\"color:blue\">if</span>($nb==2 &amp;&amp; $couple==2)\r\n\t{\r\n\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#a31515\">&quot;A$i:E$i&quot;</span>)-&gt;getFill()-&gt;setFillType(PHPExcel_Style_Fill::FILL_SOLID);\r\n\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#a31515\">&quot;A$i:E$i&quot;</span>)-&gt;getFill()-&gt;getStartColor()-&gt;setARGB(<span style=\"color:#a31515\">'FFFFFF66'</span>);\r\n\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#a31515\">&quot;A$i:E$i&quot;</span>)-&gt;getFont()-&gt;setSize(14);\r\n\t\t$sitfam=<span style=\"color:#a31515\">&quot;couple sans enfants&quot;</span>;\r\n\t}\r\n\t<span style=\"color:blue\">else</span> <span style=\"color:blue\">if</span>($nb==1 &amp;&amp; $couple==1)\r\n\t{\r\n\t\t$sql1=<span style=\"color:#a31515\">&quot;select sexe,DateNaiss from personne where lienfamille='$id' &quot;</span>;\r\n\t\t$requete1=mysql_query($sql1) <span style=\"color:blue\">or</span> <span style=\"color:blue\">die</span> (mysql_error());\r\n\t\t$val2=mysql_fetch_array($requete1);\r\n\t\t<span style=\"color:blue\">if</span>($val2[0]==<span style=\"color:#a31515\">&quot;homme&quot;</span>)\r\n\t\t{\r\n\t\t\t$sitfam=<span style=\"color:#a31515\">&quot;Homme seul&quot;</span>;\r\n\t\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#a31515\">&quot;A$i:E$i&quot;</span>)-&gt;getFill()-&gt;setFillType(PHPExcel_Style_Fill::FILL_SOLID);\r\n\t\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#a31515\">&quot;A$i:E$i&quot;</span>)-&gt;getFill()-&gt;getStartColor()-&gt;setARGB(<span style=\"color:#a31515\">'FF87CEEB'</span>);\r\n\t\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#a31515\">&quot;A$i:E$i&quot;</span>)-&gt;getFont()-&gt;setSize(14);\r\n\t\t}\r\n\t\t<span style=\"color:blue\">else</span>\r\n\t\t{\r\n\t\t\t$sitfam=<span style=\"color:#a31515\">&quot;Femme seule&quot;</span>;\r\n\t\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#a31515\">&quot;A$i:E$i&quot;</span>)-&gt;getFill()-&gt;setFillType(PHPExcel_Style_Fill::FILL_SOLID);\r\n\t\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#a31515\">&quot;A$i:E$i&quot;</span>)-&gt;getFill()-&gt;getStartColor()-&gt;setARGB(<span style=\"color:#a31515\">'FFFFC0CB'</span>);\r\n\t\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#a31515\">&quot;A$i:E$i&quot;</span>)-&gt;getFont()-&gt;setSize(14);\r\n\t\t}\r\n\t}\r\n\t\r\n\t<span style=\"color:blue\">else</span>\r\n\t{\r\n\t\t$sql1=<span style=\"color:#a31515\">&quot;select sexe,DateNaiss from personne where lienfamille='$id' &quot;</span>;\r\n\t\t$max=18;\r\n\t\t$sexe=<span style=\"color:#a31515\">&quot;&quot;</span>;\r\n\t\t$requete1=mysql_query($sql1) <span style=\"color:blue\">or</span> <span style=\"color:blue\">die</span> (mysql_error());\r\n\t\t<span style=\"color:blue\">while</span>($val2=mysql_fetch_array($requete1))\r\n\t\t{\r\n\t\t\t$age=age($val2[1]);\r\n\t\t\t\r\n\t\t\t<span style=\"color:blue\">if</span>($max&lt;$age)\r\n\t\t\t{\r\n\t\t\t\t$max=$age;\r\n\t\t\t\t$sexe=$val2[0];\r\n\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\r\n\t\t}\r\n\t\t\r\n\t\t<span style=\"color:blue\">if</span>($sexe==<span style=\"color:#a31515\">&quot;homme&quot;</span>)\r\n\t\t{\r\n\t\t\t$sitfam=<span style=\"color:#a31515\">&quot;homme avec enfant(s)&quot;</span>;\r\n\t\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#a31515\">&quot;A$i:E$i&quot;</span>)-&gt;getFill()-&gt;setFillType(PHPExcel_Style_Fill::FILL_SOLID);\r\n\t\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#a31515\">&quot;A$i:E$i&quot;</span>)-&gt;getFill()-&gt;getStartColor()-&gt;setARGB(<span style=\"color:#a31515\">'FF9933FF'</span>);\r\n\t\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#a31515\">&quot;A$i:E$i&quot;</span>)-&gt;getFont()-&gt;setSize(14);\r\n\t\t}\r\n\t\t\r\n\t\t<span style=\"color:blue\">else</span>\r\n\t\t{\r\n\t\t\t$sitfam=<span style=\"color:#a31515\">&quot;femme avec enfant(s)&quot;</span>;\r\n\t\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#a31515\">&quot;A$i:E$i&quot;</span>)-&gt;getFill()-&gt;setFillType(PHPExcel_Style_Fill::FILL_SOLID);\r\n\t\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#a31515\">&quot;A$i:E$i&quot;</span>)-&gt;getFill()-&gt;getStartColor()-&gt;setARGB(<span style=\"color:#a31515\">'FFFFCC00'</span>);\r\n\t\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#a31515\">&quot;A$i:E$i&quot;</span>)-&gt;getFont()-&gt;setSize(14);\r\n\t\t}\r\n\t\t\r\n\t}\r\n\t\r\n\t$sql1=<span style=\"color:#a31515\">&quot;select DateEntree,DateSortieHotel,dateNaiss from personne where lienfamille='$id' and nombreNuit&gt;3&quot;</span>;\r\n\t$requete1=mysql_query($sql1) <span style=\"color:blue\">or</span> <span style=\"color:blue\">die</span> (mysql_error());\r\n\t<span style=\"color:blue\">while</span>($val1=mysql_fetch_array($requete1))\r\n\t{\r\n\t\t\r\n\t\t<span style=\"color:blue\">if</span>(substr($val1[1],0,4)&gt;= date(<span style=\"color:#a31515\">&quot;Y&quot;</span>) &amp;&amp; substr($val1[1],5,2)&gt;=date(<span style=\"color:#a31515\">&quot;m&quot;</span>) &amp;&amp; substr($val1[1],8,2)&gt;=date(<span style=\"color:#a31515\">&quot;d&quot;</span>))\r\n\t\t{\r\n\t\t\t$j=0;\r\n\t\t\t$dateEnt=DateForm($val1[0]);\r\n\t\t\t$dateSort=DateForm($val1[1]);\r\n\t\t\t$tabAgeEnfant[]=age($val1[2]);\r\n\t\t\t$objPHPExcel-&gt;setActiveSheetIndex(0)-&gt;setCellValue(<span style=\"color:#a31515\">&quot;A&quot;</span>.$i, <span style=\"color:#a31515\">&quot;$dateEnt&quot;</span>);\r\n\t\t\t$objPHPExcel-&gt;setActiveSheetIndex(0)-&gt;setCellValue(<span style=\"color:#a31515\">&quot;D&quot;</span>.$i, <span style=\"color:#a31515\">&quot;$dateSort&quot;</span>);\r\n\t\t\t\r\n\t\t}\r\n\t\t<span style=\"color:blue\">else</span> \r\n\t\t{\r\n\t\t\t$j=1;\r\n\t\t}\r\n\t}\r\n\t<span style=\"color:blue\">if</span>($j==0)\r\n\t{\r\n\t\t$hotel=$val[4];\r\n\t\t$admi=$val[5];\r\n\t\t$nom=$val[1];\r\n\t\t\r\n\t\t$objPHPExcel-&gt;setActiveSheetIndex(0)-&gt;setCellValue(<span style=\"color:#a31515\">&quot;E&quot;</span>.$i, <span style=\"color:#a31515\">&quot;$hotel&quot;</span>);\r\n\t\t$objPHPExcel-&gt;setActiveSheetIndex(0)-&gt;setCellValue(<span style=\"color:#a31515\">&quot;C&quot;</span>.$i, <span style=\"color:#a31515\">&quot;$admi&quot;</span>);\r\n\t\t$objPHPExcel-&gt;setActiveSheetIndex(0)-&gt;setCellValue(<span style=\"color:#a31515\">&quot;B&quot;</span>.$i, <span style=\"color:#a31515\">&quot;$nom&quot;</span>);\r\n\t\t\r\n\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;getComment(<span style=\"color:#a31515\">'B'</span>.$i)-&gt;setAuthor(<span style=\"color:#a31515\">'Famille'</span>);\r\n\t\t$objCommentRichText = $objPHPExcel-&gt;getActiveSheet()-&gt;getComment(<span style=\"color:#a31515\">'B'</span>.$i)-&gt;getText()-&gt;createTextRun(<span style=\"color:#a31515\">'Famille:'</span>);\r\n\t\t$objCommentRichText-&gt;getFont()-&gt;setBold(true);\r\n\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;getComment(<span style=\"color:#a31515\">'B'</span>.$i)-&gt;setWidth(<span style=\"color:#a31515\">'200pt'</span>);\r\n\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;getComment(<span style=\"color:#a31515\">'B'</span>.$i)-&gt;setHeight(<span style=\"color:#a31515\">'200pt'</span>);\r\n\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;getComment(<span style=\"color:#a31515\">'B'</span>.$i)-&gt;setMarginLeft(<span style=\"color:#a31515\">'150pt'</span>);\r\n\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;getComment(<span style=\"color:#a31515\">'B'</span>.$i)-&gt;getFillColor()-&gt;setRGB(<span style=\"color:#a31515\">'EEEEEE'</span>);\r\n\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;getComment(<span style=\"color:#a31515\">'B'</span>.$i)-&gt;getText()-&gt;createTextRun(<span style=\"color:#a31515\">&quot;\\r\\n&quot;</span>);\r\n\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;getComment(<span style=\"color:#a31515\">'B'</span>.$i)-&gt;getText()-&gt;createTextRun(<span style=\"color:#a31515\">&quot; composition: $sitfam \\n enfants age: \\n &quot;</span>);\r\n\t\t\r\n\t\t<span style=\"color:blue\">foreach</span>($tabAgeEnfant <span style=\"color:blue\">as</span> $valeur)\r\n\t\t{\r\n\t\t\t$age=$valeur;\r\n\t\t\t$objPHPExcel-&gt;getActiveSheet()-&gt;getComment(<span style=\"color:#a31515\">'B'</span>.$i)-&gt;getText()-&gt;createTextRun(<span style=\"color:#a31515\">&quot; $age ans  \\n &quot;</span>);\r\n\t\t\t<span style=\"color:blue\">echo</span> <span style=\"color:#a31515\">&quot;\\n $age \\n&quot;</span>;\r\n\t\t}\r\n\t\t\r\n\t\t$i&#43;&#43;;\r\n\t}\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n<span style=\"color:green\">// Rename sheet</span>\r\n<span style=\"color:blue\">echo</span> date(<span style=\"color:#a31515\">'H:i:s'</span>) . <span style=\"color:#a31515\">&quot; Rename sheet\\n&quot;</span>;\r\n$objPHPExcel-&gt;setActiveSheetIndex(0);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setTitle(<span style=\"color:#a31515\">'PRISE EN CHARGE URGENCE'</span>);\r\n\r\n\r\n\r\n$objPHPExcel-&gt;createSheet();\r\n$objPHPExcel-&gt;setActiveSheetIndex(1);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setTitle(<span style=\"color:#a31515\">'FIN PEC URGENCE'</span>);\r\n\r\n$objPHPExcel-&gt;createSheet();\r\n$objPHPExcel-&gt;setActiveSheetIndex(2);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setTitle(<span style=\"color:#a31515\">'PRISE EN CHARGE CG'</span>);\r\n\r\n$objPHPExcel-&gt;createSheet();\r\n$objPHPExcel-&gt;setActiveSheetIndex(3);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setTitle(<span style=\"color:#a31515\">'FIN PEC CG'</span>);\r\n\r\n<span style=\"color:green\">// Set active sheet index to the first sheet, so Excel opens this as the first sheet</span>\r\n$objPHPExcel-&gt;setActiveSheetIndex(0);\r\n\r\n\r\n<span style=\"color:green\">// Save Excel 2007 file</span>\r\n<span style=\"color:blue\">echo</span> date(<span style=\"color:#a31515\">'H:i:s'</span>) . <span style=\"color:#a31515\">&quot; Write to Excel2007 format\\n&quot;</span>;\r\n$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, <span style=\"color:#a31515\">'Excel2007'</span>);\r\n$objWriter-&gt;save(str_replace(<span style=\"color:#a31515\">'.php'</span>, <span style=\"color:#a31515\">'.xlsx'</span>, <span style=\"color:blue\">__FILE__</span>));\r\n\r\n\r\n<span style=\"color:green\">// Echo memory peak usage</span>\r\n<span style=\"color:blue\">echo</span> date(<span style=\"color:#a31515\">'H:i:s'</span>) . <span style=\"color:#a31515\">&quot; Peak memory usage: &quot;</span> . (memory_get_peak_usage(true) / 1024 / 1024) . <span style=\"color:#a31515\">&quot; MB\\r\\n&quot;</span>;\r\n\r\n<span style=\"color:green\">// Echo done</span>\r\n<span style=\"color:blue\">echo</span> date(<span style=\"color:#a31515\">'H:i:s'</span>) . <span style=\"color:#a31515\">&quot; Done writing file.\\r\\n&quot;</span>;\r\n\r\nheader(<span style=\"color:#a31515\">&quot;location:./excel_nomee.xlsx&quot;</span> );\r\n\r\n\r\n</pre>\r\n</div>\r\n<p></p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n<p>with this code in the first sheet I don't have a problem, but if I copy this code in the over sheet that I create I have an XML errors with excel and comment in the first page are missing.</p>\r\n<p>&nbsp;</p>\r\n<p>Thx for your attention and sorry for my english</p>\r\n",
    "PostedDate": "2012-05-03T07:18:40.81-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]