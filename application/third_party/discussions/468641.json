[
  {
    "Id": "1123295",
    "ThreadId": "468641",
    "Html": "CentOS 6, php5.3.3 PHPExcel1.7.9\r<br />\nWhen this formula is set:\r<br />\n<br />\n$Allocation-&gt;getActiveSheet()-&gt;setCellValue(&quot;C5&quot;, &quot;Ticker&quot;)-&gt;setCellValue(&quot;D5&quot;, &quot;Class&quot;)<br />\n<pre><code>    -&gt;setCellValue(&quot;E5&quot;, &quot;=IF(OR(E4&lt;0,E4&gt;80),'RangeErr','')&quot;);\n</code></pre>\n\nThe formula works directly in both excel as is and OO by changing the , to ;\r<br />\nIf setting setPreCalculateFormulas(FALSE) it shows as unreadable content in Excel. OO shows the formula text, but it is text not formula.\r<br />\n<br />\nThis exception is thrown.\r<br />\n<br />\nFatal error: Uncaught exception 'PHPExcel_Calculation_Exception' with message 'Worksheet!E5 -&gt; Formula Error: An unexpected error occured' in /home/hewdavid/Shared/Classes/PHPExcel/Cell.php:298\r<br />\nStack trace:<br />\n<h1>0 /home/hewdavid/Shared/Classes/PHPExcel/Writer/Excel2007/Worksheet.php(1078): PHPExcel_Cell-&gt;getCalculatedValue()</h1>\n<h1>1 /home/hewdavid/Shared/Classes/PHPExcel/Writer/Excel2007/Worksheet.php(1025): PHPExcel_Writer_Excel2007_Worksheet-&gt;_writeCell(Object(PHPExcel_Shared_XMLWriter), Object(PHPExcel_Worksheet), 'E5', Array, Array)</h1>\n<h1>2 /home/hewdavid/Shared/Classes/PHPExcel/Writer/Excel2007/Worksheet.php(83): PHPExcel_Writer_Excel2007_Worksheet-&gt;_writeSheetData(Object(PHPExcel_Shared_XMLWriter), Object(PHPExcel_Worksheet), Array)</h1>\n<h1>3 /home/hewdavid/Shared/Classes/PHPExcel/Writer/Excel2007.php(253): PHPExcel_Writer_Excel2007_Worksheet-&gt;writeWorksheet(Object(PHPExcel_Worksheet), Array, false)</h1>\n<h1>4 /home/hewdavid/4kadv/webuildyoua_com/htdocs/new_xls1.php(293): PHPExcel_Writer_Excel2007-&gt;save('php://output')</h1>\n<h1>5 {main}</h1>\nthrown in /home/hewdavid/Shared/Classes/PHPExcel/Cell.php on line 298<br />\n",
    "PostedDate": "2013-11-13T20:10:48.367-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]