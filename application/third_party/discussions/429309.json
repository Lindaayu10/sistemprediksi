[
  {
    "Id": "985525",
    "ThreadId": "429309",
    "Html": "\r\n<p>Just starting to integrate PHPExcel 1.7.8 into a project of mine. Seeing a weird issue that any file created in Excel 2007 and saved as .xlsx seems to instantiate a&nbsp;PHPExcel_Reader_HTML instead of the expected&nbsp;PHPExcel_Reader_Excel2007 reader (similar\r\n for .ods files created in LibreOffice). Using a standard .xls file generated in either Excel 2007 or LibreOffice works fine though. The spreadsheet is fairly simple, two rows (one header, one data) with about 8 columns of strings.</p>\r\n<p>This is what I'm using to read the file:</p>\r\n<p>&nbsp;</p>\r\n<pre>$path = &quot;temporary://newimport_3.xlsx&quot;;<br>$xls_reader = PHPExcel_IOFactory::createReaderForFile($path);\n$xls_reader-&gt;setReadDataOnly(TRUE);\n$xls_data = $xls_reader-&gt;load($path);</pre>\r\n<p>And of course because PHPExcel_Reader_HTML doesn't actually have a setReadDataOnly method, this gives a fatal error. If I take out the setReadDataOnly line, then I get a bunch of other errors:</p>\r\n<p>&nbsp;</p>\r\n<pre>Warning: DOMDocument::loadHTMLFile(): Invalid char in CDATA 0x3 in temporary://newimport_3.xlsx, line: 1 in PHPExcel_Reader_HTML-&gt;loadIntoExisting() (line 458 of /mnt/nas/drupal-7.0/sites/all/libraries/PHPExcel/PHPExcel/Reader/HTML.php).\nWarning: DOMDocument::loadHTMLFile(): Invalid char in CDATA 0x4 in temporary://newimport_3.xlsx, line: 1 in PHPExcel_Reader_HTML-&gt;loadIntoExisting() (line 458 of /mnt/nas/drupal-7.0/sites/all/libraries/PHPExcel/PHPExcel/Reader/HTML.php).\nWarning: DOMDocument::loadHTMLFile(): Invalid char in CDATA 0x14 in temporary://newimport_3.xlsx, line: 1 in PHPExcel_Reader_HTML-&gt;loadIntoExisting() (line 458 of /mnt/nas/drupal-7.0/sites/all/libraries/PHPExcel/PHPExcel/Reader/HTML.php).\nThe import file was an unrecognized format and cannot be imported</pre>\r\n<p>Any thoughts or pointers? PHP seems to have the proper extensions enabled, running PHP 5.3.3 on Redhat EL6.</p>\r\n",
    "PostedDate": "2013-01-11T08:55:50.117-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "986090",
    "ThreadId": "429309",
    "Html": "\r\n<p>I can't identify any path through the code that could lead to this&nbsp;for xlsx files generated by any version of MS Excel (tried with 2003, 2007 and 2010) or with Open or Libre Office.</p>\r\n<p>The signatures for xlsx and html should be very different, and I can't understand how they could get confused.</p>\r\n<p>Can you upload an example of a file that demonstrates this behaviour to <a href=\"http://phpexcel.codeplex.com/workitem/10749?ProjectName=phpexcel\">\r\nhttp://phpexcel.codeplex.com/workitem/10749?ProjectName=phpexcel</a></p>\r\n",
    "PostedDate": "2013-01-13T03:58:51.217-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "986751",
    "ThreadId": "429309",
    "Html": "\r\n<p>Actually just did some debugging and figured out the issue. Essentially its due to the fact that the file I was trying to load was referenced using a stream wrapper, and PHPExcel doesn't play nicely with them (specifically the canRead() method can't read\r\n the file, so it fails to use the reader it detected, and instead tries to use whatever it finds through the autoresolveclasses loop further down)</p>\r\n",
    "PostedDate": "2013-01-14T15:31:35.337-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "986773",
    "ThreadId": "429309",
    "Html": "\r\n<p>Ah, no! PHPExcel explicitly requires direct access to open and close the file as it sees fit, so it doesn't work particularly well with stream wrappers. Glad you were able to figure it out.</p>\r\n",
    "PostedDate": "2013-01-14T16:28:45.02-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1293970",
    "ThreadId": "429309",
    "Html": "I realize I'm very late to this discussion, but I've just encountered this problem, and I was hoping you might be able to help me understand how you managed to work around the issue.  I'm downloading an XLS file using CURL in PHP, and saving the file to disk, then trying to parse it using the PHPExcel reader.  Here's my basic implementation.<br />\n<pre><code>    $fp = fopen('output/myfile.xls', 'wb');\n    $ch = curl_init();\n    curl_setopt($ch, CURLOPT_URL, 'http://www.example.com/excelfileurl'); \n    curl_setopt($ch, CURLOPT_COOKIE, ' SOME SESSION COOKIE STUFF HERE THAT I'VE OMITTED FROM MY EXAMPLE');\n    curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); \n    curl_setopt($ch, CURLOPT_FILE, $fp);\n    curl_exec($ch);\n    curl_close($ch);\n    fclose($fp);\n\n\n    require_once './Classes/PHPExcel/IOFactory.php';\n    $objPHPExcel = PHPExcel_IOFactory::load(&quot;output/myfile.xls&quot;);</code></pre>\n\nSo it seems like PHPExcel should have direct access to the file since it's sitting on the disk.  But I'm seeing the following errors leading me to believe that the XLS file is being read as HTML instead of XLS.  I'm able to open the XLS file with Excel and it opens fine.<br />\n<pre><code>Notice: DOMDocument::loadHTMLFile(): Namespace prefix ss is not defined in output/myfile.xls, line: 2 in /&lt;full path&gt;/Classes/PHPExcel/Reader/HTML.php on line 427\nWarning: DOMDocument::loadHTMLFile(): Namespace prefix xmlns of attribute ss is not defined in output/myfile.xls, line: 2 in /&lt;full path&gt;/Classes/PHPExcel/Reader/HTML.php on line 427</code></pre>\n\nThanks for any suggestions you may have.<br />\n",
    "PostedDate": "2014-08-27T08:51:29.453-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]