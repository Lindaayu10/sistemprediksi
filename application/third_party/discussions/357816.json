[
  {
    "Id": "843010",
    "ThreadId": "357816",
    "Html": "\r\n<p>Hi Mark and other contributors.</p>\r\n<p>I was wondering if it is possible to do something like that. Assume that you know nothing about the table fields.Get the rows from the database with select count query, get the columns with show columns query</p>\r\n<p>and then</p>\r\n<p>for example:</p>\r\n<p>&nbsp;</p>\r\n<pre>$re=mysql_query('select count(*) from table');\n<pre>$res=mysql_query('show  columns from table');</pre>\n$r=mysql_query('select * from table');    <br> $excel = new PHPExcel();   <br> $excel-&gt;setActiveSheetIndex(0);   <br> $worksheet = $excel-&gt;getActiveSheet();  <br>$row=1;  <br>$col=0;<br>&nbsp;while($q=mysql_fetch_assoc($db,$r)){<br>&nbsp;//i mean if there is a rowIterator like for the reader interfaces <br> for($row=1;$row&lt; $rowCount;$row&#43;&#43;){  <br>for($col=o;$col&lt; $colCount;$col&#43;&#43;){    <br> $worksheet-&gt;setValue(&quot;value goes here&quot;);       <br> }  }}     <br> header('Last-Modified:' . gmdate('D, d M Y H:i:s') . ' GMT');       <br> header('Cache-Control: no-store, no-cache, must-revalidate');<br>&nbsp;header('Cache-Control: post-check=0, pre-check=0', false);<br>&nbsp;header('Pragma: no-cache');   <br> header('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');   <br> header('Content-Disposition: attachment;filename='Report.xlsx'');  <br> $objWriter = PHPExcel_IOFactory::createWriter($excel, 'Excel2007');     <br>ob_end_clean();   <br> $objWriter-&gt;save('php://output');  <br> $excel-&gt;disconnectWorksheets();  <br> unset(\\$excel);</pre>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; would it be hard to do something like that or is there\r\n already a defined class or any methods for such an operation?</p>\r\n",
    "PostedDate": "2012-05-31T03:29:06.463-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "843466",
    "ThreadId": "357816",
    "Html": "\r\n<p>Ok i am almost there but with a slight issue</p>\r\n<p>here is my code</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n<pre>         error_reporting(E_ALL);\n            $re=mysqli_query($dbco,&quot;select count(*) from table&quot;) or die(&quot;Error:&quot;.  mysqli_error($dbco));\n\n$res=mysqli_query($dbco,&quot;show columns from table&quot;) or die(&quot;Error:&quot;.  mysqli_error($dbco));\n$a1=mysqli_fetch_array($re,MYSQLI_NUM) or die(&quot;Error while fetching&quot;.mysqli_error($dbco));\n$a2=  mysqli_num_rows($res) or die(&quot;Error while returning nums&quot;.mysqli_error($dbco));\n                       \n             $sq=&quot;SELECT * FROM table &quot;;\n                $result = mysqli_query($dbco, $sq) or die('ERROR IN GET QUERY: '.mysqli_error($dbco));\n               \n                $r=array();\n              \n                   \n            \n            $bindCount=array(1=&gt;&quot;A&quot;,2=&gt;&quot;B&quot;,3=&gt;&quot;C&quot;,4=&gt;&quot;D&quot;,5=&gt;&quot;E&quot;,6=&gt;&quot;F&quot;,7=&gt;&quot;G&quot;,8=&gt;&quot;H&quot;,9=&gt;&quot;I&quot;,10=&gt;&quot;J&quot;);\n            \n            \n            require_once 'PHPExcel/Autoloader.php';\n            require_once 'PHPExcel/IOFactory.php';                require_once 'PHPExcel.php';\n            PHPExcel_Settings::setZipClass(PHPExcel_Settings::PCLZIP);\n               \n                \n                         $excel = new PHPExcel();\n    $excel-&gt;setActiveSheetIndex(0);\n    $worksheet = $excel-&gt;getActiveSheet();\n    \n while($rows= mysqli_fetch_array($result,MYSQLI_NUM)){\n                   $r[]=$rows;\n               }\n                                   for($row=0; $row&lt;$a1.length; $row&#43;&#43;){\n                       for($col=0; $col&lt;$a2.length; $col&#43;&#43;){\n                          for($bind=0; $bind&lt;$bindCount.length; $bind&#43;&#43;){    \n                 $worksheet-&gt;getCell(&quot;{$bindCount[$bind]}.{$row&#43;&#43;}&quot;)-&gt;setValue(&quot;{$r[$row][$col]}&quot;);\n                        }\n                       }\n                                   }\n               \n                \n                \n                        \n        header('Last-Modified:' . gmdate('D, d M Y H:i:s') . ' GMT');\n        header('Cache-Control: no-store, no-cache, must-revalidate');\n        header('Cache-Control: post-check=0, pre-check=0', false);\n        header('Pragma: no-cache');\n        header('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');\n        header(&quot;Content-Disposition: attachment;filename='Report.xlsx'&quot;);\n    $objWriter = PHPExcel_IOFactory::createWriter($excel, 'Excel2007');\n    ob_end_clean();\n    $objWriter-&gt;save('php://output');\n    $excel-&gt;disconnectWorksheets();\n    unset($excel);     \n                     </pre>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n<p>In the generated excel file i get a</p>\r\n<p><strong>Parse error: syntax error, unexpected '}' in /opt/lampp/lib/php/PHPExcel/PHPExcel/Shared/PCLZip/pclzip.lib.php on line 5692</strong></p>\r\n<p>i assume because of the curly braces in -&gt;getCell(&quot;{$bind}.{$row&#43;&#43;}&quot;). Am i correct?</p>\r\n<p>Do i have to explicitly set a value for a cell with ' ' and not &quot;&quot;?</p>\r\n<p>Is there a workaround for that?</p>\r\n<p>&nbsp;</p>\r\n<p>P.S: I saw that there is graph support now in the newer version, Congrats for that.</p>\r\n<p>Thanks for any help,regards George.</p>\r\n",
    "PostedDate": "2012-06-01T02:29:46-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]