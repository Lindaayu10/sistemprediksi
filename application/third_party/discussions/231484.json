[
  {
    "Id": "509362",
    "ThreadId": "231484",
    "Html": "<p>Hello!</p>\r\n<p>I am using PHP Excel 1.7.4. / PHP 5.3.3. and I have Excel 2007 for Windows and 2008 for Mac.</p>\r\n<p>I write a xls file in this way:</p>\r\n<p>&nbsp;</p>\r\n<div style=\"color:black;background-color:white\">\r\n<pre>header(<span style=\"color:#a31515\">'Content-Type: application/vnd.ms-excel'</span>);\r\nheader(<span style=\"color:#a31515\">'Content-Disposition: attachment;filename=&quot;testfile.xls&quot;'</span>);\r\nheader(<span style=\"color:#a31515\">'Cache-Control: max-age=0'</span>);\r\n$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, <span style=\"color:#a31515\">'Excel5'</span>);\r\n$objWriter-&gt;save(<span style=\"color:#a31515\">'php://output'</span>);\r\n<span style=\"color:blue\">exit</span>;\r\n</pre>\r\n</div>\r\n<p>I do some calculations with several sheets and then this:</p>\r\n<div style=\"color:black;background-color:white\">\r\n<pre>$objPHPExcel-&gt;setActiveSheetIndex($sheetIndex)<br>&nbsp;&nbsp;&nbsp; -&gt;setCellValue(<span style=\"color:#a31515\">'B'</span>.$counter, $key)<br>&nbsp; &nbsp; -&gt;setCellValue(<span style=\"color:#a31515\">'C'</span>.$counter, <span style=\"color:#a31515\">'=AVERAGE(Test1:Test'</span>.$sheetNumber.<span style=\"color:#a31515\">'!H'</span>.$counter.<span style=\"color:#a31515\">')'</span>)<br>&nbsp; &nbsp; -&gt;setCellValue(<span style=\"color:#a31515\">'D'</span>.$counter, <span style=\"color:#a31515\">'=AVERAGE(Test1:Test'</span>.$sheetNumber.<span style=\"color:#a31515\">'!I'</span>.$counter.<span style=\"color:#a31515\">')'</span>)<br>&nbsp; &nbsp; -&gt;setCellValue(<span style=\"color:#a31515\">'E'</span>.$counter, <span style=\"color:#a31515\">'=AVERAGE(Test1:Test'</span>.$sheetNumber.<span style=\"color:#a31515\">'!J'</span>.$counter.<span style=\"color:#a31515\">')'</span>)<br>&nbsp; &nbsp; -&gt;setCellValue(<span style=\"color:#a31515\">'F'</span>.$counter, <span style=\"color:#a31515\">'=AVERAGE(Test1:Test'</span>.$sheetNumber.<span style=\"color:#a31515\">'!K'</span>.$counter.<span style=\"color:#a31515\">')'</span>)<br>&nbsp;&nbsp;&nbsp; -&gt;setCellValue(<span style=\"color:#a31515\">'G'</span>.$counter, <span style=\"color:#a31515\">'=AVERAGE(Test1:Test'</span>.$sheetNumber.<span style=\"color:#a31515\">'!L'</span>.$counter.<span style=\"color:#a31515\">')'</span>);\r\n</pre>\r\n</div>\r\n<p>The AVERAGE will be changed in my case to (german) MITTELWERT.</p>\r\n<p>Now I have the problem, that every cell has an error #BEZUG! (english term: <span id=main style=\"visibility:visible\"><span id=search style=\"visibility:visible\">#REF!</span></span>) But if I click into a cell, the formula is right, and if I click in this field, so I can edit the formula, but do not edit it and press the return key, it calculates correctly the value with this formula.</p>\r\n<p>So the formula is right, what's wrong here? Same behavior in Excel 2007 and Excel 2008 (Mac).</p>\r\n<p>Thank you in advance for your help &amp; Best regards.</p>",
    "PostedDate": "2010-10-19T06:39:54.417-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "510638",
    "ThreadId": "231484",
    "Html": "<p>Hello. I still have the problem and I created a full little example which will show the problem / error:</p>\r\n<p>I have three sheets Pager1, Pager2 and PagerAll. Pager1 and Pager 2 the values 10 and 20, PagerAll should calculate the average = 15. But this is not working...</p>\r\n<p>\r\n<div style=\"color:black;background-color:white\">\r\n<pre>&lt;?php\r\n<span style=\"color:blue\">require_once</span> <span style=\"color:#a31515\">'Classes/PHPExcel.php'</span>;\r\n$objPHPExcel = <span style=\"color:blue\">new</span> PHPExcel();\r\n\r\n$objWorksheet = $objPHPExcel-&gt;createSheet(0);\r\n$objPHPExcel-&gt;setActiveSheetIndex(0)-&gt;setCellValue(<span style=\"color:#a31515\">'A1'</span>, 10);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setTitle(<span style=\"color:#a31515\">&quot;Pager1&quot;</span>);\r\n\r\n$objWorksheet = $objPHPExcel-&gt;createSheet(1);\r\n$objPHPExcel-&gt;setActiveSheetIndex(1)-&gt;setCellValue(<span style=\"color:#a31515\">'A1'</span>, 20);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setTitle(<span style=\"color:#a31515\">&quot;Pager2&quot;</span>);\r\n\r\n$objWorksheet = $objPHPExcel-&gt;createSheet(2);\r\n$objPHPExcel-&gt;setActiveSheetIndex(2)-&gt;setCellValue(<span style=\"color:#a31515\">'A1'</span>, <span style=\"color:#a31515\">'=AVERAGE(Pager1:Pager2!A1)'</span>);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setTitle(<span style=\"color:#a31515\">&quot;PagerAll&quot;</span>);\r\n\r\nheader(<span style=\"color:#a31515\">'Content-Type: application/vnd.ms-excel'</span>);\r\nheader(<span style=\"color:#a31515\">'Content-Disposition: attachment;filename=&quot;testfile.xls&quot;'</span>);\r\nheader(<span style=\"color:#a31515\">'Cache-Control: max-age=0'</span>);\r\n$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, <span style=\"color:#a31515\">'Excel5'</span>);\r\n$objWriter-&gt;save(<span style=\"color:#a31515\">'php://output'</span>);\r\n<span style=\"color:blue\">exit</span>;\r\n?&gt;\r\n</pre>\r\n</div>\r\nPerhaps someone can help me?</p>",
    "PostedDate": "2010-10-21T10:19:15.673-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "510937",
    "ThreadId": "231484",
    "Html": "\r\n<p>While the PHPExcel calculation engine is fairly comprehensive now, it doesn't yet support 3D references such as Pager1:Pager2!A1.</p>\r\n<p>When saving the file using the Excel2007 writer, PHPExcel attempts to execute the formula so that the result can be stored as part of the cell information written to the xlsx, but this formula with its 3D reference will generate an error in the calculation\r\n engine, so no result can be written. The default behaviour in this case is to store the error (as a #REF! error, because it is a Reference problem). The Excel2007 format also stores the formula as part of the cell information in the xlsx file, which is valid\r\n for Excel itself... hence forcing a recalculation within Excel itself, which&nbsp;results in the recalc correcting the result.</p>\r\n",
    "PostedDate": "2010-10-22T00:52:04.45-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]