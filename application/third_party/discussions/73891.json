[
  {
    "Id": "252691",
    "ThreadId": "73891",
    "Html": "<p>Hello all,</p>\r\n<p>I have a coding problem.</p>\r\n<p>I have to save contents from excel5 file to db.</p>\r\n<p>I have no problem with reading contents from excel.</p>\r\n<p>But when for example 3 cells are merged i would like to duplicate content from first to another two.</p>\r\n<p>Here's example:</p>\r\n<p><strong>merged (A1:A3) = some data</strong></p>\r\n<p>after reading unmarged cells looks like:</p>\r\n<p><strong>A1 = some data</strong></p>\r\n<p><strong>A2 = ' '</strong></p>\r\n<p><strong>A3 = ' '</strong></p>\r\n<p>I wuld like to have something like this after reading:</p>\r\n<p><strong>A1 = some data</strong></p>\r\n<p><strong>A2 =</strong><strong> some data</strong></p>\r\n<p><strong>A3 = </strong><strong>some data</strong></p>\r\n<p>How to chek if cell is merged to copy data to all merged cells?</p>\r\n<p>Is there any answer</p>\r\n<p>Thank you</p>\r\n<p>jaskooo</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2009-11-03T00:57:48.333-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "252706",
    "ThreadId": "73891",
    "Html": "<p>A call to $objPHPExcel-&gt;getActiveSheet()-&gt;getMergeCells() will return an array of all the merged ranges in a worksheet, so a block of code like the following (untested)</p>\r\n<p>$cellAddress = <span style=\"color:#A31515\">'A2'</span>;<br>$foundInRange = false;<br><span style=\"color:Blue\">foreach</span>($objPHPExcel-&gt;getActiveSheet()-&gt;getMergeCells() <span style=\"color:Blue\">as</span> $range) {<br>&nbsp;&nbsp; <span style=\"color:Blue\">if</span> ($objPHPExcel-&gt;getActiveSheet()-&gt;getCell($cellAddress)-&gt;isInRange($range)) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $rangeDetails = PHPExcel_Cell::splitRange($range);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $result = $objPHPExcel-&gt;getActiveSheet()-&gt;getCell($rangeDetails[0][0])-&gt;getValue();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $foundInRange = true;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style=\"color:Blue\">break</span>;<br>&nbsp;&nbsp; }<br>}<br><span style=\"color:Blue\">if</span> (!$foundInRange) {<br>&nbsp;&nbsp; $result = $objPHPExcel-&gt;getActiveSheet()-&gt;getCell($cellAddress)-&gt;getValue();<br>}</p>\r\n<p>should allow you to search through all merged ranges for a given cell, returning the correct value whether it's in a merged range or not</p>",
    "PostedDate": "2009-11-03T01:28:11.627-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "252727",
    "ThreadId": "73891",
    "Html": "<p>Ok I'm stuck again :)</p>\r\n<p>Here's my code\r\n<div style=\"color:Black;background-color:White\">\r\n<pre>$<span style=\"color:Blue\">file</span> = $_FILES[<span style=\"color:#A31515\">'file_loaded'</span>][<span style=\"color:#A31515\">'tmp_name'</span>];\r\n\t\t\t$objReader = PHPExcel_IOFactory::createReader(<span style=\"color:#A31515\">'Excel5'</span>);\r\n\t\t\t$objPHPExcel = $objReader-&gt;load($<span style=\"color:Blue\">file</span>);\r\n\t\t\t$objWorksheet = $objPHPExcel-&gt;getActiveSheet();\r\n\t\t\t$highestRow = $objWorksheet-&gt;getHighestRow(); <span style=\"color:Green\">// e.g. 10</span>\r\n\t\t\t$highestColumn = $objWorksheet-&gt;getHighestColumn(); <span style=\"color:Green\">// e.g 'F'</span>\r\n\t\t\t$highestColumnIndex = PHPExcel_Cell::columnIndexFromString($highestColumn); <span style=\"color:Green\">// e.g.</span>\r\n\t\t\t\r\n\t\t\t$data = Array();\r\n\t\t\t$start = 9;\r\n\t\t\t<span style=\"color:Blue\">for</span> ($row = $start; $row &lt;= $highestRow; ++$row) {\r\n\t\t\t<span style=\"color:Green\">&nbsp;</span>\t\t\t\t\r\n\t\t\t\t $no = $objWorksheet-&gt;getCellByColumnAndRow(0, $row)-&gt;getCalculatedValue();\r\n\t\r\n\t\t\t\t $div = $objWorksheet-&gt;getCellByColumnAndRow(1, $row)-&gt;getCalculatedValue();\r\n\t\r\n\t\t\t\t $page = $objWorksheet-&gt;getCellByColumnAndRow(2, $row)-&gt;getValue();\r\n\t\t\t\t\r\n\t\t\t\t $dept = $objWorksheet-&gt;getCellByColumnAndRow(3, $row)-&gt;getCalculatedValue();\r\n\t\t\t\t\r\n\t\t\t\t $buyer_id = $objWorksheet-&gt;getCellByColumnAndRow(4, $row)-&gt;getCalculatedValue();\r\n\t\t\t\t\r\n\t\t\t\t $upc = $objWorksheet-&gt;getCellByColumnAndRow(5, $row)-&gt;getCalculatedValue();\r\n\t\t\t\t\r\n\t\t\t\t $item_name = $objWorksheet-&gt;getCellByColumnAndRow(6, $row)-&gt;getCalculatedValue();\r\n\t\t\t\t\r\n\t\t\t\t $pack_size = $objWorksheet-&gt;getCellByColumnAndRow(7, $row)-&gt;getCalculatedValue();\r\n\t\t\t\t\r\n\t\t\t\t $function_description = $objWorksheet-&gt;getCellByColumnAndRow(8, $row)-&gt;getCalculatedValue();\r\n\t\t\t\t\r\n\t\t\t\t $gift_info = $objWorksheet-&gt;getCellByColumnAndRow(9, $row)-&gt;getCalculatedValue();\r\n\t\t\t\t\r\n\t\t\t\t $special_price = $objWorksheet-&gt;getCellByColumnAndRow(10, $row)-&gt;getCalculatedValue();\r\n\t\t\t\t\r\n\t\t\t\t $member_price = $objWorksheet-&gt;getCellByColumnAndRow(11, $row)-&gt;getCalculatedValue();\r\n\t\t\t\t\r\n\t\t\t\t $effective_date_exception = $objWorksheet-&gt;getCellByColumnAndRow(13, $row)-&gt;getCalculatedValue();\r\n\t\t\t\t\r\n\t\t\t\t $sample_pic_no = $objWorksheet-&gt;getCellByColumnAndRow(14, $row)-&gt;getCalculatedValue();\r\n\t\t\t\t\r\n\t\t\t\t $special_photo_shooting_request = $objWorksheet-&gt;getCellByColumnAndRow(15, $row)-&gt;getCalculatedValue();\r\n\t\t\t\t\r\n\t\t\t\t $effective_store = $objWorksheet-&gt;getCellByColumnAndRow(16, $row)-&gt;getCalculatedValue();\r\n\t\t\t\t\r\n\t\t\t\t $change_sheet_submit_date = $objWorksheet-&gt;getCellByColumnAndRow(17\t, $row)-&gt;getCalculatedValue();\r\n\t\t\t\t\r\n\t\t\t\t$dane[$row-$start] = <span style=\"color:Blue\">array</span> (\r\n\t\t\t\t<span style=\"color:#A31515\">&quot;no&quot;</span>  =&gt; $no,\r\n\t\t\t\t<span style=\"color:#A31515\">&quot;div&quot;</span> =&gt; $div,\r\n\t\t\t\t<span style=\"color:#A31515\">&quot;page&quot;</span> =&gt; (string) $page,\r\n\t\t\t\t<span style=\"color:#A31515\">&quot;dept&quot;</span>=&gt; $dept,\r\n\t\t\t\t<span style=\"color:#A31515\">&quot;buyer_id&quot;</span> =&gt; $buyer_id,\r\n\t\t\t\t<span style=\"color:#A31515\">&quot;upc&quot;</span>=&gt;$upc,\r\n\t\t\t\t<span style=\"color:#A31515\">&quot;item_name&quot;</span> =&gt; $item_name,\r\n\t\t\t\t<span style=\"color:#A31515\">&quot;pack_size&quot;</span> =&gt; $pack_size,\r\n\t\t\t\t<span style=\"color:#A31515\">&quot;function_description&quot;</span> =&gt; $function_description,\r\n\t\t\t\t<span style=\"color:#A31515\">&quot;gift_info&quot;</span> =&gt; $gift_info,\r\n\t\t\t\t<span style=\"color:#A31515\">&quot;special_price&quot;</span> =&gt; $special_price,\r\n\t\t\t\t<span style=\"color:#A31515\">&quot;member_price&quot;</span> =&gt; $member_price,\r\n\t\t\t\t<span style=\"color:#A31515\">&quot;effective_date_exception&quot;</span> =&gt; $effective_date_exception,\r\n\t\t\t\t<span style=\"color:#A31515\">&quot;sample_pic_no&quot;</span> =&gt; $sample_pic_no,\r\n\t\t\t\t<span style=\"color:#A31515\">&quot;special_foto_shooting_request&quot;</span> =&gt; $special_photo_shooting_request,\r\n\t\t\t\t<span style=\"color:#A31515\">&quot;effective_store&quot;</span> =&gt; $effective_store,\r\n\t\t\t\t<span style=\"color:#A31515\">&quot;change_sheet_submit_date&quot;</span> =&gt; $change_sheet_submit_date\r\n\t\t\t\t);\r\n</pre>\r\n</div>\r\n</p>\r\n<p>After your answer i've made a functon:</p>\r\n<p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre><span style=\"color:Blue\">public</span> <span style=\"color:Blue\">static</span> <span style=\"color:Blue\">function</span> getCFM ($cellAddress)\r\n    {\r\n        $foundInRange = false;\r\n    <span style=\"color:Blue\">foreach</span>($objPHPExcel-&gt;getActiveSheet()-&gt;getMergeCells() <span style=\"color:Blue\">as</span> $range) {\r\n           <span style=\"color:Blue\">if</span> ($objPHPExcel-&gt;getActiveSheet()-&gt;getCell($cellAddress)-&gt;isInRange($range)) {\r\n              $rangeDetails = PHPExcel_Cell::splitRange($range);\r\n              $result = $objPHPExcel-&gt;getActiveSheet()-&gt;getCell($rangeDetails[0][0])-&gt;getValue();\r\n              $foundInRange = true;\r\n              <span style=\"color:Blue\">break</span>;\r\n               }\r\n        }\r\n        <span style=\"color:Blue\">if</span> (!$foundInRange) {\r\n           $result = $objPHPExcel-&gt;getActiveSheet()-&gt;getCell($cellAddress)-&gt;getValue();\r\n        }\r\n        <span style=\"color:Blue\">return</span> $result;\r\n    }\r\n</pre>\r\n</div>\r\n</p>\r\n<p>How do i get cell address to use it as a param in getCFM function?</p>\r\n<pre></pre>\r\n<p>I think i shoul use something like this i nevery cell call:</p>\r\n<pre>$no = getCFM($objWorksheet-&gt;getCellByColumnAndRow(0, $row)-&gt;getCellAddress());</pre>\r\n<p>But function <strong>getCellAddress</strong> doesn't exists</p>\r\n<p>Please help</p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2009-11-03T02:42:12.25-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "252745",
    "ThreadId": "73891",
    "Html": "<p>A getCellAddress() method doesn't exist, but getCoordinate() does</p>\r\n<p>And you'd need to pass $objPHPExcel through to your function as well, otherwise it isn't in scope for your function</p>\r\n<p>&nbsp;</p>\r\n<p>Also, the function only returns the cell value, not necessarily the calculated value, so you'd probably need an equivalent function (or an additional argument for your current function) to call getCalculatedValue() instead of getValue()</p>",
    "PostedDate": "2009-11-03T03:24:38.753-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "252754",
    "ThreadId": "73891",
    "Html": "<p>It finally works thanks</p>",
    "PostedDate": "2009-11-03T03:58:28.123-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]