[
  {
    "Id": "516791",
    "ThreadId": "233409",
    "Html": "\r\n<p>I am having image quality issues with my pdf output! &nbsp;</p>\r\n<p>&nbsp;</p>\r\n<p>Here is the code I am using: &nbsp;(image section is at line 99!&nbsp;</p>\r\n<p>&nbsp;</p>\r\n<p></p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre>&lt;?php\r\nini_set(<span style=\"color:#a31515\">'display_errors'</span>,1);\r\ndefine(<span style=\"color:#a31515\">'XML_FOLDER_PATH'</span>, <span style=\"color:#a31515\">'D:/wamp/www/phpexcel/xml_folder/'</span>); <span style=\"color:green\">//have slasher at end</span>\r\ndefine(<span style=\"color:#a31515\">'PDF_FOLDER_PATH'</span>, <span style=\"color:#a31515\">'D:/wamp/www/phpexcel/pdf_folder/'</span>); <span style=\"color:green\">//have slasher at end</span>\r\ndefine(<span style=\"color:#a31515\">'TOP_IMAGE'</span>,<span style=\"color:#a31515\">'newtop.jpg'</span>);\r\ndefine(<span style=\"color:#a31515\">'BOTTOM_IMAGE'</span>,<span style=\"color:#a31515\">'new bottom.jpg'</span>);\r\n\r\n<span style=\"color:green\">//change these params fit with your config</span>\r\n<span style=\"color:green\">//or you can replace with include config.php of your</span>\r\n$connection = mysql_connect(<span style=\"color:#a31515\">'localhost'</span>, <span style=\"color:#a31515\">'root'</span>, <span style=\"color:#a31515\">''</span>) <span style=\"color:blue\">or</span> <span style=\"color:blue\">die</span>(<span style=\"color:#a31515\">'Can not connect mysql server'</span>);\r\nmysql_select_db(<span style=\"color:#a31515\">'ordernew'</span>) <span style=\"color:blue\">or</span> <span style=\"color:blue\">die</span>(<span style=\"color:#a31515\">'Can not select database'</span>);\r\n\r\n<span style=\"color:green\">//parsing XML</span>\r\n$dir = opendir(XML_FOLDER_PATH);\r\n<span style=\"color:blue\">if</span>(!$dir)\r\n{\r\n    <span style=\"color:blue\">die</span>(<span style=\"color:#a31515\">'Can not open '</span>.XML_FOLDER_PATH.<span style=\"color:#a31515\">'. Please check it'</span>);\r\n}\r\n\r\n<span style=\"color:blue\">while</span>($filename = readdir($dir))\r\n{\r\n    <span style=\"color:blue\">if</span>(is_file(XML_FOLDER_PATH.$filename))\r\n    {\r\n        <span style=\"color:blue\">if</span>(processFile(XML_FOLDER_PATH.$filename))\r\n\t\t\t<span style=\"color:blue\">echo</span> <span style=\"color:#a31515\">'&lt;b&gt;Process '</span>.$filename.<span style=\"color:#a31515\">' success.&lt;/b&gt;&lt;br/&gt;'</span>;\r\n\t\t<span style=\"color:blue\">else</span>\r\n\t\t\t<span style=\"color:blue\">echo</span> <span style=\"color:#a31515\">'Can not process '</span>.$filename.<span style=\"color:#a31515\">'.&lt;br/&gt;'</span>;\r\n    }\r\n}\r\nclosedir($dir);\r\n\r\n<span style=\"color:blue\">function</span> processFile($filenameFullPath)\r\n{\r\n    $xmlDoc     = <span style=\"color:blue\">new</span> DOMDocument();\r\n    $xmlLoad    = $xmlDoc-&gt;load($filenameFullPath);\r\n    <span style=\"color:blue\">if</span>(!$xmlLoad) <span style=\"color:blue\">return</span> false;\r\n    \r\n    $patient_id     = $xmlDoc-&gt;getElementsByTagName(<span style=\"color:#a31515\">'patient_id'</span>)-&gt;item(0)-&gt;nodeValue;\r\n    $patient_last   = $xmlDoc-&gt;getElementsByTagName(<span style=\"color:#a31515\">'patient_last'</span>)-&gt;item(0)-&gt;nodeValue;\r\n    $patient_first  = $xmlDoc-&gt;getElementsByTagName(<span style=\"color:#a31515\">'patient_first'</span>)-&gt;item(0)-&gt;nodeValue;\r\n    $patient_dob    = $xmlDoc-&gt;getElementsByTagName(<span style=\"color:#a31515\">'patient_dob'</span>)-&gt;item(0)-&gt;nodeValue;\r\n    $patient_gender = $xmlDoc-&gt;getElementsByTagName(<span style=\"color:#a31515\">'patient_gender'</span>)-&gt;item(0)-&gt;nodeValue;\r\n\r\n    $xrex_case_number   = $xmlDoc-&gt;getElementsByTagName(<span style=\"color:#a31515\">'xrex_case_number'</span>)-&gt;item(0)-&gt;nodeValue;\r\n    $accession_number   = $xmlDoc-&gt;getElementsByTagName(<span style=\"color:#a31515\">'accession_number'</span>)-&gt;item(0)-&gt;nodeValue;\r\n    $date_of_exam       = $xmlDoc-&gt;getElementsByTagName(<span style=\"color:#a31515\">'date_of_exam'</span>)-&gt;item(0)-&gt;nodeValue;\r\n    $exam_type          = $xmlDoc-&gt;getElementsByTagName(<span style=\"color:#a31515\">'exam_type'</span>)-&gt;item(0)-&gt;nodeValue;\r\n    $exam_reason        = $xmlDoc-&gt;getElementsByTagName(<span style=\"color:#a31515\">'exam_reason'</span>)-&gt;item(0)-&gt;nodeValue;\r\n    $physician          = $xmlDoc-&gt;getElementsByTagName(<span style=\"color:#a31515\">'physician'</span>)-&gt;item(0)-&gt;nodeValue;\r\n    $modality           = $xmlDoc-&gt;getElementsByTagName(<span style=\"color:#a31515\">'modality'</span>)-&gt;item(0)-&gt;nodeValue;\r\n    $priority           = $xmlDoc-&gt;getElementsByTagName(<span style=\"color:#a31515\">'priority'</span>)-&gt;item(0)-&gt;nodeValue;\r\n    $facility           = $xmlDoc-&gt;getElementsByTagName(<span style=\"color:#a31515\">'facility'</span>)-&gt;item(0)-&gt;nodeValue;\r\n\r\n    $findings           = $xmlDoc-&gt;getElementsByTagName(<span style=\"color:#a31515\">'findings'</span>)-&gt;item(0)-&gt;nodeValue;\r\n    $impression         = $xmlDoc-&gt;getElementsByTagName(<span style=\"color:#a31515\">'impression'</span>)-&gt;item(0)-&gt;nodeValue;\r\n    $diagnosis          = $xmlDoc-&gt;getElementsByTagName(<span style=\"color:#a31515\">'diagnosis'</span>)-&gt;item(0)-&gt;nodeValue;\r\n    $last               = $xmlDoc-&gt;getElementsByTagName(<span style=\"color:#a31515\">'last'</span>)-&gt;item(0)-&gt;nodeValue;\r\n    $first              = $xmlDoc-&gt;getElementsByTagName(<span style=\"color:#a31515\">'first'</span>)-&gt;item(0)-&gt;nodeValue;\r\n    $npi                = $xmlDoc-&gt;getElementsByTagName(<span style=\"color:#a31515\">'npi'</span>)-&gt;item(0)-&gt;nodeValue;\r\n    $signature_timestamp = $xmlDoc-&gt;getElementsByTagName(<span style=\"color:#a31515\">'signature_timestamp'</span>)-&gt;item(0)-&gt;nodeValue;\r\n\r\n    <span style=\"color:green\">//not process if no accession number</span>\r\n    <span style=\"color:blue\">if</span>($accession_number == <span style=\"color:#a31515\">''</span>) <span style=\"color:blue\">return</span> false;\r\n    \r\n    <span style=\"color:green\">//not process if not match accession number</span>\r\n    $accession_number   = mysql_real_escape_string($accession_number);\r\n    $result             = mysql_query(<span style=\"color:#a31515\">&quot;SELECT * FROM study WHERE accessionnum = '$accession_number'&quot;</span>);\r\n\r\n    <span style=\"color:blue\">if</span>(!$result || mysql_num_rows($result) == 0) <span style=\"color:blue\">return</span> false;\r\n\r\n    <span style=\"color:green\">//get file name</span>\r\n    $row            = mysql_fetch_assoc($result);\r\n    $pdfFileName    = $row[<span style=\"color:#a31515\">'uuid'</span>].<span style=\"color:#a31515\">'.pdf'</span>; <span style=\"color:green\">//which field ?</span>\r\n    \r\n\r\n\r\n    <span style=\"color:green\">//create pdf ----------------------------------</span>\r\n\r\n    <span style=\"color:blue\">require_once</span> <span style=\"color:#a31515\">'PHPExcel/Classes/PHPExcel.php'</span>;\r\n\r\n    <span style=\"color:green\">// Create new PHPExcel object</span>\r\n    $objPHPExcel = <span style=\"color:blue\">new</span> PHPExcel();\r\n\r\n    <span style=\"color:green\">// Set properties</span>\r\n    $objPHPExcel-&gt;getProperties()-&gt;setCreator(<span style=\"color:#a31515\">&quot;SonIT&quot;</span>)\r\n                                 -&gt;setLastModifiedBy(<span style=\"color:#a31515\">&quot;SonIT&quot;</span>)\r\n                                 -&gt;setTitle(<span style=\"color:#a31515\">&quot;X-RAY&quot;</span>);\r\n    $objPHPExcel-&gt;createSheet();\r\n    $objPHPExcel-&gt;setActiveSheetIndex(0);\r\n\r\n    $sheet = $objPHPExcel-&gt;getActiveSheet();\r\n    $sheet-&gt;setTitle(<span style=\"color:#a31515\">'X-RAY'</span>);\r\n    $sheet-&gt;getPageSetup()-&gt;setOrientation(PHPExcel_Worksheet_PageSetup::ORIENTATION_DEFAULT)\r\n                            -&gt;setPaperSize(PHPExcel_Worksheet_PageSetup::PAPERSIZE_A4);\r\n    \r\n    $sheet-&gt;setShowGridlines(false);\r\n\r\n    $rowSub = 1;\r\n    $objDrawing = <span style=\"color:blue\">new</span> PHPExcel_Worksheet_Drawing();\r\n    $objDrawing-&gt;setPath(TOP_IMAGE);\r\n    $objDrawing-&gt;setCoordinates(<span style=\"color:#a31515\">'A'</span>.($rowSub&#43;1));\r\n    $objDrawing-&gt;setWorksheet($sheet);\r\n\r\n    $sheet-&gt;getColumnDimension(<span style=\"color:#a31515\">'A'</span>)-&gt;setWidth(25);\r\n    $sheet-&gt;getColumnDimension(<span style=\"color:#a31515\">'B'</span>)-&gt;setWidth(30);\r\n    $sheet-&gt;getColumnDimension(<span style=\"color:#a31515\">'C'</span>)-&gt;setWidth(25);\r\n    $sheet-&gt;getColumnDimension(<span style=\"color:#a31515\">'D'</span>)-&gt;setWidth(34);\r\n\r\n    $rowSub &#43;=3;\r\n    $sheet-&gt;getStyle(<span style=\"color:#a31515\">'A'</span>.$rowSub)-&gt;getFont()-&gt;setBold(true);\r\n    $sheet-&gt;getStyle(<span style=\"color:#a31515\">'A'</span>.$rowSub)-&gt;getAlignment()-&gt;setWrapText(true);\r\n    $sheet-&gt;setCellValue(<span style=\"color:#a31515\">'A'</span>.$rowSub, <span style=\"color:#a31515\">'PATIENT:'</span>);\r\n    $sheet-&gt;getStyle(<span style=\"color:#a31515\">'B'</span>.$rowSub)-&gt;getAlignment()-&gt;setWrapText(true);\r\n    $sheet-&gt;setCellValue(<span style=\"color:#a31515\">'B'</span>.$rowSub, $patient_first.<span style=\"color:#a31515\">' '</span>.$patient_last);\r\n\r\n    $sheet-&gt;getStyle(<span style=\"color:#a31515\">'C'</span>.$rowSub)-&gt;getFont()-&gt;setBold(true);\r\n    $sheet-&gt;getStyle(<span style=\"color:#a31515\">'C'</span>.$rowSub)-&gt;getAlignment()-&gt;setWrapText(true);\r\n    $sheet-&gt;setCellValue(<span style=\"color:#a31515\">'C'</span>.$rowSub, <span style=\"color:#a31515\">'REFERRING MD:'</span>);\r\n    $sheet-&gt;getStyle(<span style=\"color:#a31515\">'D'</span>.$rowSub)-&gt;getAlignment()-&gt;setWrapText(true);\r\n    $sheet-&gt;setCellValue(<span style=\"color:#a31515\">'D'</span>.$rowSub, $physician);\r\n\r\n    $rowSub &#43;&#43;;\r\n    $sheet-&gt;getStyle(<span style=\"color:#a31515\">'A'</span>.$rowSub)-&gt;getFont()-&gt;setBold(true);\r\n    $sheet-&gt;getStyle(<span style=\"color:#a31515\">'A'</span>.$rowSub)-&gt;getAlignment()-&gt;setWrapText(true);\r\n    $sheet-&gt;setCellValue(<span style=\"color:#a31515\">'A'</span>.$rowSub, <span style=\"color:#a31515\">'DOB:'</span>);\r\n    $sheet-&gt;getStyle(<span style=\"color:#a31515\">'B'</span>.$rowSub)-&gt;getAlignment()-&gt;setWrapText(true);\r\n    $sheet-&gt;setCellValue(<span style=\"color:#a31515\">'B'</span>.$rowSub, $patient_dob);\r\n\r\n    $sheet-&gt;getStyle(<span style=\"color:#a31515\">'C'</span>.$rowSub)-&gt;getFont()-&gt;setBold(true);\r\n    $sheet-&gt;getStyle(<span style=\"color:#a31515\">'C'</span>.$rowSub)-&gt;getAlignment()-&gt;setWrapText(true);\r\n    $sheet-&gt;setCellValue(<span style=\"color:#a31515\">'C'</span>.$rowSub, <span style=\"color:#a31515\">'INTERPRETING MD:'</span>);\r\n    $sheet-&gt;getStyle(<span style=\"color:#a31515\">'D'</span>.$rowSub)-&gt;getAlignment()-&gt;setWrapText(true);\r\n    $sheet-&gt;setCellValue(<span style=\"color:#a31515\">'D'</span>.$rowSub, $first.<span style=\"color:#a31515\">' '</span>.$last); <span style=\"color:green\">//do we need NPI ? timestamp ?</span>\r\n\r\n    $rowSub &#43;&#43;;\r\n    $sheet-&gt;getStyle(<span style=\"color:#a31515\">'A'</span>.$rowSub)-&gt;getFont()-&gt;setBold(true);\r\n    $sheet-&gt;getStyle(<span style=\"color:#a31515\">'A'</span>.$rowSub)-&gt;getAlignment()-&gt;setWrapText(true);\r\n    $sheet-&gt;setCellValue(<span style=\"color:#a31515\">'A'</span>.$rowSub, <span style=\"color:#a31515\">'DOS:'</span>);\r\n    $sheet-&gt;getStyle(<span style=\"color:#a31515\">'B'</span>.$rowSub)-&gt;getAlignment()-&gt;setWrapText(true);\r\n    $sheet-&gt;setCellValue(<span style=\"color:#a31515\">'B'</span>.$rowSub, $date_of_exam);\r\n\r\n    $sheet-&gt;getStyle(<span style=\"color:#a31515\">'C'</span>.$rowSub)-&gt;getFont()-&gt;setBold(true);\r\n    $sheet-&gt;getStyle(<span style=\"color:#a31515\">'C'</span>.$rowSub)-&gt;getAlignment()-&gt;setWrapText(true);\r\n    $sheet-&gt;setCellValue(<span style=\"color:#a31515\">'C'</span>.$rowSub, <span style=\"color:#a31515\">'FACILITY:'</span>);\r\n    $sheet-&gt;getStyle(<span style=\"color:#a31515\">'D'</span>.$rowSub)-&gt;getAlignment()-&gt;setWrapText(true);\r\n    $sheet-&gt;setCellValue(<span style=\"color:#a31515\">'D'</span>.$rowSub, $facility);\r\n\r\n    $rowSub &#43;&#43;;\r\n    $sheet-&gt;getStyle(<span style=\"color:#a31515\">'A'</span>.$rowSub)-&gt;getFont()-&gt;setBold(true);\r\n    $sheet-&gt;getStyle(<span style=\"color:#a31515\">'A'</span>.$rowSub)-&gt;getAlignment()-&gt;setWrapText(true);\r\n    $sheet-&gt;setCellValue(<span style=\"color:#a31515\">'A'</span>.$rowSub, <span style=\"color:#a31515\">'STUDY:'</span>);\r\n    $sheet-&gt;getStyle(<span style=\"color:#a31515\">'B'</span>.$rowSub)-&gt;getAlignment()-&gt;setWrapText(true);\r\n\t$sheet-&gt;getStyle(<span style=\"color:#a31515\">'B'</span>.$rowSub)-&gt;getFont()-&gt;setBold(true);\r\n\t$sheet-&gt;getStyle(<span style=\"color:#a31515\">'B'</span>.$rowSub)-&gt;getFont()-&gt;setUnderline(PHPExcel_Style_Font::UNDERLINE_SINGLE);\r\n    $sheet-&gt;setCellValue(<span style=\"color:#a31515\">'B'</span>.$rowSub, $exam_type);\r\n\r\n    $alignArray = <span style=\"color:blue\">array</span>(<span style=\"color:#a31515\">'alignment'</span> =&gt; <span style=\"color:blue\">array</span>(\r\n\t\t\t\t\t\t\t\t<span style=\"color:#a31515\">'horizontal'</span>    =&gt; PHPExcel_Style_Alignment::HORIZONTAL_JUSTIFY,\r\n\t\t\t\t\t\t\t\t<span style=\"color:#a31515\">'vertical'</span>      =&gt; PHPExcel_Style_Alignment::VERTICAL_TOP,\r\n\t\t\t\t\t\t\t\t<span style=\"color:#a31515\">'wrap'</span>          =&gt; true\r\n\t\t\t\t\t\t\t ));\r\n\r\n    $rowSub &#43;= 2;\r\n    $sheet-&gt;getStyle(<span style=\"color:#a31515\">'A'</span>.$rowSub.<span style=\"color:#a31515\">':D'</span>.$rowSub)-&gt;applyFromArray($alignArray);\r\n    $sheet-&gt;mergeCells(<span style=\"color:#a31515\">'A'</span>.$rowSub.<span style=\"color:#a31515\">':D'</span>.$rowSub);\r\n    $sheet-&gt;setCellValue(<span style=\"color:#a31515\">'A'</span>.$rowSub, <span style=\"color:#a31515\">'DEAR:    '</span>.$physician.<span style=\"color:#a31515\">'  MD'</span>);\r\n\t\r\n    $rowSub &#43;=2;\r\n\t$sheet-&gt;mergeCells(<span style=\"color:#a31515\">'A'</span>.$rowSub.<span style=\"color:#a31515\">':D'</span>.$rowSub);\r\n\r\n\t$objRichText = <span style=\"color:blue\">new</span> PHPExcel_RichText();\r\n\t$objStudy = $objRichText-&gt;createTextRun(<span style=\"color:#a31515\">&quot;REASON FOR STUDY:    &quot;</span>);\r\n\t$objStudy-&gt;getFont()-&gt;setBold(true);\r\n<span style=\"color:green\">//\t$objStudy-&gt;getFont()-&gt;setColor( new PHPExcel_Style_Color( PHPExcel_Style_Color::COLOR_DARKGREEN ) );</span>\r\n\t$objRichText-&gt;createText($exam_reason);\r\n\t\r\n\t$sheet-&gt;getCell(<span style=\"color:#a31515\">'A'</span>.$rowSub)-&gt;setValue($objRichText);\r\n\r\n\r\n    $rowSub &#43;= 2;\r\n    $sheet-&gt;mergeCells(<span style=\"color:#a31515\">'A'</span>.$rowSub.<span style=\"color:#a31515\">':D'</span>.$rowSub);\r\n\t$sheet-&gt;getStyle(<span style=\"color:#a31515\">'A'</span>.$rowSub)-&gt;getFont()-&gt;setBold(true);\r\n    $sheet-&gt;setCellValue(<span style=\"color:#a31515\">'A'</span>.$rowSub, <span style=\"color:#a31515\">&quot;FINDINGS:&quot;</span>);\r\n\r\n\t$rowSub &#43;&#43;;\r\n    $sheet-&gt;getStyle(<span style=\"color:#a31515\">'A'</span>.$rowSub.<span style=\"color:#a31515\">':D'</span>.$rowSub)-&gt;applyFromArray($alignArray);\r\n    $sheet-&gt;mergeCells(<span style=\"color:#a31515\">'A'</span>.$rowSub.<span style=\"color:#a31515\">':D'</span>.$rowSub);\r\n    $sheet-&gt;setCellValue(<span style=\"color:#a31515\">'A'</span>.$rowSub, $findings);\r\n\r\n    $rowSub &#43;= 2;\r\n    $sheet-&gt;mergeCells(<span style=\"color:#a31515\">'A'</span>.$rowSub.<span style=\"color:#a31515\">':D'</span>.$rowSub);\r\n    $sheet-&gt;getStyle(<span style=\"color:#a31515\">'A'</span>.$rowSub)-&gt;getFont()-&gt;setBold(true);\r\n    $sheet-&gt;setCellValue(<span style=\"color:#a31515\">'A'</span>.$rowSub, <span style=\"color:#a31515\">&quot;IMPRESSION:&quot;</span>);\r\n    $rowSub &#43;&#43;;\r\n    $sheet-&gt;getStyle(<span style=\"color:#a31515\">'A'</span>.$rowSub.<span style=\"color:#a31515\">':D'</span>.$rowSub)-&gt;applyFromArray($alignArray);\r\n    $sheet-&gt;mergeCells(<span style=\"color:#a31515\">'A'</span>.$rowSub.<span style=\"color:#a31515\">':D'</span>.$rowSub);\r\n\t$sheet-&gt;getStyle(<span style=\"color:#a31515\">'A'</span>.$rowSub)-&gt;getFont()-&gt;setBold(true);\r\n    $sheet-&gt;setCellValue(<span style=\"color:#a31515\">'A'</span>.$rowSub, $impression);\r\n\r\n    $rowSub &#43;= 4;\r\n    $sheet-&gt;getStyle(<span style=\"color:#a31515\">'A'</span>.$rowSub.<span style=\"color:#a31515\">':D'</span>.$rowSub)-&gt;applyFromArray($alignArray);\r\n    $sheet-&gt;mergeCells(<span style=\"color:#a31515\">'A'</span>.$rowSub.<span style=\"color:#a31515\">':D'</span>.$rowSub);\r\n    $sheet-&gt;setCellValue(<span style=\"color:#a31515\">'A'</span>.$rowSub, <span style=\"color:#a31515\">&quot;Thank you for allowing BUFFALO ULTRASOUND to participate in the care of this patient.\\nShould you have any questions concerning this report or the study performed,\\nPlease do not hesitate to contact us.&quot;</span>);\r\n\r\n    $rowSub &#43;=2;\r\n    $sheet-&gt;getStyle(<span style=\"color:#a31515\">'A'</span>.$rowSub.<span style=\"color:#a31515\">':D'</span>.$rowSub)-&gt;applyFromArray($alignArray);\r\n    $sheet-&gt;mergeCells(<span style=\"color:#a31515\">'A'</span>.$rowSub.<span style=\"color:#a31515\">':D'</span>.$rowSub);\r\n    $sheet-&gt;setCellValue(<span style=\"color:#a31515\">'A'</span>.$rowSub,<span style=\"color:#a31515\">&quot;Very Truly Yours,&quot;</span>);\r\n    $rowSub &#43;&#43;;\r\n<span style=\"color:green\">//    $sheet-&gt;getStyle('A'.$rowSub.':D'.$rowSub)-&gt;applyFromArray($alignArray);</span>\r\n<span style=\"color:green\">//    $sheet-&gt;mergeCells('A'.$rowSub.':D'.$rowSub);</span>\r\n<span style=\"color:green\">//    $sheet-&gt;setCellValue('A'.$rowSub,&quot;Buffalo Ultrasound, IDTF&quot;);</span>\r\n\r\n    $rowSub &#43;&#43;;\r\n    $sheet-&gt;getStyle(<span style=\"color:#a31515\">'A'</span>.$rowSub.<span style=\"color:#a31515\">':D'</span>.$rowSub)-&gt;applyFromArray($alignArray);\r\n    $sheet-&gt;setCellValue(<span style=\"color:#a31515\">'A'</span>.$rowSub,<span style=\"color:#a31515\">&quot;E-SIGNED BY:   &quot;</span>);\r\n    $sheet-&gt;getStyle(<span style=\"color:#a31515\">'A'</span>.$rowSub)-&gt;getFont()-&gt;setBold(true);\r\n    $sheet-&gt;getStyle(<span style=\"color:#a31515\">'A'</span>.$rowSub)-&gt;getFont()-&gt;setSize(14);\r\n    $sheet-&gt;setCellValue(<span style=\"color:#a31515\">'B'</span>.$rowSub, $first.<span style=\"color:#a31515\">' '</span>.$last.<span style=\"color:#a31515\">&quot;,  MD\\nBoard Certified Radiologist&quot;</span>);\r\n\r\n    $sheet-&gt;setCellValue(<span style=\"color:#a31515\">'C'</span>.$rowSub,<span style=\"color:#a31515\">&quot;ON:&quot;</span>);\r\n    $sheet-&gt;getStyle(<span style=\"color:#a31515\">'C'</span>.$rowSub)-&gt;getFont()-&gt;setBold(true);\r\n    $sheet-&gt;getStyle(<span style=\"color:#a31515\">'C'</span>.$rowSub)-&gt;getFont()-&gt;setSize(14);\r\n\t$sheet-&gt;getStyle(<span style=\"color:#a31515\">'C'</span>.$rowSub)-&gt;getAlignment()-&gt;setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_RIGHT);\r\n    $sheet-&gt;setCellValue(<span style=\"color:#a31515\">'D'</span>.$rowSub, <span style=\"color:#a31515\">&quot;   &quot;</span>.$signature_timestamp);\r\n\r\n    $rowSub &#43;=6;\r\n    $objDrawing = <span style=\"color:blue\">new</span> PHPExcel_Worksheet_Drawing();\r\n    $objDrawing-&gt;setPath(BOTTOM_IMAGE);\r\n    $objDrawing-&gt;setCoordinates(<span style=\"color:#a31515\">'A'</span>.($rowSub&#43;1));\r\n    $objDrawing-&gt;setWorksheet($sheet);\r\n\r\n    $rowSub &#43;=2;\r\n    $sheet-&gt;mergeCells(<span style=\"color:#a31515\">'A'</span>.$rowSub.<span style=\"color:#a31515\">':D'</span>.$rowSub);\r\n    $sheet-&gt;getStyle(<span style=\"color:#a31515\">'A'</span>.$rowSub)-&gt;getAlignment()-&gt;setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_CENTER);\r\n    $sheet-&gt;getStyle(<span style=\"color:#a31515\">'A'</span>.$rowSub)-&gt;getFont()-&gt;setItalic(true);\r\n    $sheet-&gt;setCellValue(<span style=\"color:#a31515\">'A'</span>.$rowSub,<span style=\"color:#a31515\">&quot;Patient Name: $patient_first $patient_last&quot;</span>.<span style=\"color:#a31515\">&quot;                 DOB: $patient_dob            DOS: $date_of_exam                         Page 1 of 1&quot;</span>);\r\n\r\n\t$sheet-&gt;setBreak( <span style=\"color:#a31515\">'A'</span> . ($rowSub&#43;1), PHPExcel_Worksheet::BREAK_ROW );\r\n\t\r\n    <span style=\"color:blue\">try</span>\r\n    {\r\n        $objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, <span style=\"color:#a31515\">'PDF'</span>);\r\n        $objWriter-&gt;save(PDF_FOLDER_PATH.$pdfFileName);\r\n    }\r\n    <span style=\"color:blue\">catch</span> (Exception $e)\r\n    {\r\n        <span style=\"color:blue\">return</span> false;\r\n    }\r\n    <span style=\"color:green\">//end create pdf -------------------------------</span>\r\n\r\n    <span style=\"color:green\">//update db</span>\r\n\tmysql_query(<span style=\"color:#a31515\">&quot;UPDATE study SET reviewed = 'xml' WHERE accessionnum = '$accession_number'&quot;</span>);\r\n\r\n    <span style=\"color:green\">//remove xml file</span>\r\n    unlink($filenameFullPath);\r\n\r\n    <span style=\"color:green\">//done</span>\r\n    <span style=\"color:blue\">return</span> true;\r\n}\r\n\r\n</pre>\r\n</div>\r\n<p></p>\r\n<p>the quality of the image is dramatically reduced compared to the original images) &nbsp;Image is a jpeg!&nbsp;</p>\r\n<p>&nbsp;</p>\r\n<p>suggestions?&nbsp;</p>\r\n<p>&nbsp;</p>\r\n",
    "PostedDate": "2010-11-03T17:45:17.84-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]