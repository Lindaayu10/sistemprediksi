[
  {
    "Id": "1350443",
    "ThreadId": "579855",
    "Html": "Ok I have 2 files that seems the same...\r<br />\n<br />\n1 file works really well and i get what i want.\r<br />\n<br />\nthe other file, not so much i get so many php errors but to me they seem like the same type of documents with the same sheets and everything...\r<br />\n<br />\ni get those errors \r<br />\n<br />\nWarning: DOMDocument::loadHTMLFile(): Tag cell invalid in Facebook-Insights-Data-Export-86WORX-2015-01-22.xls, line: 11313 in C:\\wamp\\www\\Facebook\\Classes\\PHPExcel\\Reader\\HTML.php on line 427\r<br />\n<br />\nfor like 1000 times\r<br />\n<br />\ncan  you guys help me to get what is wrong ?<br />\n<pre><code>\n&lt;?php \nset_include_path(dirname(__FILE__) . PATH_SEPARATOR . get_include_path());\n\nrequire 'Classes/PHPExcel.php';\nrequire 'Classes/PHPExcel/IOFactory.php';\n// libxml_use_internal_errors(true);\n?&gt; \n\n\n&lt;?php\n\nif(isset($_FILES['file_upload']))\n{\n    \n    \n    Upload();\n    \n    $sheetname = 'Daily Liked and online';\n    $name = $_FILES[&quot;file_upload&quot;][&quot;name&quot;]; \n    $thefile = $name;\n    \n    $inputFileType = PHPExcel_IOFactory::identify($thefile);\n    $objReader = PHPExcel_IOFactory::createReader($inputFileType);\n    $objReader-&gt;setReadDataOnly(true);\n    $objReader-&gt;setLoadSheetsOnly($sheetname);\n    $objPHPExcel = $objReader-&gt;load($thefile);\n    $objWorksheet = $objPHPExcel-&gt;getActiveSheet();\n    \n    $total_sheets=$objPHPExcel-&gt;getSheetCount(); \n    //$allSheetName=$objPHPExcel-&gt;getSheetNames(); \n    $objWorksheet = $objPHPExcel-&gt;setActiveSheetIndex($total_sheets-1); \n    \n    \n    $highestRow = $objWorksheet-&gt;getHighestRow(); \n    $highestColumn = $objWorksheet-&gt;getHighestColumn();  \n    $highestColumnIndex = PHPExcel_Cell::columnIndexFromString($highestColumn);  \n                for ($row = 6; $row &lt;= $highestRow;++$row) \n                {  \n                    $first = 0;\n                    $colfirst = 0;\n                    $second = 0;\n                    $colsecond = 0;\n                    $third = 0;\n                    $colthird = 0;\n                    $highertempo = 0;\n                    \n                    for ($bouclecol = 1; $bouclecol &lt; 4; ++$bouclecol)\n                    {\n                    \n                        for ($col = 1; $col &lt;$highestColumnIndex;++$col)\n                        {  \n\n                            $value=$objWorksheet-&gt;getCellByColumnAndRow($col, $row)-&gt;getFormattedValue();  \n                            if ($col &gt;= 2)\n                            {\n                                if ($value &gt; $first )\n                                {\n                                    if ($first &gt; $second)\n                                    {\n                                        if ($second &gt; $third)\n                                        {\n                                            $third = $second;\n                                            $colthird = $colsecond;\n                                        }\n                                        $second = $first;\n                                        $colsecond = $colfirst;\n                                    }\n                                    $first = $value;\n                                    $colfirst = $col;\n                                }\n                                else\n                                {\n                                    if ($value &gt; $second and $col &lt;&gt; $colfirst)\n                                    {\n                                        if ($second &gt; $third)\n                                        {\n                                            $third = $second;\n                                            $colthird = $colsecond;\n                                        }\n                                        $second = $value;\n                                        $colsecond = $col;\n                                    }\n                                    else\n                                    {\n                                        if ($value &gt; $third and $col &lt;&gt; $colfirst and $col &lt;&gt; $colsecond)\n                                        {\n                                            $third = $value;\n                                            $colthird = $col;\n                                        }\n                                    }\n                                }\n                                $tempo = $objWorksheet-&gt;getCellByColumnAndRow(2,$row)-&gt;getFormattedValue();\n                                if ($tempo &lt;&gt; null )\n                                {\n                                $tempodate = $objWorksheet-&gt;getCellByColumnAndRow(1,$row)-&gt;getFormattedValue();\n                                $tempodate = strtotime($tempodate);\n                                $arraydata[$row-1][3]=date(&quot;l&quot;,$tempodate); ;\n                                \n                                if ($colfirst &gt;=10)\n                                {\n                                $arraydata[$row-1][4]=&quot;{$colfirst} : 00 | {$first}&quot; ; \n                                }\n                                else\n                                {\n                                $arraydata[$row-1][4]=&quot;0{$colfirst} : 00 | {$first}&quot; ; \n                                }\n                                \n                                if ($colsecond &gt;=10)\n                                {\n                                $arraydata[$row-1][5]=&quot;{$colsecond} : 00 | {$second}&quot; ; \n                                }\n                                else\n                                {\n                                $arraydata[$row-1][5]=&quot;0{$colsecond} : 00 | {$second}&quot; ; \n                                }\n                                \n                                if ($colthird &gt;=10)\n                                {\n                                $arraydata[$row-1][6]=&quot;{$colthird} : 00 | {$third}&quot; ; \n                                }\n                                else\n                                {\n                                $arraydata[$row-1][6]=&quot;0{$colthird} : 00 | {$third}&quot; ; \n                                }\n                                \n                                }\n                            }\n                            else\n                            {\n                                $tempo =$objWorksheet-&gt;getCellByColumnAndRow(2,$row)-&gt;getFormattedValue();\n                                if ($tempo &lt;&gt; null )\n                                {\n                                $arraydata[$row-1][$col] = $value;\n                                }   \n                            }\n                \n\n                        }  \n                    }\n\n                }\n    //unlink($_FILES[&quot;file_upload&quot;][&quot;name&quot;]);\n    \n    //print_r($arraydata);\n} \nfunction Upload() \n{\n// Check for errors\n    if($_FILES['file_upload']['error'] &gt; 0)\n    {\n        die('An error ocurred when uploading.');\n    }\n\n    $ext = substr(strrchr($_FILES['file_upload']['name'], &quot;.&quot;), 1);\n    //Check filetype\n    if($ext != 'xls')\n    {\n        die('Unsupported filetype uploaded.');\n    }\n\n    // Check filesize\n    //if($_FILES['file_upload']['size'] &gt; 5000000)\n    //{\n    //  die('File uploaded exceeds maximum upload size.');\n    //}\n    \n    $path = getcwd();\n    \n    \n    $uploads_dir = $path;\n    $tmp_name = $_FILES[&quot;file_upload&quot;][&quot;tmp_name&quot;];\n    $name = $_FILES[&quot;file_upload&quot;][&quot;name&quot;];\n\n    if (!move_uploaded_file($tmp_name, $name)) \n    {\n        die('Error uploading file - check destination is writeable.');\n    }\n  \n}\n?&gt;\n\n&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n  &lt;title&gt;Import Facebook Data&lt;/title&gt;\n&lt;/head&gt;\n\n&lt;body&gt;\n\n\n&lt;table border=&quot;1&quot; width=&quot;75%&quot;&gt;\n    &lt;?php\n    $NbrCol     = 5;\n    $NbrLigne   = 8;\n    ?&gt;\n    &lt;thead&gt;\n        &lt;td width=&quot;10%&quot;&gt;Date&lt;/td&gt;\n        &lt;td&gt;Weekday&lt;/td&gt;\n        &lt;td&gt;1&lt;/td&gt;\n        &lt;td&gt;2&lt;/td&gt;\n        &lt;td&gt;3&lt;/td&gt;\n    &lt;/thead&gt;\n\n    &lt;tbody&gt;\n\n    &lt;?php if (count(@$arraydata) &gt; 0): ?&gt;\n        \n        &lt;?php foreach (@$arraydata as $row): array_map('htmlentities', $row); ?&gt;\n        &lt;tr&gt;\n        &lt;td&gt;&lt;?php echo implode('&lt;/td&gt;&lt;td&gt;', $row); ?&gt;&lt;/td&gt;\n        &lt;/tr&gt;\n        &lt;?php endforeach; ?&gt;\n    \n    \n        &lt;?php endif; ?&gt;\n    &lt;/tbody&gt;\n    \n    \n\n\n&lt;/table&gt;\n    &lt;table&gt;\n            &lt;form method='post' enctype='multipart/form-data' action='Excel Importer.php'&gt;\n            File: &lt;input type='file' name='file_upload'&gt;\n            &lt;input type='submit'&gt;\n            &lt;/form&gt;\n    \n    \n\n    &lt;table&gt;\n&lt;?php\n\n\n?&gt;\n\n&lt;/body&gt;\n\n&lt;/html&gt;</code></pre>\n\n",
    "PostedDate": "2015-02-09T19:09:17.823-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]