[
  {
    "Id": "107187",
    "ThreadId": "32312",
    "Html": "<div><p style=\"margin:0.0px 0.0px 0.0px 0.0px;font:12.0px Verdana\"><div>I have an XLSX document with 2 worksheets. A cell on the first sheet has a formula which references cells in both sheets, some of which themselves are formulas.</div><div><br></div><div>Calling this:</div><div>&lt;?php echo $excel-&gt;getActiveSheet()-&gt;getCell('I7')-&gt;getValue(); ?&gt;</div><div><br></div><div>Returns the following:</div><div>=ROUND(VLOOKUP($E10,'Sheet 2'!$C$3:$J$44,MATCH(I$5,'Sheet 2'!$C$3:$J$3,0),FALSE),0)</div><div><br></div><div>Calling this:</div><div>&lt;?php echo $excel-&gt;getActiveSheet()-&gt;getCell('I7')-&gt;getCalculatedValue(); ?&gt;</div><div><br></div><div>Always returns 0.</div><div><br></div><div>Is there something in that formula that is not compatible with PHPExcel or am I just doing it wrong?</div><div><br></div></p></div>",
    "PostedDate": "2008-07-25T16:12:20.39-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "107233",
    "ThreadId": "32312",
    "Html": "While over 200 of Excel's functions have now been implemented in PHPExcel (including MATCH, although this only exists in the latest CVS version of the code, rather than the 1.6.2 Release version), VLOOKUP hasn't yet been implemented. VLOOKUP and HLOOKUP are on the &quot;To do list&quot;, but not yet available.\r\n",
    "PostedDate": "2008-07-26T05:16:18.113-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "107369",
    "ThreadId": "32312",
    "Html": "<div>Mark,</div><div><br></div>Thanks for your quick response. I downloaded Friday's commit and started the VLOOKUP implementation. Thus far, it does not have much error checking and only works on exact matches for the lookup value. I will clean this up more in the next few days and post an update here. If there's a painless way to commit this into the repository, I'm happy to do so. Otherwise, I'll just pass the code to you and let you handle since I'm just working on this far enough to make it suit my purposes for my current project.<div><br></div><div>Here's what I have thus far:</div><div><br></div><div><div><span style=\"white-space:pre\">\t</span>/**</div><div><span style=\"white-space:pre\">\t</span> * VLOOKUP</div><div><span style=\"white-space:pre\">\t</span> * The VLOOKUP function searches for value in the left-most column of lookup_array and returns the value in the same row based on the index_number.</div><div><span style=\"white-space:pre\">\t</span> * @param<span style=\"white-space:pre\">\t</span>lookup_value<span style=\"white-space:pre\">\t</span>The value that you want to match in lookup_array</div><div><span style=\"white-space:pre\">\t</span> * @param<span style=\"white-space:pre\">\t</span>lookup_array<span style=\"white-space:pre\">\t</span>The range of cells being searched</div><div><span style=\"white-space:pre\">\t</span> * @param<span style=\"white-space:pre\">\t</span>index_number<span style=\"white-space:pre\">\t</span>The column number in table_array from which the matching value must be returned. The first column is 1.</div><div><span style=\"white-space:pre\">\t</span> * @param<span style=\"white-space:pre\">\t</span>not_exact_match<span style=\"white-space:pre\">\t</span>Determines if you are looking for an exact match based on lookup_value.</div><div><span style=\"white-space:pre\">\t</span> * @return<span style=\"white-space:pre\">\t</span>mixed<span style=\"white-space:pre\">\t\t\t</span>The value of the found cell</div><div><span style=\"white-space:pre\">\t</span> */</div><div><span style=\"white-space:pre\">\t</span>public static function VLOOKUP($lookup_value, $lookup_array, $index_number, $not_exact_match=true) {</div><div><span style=\"white-space:pre\">\t\t</span>// index_number must be greater than or equal to 1</div><div><span style=\"white-space:pre\">\t\t</span>if ($index_number &lt; 1) {</div><div><span style=\"white-space:pre\">\t\t\t</span>return self::$_errorCodes['value'];</div><div><span style=\"white-space:pre\">\t\t</span>}</div><div><span style=\"white-space:pre\">\t\t</span></div><div><span style=\"white-space:pre\">\t\t</span>// index_number must be less than or equal to the number of columns in lookup_array</div><div><span style=\"white-space:pre\">\t\t</span>if ($index_number &gt; count($lookup_array)) {</div><div><span style=\"white-space:pre\">\t\t\t</span>return self::$_errorCodes['reference'];</div><div><span style=\"white-space:pre\">\t\t</span>}</div><div><span style=\"white-space:pre\">\t\t</span></div><div><span style=\"white-space:pre\">\t\t</span>// re-index lookup_array with numeric keys starting at 1</div><div><span style=\"white-space:pre\">\t\t</span>array_unshift($lookup_array, array());</div><div><span style=\"white-space:pre\">\t\t</span>$lookup_array = array_slice(array_values($lookup_array), 1, count($lookup_array), true);</div><div><span style=\"white-space:pre\">\t\t</span></div><div><span style=\"white-space:pre\">\t\t</span>$row_number = array_search($lookup_value, $lookup_array[1]);</div><div><span style=\"white-space:pre\">\t\t</span>return $lookup_array[$index_number][$row_number];</div><div><span style=\"white-space:pre\">\t\t</span>/*</div><div><span style=\"white-space:pre\">\t\t</span>var_dump($lookup_value);</div><div><span style=\"white-space:pre\">\t\t</span>var_dump($lookup_array);</div><div><span style=\"white-space:pre\">\t\t</span>var_dump($index_number);</div><div><span style=\"white-space:pre\">\t\t</span>var_dump($not_exact_match);</div><div><span style=\"white-space:pre\">\t\t</span>exit();</div><div><span style=\"white-space:pre\">\t\t</span>*/</div><div><span style=\"white-space:pre\">\t</span>}</div><div><br></div><div>Sources: http://www.techonthenet.com/excel/formulas/vlookup.php</div></div>",
    "PostedDate": "2008-07-27T13:22:06.33-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "107826",
    "ThreadId": "32312",
    "Html": "Here is my final VLOOKUP function. As noted, it does not handle approximate matches since a) I'm not able to find a detailed specification of how to handle string comparisons in Excel and b) I don't need this functionality for myself currently.<div><br></div><div><div><span style=\"white-space:pre\">\t</span>/**</div><div><span style=\"white-space:pre\">\t</span> * VLOOKUP</div><div><span style=\"white-space:pre\">\t</span> * The VLOOKUP function searches for value in the left-most column of lookup_array and returns the value in the same row based on the index_number.</div><div><span style=\"white-space:pre\">\t</span> * @param<span style=\"white-space:pre\">\t</span>lookup_value<span style=\"white-space:pre\">\t</span>The value that you want to match in lookup_array</div><div><span style=\"white-space:pre\">\t</span> * @param<span style=\"white-space:pre\">\t</span>lookup_array<span style=\"white-space:pre\">\t</span>The range of cells being searched</div><div><span style=\"white-space:pre\">\t</span> * @param<span style=\"white-space:pre\">\t</span>index_number<span style=\"white-space:pre\">\t</span>The column number in table_array from which the matching value must be returned. The first column is 1.</div><div><span style=\"white-space:pre\">\t</span> * @param<span style=\"white-space:pre\">\t</span>not_exact_match<span style=\"white-space:pre\">\t</span>Determines if you are looking for an exact match based on lookup_value.</div><div><span style=\"white-space:pre\">\t</span> * @return<span style=\"white-space:pre\">\t</span>mixed<span style=\"white-space:pre\">\t\t\t</span>The value of the found cell</div><div><span style=\"white-space:pre\">\t</span> */</div><div><span style=\"white-space:pre\">\t</span>public static function VLOOKUP($lookup_value, $lookup_array, $index_number, $not_exact_match=true) {</div><div><span style=\"white-space:pre\">\t\t</span>// index_number must be greater than or equal to 1</div><div><span style=\"white-space:pre\">\t\t</span>if ($index_number &lt; 1) {</div><div><span style=\"white-space:pre\">\t\t\t</span>return self::$_errorCodes['value'];</div><div><span style=\"white-space:pre\">\t\t</span>}</div><div><span style=\"white-space:pre\">\t\t</span></div><div><span style=\"white-space:pre\">\t\t</span>// index_number must be less than or equal to the number of columns in lookup_array</div><div><span style=\"white-space:pre\">\t\t</span>if ($index_number &gt; count($lookup_array)) {</div><div><span style=\"white-space:pre\">\t\t\t</span>return self::$_errorCodes['reference'];</div><div><span style=\"white-space:pre\">\t\t</span>}</div><div><span style=\"white-space:pre\">\t\t</span></div><div><span style=\"white-space:pre\">\t\t</span>// re-index lookup_array with numeric keys starting at 1</div><div><span style=\"white-space:pre\">\t\t</span>array_unshift($lookup_array, array());</div><div><span style=\"white-space:pre\">\t\t</span>$lookup_array = array_slice(array_values($lookup_array), 1, count($lookup_array), true);</div><div><span style=\"white-space:pre\">\t\t</span></div><div><span style=\"white-space:pre\">\t\t</span>// look for an exact match</div><div><span style=\"white-space:pre\">\t\t</span>$row_number = array_search($lookup_value, $lookup_array[1]);</div><div><span style=\"white-space:pre\">\t\t</span></div><div><span style=\"white-space:pre\">\t\t</span>// if an exact match is required, we have what we need to return an appropriate response</div><div><span style=\"white-space:pre\">\t\t</span>if ($not_exact_match == false) {</div><div><span style=\"white-space:pre\">\t\t\t</span>if ($row_number === false) {</div><div><span style=\"white-space:pre\">\t\t\t\t</span>return self::$_errorCodes['na'];</div><div><span style=\"white-space:pre\">\t\t\t</span>} else {</div><div><span style=\"white-space:pre\">\t\t\t\t</span>return $lookup_array[$index_number][$row_number];</div><div><span style=\"white-space:pre\">\t\t\t</span>}</div><div><span style=\"white-space:pre\">\t\t</span>}</div><div><span style=\"white-space:pre\">\t\t</span></div><div><span style=\"white-space:pre\">\t\t</span>// TODO: The VLOOKUP spec in Excel states that, at this point, we should search for</div><div><span style=\"white-space:pre\">\t\t</span>// the highest value that is less than lookup_value. However, documentation on how string</div><div><span style=\"white-space:pre\">\t\t</span>// values should be treated here is sparse.</div><div><span style=\"white-space:pre\">\t\t</span>return self::$_errorCodes['na'];</div><div><span style=\"white-space:pre\">\t</span>}</div><div><br></div><div><br></div></div>",
    "PostedDate": "2008-07-29T15:10:29.853-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "110311",
    "ThreadId": "32312",
    "Html": "Function has been added as-is (<a href=\"http://www.codeplex.com/PHPExcel/WorkItem/View.aspx?WorkItemId=7270\">http://www.codeplex.com/PHPExcel/WorkItem/View.aspx?WorkItemId=7270</a>)\r\n",
    "PostedDate": "2008-08-11T06:16:40.473-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]