[
  {
    "Id": "1347013",
    "ThreadId": "578882",
    "Html": "We have code to import excel to mysql database, there are 10 sheets inside. It works to view on browser all sheet, but only one sheet insert into database. Could you help us, thanks.<br />\n<pre><code>$path = $_FILES['file']['name'];\n    \n    // Load PHPExcel\n    $objPHPExcel = PHPExcel_IOFactory::load($path);\n\n    foreach ($objPHPExcel-&gt;getWorksheetIterator() as $worksheet) {\n        $worksheetTitle = $worksheet-&gt;getTitle();\n        $highestRow = $worksheet-&gt;getHighestRow();\n        $number=$objPHPExcel-&gt;getIndex($worksheet);\n        $highestColumn = $worksheet-&gt;getHighestColumn();\n        $highestColumnIndex = PHPExcel_Cell::columnIndexFromString($highestColumn);\n        $nrColumns = ord($highestColumn) - 64;\n\necho &quot;&lt;br&gt;The worksheet &quot;.$worksheetTitle.&quot; has &quot;;\n    echo $nrColumns . ' columns (A-' . $highestColumn . ') ';\n    echo ' and ' . $highestRow . ' row.';\n    echo '&lt;br&gt;Data: &lt;table border=&quot;1&quot;&gt;&lt;tr&gt;';\n    for ($row = 1; $row &lt;= $highestRow; ++ $row) {\n        echo '&lt;tr&gt;';\n        for ($col = 0; $col &lt; $highestColumnIndex; ++ $col) {\n            $cell = $worksheet-&gt;getCellByColumnAndRow($col, $row);\n            $val = $cell-&gt;getValue();\n            $dataType = PHPExcel_Cell_DataType::dataTypeForValue($val);\n            echo '&lt;td&gt;' . $val . '&lt;br&gt;&lt;/td&gt;';\n        }\n        echo '&lt;/tr&gt;';\n    }\n    echo '&lt;/table&gt;';\n    }\n\nfor ($row = 2; $row &lt;= $highestRow; ++$row) {\n        $val = array();\n        for ($col = 0; $col &lt; $highestColumnIndex; ++$col) {\n            $cell = $worksheet-&gt;getCellByColumnAndRow($col, $row);\n            $val[] = $cell-&gt;getValue();\n        }\nif ($numMatch &gt; 0) {} else{\n            // Buat query insert per-baris data ke tabel user\n            $sql = &quot;INSERT IGNORE INTO mvr (number,project_id,raised_by, approved_by) VALUES ('&quot; .$val[1].&quot;&quot;.$val[2]. &quot;','&quot;.$project_id.&quot;','&quot;.$raised_by.&quot;','&quot;.$approved_by.&quot;')&quot;;\n            mysql_query($sql);\n        \n        }</code></pre>\n\n",
    "PostedDate": "2015-01-29T00:12:00.313-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]