[
  {
    "Id": "710071",
    "ThreadId": "282442",
    "Html": "\r\n<p>Hi,</p>\r\n<p>I'm having troubles to set conditional formating of cells with 2 formulas. No matter if I set the formating in template or try to do it via code, the first formula get broken.</p>\r\n<p>Im using 1.7.6 and here is the code to set the Conditional Format:</p>\r\n<p></p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre>$objConditional1 = <span style=\"color:blue\">new</span> PHPExcel_Style_Conditional();\r\n$objConditional1-&gt;setConditionType(PHPExcel_Style_Conditional::CONDITION_EXPRESSION);\r\n$objConditional1-&gt;addCondition(<span style=\"color:#a31515\">'(F21-G21)/F21&gt;=0.05'</span>);\r\n$objConditional1-&gt;addCondition(TRUE);\r\n$objConditional1-&gt;getStyle()-&gt;getFont()-&gt;getColor()-&gt;setARGB(PHPExcel_Style_Color::COLOR_RED);\r\n$objConditional1-&gt;getStyle()-&gt;getFont()-&gt;setBold(true);\r\n$objConditional2 = <span style=\"color:blue\">new</span> PHPExcel_Style_Conditional();\r\n$objConditional2-&gt;setConditionType(PHPExcel_Style_Conditional::CONDITION_EXPRESSION);\r\n$objConditional2-&gt;addCondition(<span style=\"color:#a31515\">'(F21-G21)/F21&lt;=-0.05'</span>);\r\n$objConditional2-&gt;addCondition(TRUE);\r\n$objConditional2-&gt;getStyle()-&gt;getFont()-&gt;getColor()-&gt;setARGB(PHPExcel_Style_Color::COLOR_GREEN);\r\n$objConditional2-&gt;getStyle()-&gt;getFont()-&gt;setBold(true);\r\n$conditionalStyles = $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#a31515\">'G21'</span>)-&gt;getConditionalStyles();\r\narray_push($conditionalStyles, $objConditional1);\r\narray_push($conditionalStyles, $objConditional2);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#a31515\">'G21'</span>)-&gt;setConditionalStyles($conditionalStyles);<br><br>Result is that first formula look like (#REF!1-G21)/#REF!1&gt;=0.05<br><br>File is being written by<div style=\"color:black; background-color:white\"><pre>$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, <span style=\"color:#a31515\">'Excel2007'</span>); <br></pre>\r\n</div>\r\n<br>Is this a bug or am I doing something wrong?<br><br>Thank you for your help in advance,<br>Miso</pre>\r\n</div>\r\n<p></p>\r\n",
    "PostedDate": "2011-12-09T12:53:13.64-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]