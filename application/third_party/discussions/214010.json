[
  {
    "Id": "447984",
    "ThreadId": "214010",
    "Html": "<p>Hi,</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; I am new to to phpexcel, i couldn't understand how to read a sheet and write datas to one sheet at a time. When ever i try to do this&nbsp; i am getting either Undefined offset eror or call method setTitle to a non member functio.</p>\r\n<p>I have also posted some discussions before for which i haven't got reply.&nbsp; Please help as i am new to this library and technology, i couldn't cope up.</p>\r\n<p>I have 84 sheets with sheets name starting from sheet1 to sheet84.&nbsp; But when i try to rename the sheets with various names like</p>\r\n<p>&lt;?</p>\r\n<p>require_once('../../../include/conf.inc.php');<br>&nbsp;&nbsp; &nbsp;$objPHPExcel-&gt;removeSheetByIndex(0);<br>&nbsp;&nbsp; &nbsp;$objPHPExcel = PHPExcel_IOFactory::load(&quot;../excel_templates/q4full.xls&quot;);<br>&nbsp;&nbsp; &nbsp;foreach($countryArray as $ck =&gt;$cv) {<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; $objPHPExcel-&gt;getActiveSheet()-&gt;setActiveSheetIndex($ck);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; $objPHPExcel-&gt;getActiveSheet()-&gt;setTitle($cv);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;<br>&nbsp;&nbsp; &nbsp;}</p>\r\n<p>?&gt;</p>\r\n<p>sometumes the last sheet i.e., sheet82 changes.</p>\r\n<p>&nbsp;</p>\r\n<p>Please help me and try to come out of this problem</p>\r\n<p>Thanks</p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2010-05-26T23:27:02.9-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "448036",
    "ThreadId": "214010",
    "Html": "<div style=\"color:black;background-color:white\">\r\n<pre>$countryArray = <span style=\"color:blue\">array</span>(<span style=\"color:#a31515\">'UK'</span>,<span style=\"color:#a31515\">'USA'</span>,<span style=\"color:#a31515\">'GERMANY'</span>,<span style=\"color:#a31515\">'FRANCE'</span>,<span style=\"color:#a31515\">'BELGIUM'</span>,<span style=\"color:#a31515\">'SWEDEN'</span>,<span style=\"color:#a31515\">'JAPAN'</span>,<span style=\"color:#a31515\">'CHILE'</span>,<span style=\"color:#a31515\">'BOTSWANA'</span>,<span style=\"color:#a31515\">'SRI LANKA'</span>);\r\n</pre>\r\n<pre>$objPHPExcel = <span style=\"color:blue\">new</span> PHPExcel();\r\n$objPHPExcel-&gt;removeSheetByIndex(0);</pre>\r\n<pre>\r\n<span style=\"color:blue\">foreach</span>($countryArray <span style=\"color:blue\">as</span> $ck =&gt;$cv) {\r\n    $sheet = $objPHPExcel-&gt;createSheet($ck);\r\n    $sheet-&gt;setTitle($cv);\r\n    $sheet-&gt;setCellValue(<span style=\"color:#a31515\">'A1'</span>, $cv.<span style=\"color:#a31515\">' '</span>.$ck);\r\n}\r\n</pre>\r\n<pre>$objPHPExcel-&gt;setActiveSheetIndex(0);\r\n</pre>\r\n<pre>$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, <span style=\"color:#a31515\">'Excel5'</span>);\r\n$objWriter-&gt;save(<span style=\"color:#a31515\">'CountrySheets.xls'</span>);\r\n</pre>\r\n</div>",
    "PostedDate": "2010-05-27T01:08:15.383-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "448083",
    "ThreadId": "214010",
    "Html": "<p>Thanks Mark,</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; But i just want to have it from a template say 10 sheets for 10 countries and i don't know how to migrate from one sheet to another sheet t write data in each sheet.&nbsp;</p>\r\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; That is my problem. I know this is bit silly but i am trying for&nbsp; more than 2 days</p>\r\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Please try to provide the solution</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2010-05-27T03:04:22.37-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "448417",
    "ThreadId": "214010",
    "Html": "<div style=\"color:black;background-color:white\">\r\n<pre>$objPHPExcel-&gt;setActiveSheetIndex($index); \r\n</pre>\r\n</div>\r\n<p>where $index is the sheet index</p>\r\n<p>or</p>\r\n<div style=\"color:black;background-color:white\">\r\n<pre>$objPHPExcel-&gt;setActiveSheetIndexByName($title);\r\n</pre>\r\n</div>\r\n<p>where $title is the sheet name</p>",
    "PostedDate": "2010-05-27T15:05:57.06-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "448529",
    "ThreadId": "214010",
    "Html": "<p>&nbsp; Thanks Mark,</p>\r\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; With your suggestion to me and by seeing your previous posts to other developers i tried to manage some what and&nbsp; could now&nbsp; work with templates. But the problem now my template sheet consists of six sheets</p>\r\n<p>from which i am trying to generate 86 sheets .&nbsp; The first sheet wwill be cloned 82 times and the rest were copied once . But i could make this&nbsp; only for 85 sheets after which i a getting this message</p>\r\n<pre><code>&lt;b&gt;Fatal error&lt;/b&gt;:  Allowed memory size of 1073741824 bytes exhausted (tried to allocate 3 bytes) in</code><code> &lt;b&gt;D:\\projects\\VRM\\pfizerCRS\\pfizer_crash_report\\PHPExcel\\Classes\\PHPExcel\\Worksheet.php&lt;/b&gt; <br>on line</code><code> &lt;b&gt;2485&lt;/b&gt;&lt;br /&gt;<br><br>but my ini_set level is 1024M<br><br>For your convenience i have given some code part<br><br>Can u help me<br><br></code>&lt;?php<br><br>&nbsp;&nbsp; /****<br>&nbsp;&nbsp;&nbsp; * File : dummy.php<br>&nbsp;&nbsp;&nbsp; * created for cloning the xls worksheets dynamically and to fetch records<br>&nbsp;&nbsp;&nbsp; * */&nbsp;&nbsp; &nbsp;<br>&nbsp; &nbsp;<br>&nbsp; &nbsp;&nbsp; // include the configuartion file <br>&nbsp;&nbsp; &nbsp;require_once('../../../include/conf.inc.php');<br>&nbsp; &nbsp;<br>&nbsp;&nbsp; //Declaration of variables <br>&nbsp;&nbsp; &nbsp;$i = 0;<br>&nbsp;&nbsp; &nbsp;<br>&nbsp;&nbsp; &nbsp;$countrySheet = &quot;&quot;;<br>&nbsp;&nbsp; &nbsp;$tcoSheet = &quot;&quot;;<br>&nbsp;&nbsp; &nbsp;$tcoAnnual = &quot;&quot;;<br>&nbsp;&nbsp; &nbsp;$CO2Sheet = &quot;&quot;;<br>&nbsp;&nbsp; &nbsp;$safetySheet = &quot;&quot;;<br>&nbsp;&nbsp; &nbsp;$imburseSheet = &quot;&quot;;<br>&nbsp;&nbsp; &nbsp;<br>&nbsp;&nbsp; &nbsp;$sheet = &quot;&quot;;<br>&nbsp;&nbsp; &nbsp;$sheetTCOQuarter = &quot;&quot;;<br>&nbsp;&nbsp; &nbsp;$sheetTCOAnnual = &quot;&quot;;<br>&nbsp;&nbsp; &nbsp;$sheetSafety = &quot;&quot;;<br>&nbsp;&nbsp; &nbsp;$sheetCO2 = &quot;&quot;;<br>&nbsp;&nbsp; &nbsp;$sheetImburse = &quot;&quot;;<br>&nbsp;&nbsp; &nbsp;<br>&nbsp;&nbsp; &nbsp;<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$objPHPExcel = PHPExcel_IOFactory::load(&quot;../excel_templates/report.xls&quot;);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;//Get the copy of all the sheets in the template.<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$countrySheet = $objPHPExcel-&gt;getSheetByName('Sheet1')-&gt;copy();<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$tcoSheet = $objPHPExcel-&gt;getSheetByName('Sheet2')-&gt;copy();<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$tcoAnnual = $objPHPExcel-&gt;getSheetByName('Sheet3')-&gt;copy();<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$CO2Sheet = $objPHPExcel-&gt;getSheetByName('Sheet4')-&gt;copy();<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$safetySheet = $objPHPExcel-&gt;getSheetByName('Sheet5')-&gt;copy();<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$imburseSheet = $objPHPExcel-&gt;getSheetByName('Sheet6')-&gt;copy();<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;//disconnect all existing sheets<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$objPHPExcel-&gt;disconnectWorkSheets();<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;<br>&nbsp;&nbsp; &nbsp;<br><br>&nbsp;&nbsp; &nbsp;// looping with different quarters and countries <br>&nbsp;&nbsp; &nbsp;foreach($countryArray as $ck =&gt;$cv) {<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;//Sheets are cloned here and 82 tabs are created and one for each country<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; $sheet = &quot;&quot;;<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; $sheet = clone $countrySheet;<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$sheet-&gt;setTitle($cv);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$objPHPExcel-&gt;addSheet($sheet);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$objPHPExcel-&gt;setActiveSheetIndex($ck);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br>&nbsp;&nbsp; &nbsp;}&nbsp;&nbsp; &nbsp;//unset the copied sheet which has been created for countries<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;unset($countrySheet);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;unset($sheet);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;// Here the sheet is cloned for Tco quarterly report<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$sheetTCOQuarter = clone $tcoSheet;<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$sheetTCOQuarter-&gt;setTitle(&quot;TCO Report quarterly&quot;);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$objPHPExcel-&gt;addSheet($sheetTCOQuarter);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$objPHPExcel-&gt;setActiveSheetIndex(82);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;unset($tcoSheet);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;unset($sheetTCOQuarter);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;//Here the sheet is cloned for Tco Annual report<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$sheetTCOAnnual = clone $tcoAnnual;<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$sheetTCOAnnual-&gt;setTitle(&quot;TCO Annual Report&quot;);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$objPHPExcel-&gt;addSheet($sheetTCOAnnual);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$objPHPExcel-&gt;setActiveSheetIndex(83);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;unset($tcoAnnual);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;unset($sheetTCOAnnual);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;//Here the sheet is cloned for CO2 report<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$sheetCO2 = clone $CO2Sheet;<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$sheetCO2-&gt;setTitle(&quot;CO2 Report&quot;);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$objPHPExcel-&gt;addSheet($sheetCO2);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$objPHPExcel-&gt;setActiveSheetIndex(84);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;unset($CO2Sheet);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;unset($sheetCO2);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;//Here the sheet is cloned for Safety report<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$sheetSafety = clone $safetySheet;<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$sheetSafety-&gt;setTitle(&quot;Safety Report&quot;);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$objPHPExcel-&gt;addSheet($sheetSafety);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$objPHPExcel-&gt;setActiveSheetIndex(85);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;unset($safetySheet);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;unset($sheetSafety);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;//Here the sheet is cloned for Reimbursement report<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; $sheetImburse = clone $imburseSheet;<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$sheetImburse-&gt;setTitle(&quot;Re-Imbursement Report&quot;);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$objPHPExcel-&gt;addSheet($sheetImburse);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$objPHPExcel-&gt;setActiveSheetIndex(86);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;unset($imburseSheet);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;unset($sheetImburse);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;<br>&nbsp;&nbsp; &nbsp;<br>?&gt;<br></pre>",
    "PostedDate": "2010-05-28T00:03:07.213-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]