[
  {
    "Id": "1058041",
    "ThreadId": "447371",
    "Html": "Hi,\r<br />\nI am using phpexcel to generate xls sheet.I tried the examples of the downloaded excel library and all seemed to be working fine.How ever when I integrated the library in my project where we use zend frame-work,I faced one issue.Though the xls file is generating but it contains lots of special character.My projects debug is off.This is my code :\r<br />\n<br />\nrequire_once 'PHPExcel-Develop/Classes/PHPExcel.php';<br />\n<pre><code>    // Create new PHPExcel object\n    $objPHPExcel = new PHPExcel();\n    $blockNames=array(&quot;test&quot;,&quot;google&quot;);\n    $blocksList = implode (&quot;, &quot;, $blockNames);\n\n    // Set document properties\n    $objPHPExcel-&gt;getProperties()-&gt;setCreator(&quot;Maarten Balliauw&quot;)\n    -&gt;setLastModifiedBy(&quot;Maarten Balliauw&quot;)\n    -&gt;setTitle(&quot;Office 2007 XLSX Test Document&quot;)\n    -&gt;setSubject(&quot;Office 2007 XLSX Test Document&quot;)\n    -&gt;setDescription(&quot;Test document for Office 2007 XLSX, generated using PHP classes.&quot;)\n    -&gt;setKeywords(&quot;office 2007 openxml php&quot;)\n    -&gt;setCategory(&quot;Test result file&quot;);\n\n\n    // Add some data\n    $objPHPExcel-&gt;setActiveSheetIndex(0)\n    -&gt;setCellValue('A1', 'Hello')\n    -&gt;setCellValue('B1', 'world!')\n    -&gt;setCellValue('C1', 'Hello')\n    -&gt;setCellValue('D1', 'world!');\n\n\n\n    // Rename worksheet\n    $objPHPExcel-&gt;getActiveSheet()-&gt;setTitle('Simple');\n\n\n    // Set active sheet index to the first sheet, so Excel opens this as the first sheet\n    $objPHPExcel-&gt;setActiveSheetIndex(0);\n\n    $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(&quot;A2&quot;, &quot;item1&quot;);\n    $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(&quot;A3&quot;, &quot;item2&quot;);\n    $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(&quot;A4&quot;, &quot;item3&quot;);\n    $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(&quot;B2&quot;, &quot;Select Country&quot;);\n\n    $objValidation = $objPHPExcel-&gt;getActiveSheet()-&gt;getCell(&quot;B2&quot;)-&gt;getDataValidation();\n    $objValidation-&gt;setType( PHPExcel_Cell_DataValidation::TYPE_LIST );\n    $objValidation-&gt;setErrorStyle( PHPExcel_Cell_DataValidation::STYLE_INFORMATION );\n    $objValidation-&gt;setAllowBlank(false);\n    $objValidation-&gt;setShowInputMessage(true);\n    $objValidation-&gt;setShowErrorMessage(true);\n    $objValidation-&gt;setShowDropDown(true);\n    $objValidation-&gt;setErrorTitle('Input error');\n    $objValidation-&gt;setError('Value is not in list.');\n    $objValidation-&gt;setPromptTitle('Pick from list');\n    $objValidation-&gt;setPrompt('Please pick a value from the drop-down list.');\n\n    $objValidation-&gt;setFormula1('&quot;test,test2,test3,test,4th,&quot;');\n\n    // Redirect output to a client’s web browser (Excel5)\n    header('Content-Type: application/vnd.ms-excel');\n    header('Content-Disposition: attachment;filename=&quot;01simple.xls&quot;');\n    header('Cache-Control: max-age=0');\n    // If you're serving to IE 9, then the following may be needed\n    header('Cache-Control: max-age=1');\n\n    // If you're serving to IE over SSL, then the following may be needed\n    header ('Expires: Mon, 26 Jul 1997 05:00:00 GMT'); // Date in the past\n    header ('Last-Modified: '.gmdate('D, d M Y H:i:s').' GMT'); // always modified\n    header ('Cache-Control: cache, must-revalidate'); // HTTP/1.1\n    header ('Pragma: public'); // HTTP/1.0\n\n    $objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, 'Excel5');\n    $objWriter-&gt;save('php://output');\n    exit;\n</code></pre>\n\nI am not able to attaching screen shot of the xls file .Pasted the contents of it..<br />\n<pre><code>��\u0011ࡱ\u001a�\n\u000b\f\n\u000e\u000f\u0010\u0011\u0012\u0013\u0014\u0015\u0016����\u0018\u0019\u001a��������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������\u0006\u0001\u0002\u0001ş��Oh\u0010��\b+'��0�\u0007\u0001@\u0002H\u0004h\b�\f�\n�\u0013�\u0002�\u0004\u001e\u0018Untitled\n�\u0007�\u0001\u0006\u0004B\u0002�\u0004=\u0012�%r\u00158\u0001X\u0002&quot;\u00021\u001e�\b�\u0001\u0007\u0001Calibri�\u0014�\n\u0001Block\n\u0001House\n&quot;   \b\u0010\u0006\u0010ﾻ&quot;\n&quot;�\u0007�\u0001\u0006\u0004*\u0002+\u0002�\u0002\u0001�\b�\u0002�\u0004\u0014\u0003\u0001\u0015\u0003\u0001�\u0002�\u0002&amp;\bffffff�?'\bffffff�?(\b�?)\b�?�&quot;&quot;\u0001d\u0001\u0001\u0001\u0002X\u0002X\u0002333333�?333333�?\u0001U\u0002\b}\f$  \u000f}\f\u0001\u0001$  \u000f}\f\u0002\u0002$  \u000f\u0002\u000e\u0002\u0001\u0004�&quot;\n\u000f�\n\u0001\u000f\u0001�\n\u0002\u000f\u0002&gt;\u0002\u0012ﾶ\u0006@\u001d\u000f\u0003\u0001g\b\u0017g\b\u0002\u0001?????\n��\u0006\u0001\u0002\u0001\u0002��՜.\u001b\u0010��\b+,�0�\b\u0001H\u0017P\u000bX\u0010`\u0013h\u0016p\nx\f�\u0002�\u0004\u0003\f\u000b\u000b\u000b\u000b\u001e\u0010\u0001\nWorksheet\f\u0010\u0002\u001e\u0013Feuilles</code></pre>\n\nThanks in Advance.<br />\n",
    "PostedDate": "2013-06-18T00:17:13.983-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1058167",
    "ThreadId": "447371",
    "Html": "It looks as though ZF is sending the file to the browser but with ZF sending its headers rather than yours.... you need to prevent ZF from sending its headers<br />\n",
    "PostedDate": "2013-06-18T05:47:07.68-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]