[
  {
    "Id": "116505",
    "ThreadId": "35056",
    "Html": "Hi :<br>\r\n<br>\r\nIn this thread&nbsp;<a href=\"http://www.codeplex.com/PHPExcel/Thread/View.aspx?ThreadId=28001\">http://www.codeplex.com/PHPExcel/Thread/View.aspx?ThreadId=28001</a>&nbsp;i read about formating&nbsp; numbers.<br>\r\n<br>\r\n<span style=\"font-family:courier new\">This is code that thread give:<br>\r\n$this-&gt;_objPHPExcel-&gt;getActiveSheet()-&gt;getStyle($cellID)-&gt;getNumberFormat()-&gt;setFormatCode(&quot;[Green]#,##0;[Red](-#,##0)&quot;);<br>\r\n<br>\r\nI try this:<br>\r\n<br>\r\n<span style=\"font-family:Courier New\">$this-&gt;_objPHPExcel-&gt;getActiveSheet()-&gt;getStyle($cellID)-&gt;getNumberFormat()-&gt;setFormatCode(&quot;[Green]#.##0;[Red](-#.##0)&quot;);</span><br>\r\n<br>\r\nand :<br>\r\n<br>\r\n<span style=\"font-size:13px;color:#660000\"><span style=\"font-size:13px;color:#660000\">\r\n<p>$objPHPExcel</p>\r\n</span>\r\n<p>&nbsp;</p>\r\n</span>\r\n<p><span style=\"font-size:13px\">-&gt;getActiveSheet()-&gt;getStyle($cellID</span><span style=\"font-size:13px\">)-&gt;getNumberFormat()-&gt;setFormatCode(</span><span style=\"font-size:13px;color:#008200\"><span style=\"font-size:13px;color:#008200\"><span style=\"font-size:13px;color:#008200\"><span style=\"font-size:13px;color:#008200\">'#.##0,00;[Red](#.##0,00)'</span></span></span></span><span style=\"font-size:13px\">);<br>\r\n<br>\r\nThe numbers are formated lik this:<br>\r\n2203,20 and negative -50,40 but are formated as text, and align left, and not as number.<br>\r\n<br>\r\nWhere is brong?<br>\r\n<br>\r\nCan you give my some help<br>\r\n<br>\r\nTanks in advance\r\n<p>&nbsp;</p>\r\n</span></p>\r\n</span>\r\n",
    "PostedDate": "2008-09-06T07:05:25.163-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "116507",
    "ThreadId": "35056",
    "Html": "What component are you using? Excel5 writer or Excel2007 writer? Which version of PHPExcel? Also, can you please post a more complete script where we can see how you are setting the cell values?<br>\r\n",
    "PostedDate": "2008-09-06T07:11:28.173-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "116519",
    "ThreadId": "35056",
    "Html": "<b><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#660000\"><span style=\"font-size:13px;color:#660000\">\r\n<p>$nRow</p>\r\n</span>\r\n<p>&nbsp;</p>\r\n</span>\r\n<p><span style=\"font-size:13px\"> = </span><b><span style=\"font-size:13px;color:#ff0000\"><span style=\"font-size:13px;color:#ff0000\">4</b></span></span></b><span style=\"font-size:13px\">;<br>\r\n</span><br>\r\nwhile</b></p>\r\n</span>\r\n<p>&nbsp;</p>\r\n</span>\r\n<p></b><span style=\"font-size:13px\"> ( !</span><span style=\"font-size:13px;color:#660000\"><span style=\"font-size:13px;color:#660000\">$rs</span></span><span style=\"font-size:13px\">-&gt;EOF )<br>\r\n{\r\n<p>&nbsp;</p>\r\n<p align=left>&nbsp;</p>\r\n</span></p>\r\n<span style=\"font-size:13px\">\r\n<p align=left>&nbsp;</p>\r\n</span>\r\n<p align=left><span style=\"font-size:13px;color:#660000\"><span style=\"font-size:13px;color:#660000\">$objPHPExcel</span></span><span style=\"font-size:13px\">-&gt;getActiveSheet()-&gt;setCellValue(</span><span style=\"font-size:13px;color:#008200\"><span style=\"font-size:13px;color:#008200\">'A'</span></span><span style=\"font-size:13px\"> . </span><span style=\"font-size:13px;color:#660000\"><span style=\"font-size:13px;color:#660000\">$nRow</span></span><span style=\"font-size:13px\">, FormatNumProduto( </span><span style=\"font-size:13px;color:#660000\"><span style=\"font-size:13px;color:#660000\">$rs</span></span><span style=\"font-size:13px\">-&gt;fields[</span><span style=\"font-size:13px;color:#008200\"><span style=\"font-size:13px;color:#008200\">'idproduto'</span></span><span style=\"font-size:13px\">] ) );\r\n<p>&nbsp;</p>\r\n<p align=left>&nbsp;</p>\r\n</span></p>\r\n<p align=left><span style=\"font-size:13px;color:#660000\"><span style=\"font-size:13px;color:#660000\">$objPHPExcel</span></span><span style=\"font-size:13px\">-&gt;getActiveSheet()-&gt;setCellValue(</span><span style=\"font-size:13px;color:#008200\"><span style=\"font-size:13px;color:#008200\">'B'</span></span><span style=\"font-size:13px\"> . </span><span style=\"font-size:13px;color:#660000\"><span style=\"font-size:13px;color:#660000\">$nRow</span></span><span style=\"font-size:13px\">, utf8_encode(</span><span style=\"font-size:13px;color:#660000\"><span style=\"font-size:13px;color:#660000\">$rs</span></span><span style=\"font-size:13px\">-&gt;fields[</span><span style=\"font-size:13px;color:#008200\"><span style=\"font-size:13px;color:#008200\">'modelo'</span></span><span style=\"font-size:13px\">] ));\r\n<p>&nbsp;</p>\r\n<p align=left>&nbsp;</p>\r\n<p align=left>&nbsp;</p>\r\n</span></p>\r\n<p align=left><span style=\"font-size:13px;color:#660000\"><span style=\"font-size:13px;color:#660000\">$objPHPExcel</span></span><span style=\"font-size:13px\">-&gt;getActiveSheet()-&gt;getStyle(</span><span style=\"font-size:13px;color:#008200\"><span style=\"font-size:13px;color:#008200\">'C'</span></span><span style=\"font-size:13px\"> . </span><span style=\"font-size:13px;color:#660000\"><span style=\"font-size:13px;color:#660000\">$nRow</span></span><span style=\"font-size:13px\">)-&gt;getNumberFormat()-&gt;setFormatCode(</span><span style=\"font-size:13px;color:#008200\"><span style=\"font-size:13px;color:#008200\">&quot;##0;(-##0)&quot;</span></span><span style=\"font-size:13px\">);<br>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<b><span style=\"font-size:13px;color:#808080\"><span style=\"font-size:13px;color:#808080\"><span style=\"font-size:13px\">\r\n<p>&nbsp;</p>\r\n</span>\r\n<p><span style=\"font-size:13px;color:#660000\"><span style=\"font-size:13px;color:#660000\">$objPHPExcel</span></span><span style=\"font-size:13px\">-&gt;getActiveSheet()-&gt;getStyle(</span><span style=\"font-size:13px;color:#008200\"><span style=\"font-size:13px;color:#008200\">'E'</span></span><span style=\"font-size:13px\"> . </span><span style=\"font-size:13px;color:#660000\"><span style=\"font-size:13px;color:#660000\">$nRow</span></span><span style=\"font-size:13px\"><span style=\"font-size:13px\">)-&gt;getNumberFormat()-&gt;setFormatCode(</span></span><span style=\"font-size:13px;color:#008200\"><span style=\"font-size:13px;color:#008200\">'#########0,00;(-#########0,00)'</span></span><span style=\"font-size:13px\">);</span><br>\r\n</b></p>\r\n</span>\r\n<p>&nbsp;</p>\r\n</span>\r\n<p></b><span style=\"font-size:13px;color:#660000\"><span style=\"font-size:13px;color:#660000\">$objPHPExcel</span></span><span style=\"font-size:13px\">-&gt;getActiveSheet()-&gt;getStyle(</span><span style=\"font-size:13px;color:#008200\"><span style=\"font-size:13px;color:#008200\">'F'</span></span><span style=\"font-size:13px\"> . </span><span style=\"font-size:13px;color:#660000\"><span style=\"font-size:13px;color:#660000\">$nRow</span></span><span style=\"font-size:13px\">)-&gt;getNumberFormat()-&gt;setFormatCode(</span><span style=\"font-size:13px;color:#008200\"><span style=\"font-size:13px;color:#008200\">'#.##0,00;[Red](#.##0,00)'</span></span><span style=\"font-size:13px\">);\r\n<p>&nbsp;</p>\r\n<p align=left>&nbsp;</p>\r\n</span></p>\r\n<p align=left><span style=\"font-size:13px;color:#660000\"><span style=\"font-size:13px;color:#660000\">$objPHPExcel</span></span><span style=\"font-size:13px\">-&gt;getActiveSheet()-&gt;setCellValue(</span><span style=\"font-size:13px;color:#008200\"><span style=\"font-size:13px;color:#008200\">'C'</span></span><span style=\"font-size:13px\"> . </span><span style=\"font-size:13px;color:#660000\"><span style=\"font-size:13px;color:#660000\">$nRow</span></span><span style=\"font-size:13px\">, </span><span style=\"font-size:13px;color:#660000\"><span style=\"font-size:13px;color:#660000\">$rs</span></span><span style=\"font-size:13px\">-&gt;fields[</span><span style=\"font-size:13px;color:#008200\"><span style=\"font-size:13px;color:#008200\">'qtd'</span></span><span style=\"font-size:13px\">]);\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<span style=\"font-size:13px\">\r\n<p align=left>&nbsp;</p>\r\n<p align=left>&nbsp;</p>\r\n</span>\r\n<p align=left><b><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">if</b></span></span></b><span style=\"font-size:13px\"> ( </span><span style=\"font-size:13px;color:#660000\"><span style=\"font-size:13px;color:#660000\">$rs</span></span><span style=\"font-size:13px\">-&gt;fields[</span><span style=\"font-size:13px;color:#008200\"><span style=\"font-size:13px;color:#008200\">'idmoeda'</span></span><span style=\"font-size:13px\">] == </span><b><span style=\"font-size:13px;color:#ff0000\"><span style=\"font-size:13px;color:#ff0000\">2</b></span></span></b><span style=\"font-size:13px\"> ) {\r\n<p>&nbsp;</p>\r\n<p align=left>&nbsp;</p>\r\n</span></p>\r\n<p align=left><span style=\"font-size:13px;color:#660000\"><span style=\"font-size:13px;color:#660000\">$nStockTotalUS</span></span><span style=\"font-size:13px\"> += </span><span style=\"font-size:13px;color:#660000\"><span style=\"font-size:13px;color:#660000\">$rs</span></span><span style=\"font-size:13px\">-&gt;fields[</span><span style=\"font-size:13px;color:#008200\"><span style=\"font-size:13px;color:#008200\">'total'</span></span><span style=\"font-size:13px\">];\r\n<p>&nbsp;</p>\r\n<p align=left>&nbsp;</p>\r\n</span></p>\r\n<p align=left><span style=\"font-size:13px;color:#660000\"><span style=\"font-size:13px;color:#660000\">$objPHPExcel</span></span><span style=\"font-size:13px\">-&gt;getActiveSheet()-&gt;setCellValue(</span><span style=\"font-size:13px;color:#008200\"><span style=\"font-size:13px;color:#008200\">'E'</span></span><span style=\"font-size:13px\"> . </span><span style=\"font-size:13px;color:#660000\"><span style=\"font-size:13px;color:#660000\">$nRow</span></span><span style=\"font-size:13px\">, number_format( </span><span style=\"font-size:13px;color:#660000\"><span style=\"font-size:13px;color:#660000\">$rs</span></span><span style=\"font-size:13px\">-&gt;fields[</span><span style=\"font-size:13px;color:#008200\"><span style=\"font-size:13px;color:#008200\">'total'</span></span><span style=\"font-size:13px\">], </span><b><span style=\"font-size:13px;color:#ff0000\"><span style=\"font-size:13px;color:#ff0000\">2</b></span></span></b><span style=\"font-size:13px\">, </span><span style=\"font-size:13px;color:#008200\"><span style=\"font-size:13px;color:#008200\">','</span></span><span style=\"font-size:13px\">, </span><span style=\"font-size:13px;color:#008200\"><span style=\"font-size:13px;color:#008200\">''</span></span><span style=\"font-size:13px\">) );\r\n<p>&nbsp;</p>\r\n<p align=left>&nbsp;</p>\r\n</span></p>\r\n<p align=left><span style=\"font-size:13px;color:#660000\"><span style=\"font-size:13px;color:#660000\">$objPHPExcel</span></span><span style=\"font-size:13px\">-&gt;getActiveSheet()-&gt;setCellValue(</span><span style=\"font-size:13px;color:#008200\"><span style=\"font-size:13px;color:#008200\">'F'</span></span><span style=\"font-size:13px\"> . </span><span style=\"font-size:13px;color:#660000\"><span style=\"font-size:13px;color:#660000\">$nRow</span></span><span style=\"font-size:13px\">, </span><b><span style=\"font-size:13px;color:#ff0000\"><span style=\"font-size:13px;color:#ff0000\">0</b></span></span></b><span style=\"font-size:13px\">);\r\n<p>&nbsp;</p>\r\n<p align=left>&nbsp;</p>\r\n<p align=left>} </p>\r\n</span></p>\r\n<p align=left><b><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">else</b></span></span></b><span style=\"font-size:13px\"> {\r\n<p>&nbsp;</p>\r\n<p align=left>&nbsp;</p>\r\n</span></p>\r\n<p align=left><span style=\"font-size:13px;color:#660000\"><span style=\"font-size:13px;color:#660000\">$nStockTotalBR</span></span><span style=\"font-size:13px\"> += </span><span style=\"font-size:13px;color:#660000\"><span style=\"font-size:13px;color:#660000\">$rs</span></span><span style=\"font-size:13px\">-&gt;fields[</span><span style=\"font-size:13px;color:#008200\"><span style=\"font-size:13px;color:#008200\">'total'</span></span><span style=\"font-size:13px\">];\r\n<p>&nbsp;</p>\r\n<p align=left>&nbsp;</p>\r\n</span></p>\r\n<p align=left><span style=\"font-size:13px;color:#660000\"><span style=\"font-size:13px;color:#660000\">$objPHPExcel</span></span><span style=\"font-size:13px\">-&gt;getActiveSheet()-&gt;setCellValue(</span><span style=\"font-size:13px;color:#008200\"><span style=\"font-size:13px;color:#008200\">'E'</span></span><span style=\"font-size:13px\"> . </span><span style=\"font-size:13px;color:#660000\"><span style=\"font-size:13px;color:#660000\">$nRow</span></span><span style=\"font-size:13px\">, </span><b><span style=\"font-size:13px;color:#ff0000\"><span style=\"font-size:13px;color:#ff0000\">0</b></span></span></b><span style=\"font-size:13px\">);<br>\r\n<p>&nbsp;</p>\r\n<p align=left>&nbsp;</p>\r\n</span></p>\r\n<p align=left><span style=\"font-size:13px;color:#660000\"><span style=\"font-size:13px;color:#660000\">I try this :<br>\r\n<p>&nbsp;</p>\r\n<p align=left><span style=\"font-size:13px;color:#660000\"><span style=\"font-size:13px;color:#660000\">$objPHPExcel</span></span><span style=\"font-size:13px\">-&gt;getActiveSheet()-&gt;setCellValue(</span><span style=\"font-size:13px;color:#008200\"><span style=\"font-size:13px;color:#008200\">'F'</span></span><span style=\"font-size:13px\"> . </span><span style=\"font-size:13px;color:#660000\"><span style=\"font-size:13px;color:#660000\">$nRow</span></span><span style=\"font-size:13px\">,&nbsp; </span><span style=\"font-size:13px;color:#660000\"><span style=\"font-size:13px;color:#660000\">$rs</span></span><span style=\"font-size:13px\">-&gt;fields[</span><span style=\"font-size:13px;color:#008200\"><span style=\"font-size:13px;color:#008200\">'total'</span></span><span style=\"font-size:13px\">]</span><span style=\"font-size:13px\"> );<br>\r\nand this :</span><br>\r\n$objPHPExcel</p>\r\n</span>\r\n<p align=left>&nbsp;</p>\r\n</span></p>\r\n<p align=left><span style=\"font-size:13px\">-&gt;getActiveSheet()-&gt;setCellValue(</span><span style=\"font-size:13px;color:#008200\"><span style=\"font-size:13px;color:#008200\">'F'</span></span><span style=\"font-size:13px\"> . </span><span style=\"font-size:13px;color:#660000\"><span style=\"font-size:13px;color:#660000\">$nRow</span></span><span style=\"font-size:13px\">, number_format( </span><span style=\"font-size:13px;color:#660000\"><span style=\"font-size:13px;color:#660000\">$rs</span></span><span style=\"font-size:13px\">-&gt;fields[</span><span style=\"font-size:13px;color:#008200\"><span style=\"font-size:13px;color:#008200\">'total'</span></span><span style=\"font-size:13px\">], </span><b><span style=\"font-size:13px;color:#ff0000\"><span style=\"font-size:13px;color:#ff0000\">2</b></span></span></b><span style=\"font-size:13px\">, </span><span style=\"font-size:13px;color:#008200\"><span style=\"font-size:13px;color:#008200\">','</span></span><span style=\"font-size:13px\">, </span><span style=\"font-size:13px;color:#008200\"><span style=\"font-size:13px;color:#008200\">''</span></span><span style=\"font-size:13px\">) );\r\n<p>&nbsp;</p>\r\n<p align=left>}</p>\r\n<p align=left>&nbsp;</p>\r\n<p align=left>&nbsp;</p>\r\n</span></p>\r\n<p align=left><span style=\"font-size:13px;color:#660000\"><span style=\"font-size:13px;color:#660000\">$nRow</span></span><span style=\"font-size:13px\">++;\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<span style=\"font-size:13px\">\r\n<p align=left>&nbsp;</p>\r\n<p align=left>&nbsp;</p>\r\n</span>\r\n<p align=left><span style=\"font-size:13px;color:#660000\"><span style=\"font-size:13px;color:#660000\">$rs</span></span><span style=\"font-size:13px\">-&gt;MoveNext();\r\n<p>&nbsp;</p>\r\n<p>}<br>\r\n<br>\r\nE column are us dolars, F column are local money.<br>\r\n</p>\r\n</span></p>\r\n",
    "PostedDate": "2008-09-06T10:09:01.953-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "116521",
    "ThreadId": "35056",
    "Html": "when i click in a cell bad formated and then click enter to&nbsp;go out,&nbsp;&nbsp;excel put the right format in the cell.\r\n",
    "PostedDate": "2008-09-06T10:11:22.99-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "116523",
    "ThreadId": "35056",
    "Html": "sorry, my writer is&nbsp;Excel2007\r\n",
    "PostedDate": "2008-09-06T10:30:35.553-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "116538",
    "ThreadId": "35056",
    "Html": "I took a look at your script. Here is what you need to do:<br>\r\n<br>\r\n1.<br>\r\nDownload latest source of PHPExcel.<br>\r\n<a href=\"http://www.codeplex.com/PHPExcel/SourceControl/ListDownloadableCommits.aspx\">http://www.codeplex.com/PHPExcel/SourceControl/ListDownloadableCommits.aspx</a><br>\r\nAfter PHPExcel 1.6.3 was released a bug was discovered where negative number would be stored as text<br>\r\n<a href=\"http://www.codeplex.com/PHPExcel/WorkItem/View.aspx?WorkItemId=7527\">http://www.codeplex.com/PHPExcel/WorkItem/View.aspx?WorkItemId=7527</a><br>\r\n<br>\r\n2.<br>\r\nWhen you want to set numerical cell values <strong>never</strong> do like this:<br>\r\n<code>\r\n$cell-&gt;setValue('123,45'); // wrong: will become text<br>\r\n</code>\r\n<br>\r\nInstead do like this:<br>\r\n<code>\r\n$cell-&gt;setValue('123.45'); // ok: will become number<br>\r\n$cell-&gt;setValue(123.45); // also ok: will become number<br>\r\n</code>\r\n<br>\r\n3.<br>\r\nWhen you want to set the number format code from PHPExcel <strong>always</strong> use <code>'.'</code> (point) to indicate decimal separator, and <strong>always</strong> use <code>','</code> (comma) to indicate thousands separator. This is true even when you really want decimal separator to be a <code>','</code> and thousands separator to be <code>'.'</code> when you open the spreadsheet in MS Office Excel. But it is the application that decides how to render the decimal separator. Thus on a Spanish platform one may see a number as <code>1.030,45</code> when one opens the spreadsheet while for the same spreadsheet the number will be seen as <code>1,030.45</code> on an English platform.<br>\r\n<br>\r\nCaution: Therefore you cannot just copy and paste the number format as seen in MS Office Excel and use it in your PHP script. What you see in the applications dialog for setting number format is platform dependent. You need to use the applications internal format which is as described above.<br>\r\n<br>\r\n4.<br>\r\nExample, working script with latest source. (PHPExcel 1.6.3 will not work for negative numbers)<br>\r\n<br>\r\n<code>\r\n$ws-&gt;getStyle('F1')-&gt;getNumberFormat()-&gt;setFormatCode('#,##0.00;[Red](#,##0.00)');<br>\r\n$ws-&gt;setCellValue('F1', 1030.45);<br>\r\n<br>\r\n// will show as 1.030,45 in MS Office Excel on Spanish platform<br>\r\n// will show as 1,030.45 in MS Office Excel on English platform\r\n</code>\r\n",
    "PostedDate": "2008-09-06T11:54:45.783-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "116555",
    "ThreadId": "35056",
    "Html": "<p>Hi:<br>\r\nI test download the last change set Number 17115.</p>\r\n<p>I try this :<br>\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('F4')-&gt;getNumberFormat()-&gt;setFormatCode('#,##0.00;[Red](#,##0.00)');</p>\r\n<p>$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('F4', $rs-&gt;fields['stock'] );</p>\r\n<p>Give me this error :<br>\r\nNotice: Undefined index: 3628.80 in D:\\webroot\\homeinf\\util\\phpexcel\\PHPExcel\\Writer\\Excel2007\\Worksheet.php on line 989</p>\r\n<p>3628.80 is the value to be set in the cell.</p>\r\n<p>this is the code that give problem :</p>\r\n<p>case 'n':&nbsp;&nbsp;&nbsp;// Numeric<br>\r\n&nbsp;if (PHPExcel_Shared_Date::isDateTime($pCell)) {<br>\r\n&nbsp;&nbsp;$dateValue = $pCell-&gt;getValue();<br>\r\n&nbsp;&nbsp;if (is_string($dateValue)) {<br>\r\n&nbsp;&nbsp;&nbsp;//&nbsp;Error string<br>\r\n&nbsp;&nbsp;&nbsp;$objWriter-&gt;writeElement('v', $pFlippedStringTable[$dateValue]);<br>\r\n&nbsp;&nbsp;} elseif (!is_float($dateValue)) {<br>\r\n&nbsp;&nbsp;&nbsp;//&nbsp;PHP serialized date/time or date/time object<br>\r\n&nbsp;&nbsp;&nbsp;$objWriter-&gt;writeElement('v', PHPExcel_Shared_Date::PHPToExcel($dateValue));<br>\r\n&nbsp;&nbsp;} else {<br>\r\n&nbsp;&nbsp;&nbsp;//&nbsp;Excel serialized date/time<br>\r\n&nbsp;&nbsp;&nbsp;$objWriter-&gt;writeElement('v', $dateValue);<br>\r\n&nbsp;&nbsp;}<br>\r\n&nbsp;} else {<br>\r\n&nbsp;&nbsp;$objWriter-&gt;writeElement('v', $pCell-&gt;getValue());<br>\r\n&nbsp;}<br>\r\n&nbsp;break;</p>\r\n<p>File : Classes\\PHPExcel\\Writer\\Excel2007\\Worksheet.php<br>\r\nLine Number : 989</p>\r\n<p>Without format has no errors.</p>\r\n<p>This work, but i have not format.<br>\r\n//$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('F4')-&gt;getNumberFormat()-&gt;setFormatCode('#,##0.00;[Red](#,##0.00)');</p>\r\n<p>$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('F4', $rs-&gt;fields['stock'] );</p>\r\n",
    "PostedDate": "2008-09-06T14:21:08.573-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "116556",
    "ThreadId": "35056",
    "Html": "Thank you. I verified the issue. This is happening when one supplies the value as a string. I guess your <code>$rs-&gt;fields['stock']</code> variable is a string and not a float.<br>\r\n<br>\r\nI was not aware of this problem. Will investigate further and post a bug report if necessary.<br>\r\n<br>\r\nIf you need a temporary quick fix, use this:<br>\r\n<br>\r\n<code>\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('F4', (float) $rs-&gt;fields['stock'] );<br>\r\n</code>\r\n<br>\r\n",
    "PostedDate": "2008-09-06T14:40:06.007-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "116562",
    "ThreadId": "35056",
    "Html": "Please continue the discussion here:<br>\r\n<a href=\"http://www.codeplex.com/PHPExcel/WorkItem/View.aspx?WorkItemId=7536\">http://www.codeplex.com/PHPExcel/WorkItem/View.aspx?WorkItemId=7536</a><br>\r\n",
    "PostedDate": "2008-09-06T15:42:03.747-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "235577",
    "ThreadId": "35056",
    "Html": "<p>Hi,</p>\r\n<p>I continue the discussion here, because my concern is not about date formatting, missing (float) setup or the [Color] notation. My question is: Is it possible to format a number into English format (12,345.67) using a German Microsoft Excel version to open it? German notation is (12.345,67). Because of the special handling for . and , it's seems to be impossible for me, even using the number format setup in Excel itself. When I try this setup: #,##0.00 I got this output: 123456,67000. After submitting this setup, I reopened the number format setup and got this setup: 0,00000 (which explains the number formatting).</p>\r\n<p>It's very important for me, that the produced number format will not be transformed, because we want to produce localization-dependend Excel files. I hope this won't end up in using strings instead.</p>\r\n<p>&nbsp;</p>\r\n<p>Thanks in advance and also for this nice library :)</p>",
    "PostedDate": "2009-09-17T06:54:03.887-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "235605",
    "ThreadId": "35056",
    "Html": "<p>@Baj<br> <br> <em>&gt;&gt; Is it possible to format a number into English format (12,345.67) using a German<br> &gt;&gt; Microsoft Excel version to open it?</em><br> <br> As far as I am aware it is not possible. From the Excel document itself you <strong>can control</strong> whether or not to use thousands or decimal separators, but you <strong>cannot control</strong> the actual characters to use. The actual characters to use for thousand and decimal separators are decided by the application used to open the workbook, and the user can at any time change those settings.<br> <br> I think we should appreciate that the author cannot define characters to be used for thousand and decimal separators. The real question is why you are trying to control that?<br> <br> The correct approach is to use<br> <br>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre>$sheet-&gt;getCell(<span style=\"color:#A31515\">'A1'</span>)-&gt;setValue(12345.67);\r\n$sheet-&gt;getStyle(<span style=\"color:#A31515\">'A1'</span>)-&gt;getNumberFormat()-&gt;setFormatCode(<span style=\"color:#A31515\">'#,##0.00'</span>);\r\n</pre>\r\n</div>\r\n<br> Now, when a German user open the workbook he will probably see <span style=\"font-family:Courier New\">12.345,67</span> unless he has changed his locale, or settings in MS Office Excel. English users will see<span style=\"font-family:Courier New\"> 12,345.67</span>.<br> <br> Note also that when the German user inspects the number format setup he will see <span style=\"font-family:Courier New\">#.##0,00</span> in Excel even though you used <span style=\"font-family:Courier New\">#,##0.00</span>. That is because even  the format mask itself is being localized by MS Office Excel.</p>",
    "PostedDate": "2009-09-17T07:41:47.087-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "235615",
    "ThreadId": "35056",
    "Html": "<blockquote style=\"border:solid .1em #ccc;font-style:italic;margin:.25em 1em 0 1em;padding:0 .25em 0 .25em\"><strong>koyama wrote:</strong><br>\r\n<p>The real question is why you are trying to control that?</p>\r\n</blockquote>\r\n<p>Thanks for your quick answer.</p>\r\n<p>Long answer: We generate DOCX documents for a Federal Office. They provide those documents in different languages. The reports include Excel tables. So we generate those Excel files, which include translations for some cells and of course number formatting. The generated report can never be perfect. So the guys from the Fed. Office will add or remove some stuff, change a thing here and there. At the end, there is f.e. a French guy, editing the English stuff in the Excel table and moves the table back to the (still English) Word document. It's not acceptable, that the English Word document now contains French number formatting. That's what I'm afraid of. The document will be printed if it's reviewed successfully.</p>\r\n<p>But maybe that's more an Excel than a PHPExcel problem, right? :(</p>",
    "PostedDate": "2009-09-17T08:00:29.41-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "235632",
    "ThreadId": "35056",
    "Html": "<p>@Baj</p>\r\n<p>Ok, I see, you may have a special situation. You're right, this is really an Excel problem. But if you find some technique to solve the problem, please share it anyway.</p>",
    "PostedDate": "2009-09-17T08:31:43.947-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "235634",
    "ThreadId": "35056",
    "Html": "<p>I will (in case), thanks so far.</p>",
    "PostedDate": "2009-09-17T08:38:23.45-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "236005",
    "ThreadId": "35056",
    "Html": "<p>I tried a lot,</p>\r\n<p>- using similar utf 8 characters such as Arabic Decimal Separator (hex d9 ab) for comma or Tibetian Mark Ngas Bzung Sgor Rtags (hex e0 bc b7) as dot (problem is still that the native decimal delimiter is required, if you want to show decimals)</p>\r\n<p>- escape the separators with backslash</p>\r\n<p>- adding a backspace control character after the separators</p>\r\n<p>- adding xml:lang=&quot;enUS&quot; to the &lt;numFmt&gt; in styles.xml</p>\r\n<p>nothing works. So I will add &quot;output as string&quot; or &quot;output as number&quot; radioboxes to the export functionality with a little explanation.</p>\r\n<p>Ultimate alternative is to switch the Windows localization setup or maybe use macros, but both are not options in my case.</p>",
    "PostedDate": "2009-09-18T05:33:26.087-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]