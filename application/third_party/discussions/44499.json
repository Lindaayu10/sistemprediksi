[
  {
    "Id": "148100",
    "ThreadId": "44499",
    "Html": "Anyone ever use CodeIgniter before ?<br>\r\nI'm trying to use PHPExcel library within my CI code and i found this strange behaviour.<br>\r\n<br>\r\n<span style=\"text-decoration:underline\"><strong>I want to do this</strong><strong> :<br>\r\n<br>\r\n</strong></span>Create on-the-fly spreadsheet based on a template.<br>\r\nSo i have to load a template, manipulate the content, and send it to the browser.<br>\r\n<br>\r\nI have this file in my CI library :<br>\r\n<br>\r\n<strong>excel.php</strong><br>\r\n<br>\r\n<blockquote><em>&lt;?php if ( ! defined('BASEPATH')) exit('No direct script access allowed');</em><br>\r\n<br>\r\n<em>class Excel &nbsp;</em><br>\r\n<em>{</em><br>\r\n<em>&nbsp;&nbsp; &nbsp;public $workbook;</em><br>\r\n<em>&nbsp;&nbsp; &nbsp;</em><br>\r\n<em>&nbsp;&nbsp; &nbsp;function __construct()</em><br>\r\n<em>&nbsp;&nbsp; &nbsp;{</em><br>\r\n<em>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;// PHPExcel libraries have to be in your include path !</em><br>\r\n<em>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;require_once('PHPExcel.php');</em><br>\r\n<em>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;require_once('PHPExcel/IOFactory.php');</em><br>\r\n<em>&nbsp;&nbsp; &nbsp;}</em><br>\r\n<em>&nbsp;&nbsp; &nbsp;</em><br>\r\n<em>&nbsp;&nbsp; &nbsp;function load()</em><br>\r\n<em>&nbsp;&nbsp; &nbsp;{</em><br>\r\n<em>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;// Path to the template file</em><br>\r\n<em>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$template_location = 'resources/template.xls';</em><br>\r\n<em>&nbsp;&nbsp; &nbsp;</em><br>\r\n<em>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$xls_reader = PHPExcel_IOFactory::createReader('Excel5');</em><br>\r\n<em>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$this-&gt;workbook = $xls_reader-&gt;load($template_location);</em><br>\r\n<em>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;</em><br>\r\n<em>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;var_dump($this-&gt;workbook); // Yea, successfully load the data</em><br>\r\n<em>&nbsp;&nbsp; &nbsp;}</em><br>\r\n<em>&nbsp;&nbsp; &nbsp;</em><br>\r\n<em>&nbsp;&nbsp; &nbsp;function send()</em><br>\r\n<em>&nbsp;&nbsp; &nbsp;{</em><br>\r\n<em>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;//So far so good, now let's create the writer</em><br>\r\n<em>&nbsp;&nbsp; &nbsp;</em><br>\r\n<em>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$xls_writer = PHPExcel_IOFactory::createWriter($this-&gt;workbook, 'Excel5'); // Trouble maker</em><br>\r\n<em>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;// Stops here, no error message, output nothing</em><br>\r\n<em>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;</em><br>\r\n<em>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;header('Pragma: public');</em><br>\r\n<em>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;header('Expires: 0');</em><br>\r\n<em>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;header('Cache-Control: must-revalidate, post-check=0, pre-check=0');</em><br>\r\n<em>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;header('Content-Type: application/force-download');</em><br>\r\n<em>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;header('Content-Type: application/octet-stream');</em><br>\r\n<em>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;header('Content-Type: application/download');</em><br>\r\n<em>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;header(&quot;Content-Disposition: attachment;filename=from-template.xls&quot;);</em><br>\r\n<em>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;header('Content-Transfer-Encoding: binary');</em><br>\r\n<br>\r\n<em>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$xls_writer-&gt;save('php://output');&nbsp;&nbsp; &nbsp;</em><br>\r\n<em>&nbsp;&nbsp; &nbsp;}</em><br>\r\n<em>}</em><br>\r\n<br>\r\n</blockquote>And i have this tester class in my controller :<br>\r\n<br>\r\n<strong>excel_tester.php</strong><br>\r\n<br>\r\n<blockquote><em>&lt;?php</em><br>\r\n<br>\r\n<em>class Excel_tester extends Controller</em><br>\r\n<em>{</em><br>\r\n<em>&nbsp;&nbsp; &nbsp;function __construct()</em><br>\r\n<em>&nbsp;&nbsp; &nbsp;{</em><br>\r\n<em>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;parent::__construct();</em><br>\r\n<em>&nbsp;&nbsp; &nbsp;}</em><br>\r\n<em>&nbsp;&nbsp; &nbsp;</em><br>\r\n<em>&nbsp;&nbsp; &nbsp;function test()</em><br>\r\n<em>&nbsp;&nbsp; &nbsp;{</em><br>\r\n<em>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$this-&gt;load-&gt;library('excel');</em><br>\r\n<em>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;</em><br>\r\n<em>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$this-&gt;excel-&gt;load();</em><br>\r\n<em>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$this-&gt;excel-&gt;send();</em><br>\r\n<em>&nbsp;&nbsp; &nbsp;}</em><br>\r\n<em>}</em><br>\r\n</blockquote><br>\r\n<span style=\"text-decoration:underline\"><strong>And here goes the problem :</strong></span><br>\r\n<br>\r\nThe template was loaded successfully. I tried to var_dump'ing the workbook object, and it outputs correctly.<br>\r\nThe code execution <span style=\"text-decoration:underline\">stops right when i call <strong>PHPExcel_IOFactory::createWriter()</strong></span>. No error messages displayed. It just stopped.<br>\r\n<br>\r\nI tried to change the parameter, <br>\r\nso instead of <em>&quot;createWriter(<span style=\"text-decoration:underline\">$this-&gt;workbook</span>, 'Excel5')&quot;</em>, i use &quot;<em>createWriter(<span style=\"text-decoration:underline\">new PHPExcel()</span>, 'Excel5')</em>&quot;.<br>\r\nNo luck.<br>\r\n<br>\r\n<span style=\"text-decoration:underline\"><strong>BUT</strong></span>, when i omit the template load code (that is, no <strong>createReader</strong> executed in my code), the &quot;<em>createWriter(<span style=\"text-decoration:underline\">new PHPExcel()</span>, 'Excel5')</em>&quot; works like a charm, and it outputs the empty xls correcly.<br>\r\n<br>\r\n<br>\r\nWhy is that, and how can i fix my problem here ?<br>\r\nAny helps will be appreciated. As far as i found, PHPExcel fits my needs the most, and i don't want to abandon this library.<br>\r\n",
    "PostedDate": "2009-01-18T09:39:08.94-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "148159",
    "ThreadId": "44499",
    "Html": "Double post:<br>\r\n<a href=\"http://www.codeplex.com/PHPExcel/Thread/View.aspx?ThreadId=44498\">http://www.codeplex.com/PHPExcel/Thread/View.aspx?ThreadId=44498</a><br>\r\n<br>\r\n<br>\r\n\r\n",
    "PostedDate": "2009-01-18T16:45:04.11-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]