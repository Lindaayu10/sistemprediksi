[
  {
    "Id": "459287",
    "ThreadId": "217139",
    "Html": "<p>Dear All,<br><br>I'm trying to write data into two excel files or multiple excel files from mysql with looping method.<br><br>I'm doing something like:<br><br>#!/usr/bin/php -q<br><br>&lt;?php<br>/** Error reporting */<br>error_reporting(E_ALL);<br><br>set_include_path(get_include_path() . PATH_SEPARATOR . '/home/chemonk/sinau/Classes');<br><br>/** PHPExcel */<br>require_once 'PHPExcel.php';<br><br>/** PHPExcel_IOFactory */<br>require_once 'PHPExcel/IOFactory.php';<br><br>/* PHPExcel_Cell_AdvanceValueBinder required for this sample */<br>require_once 'PHPExcel/Cell/AdvancedValueBinder.php';<br><br>include 'connect.php';<br><br>$style = array(<br>'font' =&gt; array(<br>'name' =&gt; 'Arial',<br>'size' =&gt; 10,<br>),<br>'alignment' =&gt; array(<br>'horizontal' =&gt; PHPExcel_Style_Alignment::HORIZONTAL_LEFT,<br>),<br>);<br><br>$objPHPExcel = new PHPExcel();<br><br>$objPHPExcel-&gt;getProperties()-&gt;setCreator(&quot;Ponco Nugrah Wibowo&quot;);<br>$objPHPExcel-&gt;getProperties()-&gt;setLastModifiedBy(&quot;IDMSCoins&quot;);<br><br>$objPHPExcel-&gt;getActiveSheet()-&gt;getDefaultColumnDimension()-&gt;setAutoSize(true);<br>$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('A1:AF1')-&gt;applyFromArray($style);<br><br>$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('A1','Record Status');<br>$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('B1','Container Number');<br>$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('C1','Size Type');<br>$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('D1','Shipping Line (Carrier)');<br>$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('E1','Full/Empty Indicator');<br>$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('F1','Activity Code');<br>$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('G1','Activity Date Time');<br>$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('H1','Port code (Activity)');<br>$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('I1','Terminal Code');<br>$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('J1','To Place');<br>$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('K1','To Depot');<br>$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('L1','Service Code');<br>$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('M1','Vessel Code');<br>$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('N1','Voyage');<br>$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('O1','Bound');<br>$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('P1','Place of Origin Code (UN Code)');<br>$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('Q1','Port of Loading Code (UN Code)');<br>$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('R1','Port of Discharge Code');<br>$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('S1','Destination Code (UN Code)');<br>$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('T1','Container Condition Code');<br>$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('U1','Booking Number');<br>$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('V1','Gross Weight');<br>$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('W1','Seal Number');<br>$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('X1','Mode of Transport Code');<br>$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('Y1','Created User');<br>$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('Z1','Remarks');<br>$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('AA1','Flag Status');<br>$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('AB1','Supplier Ref');<br>$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('AC1','Sub lease Ref');<br>$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('AD1','Scale In Ref');<br>$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('AE1','Scale Out Ref');<br>$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue('AF1','Soc');<br><br>$SQLin = &quot;SELECT<br>cp.CPOPR, cp.CRNO AS Container_No, DATE_FORMAT(cp.CPITGL, '%d/%m/%Y') AS Tgl,<br>cp.CPITERM, SEC_TO_TIME(TIME_TO_SEC(cp.CPIJAM) - 1800) AS trfetime, cp.CPIJAM AS Jam,<br>SEC_TO_TIME(TIME_TO_SEC(cp.CPIJAM) + 300) AS sntrtime,<br>sur.SVCOND, cp.CPIDELIVER, cp.CPIREMARK, cr.RETYPE, cr.RETFROM<br>FROM idms_coins.coins_container_process cp<br>LEFT JOIN idms_coins.tblcontainer con ON con.CRNO = cp.CRNO<br>LEFT JOIN idms_coins.coins_container_repo cr ON cr.REORDERNO=cp.CPIORDERNO<br>LEFT JOIN idms_coins.coins_survey sur ON sur.CPID = cp.CPID<br>LEFT JOIN idms_coins.tblcontainer_code cc ON cc.CCCODE = con.CCCODE<br>LEFT JOIN idms_coins.tbldepo dep ON dep.DPCODE = cp.CPDEPO<br>WHERE<br>$Subdepo<br>$Oprcon<br>$TanggalIN<br>cp.CPOPR &lt;&gt;'' AND cp.CRNO IS NOT NULL<br>ORDER BY cp.CPOPR, cp.CPIJAM&quot;;<br><br>//die($SQLin);<br><br>$resultsIN = mysql_query($SQLin,$link);<br><br><br>function in($objPHPExcel,$resultsIN,$style,$port,$terminal) {<br><br>$i = 2;<br><br>while ($rowIN = mysql_fetch_array($resultsIN, MYSQL_ASSOC)){<br><br><br>$range = &quot;A$i:AF$i&quot;;<br>$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('A'.$i)-&gt;getAlignment()-&gt;setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_RIGHT);<br>$objPHPExcel-&gt;getActiveSheet()-&gt;getDefaultColumnDimension()-&gt;setAutoSize(true);<br>$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle($range)-&gt;applyFromArray($style);<br>$objPHPExcel-&gt;setActiveSheetIndex()<br>-&gt;setCellValue('A'.$i, &quot;0&quot; )<br>-&gt;setCellValue('B'.$i, $rowIN[&quot;Container_No&quot;])<br>-&gt;setCellValue('F'.$i, &quot;RCVC&quot;);<br>-&gt;setCellValue('G'.$i, $rowIN[&quot;Tgl&quot;].&quot; &quot;.$rowIN[&quot;Jam&quot;])<br>-&gt;setCellValue('H'.$i, $port)<br>-&gt;setCellValue('I'.$i, $terminal)<br>-&gt;setCellValue('AF'.$i, &quot;N&quot;);<br><br>$i++;<br><br>}<br>// Save file<br><br>$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, 'Excel5');<br>$objWriter-&gt;save('MTCON_JKT_RCVC.xls');<br><br>$objPHPExcel-&gt;setActiveSheetIndex()-&gt;setCellValue('F'.$i, &quot;SNTR&quot;);<br>$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, 'Excel5');<br>$objWriter-&gt;save('MTCON_JKT_SNTR.xls');<br><br>}<br>in($objPHPExcel,$resultsIN,$style,$port,$terminal);<br>?&gt;<br><br>There are differences in the contents of the data in column F between MTCON_JKT_RCVC.xls with MTCON_JKT_SNTR.xls.I want to change the content in column F. From RCVC become SNTR.<br><br>Please let me know any suggestions you have.<br><br>Thank You.<br><br></p>",
    "PostedDate": "2010-06-23T22:04:13.703-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]