[
  {
    "Id": "283875",
    "ThreadId": "82582",
    "Html": "<p>Hi</p>\r\n<p>I'm using PHPExcel 1.7.2 and PHP 5.2.6 on Windows 7 RC 1. I'm having trouble with conditional formatting - specifically, setting a background colour. Here's some code:</p>\r\n<p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre><span style=\"color:Blue\">require_once</span>(<span style=\"color:#A31515\">'PHPExcel.php'</span>);\r\n<span style=\"color:Blue\">require_once</span>(<span style=\"color:#A31515\">'PHPExcel/IOFactory.php'</span>);\r\n\r\n$objPHPExcel = <span style=\"color:Blue\">new</span> PHPExcel();\r\n\r\n$worksheet = $objPHPExcel-&gt;setActiveSheetIndex(0);\r\n\r\n$worksheet-&gt;setCellValueByColumnAndRow(0, 1, 5);\r\n\r\n$condition_style = <span style=\"color:Blue\">array</span>(<span style=\"color:#A31515\">'type'</span> =&gt; PHPExcel_Style_Fill::FILL_SOLID, <span style=\"color:#A31515\">'startcolor'</span> =&gt; <span style=\"color:Blue\">array</span>(<span style=\"color:#A31515\">'rgb'</span> =&gt; <span style=\"color:#A31515\">'ff0000'</span>));\r\n\r\n$objConditional = <span style=\"color:Blue\">new</span> PHPExcel_Style_Conditional();\r\n$objConditional-&gt;setConditionType(PHPExcel_Style_Conditional::CONDITION_EXPRESSION);\r\n$objConditional-&gt;setOperatorType(PHPExcel_Style_Conditional::OPERATOR_NONE);\r\n$objConditional-&gt;setCondition(<span style=\"color:#A31515\">'A1&lt;10'</span>);\r\n$objConditional-&gt;getStyle()-&gt;getFill()-&gt;applyFromArray($condition_style);\r\n\r\n$conditionalStyles = $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#A31515\">'A1'</span>)-&gt;getConditionalStyles();\r\narray_push($conditionalStyles, $objConditional);\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#A31515\">'A1'</span>)-&gt;setConditionalStyles($conditionalStyles);\r\n\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(<span style=\"color:#A31515\">'B1'</span>)-&gt;getFill()-&gt;applyFromArray($condition_style);\r\n\r\n<span style=\"color:Green\">// Redirect output to a client's web browser</span>\r\nheader(<span style=\"color:#A31515\">'Content-Type: application/vnd.ms-excel'</span>);\r\nheader(<span style=\"color:#A31515\">'Content-Disposition: attachment;filename=&quot;test.xlsx&quot;'</span>);\r\nheader(<span style=\"color:#A31515\">'Cache-Control: max-age=0'</span>);\r\n\r\n$xls_writer = PHPExcel_IOFactory::createWriter($objPHPExcel, <span style=\"color:#A31515\">'Excel2007'</span>);\r\n$xls_writer-&gt;save(<span style=\"color:#A31515\">'php://output'</span>);\r\n</pre>\r\n</div>\r\n</p>\r\n<p>The result: cell A1 is black and it's formatting cannot be changed (perhaps it's formatting is corrupted?); B1, included as a reference, is fine. Any ideas?</p>\r\n<p>A related question: I've been using a template, which has some conditional formatting rules in it. I read in the template, add numbers to it and write it out again (using the Excel 2007 reader/writer). But the output file doesn't contain these rules. Are conditional formatting rules not supported by either the reader or writer (or both)?</p>",
    "PostedDate": "2010-01-31T05:28:17.47-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "284090",
    "ThreadId": "82582",
    "Html": "<blockquote style=\"border:solid .1em #ccc;font-style:italic;margin:.25em 1em 0 1em;padding:0 .25em 0 .25em\"><strong>MarQ wrote:</strong><br>\r\n<p>The result: cell A1 is black and it's formatting cannot be changed (perhaps it's formatting is corrupted?); B1, included as a reference, is fine. Any ideas?</p>\r\n</blockquote>\r\n<p>For some reason, with conditional styles, instead of this:</p>\r\n<p>&nbsp;</p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre>$condition_style = <span style=\"color:Blue\">array</span>(<span style=\"color:#A31515\">'type'</span> =&gt; PHPExcel_Style_Fill::FILL_SOLID, <span style=\"color:#A31515\">'startcolor'</span> =&gt; <span style=\"color:Blue\">array</span>(<span style=\"color:#A31515\">'rgb'</span> =&gt; <span style=\"color:#A31515\">'ff0000'</span>));\r\n</pre>\r\n</div>\r\n<p>you need this:</p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre>$condition_style = <span style=\"color:Blue\">array</span>(<span style=\"color:#A31515\">'type'</span> =&gt; PHPExcel_Style_Fill::FILL_SOLID, <span style=\"color:#A31515\">'endcolor'</span> =&gt; <span style=\"color:Blue\">array</span>(<span style=\"color:#A31515\">'rgb'</span> =&gt; <span style=\"color:#A31515\">'ff0000'</span>));\r\n</pre>\r\n</div>\r\n<p>I know that this is the opposite compared to normal styles. Will investigate later why this is the case.</p>\r\n<p>&nbsp;</p>\r\n<blockquote style=\"border:solid .1em #ccc;font-style:italic;margin:.25em 1em 0 1em;padding:0 .25em 0 .25em\"><strong>MarQ wrote:</strong><br>\r\n<p>A related question: I've been using a template, which has some conditional formatting rules in it. I read in the template, add numbers to it and write it out again (using the Excel 2007 reader/writer). But the output file doesn't contain these rules. Are conditional formatting rules not supported by either the reader or writer (or both)?</p>\r\n</blockquote>\r\n<p>This is a bug.</p>\r\n<p><a href=\"http://phpexcel.codeplex.com/WorkItem/View.aspx?WorkItemId=11668\">http://phpexcel.codeplex.com/WorkItem/View.aspx?WorkItemId=11668</a></p>\r\n<p>Download source code tomorrow:</p>\r\n<p><a href=\"http://phpexcel.codeplex.com/SourceControl/list/changesets\">http://phpexcel.codeplex.com/SourceControl/list/changesets</a></p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2010-01-31T18:01:51.64-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "284435",
    "ThreadId": "82582",
    "Html": "<p>Thanks for your quick reply Koyama. The conditional style now works. However, reading and writing a template with conditional formatting rules is still an issue. I've tested change set 38617 (problem still exists) and 38705 (failed for me - Fatal error: Allowed memory size of 134217728 bytes exhausted (tried to allocate 35 bytes) in Cell.php&nbsp; on line 694).</p>\r\n<p>I tested using the following template and code: <a>http://rapidshare.com/files/344539525/template.xlsx</a></p>\r\n<p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre><span style=\"color:Blue\">require_once</span>(<span style=\"color:#A31515\">'PHPExcel.php'</span>);\r\n<span style=\"color:Blue\">require_once</span>(<span style=\"color:#A31515\">'PHPExcel/IOFactory.php'</span>);\r\n\r\n$objPHPExcel = <span style=\"color:Blue\">new</span> PHPExcel();\r\n\r\n$xls_reader = PHPExcel_IOFactory::createReader(<span style=\"color:#A31515\">'Excel2007'</span>);\r\n$objPHPExcel = $xls_reader-&gt;load(<span style=\"color:#A31515\">'template.xlsx'</span>);\r\n\r\nheader(<span style=\"color:#A31515\">'Content-Type: application/vnd.ms-excel'</span>);\r\nheader(<span style=\"color:#A31515\">'Content-Disposition: attachment;filename=&quot;test.xlsx&quot;'</span>);\r\nheader(<span style=\"color:#A31515\">'Cache-Control: max-age=0'</span>);\r\n\r\n$xls_writer = PHPExcel_IOFactory::createWriter($objPHPExcel, <span style=\"color:#A31515\">'Excel2007'</span>);\r\n$xls_writer-&gt;save(<span style=\"color:#A31515\">'php://output'</span>);\r\n</pre>\r\n</div>\r\n</p>",
    "PostedDate": "2010-02-01T14:58:30.43-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "445667",
    "ThreadId": "82582",
    "Html": "Hi, I am using the template also. The template is a formatted excel worksheet. \r\nWhen i write some data in the sheet and save that sheet, it changes the background color of all cells where formatting is applied \r\n\r\nCan any one tell suggest me the solution. I am using 1.7.2\r\n\r\nThanks",
    "PostedDate": "2010-05-20T19:28:34.197-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]