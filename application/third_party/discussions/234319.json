[
  {
    "Id": "520600",
    "ThreadId": "234319",
    "Html": "\r\n<p>How do I convert from xls to tab-delimited file?</p>\r\n",
    "PostedDate": "2010-11-11T07:27:12.073-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "520800",
    "ThreadId": "234319",
    "Html": "\r\n<p>Read the file using the Excel5 Reader:</p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre>$inputFileType = <span style=\"color:#a31515\">'Excel5'</span>;\r\n$inputFileName = <span style=\"color:#a31515\">'./example1.xls'</span>;</pre>\r\n<pre>\r\n<span style=\"color:green\">/**  Create a new Reader of the type defined in $inputFileType  **/</span>\r\n$objReader = PHPExcel_IOFactory::createReader($inputFileType);\r\n<span style=\"color:green\">/**  Load $inputFileName to a PHPExcel Object  **/</span>\r\n$objPHPExcel = $objReader-&gt;load($inputFileName);\r\n</pre>\r\n</div>\r\n<p>Create a CSV Writer:</p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre>$outputFileType = <span style=\"color:#a31515\">'CSV'</span>;</pre>\r\n<pre>\r\n$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, $outputFileType);\r\n</pre>\r\n</div>\r\n<p>Set the separator to a TAB</p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre>$objWriter-&gt;setDelimiter(<span style=\"color:#a31515\">&quot;\\t&quot;</span>);\r\n</pre>\r\n</div>\r\n<p>Identify which worksheet you want to save:</p>\r\n<pre>$objWriter-&gt;setSheetIndex(<span style=\"color:#a31515\">0</span>);</pre>\r\n<p>And save the file</p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre>$outputFileName = <span style=\"color:#a31515\">'./example1.tsv'</span>;\r\n$objWriter2007-&gt;save($outputFileName);\r\n</pre>\r\n</div>\r\n<p>&nbsp;</p>\r\n",
    "PostedDate": "2010-11-11T14:27:22.14-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "520891",
    "ThreadId": "234319",
    "Html": "\r\n<p>Thanks, Mark, maybe this should go into a FAQ, it is certainly not in the documentation?</p>\r\n",
    "PostedDate": "2010-11-11T19:37:41.787-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "520962",
    "ThreadId": "234319",
    "Html": "\r\n<p>Probably not in the FAQ, but I've already started extending the documentation (currently only the Reader User Guide is included in the SVN code) for the next release to provide a new series of docs accompanied with working examples for all kinds of recipes\r\n (Reading, Writing, Reading Worksheets, Setting Worksheet Data, Styling, Working with Dates, Performing Calculations, Updating Template Workbooks, etc.). I'll certainly be including some examples for converting files between formats in that... although it will\r\n be an ongoing exercise extending that documentation.</p>\r\n",
    "PostedDate": "2010-11-12T01:24:21.333-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "522668",
    "ThreadId": "234319",
    "Html": "\r\n<p>Mark, using the code below. I'm still getting this error:<br>\r\nFatal error: Allowed memory size of 536870912 bytes exhausted <br>\r\n&nbsp; (tried to allocate 520093666 bytes)<br>\r\n&nbsp; <br>\r\nI uploaded the file in Issue# 14699<br>\r\nhttp://phpexcel.codeplex.com/workitem/14699<br>\r\n<br>\r\nAll I need to do is convert this thing to tab-delimited but, <br>\r\nof course, you need to read in the whole file to do that.<br>\r\nI am using cell caching but still run into this.</p>\r\n<p>&nbsp;</p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre>  set_include_path(get_include_path() . PATH_SEPARATOR . <span style=\"color:#a31515\">'PHPExcel/Classes/'</span>); \r\n  <span style=\"color:blue\">require_once</span> <span style=\"color:#a31515\">'PHPExcel/Classes/PHPExcel.php'</span>;\r\n  <span style=\"color:blue\">require_once</span> <span style=\"color:#a31515\">'PHPExcel/Classes/PHPExcel/IOFactory.php'</span>;\r\n  $cacheMethod = PHPExcel_CachedObjectStorageFactory::cache_to_discISAM;\r\n  PHPExcel_Settings::setCacheStorageMethod($cacheMethod);\r\n  $objReader = PHPExcel_IOFactory::createReaderForFile($newfilename);\r\n  $objReader-&gt;setReadDataOnly(true);\r\n  $objPHPExcel  = $objReader-&gt;load($newfilename);\r\n  $outputFileType = <span style=\"color:#a31515\">'CSV'</span>;\r\n  $objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, $outputFileType);\r\n  $objWriter-&gt;setDelimiter(<span style=\"color:#a31515\">&quot;\\t&quot;</span>);\r\n  $objWriter-&gt;setSheetIndex(0);\r\n  $filename = $user_id.<span style=\"color:#a31515\">'_'</span>.$path_parts[<span style=\"color:#a31515\">'filename'</span>].<span style=\"color:#a31515\">'_'</span>.date(<span style=\"color:#a31515\">'m_d_Y'</span>).<span style=\"color:#a31515\">'.txt'</span>;\r\n  <span style=\"color:blue\">if</span>($debug) {showProgressMsg(<span style=\"color:#a31515\">'Saving as '</span>.$filename);}\r\n  $objWriter-&gt;save($fileName);\r\n\r\n<br><br></pre>\r\n</div>\r\n<p>Here is my php.ini memory limit setting:</p>\r\n<p>memory_limit = 512M&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; Maximum amount of memory a script may consume (32MB)</p>\r\n<p>&nbsp;</p>\r\n<p>How do I fix this? This user uploads this file weekly and I need to either convert it to tab-delimited</p>\r\n<p>or somehow be able to load the entire file to parse.</p>\r\n<p>&nbsp;</p>\r\n",
    "PostedDate": "2010-11-16T06:07:17.707-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "522686",
    "ThreadId": "234319",
    "Html": "\r\n<p>Here are some of the things I've done.</p>\r\n<p>&nbsp;</p>\r\n<p>1. changed the caching method to cache_to_apc.</p>\r\n<p>2. double checked memory_limit as 512M.</p>\r\n<p>3. wrote script using exact same code to test on localhost development environment.</p>\r\n<p>&nbsp;</p>\r\n<p>Locally, it works, but when I try it on my web server, it crashes with the error:</p>\r\n<p><strong>Fatal error</strong>: Allowed memory size of 536870912 bytes exhausted (tried to allocate 520093666 bytes) in\r\n<strong>&nbsp;</strong></p>\r\n<p><strong>/home/listinve/public_html/PHPExcel/Classes/PHPExcel/Shared/OLERead.php</strong> on line\r\n<strong>282</strong></p>\r\n<p>&nbsp;</p>\r\n<p>Now, I am reading emails and extracting this file from an attachment<strong>.</strong> Doing this may also be using</p>\r\n<p>some of the memory that I am not using locally. I will look into doing some GC before calling this</p>\r\n<p>code.</p>\r\n",
    "PostedDate": "2010-11-16T06:39:28.017-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "522707",
    "ThreadId": "234319",
    "Html": "\r\n<p>Ok, done some GC by moving things around a bit. But I'm still getting the exhausted memory error even after I clear the memory down to 265288,</p>\r\n<p>It was 15852664 before I cleared everything.</p>\r\n<p>&nbsp;</p>\r\n<p>I'm at a loss here on what to do, the workbook it tried to load is only 1620449 bytes in size with 15187 rows and 5 columns.</p>\r\n<p>That workbook is located in Issue 14701:</p>\r\n<p>http://phpexcel.codeplex.com/workitem/14701</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n",
    "PostedDate": "2010-11-16T07:20:24.987-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "522712",
    "ThreadId": "234319",
    "Html": "\r\n<p>What is the memory limit on your local server? Could it be that your local server runs 32bit, while production is 64 bit? (phpexcel uses slightly more memory per cell with 64bit php)</p>\r\n",
    "PostedDate": "2010-11-16T07:29:31.827-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "522939",
    "ThreadId": "234319",
    "Html": "\r\n<p>My normal rule of thumb calculation for a 32-bit server is 1k/cell (doubled when writing) using default memory caching method, reduced to 1/3 of that when using DiscISAM or PHPTemp caching &#43; the size of the PHPExcel script. On a 64-bit server, there's about\r\n 60% overhead. Your spreadsheet is 210,000 cells, giving an estimated memory requirement of 140MB &#43; PHPExcel script size when using DiscISAM, or 225MB on a 64-bit server. &#65279;&#65279;setReadDataOnly(true) should reduce that further, but not by much as your workbook contains\r\n very little style information.</p>\r\n<p>I tried running your code with the file that you&nbsp;uploaded &#65279;earlier (41846 rows by 5 columns), and the peak memory usage was 140.5MB on a 32-bit server, 242.5MB on a 64-bit server. So I can't really understand where your memory is being used up. Another\r\n option for the reader would be to tell it only to read the first worksheet, but as the other two sheets are empty, that wouldn't help much. Another option would be to use a read filter to read the Excel in &quot;bite-size chunks&quot;, writing each out to different\r\n tsv files, then concatenating all of those files together.</p>\r\n<p>&#65279;</p>\r\n",
    "PostedDate": "2010-11-16T13:59:05.07-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "523011",
    "ThreadId": "234319",
    "Html": "\r\n<p>So, how do I do a read filter to read it in chunks?</p>\r\n<p>210,000 cells?&nbsp;&nbsp; 15187*5=75935, how do you calculate that?</p>\r\n<p>@borft:</p>\r\n<p>[quote]2. double checked memory_limit as 512M.[/quote]</p>\r\n<p>Same for localhost and server. Both 32-bit.</p>\r\n",
    "PostedDate": "2010-11-16T18:00:38.263-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "523090",
    "ThreadId": "234319",
    "Html": "\r\n<blockquote style=\"border:solid .1em #ccc; font-style:italic; margin:.25em 1em 0 1em; padding:0 .25em 0 .25em\">\r\n<strong>MrBaseball34 wrote:</strong><br>\r\n<p>210,000 cells?&nbsp;&nbsp; 15187*5=75935, how do you calculate that?</p>\r\n</blockquote>\r\n<p>&nbsp;The first workbook that you uploaded (40000 in-stock line items update 2010 NOV&nbsp; 8TH.xls) was 41846 rows by 5 columns... which is 209,230 cells</p>\r\n<blockquote style=\"border:solid .1em #ccc; font-style:italic; margin:.25em 1em 0 1em; padding:0 .25em 0 .25em\">\r\n<strong>MrBaseball34 wrote:</strong><br>\r\n<p>So, how do I do a read filter to read it in chunks?&nbsp;</p>\r\n</blockquote>\r\n<p><code><span lang=\"NL\" style=\"color:#0000bb\">$inputFileType&nbsp;</span><span lang=\"NL\" style=\"color:#007700\">=&nbsp;</span><span lang=\"NL\" style=\"color:#dd0000\">'Excel5'</span><span lang=\"NL\" style=\"color:#007700\">;\r\n</span></code><span lang=\"NL\" style=\"color:#007700\"><br>\r\n</span><code><span lang=\"NL\" style=\"color:#0000bb\">$inputFileName&nbsp;</span><span lang=\"NL\" style=\"color:#007700\">=&nbsp;</span><span lang=\"NL\" style=\"color:#dd0000\">'./40000 in-stock line items update 2010 NOV&nbsp; 8TH.xls'</span><span lang=\"NL\" style=\"color:#007700\">;\r\n</span></code><span lang=\"NL\" style=\"color:#007700\"><br>\r\n<br>\r\n<br>\r\n</span><code><span lang=\"NL\" style=\"color:#ff8000\">/**&nbsp;&nbsp;Define&nbsp;a&nbsp;Read&nbsp;Filter&nbsp;class&nbsp;implementing&nbsp;PHPExcel_Reader_IReadFilter&nbsp;&nbsp;*/\r\n</span></code><span lang=\"NL\" style=\"color:#ff8000\"><br>\r\n</span><code><span lang=\"NL\" style=\"color:#007700\">class&nbsp;</span><span lang=\"NL\" style=\"color:#0000bb\">chunkReadFilter&nbsp;</span><span lang=\"NL\" style=\"color:#007700\">implements&nbsp;</span><span lang=\"NL\" style=\"color:#0000bb\">PHPExcel_Reader_IReadFilter\r\n</span></code><span lang=\"NL\" style=\"color:#0000bb\"><br>\r\n</span><code><span lang=\"NL\" style=\"color:#007700\">{ </span></code><span lang=\"NL\" style=\"color:#007700\"><br>\r\n<code>&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;</code></span><code><span lang=\"NL\" style=\"color:#0000bb\">$_startRow&nbsp;</span><span lang=\"NL\" style=\"color:#007700\">=&nbsp;</span><span lang=\"NL\" style=\"color:#0000bb\">0</span><span lang=\"NL\" style=\"color:#007700\">;\r\n</span></code><span lang=\"NL\" style=\"color:#007700\"><br>\r\n<code>&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;</code></span><code><span lang=\"NL\" style=\"color:#0000bb\">$_endRow&nbsp;\r\n</span><span lang=\"NL\" style=\"color:#007700\">=&nbsp;</span><span lang=\"NL\" style=\"color:#0000bb\">0</span><span lang=\"NL\" style=\"color:#007700\">;\r\n</span></code><span lang=\"NL\" style=\"color:#007700\"><br>\r\n<br>\r\n<code>&nbsp;&nbsp;&nbsp;&nbsp;</code></span><code><span lang=\"NL\" style=\"color:#ff8000\">/**&nbsp;&nbsp;Set&nbsp;the&nbsp;list&nbsp;of&nbsp;rows&nbsp;that&nbsp;we&nbsp;want&nbsp;to&nbsp;read&nbsp;&nbsp;*/\r\n</span></code><span lang=\"NL\" style=\"color:#ff8000\"><br>\r\n<code>&nbsp;&nbsp;&nbsp;&nbsp;</code></span><code><span lang=\"NL\" style=\"color:#007700\">public&nbsp;function&nbsp;</span><span lang=\"NL\" style=\"color:#0000bb\">setRows</span><span lang=\"NL\" style=\"color:#007700\">(</span><span lang=\"NL\" style=\"color:#0000bb\">$startRow</span><span lang=\"NL\" style=\"color:#007700\">,&nbsp;</span><span lang=\"NL\" style=\"color:#0000bb\">$chunkSize</span><span lang=\"NL\" style=\"color:#007700\">)&nbsp;{\r\n</span></code><span lang=\"NL\" style=\"color:#007700\"><br>\r\n<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code></span><code><span lang=\"NL\" style=\"color:#0000bb\">$this</span><span lang=\"NL\" style=\"color:#007700\">-&gt;</span><span lang=\"NL\" style=\"color:#0000bb\">_startRow&nbsp;</span><span lang=\"NL\" style=\"color:#007700\">=&nbsp;</span><span lang=\"NL\" style=\"color:#0000bb\">$startRow</span><span lang=\"NL\" style=\"color:#007700\">;\r\n</span></code><span lang=\"NL\" style=\"color:#007700\"><br>\r\n<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code></span><code><span lang=\"NL\" style=\"color:#0000bb\">$this</span><span lang=\"NL\" style=\"color:#007700\">-&gt;</span><span lang=\"NL\" style=\"color:#0000bb\">_endRow&nbsp;&nbsp;&nbsp;</span><span lang=\"NL\" style=\"color:#007700\">=&nbsp;</span><span lang=\"NL\" style=\"color:#0000bb\">$startRow&nbsp;</span><span lang=\"NL\" style=\"color:#007700\">&#43;&nbsp;</span><span lang=\"NL\" style=\"color:#0000bb\">$chunkSize</span><span lang=\"NL\" style=\"color:#007700\">;\r\n</span></code><span lang=\"NL\" style=\"color:#007700\"><br>\r\n<code>&nbsp;&nbsp;&nbsp;&nbsp;} </code><br>\r\n<br>\r\n<code>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;</code></span><code><span lang=\"NL\" style=\"color:#0000bb\">readCell</span><span lang=\"NL\" style=\"color:#007700\">(</span><span lang=\"NL\" style=\"color:#0000bb\">$column</span><span lang=\"NL\" style=\"color:#007700\">,&nbsp;</span><span lang=\"NL\" style=\"color:#0000bb\">$row</span><span lang=\"NL\" style=\"color:#007700\">,&nbsp;</span><span lang=\"NL\" style=\"color:#0000bb\">$worksheetName&nbsp;</span><span lang=\"NL\" style=\"color:#007700\">=&nbsp;</span><span lang=\"NL\" style=\"color:#dd0000\">''</span><span lang=\"NL\" style=\"color:#007700\">)&nbsp;{\r\n</span></code><span lang=\"NL\" style=\"color:#007700\"><br>\r\n<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code></span><code><span lang=\"NL\" style=\"color:#ff8000\">//&nbsp;&nbsp;Only&nbsp;read&nbsp;the&nbsp;heading&nbsp;row,&nbsp;and&nbsp;the&nbsp;configured rows\r\n</span></code><span lang=\"NL\" style=\"color:#ff8000\"><br>\r\n<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code></span><code><span lang=\"NL\" style=\"color:#007700\">if&nbsp;((</span><span lang=\"NL\" style=\"color:#0000bb\">$row&nbsp;</span><span lang=\"NL\" style=\"color:#007700\">==&nbsp;</span><span lang=\"NL\" style=\"color:#0000bb\">1</span><span lang=\"NL\" style=\"color:#007700\">)&nbsp;||</span></code></p>\r\n<div>\r\n<p><code><span lang=\"NL\" style=\"color:#007700\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (</span><span lang=\"NL\" style=\"color:#0000bb\">$row&nbsp;</span><span lang=\"NL\" style=\"color:#007700\">&gt;=&nbsp;</span><span lang=\"NL\" style=\"color:#0000bb\">$this</span><span lang=\"NL\" style=\"color:#007700\">-&gt;</span><span lang=\"NL\" style=\"color:#0000bb\">_startRow&nbsp;</span><span lang=\"NL\" style=\"color:#007700\">&amp;&amp;&nbsp;</span><span lang=\"NL\" style=\"color:#0000bb\">$row&nbsp;</span><span lang=\"NL\" style=\"color:#007700\">&lt;&nbsp;</span><span lang=\"NL\" style=\"color:#0000bb\">$this</span><span lang=\"NL\" style=\"color:#007700\">-&gt;</span><span lang=\"NL\" style=\"color:#0000bb\">_endRow</span><span lang=\"NL\" style=\"color:#007700\">))&nbsp;{\r\n</span></code><span lang=\"NL\" style=\"color:#007700\"><br>\r\n<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</code></span><code><span lang=\"NL\" style=\"color:#0000bb\">true</span><span lang=\"NL\" style=\"color:#007700\">;\r\n</span></code><span lang=\"NL\" style=\"color:#007700\"><br>\r\n<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} </code><br>\r\n<code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</code></span><code><span lang=\"NL\" style=\"color:#0000bb\">false</span><span lang=\"NL\" style=\"color:#007700\">;\r\n</span></code><span lang=\"NL\" style=\"color:#007700\"><br>\r\n<code>&nbsp;&nbsp;&nbsp;&nbsp;} </code><br>\r\n<code>} </code><br>\r\n<br>\r\n<br>\r\n</span><code><span lang=\"NL\" style=\"color:#ff8000\">/**&nbsp;&nbsp;Create&nbsp;a&nbsp;new&nbsp;Reader&nbsp;of&nbsp;the&nbsp;type&nbsp;defined&nbsp;in&nbsp;$inputFileType&nbsp;&nbsp;**/\r\n</span></code><span lang=\"NL\" style=\"color:#ff8000\"><br>\r\n</span><code><span lang=\"NL\" style=\"color:#0000bb\">$objReader&nbsp;</span><span lang=\"NL\" style=\"color:#007700\">=&nbsp;</span><span lang=\"NL\" style=\"color:#0000bb\">PHPExcel_IOFactory</span><span lang=\"NL\" style=\"color:#007700\">::</span><span lang=\"NL\" style=\"color:#0000bb\">createReader</span><span lang=\"NL\" style=\"color:#007700\">(</span><span lang=\"NL\" style=\"color:#0000bb\">$inputFileType</span><span lang=\"NL\" style=\"color:#007700\">);\r\n</span></code><span lang=\"NL\" style=\"color:#007700\"><br>\r\n<br>\r\n<br>\r\n</span><code><span lang=\"NL\" style=\"color:#ff8000\">/**&nbsp;&nbsp;Define&nbsp;how&nbsp;many&nbsp;rows&nbsp;we&nbsp;want&nbsp;to&nbsp;read&nbsp;for&nbsp;each&nbsp;&quot;chunk&quot;&nbsp;&nbsp;**/\r\n</span></code><span lang=\"NL\" style=\"color:#ff8000\"><br>\r\n</span><code><span lang=\"NL\" style=\"color:#0000bb\">$chunkSize&nbsp;</span><span lang=\"NL\" style=\"color:#007700\">=&nbsp;</span><span lang=\"NL\" style=\"color:#0000bb\">2048</span><span lang=\"NL\" style=\"color:#007700\">;\r\n</span></code><span lang=\"NL\" style=\"color:#007700\"><br>\r\n</span><code><span lang=\"NL\" style=\"color:#ff8000\">/**&nbsp;&nbsp;Create&nbsp;a&nbsp;new&nbsp;Instance&nbsp;of&nbsp;our&nbsp;Read&nbsp;Filter&nbsp;&nbsp;**/\r\n</span></code><span lang=\"NL\" style=\"color:#ff8000\"><br>\r\n</span><code><span lang=\"NL\" style=\"color:#0000bb\">$chunkFilter&nbsp;</span><span lang=\"NL\" style=\"color:#007700\">=&nbsp;new&nbsp;</span><span lang=\"NL\" style=\"color:#0000bb\">chunkReadFilter</span><span lang=\"NL\" style=\"color:#007700\">();\r\n</span></code><span lang=\"NL\" style=\"color:#007700\"><br>\r\n<br>\r\n</span><code><span lang=\"NL\" style=\"color:#ff8000\">/**&nbsp;&nbsp;Tell&nbsp;the&nbsp;Reader&nbsp;that&nbsp;we&nbsp;want&nbsp;to&nbsp;use&nbsp;the&nbsp;Read&nbsp;Filter&nbsp;&nbsp;**/\r\n</span></code><span lang=\"NL\" style=\"color:#ff8000\"><br>\r\n</span><code><span lang=\"NL\" style=\"color:#0000bb\">$objReader</span><span lang=\"NL\" style=\"color:#007700\">-&gt;</span><span lang=\"NL\" style=\"color:#0000bb\">setReadFilter</span><span lang=\"NL\" style=\"color:#007700\">(</span><span lang=\"NL\" style=\"color:#0000bb\">$chunkFilter</span><span lang=\"NL\" style=\"color:#007700\">);\r\n</span></code><span lang=\"NL\" style=\"color:#007700\"><br>\r\n<br>\r\n</span><code><span lang=\"NL\" style=\"color:#ff8000\">/**&nbsp;&nbsp;Loop&nbsp;to&nbsp;read&nbsp;our&nbsp;worksheet&nbsp;in&nbsp;&quot;chunk&nbsp;size&quot;&nbsp;blocks&nbsp;&nbsp;**/\r\n</span></code><span lang=\"NL\" style=\"color:#ff8000\"><br>\r\n</span><code><span lang=\"NL\" style=\"color:#007700\">for&nbsp;(</span><span lang=\"NL\" style=\"color:#0000bb\">$startRow&nbsp;</span><span lang=\"NL\" style=\"color:#007700\">=&nbsp;</span><span lang=\"NL\" style=\"color:#0000bb\">2</span><span lang=\"NL\" style=\"color:#007700\">;&nbsp;</span><span lang=\"NL\" style=\"color:#0000bb\">$startRow&nbsp;</span><span lang=\"NL\" style=\"color:#007700\">&lt;=&nbsp;</span><span lang=\"NL\" style=\"color:#0000bb\">65536</span><span lang=\"NL\" style=\"color:#007700\">;&nbsp;</span><span lang=\"NL\" style=\"color:#0000bb\">$startRow&nbsp;</span><span lang=\"NL\" style=\"color:#007700\">&#43;=&nbsp;</span><span lang=\"NL\" style=\"color:#0000bb\">$chunkSize</span><span lang=\"NL\" style=\"color:#007700\">)&nbsp;{\r\n</span></code><span lang=\"NL\" style=\"color:#007700\"><br>\r\n<code>&nbsp;&nbsp;&nbsp;&nbsp;</code></span><code><span lang=\"NL\" style=\"color:#ff8000\">/**&nbsp;&nbsp;Tell&nbsp;the&nbsp;Read&nbsp;Filter&nbsp;which&nbsp;rows&nbsp;we&nbsp;want&nbsp;this&nbsp;iteration&nbsp;&nbsp;**/\r\n</span></code><span lang=\"NL\" style=\"color:#ff8000\"><br>\r\n<code>&nbsp;&nbsp;&nbsp;&nbsp;</code></span><code><span lang=\"NL\" style=\"color:#0000bb\">$chunkFilter</span><span lang=\"NL\" style=\"color:#007700\">-&gt;</span><span lang=\"NL\" style=\"color:#0000bb\">setRows</span><span lang=\"NL\" style=\"color:#007700\">(</span><span lang=\"NL\" style=\"color:#0000bb\">$startRow</span><span lang=\"NL\" style=\"color:#007700\">,</span><span lang=\"NL\" style=\"color:#0000bb\">$chunkSize</span><span lang=\"NL\" style=\"color:#007700\">);\r\n</span></code><span lang=\"NL\" style=\"color:#007700\"><br>\r\n<code>&nbsp;&nbsp;&nbsp;&nbsp;</code></span><code><span lang=\"NL\" style=\"color:#ff8000\">/**&nbsp;&nbsp;Load&nbsp;only&nbsp;the&nbsp;rows&nbsp;that&nbsp;match&nbsp;our&nbsp;filter&nbsp;&nbsp;**/\r\n</span></code><span lang=\"NL\" style=\"color:#ff8000\"><br>\r\n<code>&nbsp;&nbsp;&nbsp;&nbsp;</code></span><code><span lang=\"NL\" style=\"color:#0000bb\">$objPHPExcel&nbsp;</span><span lang=\"NL\" style=\"color:#007700\">=&nbsp;</span><span lang=\"NL\" style=\"color:#0000bb\">$objReader</span><span lang=\"NL\" style=\"color:#007700\">-&gt;</span><span lang=\"NL\" style=\"color:#0000bb\">load</span><span lang=\"NL\" style=\"color:#007700\">(</span><span lang=\"NL\" style=\"color:#0000bb\">$inputFileName</span><span lang=\"NL\" style=\"color:#007700\">);\r\n</span></code><span lang=\"NL\" style=\"color:#007700\"><br>\r\n<code>&nbsp;&nbsp;&nbsp;&nbsp;</code></span><code><span lang=\"NL\" style=\"color:#ff8000\">//&nbsp;&nbsp;&nbsp;&nbsp;Do&nbsp;some&nbsp;processing&nbsp;here\r\n</span></code><span lang=\"NL\" style=\"color:#ff8000\"><br>\r\n</span><code><span lang=\"NL\" style=\"color:#007700\">} </span></code><span lang=\"NL\" style=\"color:#007700\"><br>\r\n<br>\r\n</span></p>\r\n</div>\r\n",
    "PostedDate": "2010-11-17T00:52:28.523-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "525415",
    "ThreadId": "234319",
    "Html": "\r\n<blockquote style=\"border:solid .1em #ccc; font-style:italic; margin:.25em 1em 0 1em; padding:0 .25em 0 .25em\">\r\n<strong>MarkBaker wrote:</strong><br>\r\n<blockquote style=\"border:solid .1em #ccc; font-style:italic; margin:.25em 1em 0 1em; padding:0 .25em 0 .25em\">\r\n<strong>MrBaseball34 wrote:</strong><br>\r\n<p>210,000 cells?&nbsp;&nbsp; 15187*5=75935, how do you calculate that?</p>\r\n</blockquote>\r\n<p>&nbsp;The first workbook that you uploaded (40000 in-stock line items update 2010 NOV&nbsp; 8TH.xls) was 41846 rows by 5 columns... which is 209,230 cells</p>\r\n</blockquote>\r\n<p>But even the second one gets the error message.</p>\r\n<p>&nbsp;</p>\r\n<p>Where you say &quot;// Do some processing here&quot; that is where I would save the CSV and then outside the loop concatenate them?</p>\r\n",
    "PostedDate": "2010-11-22T10:27:06.41-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "550589",
    "ThreadId": "234319",
    "Html": "\r\n<p>Hi everybody,</p>\r\n<p>I'm very new in PHP and PHPExcel, but it works great.</p>\r\n<p>I'am just having a problem in saving CSV files : when a cell is empty, the separator (TAB) is not written into the text line.</p>\r\n<p>How can I modify this (using a preference command ?)</p>\r\n<p>Thanks for your answers.</p>\r\n",
    "PostedDate": "2011-01-17T07:49:54.767-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1263637",
    "ThreadId": "234319",
    "Html": "Hello!!<br />\nI'm trying to do almost same thing but i got a writing error.<br />\nI have a file in xls and try to update it and saving it in CSV, so here my stuff:<br />\n<pre><code>$inputFileName = &quot;files/base.xls&quot;;\n$inputFileType = PHPExcel_IOFactory::identify($inputFileName);\n$filename = &quot;base_&quot;.date(&quot;Y_m_d_H_i_s&quot;).&quot;_&quot;.$_SESSION[&quot;numcom&quot;].&quot;_export&quot;;\n\n$objReader = PHPExcel_IOFactory::createReader($inputFileType);\n$objPHPExcel = $objReader-&gt;load($inputFileName);\n\n$sheet = $objPHPExcel-&gt;getActiveSheet();\n\n//Doing some stuff here adding lot of data\n\n$outputFileType = 'CSV';\n    $objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, $outputFileType);\n    $objWriter-&gt;setDelimiter(&quot;\\t&quot;);\n    $objWriter-&gt;setSheetIndex(0);\n    $outputFileName = $filename.&quot;.csv&quot;;\n    $objWriter-&gt;save(dirname(__FILE__) . &quot;/files/updated/&quot;.$outputFileName);\n</code></pre>\n\nEvry folder is in 777 and here my error:<br />\n<pre><code>Warning: fopen(/var/www/html/gestionv4/dov/files/updated/{filename}.csv): failed to open stream: Permission denied in /var/www/html/gestionv4/classes/PHPExcel/Writer/CSV.php on line 118</code></pre>\n\njust for info i remplace the real name by {filename} <br />\nAny idea if i missing some step?<br />\n",
    "PostedDate": "2014-07-08T06:10:49.823-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1263643",
    "ThreadId": "234319",
    "Html": "Solved\r<br />\nJust need use of absolute path $_SERVER['DOCUMENT_ROOT'] and worked like a charm<br />\n",
    "PostedDate": "2014-07-08T06:38:07.35-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]