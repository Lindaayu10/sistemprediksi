[
  {
    "Id": "428768",
    "ThreadId": "208698",
    "Html": "<p>Hi,</p>\r\n<p>&nbsp; I have an invoice with 3500 lines. When I generate the xls file, the program expire and send me an error saying that it expire. I'm kind of surprise that it takes that long to generate 3600 lines.</p>\r\n<p>&nbsp;Any idea how I can get around that problem ?</p>\r\n<p>Also, I want to create an excel sheet without opening excel, is it possible ?</p>\r\n<p>Thanks</p>\r\n<p>Real</p>",
    "PostedDate": "2010-04-08T05:48:45.797-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "429048",
    "ThreadId": "208698",
    "Html": "<p>realdrouin,</p>\r\n<p>There are many potential reasons why it could be taking so long to generate the lines...</p>\r\n<p>How are you populating the data? How are you iterating line by line and/or cell by cell? With no code snippets, it could be anything!</p>\r\n<p>What do you mean you want to create an Excel sheet without opening it?</p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2010-04-08T17:57:17.463-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "429051",
    "ThreadId": "208698",
    "Html": "<p>Here is the code</p>\r\n<p>&nbsp;</p>\r\n<p>$query = &quot;SELECT * FROM SMtbl_Invoice_details WHERE invoicenumber='&quot;.$_REQUEST[&quot;invoice&quot;].&quot;' ORDER BY state, city&quot;; <br>&nbsp; $result=odbc_exec($conn, $query); <br>&nbsp; <br>&nbsp; while(odbc_fetch_row($result)) <br>&nbsp; { &nbsp;<br>&nbsp;&nbsp;&nbsp; $line = $line + 1;<br>&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;&nbsp; $hours = fntonbr(odbc_result($result,&quot;HoursBilled&quot;));<br>&nbsp;&nbsp;&nbsp; if ($hours == 0) $hours = fntonbr(odbc_result($result,&quot;MonthsBilled&quot;));<br>&nbsp;<br>&nbsp;&nbsp;&nbsp; $rate = fntonbr(odbc_result($result,&quot;ServiceHourly&quot;));<br>&nbsp;&nbsp;&nbsp; if ($rate == 0) $rate = fntonbr(odbc_result($result,&quot;ServiceMonthly&quot;));&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;&nbsp; $objPHPExcel-&gt;setActiveSheetIndex(0)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -&gt;setCellValue('A'.$line, odbc_result($result,&quot;storenumber&quot;))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -&gt;setCellValue('B'.$line, trim(odbc_result($result,&quot;city&quot;)).&quot;, &quot;.trim(odbc_result($result,&quot;state&quot;))) <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -&gt;setCellValue('C'.$line, fndate(odbc_result($result,&quot;ServiceDate&quot;)))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -&gt;setCellValue('D'.$line, odbc_result($result,&quot;DisplayBillName&quot;))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -&gt;setCellValue('E'.$line, $hours)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -&gt;setCellValue('F'.$line, $rate)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -&gt;setCellValue('G'.$line, odbc_result($result,&quot;LineServiceAmount&quot;))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -&gt;setCellValue('H'.$line, odbc_result($result,&quot;LineSalesTaxAmount&quot;))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -&gt;setCellValue('I'.$line, odbc_result($result,&quot;LineTotalAmount&quot;));&nbsp;&nbsp; <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;&nbsp; $tot1 = $tot1 + $hours;<br>&nbsp;&nbsp;&nbsp; $tot2 = $tot2 + odbc_result($result,&quot;LineServiceAmount&quot;);<br>&nbsp;&nbsp;&nbsp; $tot3 = $tot3 + odbc_result($result,&quot;LineSalesTaxAmount&quot;);<br>&nbsp;&nbsp;&nbsp; $tot4 = $tot4 + odbc_result($result,&quot;LineTotalAmount&quot;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>\r\n<p>&nbsp; }</p>\r\n<p>&nbsp; $line = $line + 1;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>&nbsp; $objPHPExcel-&gt;getActiveSheet(0)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -&gt;setCellValue('D'.$line, &quot;TOTAL:&quot;)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -&gt;setCellValue('E'.$line, $tot1)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -&gt;setCellValue('G'.$line, $tot2)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -&gt;setCellValue('H'.$line, $tot3)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -&gt;setCellValue('I'.$line, $tot4); <br>&nbsp; $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('D'.$line)-&gt;getAlignment()-&gt;setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_RIGHT);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>&nbsp; $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('D'.$line.':I'.$line)-&gt;getFont()-&gt;setBold(true);</p>\r\n<p>&nbsp; $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('F2:I'.$line)-&gt;getNumberFormat()-&gt;setFormatCode(PHPExcel_Style_NumberFormat::FORMAT_CURRENCY_USD_SIMPLE);</p>\r\n<p>&nbsp; $objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension('A')-&gt;setWidth(8);<br>&nbsp; $objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension('B')-&gt;setWidth(25);<br>&nbsp; $objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension('C')-&gt;setWidth(13);&nbsp; <br>&nbsp; $objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension('D')-&gt;setWidth(15);<br>&nbsp; $objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension('E')-&gt;setWidth(5);<br>&nbsp; $objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension('F')-&gt;setWidth(15);<br>&nbsp; $objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension('G')-&gt;setWidth(10);<br>&nbsp; $objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension('H')-&gt;setWidth(10);<br>&nbsp; $objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension('I')-&gt;setWidth(10);&nbsp;</p>\r\n<p>&nbsp; $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('A1')-&gt;getAlignment()-&gt;setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_RIGHT);&nbsp; <br>&nbsp; $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle('E1:I1')-&gt;getAlignment()-&gt;setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_RIGHT);&nbsp; <br>&nbsp;&nbsp;&nbsp; <br>$invoicenumber = 'inv '.$invdate.' '.$custname.' '.$billname.'.xls';</p>\r\n<p>//$invoicenumber = 'inv.xls';&nbsp;&nbsp;&nbsp;&nbsp; <br>// Redirect output to a client&rsquo;s web browser (Excel5)<br>header('Content-Type: application/vnd.ms-excel');<br>header('Content-Disposition: attachment;filename=&quot;'.$invoicenumber.'&quot;');<br>header('Cache-Control: max-age=0');</p>\r\n<p>$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, 'Excel5');<br>$objWriter-&gt;save('php://output');</p>",
    "PostedDate": "2010-04-08T18:04:31.403-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "429055",
    "ThreadId": "208698",
    "Html": "<p>About creating an excel sheet without opening it, well I have a &quot;strange&quot; user (he's 71). He wants the new system to be indentical to the current one...</p>\r\n<p>In the current application, he is entering the data in a Foxpro application. When he is done entering the data, he click on generate, the program leave and go back to the main menu. However before going back to the main menu, he must wait for the application to generate the excel sheet.</p>\r\n<p>Then he go to excel and open the newly created file.</p>\r\n<p>I told him that the new program will generate the excel sheet and open it in excel. He doesn't want that. He doesn't want to be force to go in excel. He wants to start himself excel and option the file. That annoy me but he is paying, so I cannot change him.</p>\r\n<p>Therefore, how can I create an excel sheet, without opening excel ? Can I save automatically the excel sheet&nbsp; or something like that</p>\r\n<p>Thanks</p>\r\n<p>Real</p>",
    "PostedDate": "2010-04-08T18:13:00.197-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]