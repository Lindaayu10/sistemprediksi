[
  {
    "Id": "967331",
    "ThreadId": "415196",
    "Html": "\r\n<p>Also posted on CodeReview:&nbsp;http://codereview.stackexchange.com/questions/19866/phpexcel-throwing-error</p>\r\n<p>PHPExcel 1.7.8<br>\r\nPHP v5.3.10</p>\r\n<p>I'm trying to use PHPExcel, and it's throwing an error for even the most basic things, and even for a script copied from somewhere (&nbsp;<a rel=\"nofollow\" href=\"http://blog.clock.co.uk/phpexcel-example/\">http://blog.clock.co.uk/phpexcel-example/</a>&nbsp;).</p>\r\n<pre><code><span><span> </span><span>/&gt;</span><span>\r\n</span><span><b></span><span>Warning</span><span></b></span><span>:  Invalid argument supplied for foreach() in </span><span><b></span><span>/home/.../public_html/pear/PEAR/PHPExcel/PHPExcel/Calculation.php</span><span></b></span><span> on line </span><span><b></span><span>1685</span><span></b><span> </span><span>/&gt;</span></code></pre>\r\n<p>The outputted file has this as the very top of the file, for which Excel (or Open Office) says is not a valid file. If I remove those two lines, everything is fine and Excel (or OO) can open it with no problems and everything the script does is there.</p>\r\n<p>Calculation.php line 1685:</p>\r\n<pre><code><span>foreach</span><span> </span><span>(</span><span>glob</span><span>(</span><span>$localeFileDirectory</span><span>.</span><span class=\"str\">'/*'</span><span>,</span><span>GLOB_ONLYDIR</span><span>)</span><span> </span><span>as</span><span> $filename</span><span>)</span><span> </span><span>{</span></code></pre>\r\n<p>And the function it is in:</p>\r\n<pre><code><span>private</span><span> </span><span>function</span><span> __construct</span><span>()</span><span> </span><span>{</span><span>\r\n    $localeFileDirectory </span><span>=</span><span> PHPEXCEL_ROOT</span><span>.</span><span class=\"str\">'PHPExcel/locale/'</span><span>;</span><span>\r\n    </span><span>foreach</span><span> </span><span>(</span><span>glob</span><span>(</span><span>$localeFileDirectory</span><span>.</span><span class=\"str\">'/*'</span><span>,</span><span>GLOB_ONLYDIR</span><span>)</span><span> </span><span>as</span><span> $filename</span><span>)</span><span> </span><span>{</span><span>\r\n        $filename </span><span>=</span><span> substr</span><span>(</span><span>$filename</span><span>,</span><span>strlen</span><span>(</span><span>$localeFileDirectory</span><span>)&#43;</span><span>1</span><span>);</span><span>\r\n        </span><span>if</span><span> </span><span>(</span><span>$filename </span><span>!=</span><span> </span><span class=\"str\">'en'</span><span>)</span><span> </span><span>{</span><span>\r\n            </span><span>self</span><span>::</span><span>$_validLocaleLanguages</span><span>[]</span><span> </span><span>=</span><span> $filename</span><span>;</span><span>\r\n        </span><span>}</span><span>\r\n    </span><span>}</span><span>\r\n\r\n    $setPrecision </span><span>=</span><span> </span><span>(</span><span>PHP_INT_SIZE </span><span>==</span><span> </span><span>4</span><span>)</span><span> </span><span>?</span><span> </span><span>12</span><span> </span><span>:</span><span> </span><span>16</span><span>;</span><span>\r\n    $this</span><span>-&gt;</span><span>_savedPrecision </span><span>=</span><span> ini_get</span><span>(</span><span class=\"str\">'precision'</span><span>);</span><span>\r\n    </span><span>if</span><span> </span><span>(</span><span>$this</span><span>-&gt;</span><span>_savedPrecision </span><span>&lt;</span><span> $setPrecision</span><span>)</span><span> </span><span>{</span><span>\r\n        ini_set</span><span>(</span><span class=\"str\">'precision'</span><span>,</span><span>$setPrecision</span><span>);</span><span>\r\n    </span><span>}</span><span>\r\n</span><span>}</span><span>   </span><span>//  function __construct()</span></code></pre>\r\n<p>I installed PHPExcel via PEAR.</p>\r\n<p>I didn't see a &quot;locale&quot; directory anywhere in the PHPExcel setup, so I tried creating it but still have the same problem.</p>\r\n<p>I'm not setting or using a locale feature.</p>\r\n</span></span>",
    "PostedDate": "2012-12-21T20:33:46.887-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]