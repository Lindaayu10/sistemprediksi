[
  {
    "Id": "248677",
    "ThreadId": "72811",
    "Html": "<p>I have a really complicated spreadsheet (which I think PHPExcel should be fine with). Formulas reference cells in other worksheets within the same excel file. I have two questions:</p>\r\n<p>1) Will PHPExcel support formulas referencing cells in other worksheets?<br>2) Please help with the following code, I don't get the actual values in the cells.</p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre>&lt;?php\r\n    <span style=\"color:Blue\">require_once</span>(<span style=\"color:#A31515\">&quot;../phpexcel/Classes/PHPExcel.php&quot;</span>);\r\n    <span style=\"color:Blue\">require_once</span>(<span style=\"color:#A31515\">'../phpexcel/Classes/PHPExcel/IOFactory.php'</span>);\r\n \r\n    $objPHPExcel = PHPExcel_IOFactory::load(<span style=\"color:#A31515\">&quot;quote.xls&quot;</span>);\r\n    $objPHPExcel-&gt;setActiveSheetIndex(1);\r\n\r\n    <span style=\"color:Blue\">echo</span> <span style=\"color:#A31515\">&quot;Calculated Values&lt;BR&gt;&quot;</span>;    \r\n    <span style=\"color:Blue\">echo</span> $objPHPExcel-&gt;getSheetByName(<span style=\"color:#A31515\">'Resident Paysht'</span>)-&gt;getCell(<span style=\"color:#A31515\">'F27'</span>)-&gt;getCalculatedValue().<span style=\"color:#A31515\">&quot;&lt;BR&gt;&quot;</span>;\r\n    <span style=\"color:Blue\">echo</span> $objPHPExcel-&gt;getSheetByName(<span style=\"color:#A31515\">'Resident Paysht'</span>)-&gt;getCell(<span style=\"color:#A31515\">'F21'</span>)-&gt;getCalculatedValue().<span style=\"color:#A31515\">&quot;&lt;BR&gt;&quot;</span>;\r\n    <span style=\"color:Blue\">echo</span> <span style=\"color:#A31515\">&quot;Done &lt;BR&gt;&quot;</span>;\r\n\r\n    <span style=\"color:Blue\">echo</span> <span style=\"color:#A31515\">&quot;&lt;BR&gt;Formulas&lt;BR&gt;&quot;</span>;\r\n    <span style=\"color:Blue\">echo</span> $objPHPExcel-&gt;getSheetByName(<span style=\"color:#A31515\">'Resident Paysht'</span>)-&gt;getCell(<span style=\"color:#A31515\">'F27'</span>)-&gt;getValue().<span style=\"color:#A31515\">&quot;&lt;BR&gt;&quot;</span>;\r\n    <span style=\"color:Blue\">echo</span> $objPHPExcel-&gt;getSheetByName(<span style=\"color:#A31515\">'Resident Paysht'</span>)-&gt;getCell(<span style=\"color:#A31515\">'F21'</span>)-&gt;getValue().<span style=\"color:#A31515\">&quot;&lt;BR&gt;&quot;</span>;\r\n    <span style=\"color:Blue\">echo</span> <span style=\"color:#A31515\">&quot;Done &lt;BR&gt;&quot;</span>;\r\n?&gt;\r\n</pre>\r\n</div>\r\n<p>&nbsp;</p>\r\n<p><strong>Output:</strong></p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre>Calculated Values\r\n#N/A\r\n#N/A\r\nDone \r\n\r\nFormulas\r\n=+F25+F21+F11\r\n=F18-F19-F20\r\nDone \r\n</pre>\r\n</div>\r\n<p><strong>Expected:<br></strong></p>\r\n<p><strong>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre>Calculated Values\r\n300\r\n200\r\nDone \r\n\r\nFormulas\r\n=+F25+F21+F11\r\n=F18-F19-F20\r\nDone \r\n</pre>\r\n</div>\r\n</strong></p>\r\n<p>Please note the 300 and 200 being shown. These are actual values that are set by default on load of the spreadsheet and calculated. Please help. I am a newbie with PHPExcel. I previously used COM based solution which works. I am moving to this and I am stuck!</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\">&nbsp;&nbsp; &nbsp;$objPHPExcel = PHPExcel_IOFactory::load(&quot;quote.xls&quot;);</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\">&nbsp;&nbsp; &nbsp;$objPHPExcel-&gt;setActiveSheetIndex(1);</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\">&nbsp;&nbsp; &nbsp;</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\">&nbsp;&nbsp; &nbsp;echo $objPHPExcel-&gt;getSheetByName('Intro.')-&gt;getCell('C7')-&gt;getCalculatedValue();</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\">&nbsp;&nbsp; &nbsp;echo &quot;&lt;BR&gt;Inserting....&lt;BR&gt;&quot;;</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\">&nbsp;&nbsp; &nbsp;//$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(&quot;C7&quot;,30);</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\">&nbsp;&nbsp; &nbsp;//$objPHPExcel-&gt;setActiveSheetIndex(7); &nbsp; &nbsp;</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\">&nbsp;&nbsp; &nbsp;echo $objPHPExcel-&gt;getSheetByName('Resident Paysht')-&gt;getCell('F27')-&gt;getCalculatedValue();</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\">&nbsp;&nbsp; &nbsp;echo $objPHPExcel-&gt;getSheetByName('Resident Paysht')-&gt;getCell('F21')-&gt;getCalculatedValue();</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\">&nbsp;&nbsp; &nbsp;echo $objPHPExcel-&gt;getSheetByName('Resident Paysht')-&gt;getCell('I27')-&gt;getCalculatedValue(); &nbsp; &nbsp;</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\">&nbsp;&nbsp; &nbsp;echo &quot;DoneI am</div>",
    "PostedDate": "2009-10-22T10:34:46.257-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "248706",
    "ThreadId": "72811",
    "Html": "<p><em>1) Will PHPExcel support formulas referencing cells in other worksheets?</em></p>\r\n<p>It is supposed to support this already. If not, it could be a bug? Can you try to test using latest source code:</p>\r\n<p><a href=\"http://phpexcel.codeplex.com/SourceControl/ListDownloadableCommits.aspx\">http://phpexcel.codeplex.com/SourceControl/ListDownloadableCommits.aspx</a></p>\r\n<p><br><em>2) Please help with the following code, I don't get the actual values in the cells.</em></p>\r\n<p>It could be a bug. Can you try to upload the file quote.xls so we can check. You can upload the file here:</p>\r\n<p><a href=\"http://phpexcel.codeplex.com/WorkItem/View.aspx?WorkItemId=10749\">http://phpexcel.codeplex.com/WorkItem/View.aspx?WorkItemId=10749</a></p>",
    "PostedDate": "2009-10-22T11:24:59.233-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "248946",
    "ThreadId": "72811",
    "Html": "<p>Thanks Koyama for your input. I think I found a bug. As you can see in my code above. My sheet has a space. I dont think PHPExcel likes spaces in Sheet Names. I have uploaded a sample Excel file to the link and also put the code here.</p>\r\n<p>&nbsp;</p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre>&lt;?php\r\n\r\n    <span style=\"color:Blue\">require_once</span>(<span style=\"color:#A31515\">&quot;../phpexcel/Classes/PHPExcel.php&quot;</span>);\r\n    <span style=\"color:Blue\">require_once</span>(<span style=\"color:#A31515\">'../phpexcel/Classes/PHPExcel/IOFactory.php'</span>);\r\n\r\n    $objPHPExcel = PHPExcel_IOFactory::load(<span style=\"color:#A31515\">&quot;quoteroh.xls&quot;</span>);\r\n    $objPHPExcel-&gt;setActiveSheetIndex(1);\r\n\r\n    $objPHPExcel-&gt;getSheetByName(<span style=\"color:#A31515\">'Sheet 1'</span>)-&gt;setCellValue(<span style=\"color:#A31515\">'B1'</span>,<span style=\"color:#A31515\">'30'</span>);\r\n\r\n    <span style=\"color:Blue\">echo</span> <span style=\"color:#A31515\">&quot;Calculated Values&lt;BR&gt;&quot;</span>;    \r\n    <span style=\"color:Blue\">echo</span> $objPHPExcel-&gt;getSheetByName(<span style=\"color:#A31515\">'Sheet 2'</span>)-&gt;getCell(<span style=\"color:#A31515\">'B1'</span>)-&gt;getCalculatedValue().<span style=\"color:#A31515\">&quot;&lt;BR&gt;&quot;</span>;\r\n    <span style=\"color:Blue\">echo</span> $objPHPExcel-&gt;getSheetByName(<span style=\"color:#A31515\">'Sheet 2'</span>)-&gt;getCell(<span style=\"color:#A31515\">'B2'</span>)-&gt;getCalculatedValue().<span style=\"color:#A31515\">&quot;&lt;BR&gt;&quot;</span>;\r\n    <span style=\"color:Blue\">echo</span> <span style=\"color:#A31515\">&quot;Done &lt;BR&gt;&quot;</span>;\r\n\r\n    <span style=\"color:Blue\">echo</span> <span style=\"color:#A31515\">&quot;&lt;BR&gt;Formulas&lt;BR&gt;&quot;</span>;\r\n    <span style=\"color:Blue\">echo</span> $objPHPExcel-&gt;getSheetByName(<span style=\"color:#A31515\">'Sheet 2'</span>)-&gt;getCell(<span style=\"color:#A31515\">'B1'</span>)-&gt;getValue().<span style=\"color:#A31515\">&quot;&lt;BR&gt;&quot;</span>;\r\n    <span style=\"color:Blue\">echo</span> $objPHPExcel-&gt;getSheetByName(<span style=\"color:#A31515\">'Sheet 2'</span>)-&gt;getCell(<span style=\"color:#A31515\">'B2'</span>)-&gt;getValue().<span style=\"color:#A31515\">&quot;&lt;BR&gt;&quot;</span>;\r\n    <span style=\"color:Blue\">echo</span> <span style=\"color:#A31515\">&quot;Done &lt;BR&gt;&quot;</span>;      \r\n        \r\n?&gt;\r\n</pre>\r\n</div>\r\n<p>The output is&nbsp;<br>Calculated Values<br>#VALUE!<br>#VALUE!<br>Done&nbsp;<br><br>Formulas<br>='Sheet 1'!B1*10<br>='Sheet 1'!B1*20<br>Done</p>\r\n<p>If I take out the space, it works fine. Eg: 'Sheet1' works fine but 'Sheet 1' does not. Let me know if you have a work around.</p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2009-10-23T04:04:29.34-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "249166",
    "ThreadId": "72811",
    "Html": "<p>I have tested your script, and you are right that there is such bug in PHPExcel 1.7.0. However, with latest source code the error does not appear.</p>\r\n<p><a href=\"http://phpexcel.codeplex.com/SourceControl/ListDownloadableCommits.aspx\">http://phpexcel.codeplex.com/SourceControl/ListDownloadableCommits.aspx</a></p>\r\n<p>Can you verify that it is working with that source code?</p>",
    "PostedDate": "2009-10-23T15:40:35.467-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]