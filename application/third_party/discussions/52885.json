[
  {
    "Id": "177899",
    "ThreadId": "52885",
    "Html": "Hello! <br>\r\n<br>\r\nIs it possible to add both image and some text to the header?<br>\r\n<br>\r\nI tried the following code<br>\r\n<code><br>\r\n// setting page Header &amp;&amp; Footer<br>\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getHeaderFooter()-&gt;setOddHeader('&amp;CPlease treat this document as confidential!');<br>\r\n// adding LOGO to the header<br>\r\n$objDrawing = new PHPExcel_Worksheet_HeaderFooterDrawing();<br>\r\n$objDrawing-&gt;setName('Logo');<br>\r\n$objDrawing-&gt;setDescription('Logo');<br>\r\n$objDrawing-&gt;setPath('../_img_misc/logo_dark_blue.png');<br>\r\n$objDrawing-&gt;setHeight(30);<br>\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getHeaderFooter()-&gt;addImage($objDrawing, PHPExcel_Worksheet_HeaderFooter::IMAGE_HEADER_CENTER);<br>\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getHeaderFooter()-&gt;setOddHeader('&amp;C&amp;G');<br>\r\n</code>\r\n<br>\r\nbut it seems that these elements (image and text) can exist only separatly.<br>\r\n<br>\r\nin this example text &quot;Please treat this document as confidential!&quot; is lost somewhere.<br>\r\n<br>\r\n<br>\r\n--edited<br>\r\nalthough excel2007 allows to add both images and text to header/footer<br>\r\n<br>\r\n--edited x2<br>\r\nafter some tests I realised, that setOddHeader() method really sets the header, so I have to save previous state before setting new header.<br>\r\n<br>\r\nsomething like that:<br>\r\n<code>\r\n$currentHeader = $objPHPExcel-&gt;getActiveSheet()-&gt;getHeaderFooter()-&gt;getOddHeader();\r\n$objPHPExcel-&gt;getActiveSheet()-&gt;getHeaderFooter()-&gt;setOddHeader($currentHeader.'&amp;C&amp;G');\r\n</code>\r\n<br>\r\n<br>\r\n<br>\r\nI think, the problem is solved, sorry for any inconvenience<br>\r\n<br>\r\nWell, that problem has been solved.<br>\r\n<br>\r\nAnother question is how to put image after the text? like on the next line. in generated file it looks like the text is behind the image. but I want text to be like on the first line and the image like on the second line. <br>\r\nIs it possible?<br>\r\n<br>\r\n<br>\r\nWell, comparing XML returned by script and Excel I found some differences. You can see:<br>\r\ngenerated by script: <span><code>&lt;oddheader&gt;&amp;C&amp;Hsome text! &amp;C&amp;G&lt;/oddheader&gt; </code></span><br>\r\ngenerated by Excel: <span><code>&lt;oddheader&gt;&amp;C&amp;H<span><code>some text</code></span>! &amp;H&amp;G&lt;/oddheader&gt; </code></span> <br>\r\n<br>\r\nI changed that control-symbols and it seems that my another problem is solved. thanks ;)<br>\r\n<br>\r\n",
    "PostedDate": "2009-04-10T03:45:18.273-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "485713",
    "ThreadId": "52885",
    "Html": "<p>i am trying to do like yourself but it does not work. how do you did to work? can you post the code?</p>\r\n<p>regards</p>",
    "PostedDate": "2010-08-27T08:20:28.99-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "485724",
    "ThreadId": "52885",
    "Html": "<p>Dear fudim.</p>\r\n<p>Unfortunately I didn't use PHPExcel for about an year and forgot some things.</p>\r\n<p>About your question. I can post the code. As you see, it already posted above.</p>\r\n<p>About your problem. What have you done and what was the problem?</p>",
    "PostedDate": "2010-08-27T08:51:05.703-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "485729",
    "ThreadId": "52885",
    "Html": "<p>i used the same code as you but the image do not appear.</p>\r\n<p>i tryed to put image in one cell and it works fine, but on header do not appear anything.</p>\r\n<p>i already do not know what else to do..=S</p>\r\n<p>here is my code:</p>\r\n<p>$objPHPExcel-&gt;getActiveSheet()-&gt;getHeaderFooter()-&gt;setOddHeader('&amp;CRelat&oacute;rio HACCP');<br><br>$objDrawing = new PHPExcel_Worksheet_HeaderFooterDrawing();<br>$objDrawing-&gt;setName('Logo');<br>$objDrawing-&gt;setDescription('Logo');<br>$objDrawing-&gt;setPath('assets/images/logo.png');<br>$objDrawing-&gt;setHeight(300);<br>$objPHPExcel-&gt;getActiveSheet()-&gt;getHeaderFooter()-&gt;addImage($objDrawing, PHPExcel_Worksheet_HeaderFooter::IMAGE_HEADER_CENTER);<br><br>$currentHeader = $objPHPExcel-&gt;getActiveSheet()-&gt;getHeaderFooter()-&gt;getOddHeader();<br>$objPHPExcel-&gt;getActiveSheet()-&gt;getHeaderFooter()-&gt;setOddHeader($currentHeader.'&amp;C&amp;G');</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n<p>ps:sorry for my bad english..=)</p>",
    "PostedDate": "2010-08-27T09:05:05.377-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "485748",
    "ThreadId": "52885",
    "Html": "<p>do i need to include any file?</p>",
    "PostedDate": "2010-08-27T10:00:31.42-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1058520",
    "ThreadId": "52885",
    "Html": "<strong>AzriMan wrote:</strong><br />\n<blockquote>\n--edited although excel2007 allows to add both images and text to header/footer<br />\n</blockquote>\nHow can you do that? I use excel2007 and I can't add both +;=<br />\n",
    "PostedDate": "2013-06-19T00:52:12.083-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]