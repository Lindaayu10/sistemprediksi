{
  "WorkItem": {
    "AffectedComponent": {
      "Name": "",
      "DisplayName": ""
    },
    "ClosedComment": "",
    "ClosedDate": null,
    "CommentCount": 0,
    "Custom": null,
    "Description": "Hi All,\n\nWe've been working on a site that reads and parses data out of spreadsheets and this is all working fine. Well it was until we tried reading in a an xls spreadsheet that was created with iOS Numbers on an iPad. Whenever we try to read in the data from a Numbers spreadsheet we get the number of rows to be 0. We just don't seem to be able to get any data out of the spreadsheet even though it opens fine in MS Excel.\n\nHas anyone else had this problem? Anyone got a solution?\n\nThanks,\nSteve.",
    "LastUpdatedDate": "2013-06-26T06:19:58.747-07:00",
    "PlannedForRelease": "",
    "ReleaseVisibleToPublic": false,
    "Priority": {
      "Name": "Unassigned",
      "Severity": 0,
      "Id": 0
    },
    "ProjectName": "PHPExcel",
    "ReportedDate": "2013-06-18T03:09:37.747-07:00",
    "Status": {
      "Name": "Proposed",
      "Id": 1
    },
    "ReasonClosed": {
      "Name": "Unassigned"
    },
    "Summary": "iOS Numbers Spreadsheet Read Data Problem",
    "Type": {
      "Name": "Unassigned",
      "Id": 5
    },
    "VoteCount": 1,
    "Id": 19868
  },
  "FileAttachments": [
    {
      "FileId": 7021,
      "FileName": "ios_numbers_spreadsheet.xls",
      "DownloadUrl": ".\\7021"
    },
    {
      "FileId": 7022,
      "FileName": "ios_numbers_spreadsheet.xls",
      "DownloadUrl": ".\\7022"
    }
  ],
  "Comments": [
    {
      "Message": "Do you have an example xls spreadsheet created by Numbers that I can use to test this?",
      "PostedDate": "2013-06-18T06:05:30.18-07:00",
      "Id": -2147483648
    },
    {
      "Message": "Hi Mark,\r\n\r\nThanks for replying. I'm gonna have to upload an example spreadsheet when I get home from work as I left my iPad there. Will upload a sample spreadsheet generated by numbers around 11pm GMT.\r\n\r\nCheers,\nSteve.",
      "PostedDate": "2013-06-18T06:24:36.257-07:00",
      "Id": -2147483648
    },
    {
      "Message": "",
      "PostedDate": "2013-06-19T09:16:45.663-07:00",
      "Id": -2147483648
    },
    {
      "Message": "Hi All,\r\n\r\nI've now finally been able to get onto an iPad and export out a test spreadsheet so you can try it yourself. I'm using the latest build of phpexcel downloaded from GitHub and here's the code:\r\n\r\n```\nrequire_once 'Classes/PHPExcel/IOFactory.php';\n$objReader = new PHPExcel_Reader_Excel5();\n$objReader->setReadDataOnly(true);\n$objPHPExcel = $objReader->load(\"ios_numbers_spreadsheet.xls\");\r\n\r\n\nfor ($i=1 ; $i<=20 ; $i++) {\n\tforeach(range('A','N') as $a) {\n\t\t$storeArray[$a . $i] = $objPHPExcel->getActiveSheet()->getCell(($a . $i))->getValue();\n\t}\n}\r\n\r\nvar_dump($storeArray);\r\n\r\n```\r\n\r\nand here's a sample of the output I'm getting:\r\n\r\n> array(280) {\n  [\"A1\"]=>\n  NULL\n  [\"B1\"]=>\n  NULL\n  [\"C1\"]=>\n  NULL\n  [\"D1\"]=>\n  NULL\n  [\"E1\"]=>\n  NULL\n  [\"F1\"]=>\n  NULL\n  [\"G1\"]=>\n  NULL\n  [\"H1\"]=>\n  NULL\n",
      "PostedDate": "2013-06-19T09:16:47.037-07:00",
      "Id": -2147483648
    },
    {
      "Message": "",
      "PostedDate": "2013-06-19T09:24:35.13-07:00",
      "Id": -2147483648
    },
    {
      "Message": "Here's the file.",
      "PostedDate": "2013-06-19T09:24:35.71-07:00",
      "Id": -2147483648
    },
    {
      "Message": "PHPExcel does actually populate the worksheets correctly, but isn't recognising the current active sheet in the Numbers file, so it's setting it as the last sheet created (ie the 3rd worksheet in the file rather than the 1st). As a workround, use\n```php\n$objPHPExcel->setActiveSheetIndex(0);\n```\nor\n```php\n$objPHPExcel->setActiveSheetIndexByName('Sheet1 - Table 1');\n```\nto set the active sheet to the 1st sheet before accessing any data from the workbook.\r\n\r\nIn the meanwhile, I'll try to work out how to handle active sheet in a Numbers file (perhaps forcing it to a default of 0 if it isn't explicitly defined)",
      "PostedDate": "2013-06-25T07:32:09.553-07:00",
      "Id": -2147483648
    },
    {
      "Message": "Hi Mark,\r\n\r\nThanks for looking into this and for the workaround too, It totally works and my client will be happy again.\r\n\r\nCheers,\nSteve.",
      "PostedDate": "2013-06-26T06:19:58.747-07:00",
      "Id": -2147483648
    }
  ]
}