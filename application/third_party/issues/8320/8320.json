{
  "WorkItem": {
    "AffectedComponent": {
      "Name": "PHPExcel_Writer_Excel5",
      "DisplayName": "PHPExcel_Writer_Excel5"
    },
    "ClosedComment": "Fixed in SVN",
    "ClosedDate": "2008-11-28T20:27:42.197-08:00",
    "CommentCount": 0,
    "Custom": null,
    "Description": "Reported for this project:\nhttp://www.codeplex.com/PHPExcel/Thread/View.aspx?ThreadId=40495\n \nReported for PEAR Spreadsheet_Excel_Writer\nhttp://pear.php.net/bugs/bug.php?id=4174\n \nThe problem with the OLE writer:\n \nSecID of short-sector allocation table is incorrectly written always as (00 00 00 00) in the compound document header even when there is no short-sector allocation table. In the latter case the correct value to be written is (FE FF FF FF). That happens when the size of the Excel data becomes larger than the minimum size of a standard stream (4096 bytes).\n \nThis is why Outlook messes up sectors after attaching the xls file. Outlook can really not be blamed for not dealing correctly with the invalid OLE file, but it would still have been better if Outlook didn't try to play intelligent and alter the attachments.\n \nDemonstration:\n \nAttaching 2 files:\n \nwrite75.xls\nwrite75-fixed.xls\n \nThe first file was created using PHPExcel_Writer_Excel5. Try to attach in Outlook and send it. The receiver gets a corrupt file.\n \nThe second file is identical, but 4 bytes have now been altered at using a HEX editor.\n \nBytes at offset 64-67 have been changed from 00 00 00 00 to FE FF FF FF\n \nThe result is that the file no longer gets corrupted after sending it with Outlook. This was tested in MS Office Outlook 2007.\n \n------\nThere is a comment at the PEAR site suggesting that PEAR OLE 0.6.1 fixes the problem, but I don't see any bug fix indicating this, so I am a bit skeptical about this (although I haven't tested).\n \nMore investigation needed. Anyone knows more about this?\n \nReference:\nOpenOffice.org's Documentation of the Microsoft Compound Document File Format:\nhttp://sc.openoffice.org/compdocfileformat.pdf",
    "LastUpdatedDate": "2013-05-16T05:43:03.77-07:00",
    "PlannedForRelease": "PHPExcel 1.6.5 Production",
    "ReleaseVisibleToPublic": false,
    "Priority": {
      "Name": "High",
      "Severity": 150,
      "Id": 3
    },
    "ProjectName": "PHPExcel",
    "ReportedDate": "2008-11-27T21:01:32.2-08:00",
    "Status": {
      "Name": "Closed",
      "Id": 4
    },
    "ReasonClosed": {
      "Name": "Unassigned"
    },
    "Summary": "MS Outlook corrupts files generated by PHPExcel_Writer_Excel5",
    "Type": {
      "Name": "Issue",
      "Id": 3
    },
    "VoteCount": 1,
    "Id": 8320
  },
  "FileAttachments": [
    {
      "FileId": 2355,
      "FileName": "write75.xls",
      "DownloadUrl": ".\\2355"
    },
    {
      "FileId": 2356,
      "FileName": "write75-fixed.xls",
      "DownloadUrl": ".\\2356"
    },
    {
      "FileId": 2357,
      "FileName": "write75-after-ole-fix.xls",
      "DownloadUrl": ".\\2357"
    }
  ],
  "Comments": [
    {
      "Message": "Adding second file",
      "PostedDate": "2008-11-27T21:02:01.217-08:00",
      "Id": -2147483648
    },
    {
      "Message": "",
      "PostedDate": "2008-11-27T21:02:01.747-08:00",
      "Id": -2147483648
    },
    {
      "Message": "Any chance we can alter the OLE class? If bytes at offset 64-67 are changed, is the file still valid for Excel?",
      "PostedDate": "2008-11-28T02:22:30.897-08:00",
      "Id": -2147483648
    },
    {
      "Message": "Yes, the Excel file should still be valid for Excel. Actually, more valid, I believe.\r\nUnless you or someone else knows how to do the surgery, I'm planning to study the OLE writer in the near future and see if we can get this fixed.",
      "PostedDate": "2008-11-28T06:23:24.587-08:00",
      "Id": -2147483648
    },
    {
      "Message": "Sounds like you are the right surgeon :-)",
      "PostedDate": "2008-11-28T07:38:12.013-08:00",
      "Id": -2147483648
    },
    {
      "Message": "",
      "PostedDate": "2008-11-28T19:49:17.133-08:00",
      "Id": -2147483648
    },
    {
      "Message": "Sorry, I meant bytes at offset 60-63.",
      "PostedDate": "2008-11-28T20:21:55.913-08:00",
      "Id": -2147483648
    },
    {
      "Message": "",
      "PostedDate": "2008-11-28T20:27:27.883-08:00",
      "Id": -2147483648
    },
    {
      "Message": "",
      "PostedDate": "2008-11-28T20:27:42.197-08:00",
      "Id": -2147483648
    },
    {
      "Message": "Uploading thrird file write75-after-ole-fix.xls which was created the exact same way as write75.xls, but with the modified OLE_Root class.\r\nIt demonstrates the positive effect of the fix. It goes uncorrupted through sending via Outlook as attachment.",
      "PostedDate": "2008-11-28T20:35:31.07-08:00",
      "Id": -2147483648
    },
    {
      "Message": "",
      "PostedDate": "2008-11-28T20:35:33.68-08:00",
      "Id": -2147483648
    },
    {
      "Message": "",
      "PostedDate": "2013-02-21T19:04:33.217-08:00",
      "Id": -2147483648
    },
    {
      "Message": "",
      "PostedDate": "2013-05-16T05:43:03.77-07:00",
      "Id": -2147483648
    }
  ]
}