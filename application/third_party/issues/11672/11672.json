{
  "WorkItem": {
    "AffectedComponent": {
      "Name": "PHPExcel_Writer_Excel5",
      "DisplayName": "PHPExcel_Writer_Excel5"
    },
    "ClosedComment": "",
    "ClosedDate": "2010-05-11T00:59:12.027-07:00",
    "CommentCount": 0,
    "Custom": null,
    "Description": "Have been testing these great libraries to generate a xls file to\nupload here: https//eps.banorte.com\n \nUnfortunately that system can't read any file generated with \nPHPExcel_Writer_Excel5 while it can read the same file \nresaved as Microsoft Excel 97/200/XP (.xls) through openoffice 3.1.1, \nMs Excel 2000, Ms. Excel 2003, gnumeric.\n \nI'm using gentoo-linux and php 5.2.12, and noticed that the file generated\nby PHPExcel is bigger than the file generated by openoffice calc.\n \nmoreover, using the command \"file\" the output for the openoffice generated file is:\ntemp2.xls: CDF V2 Document, Little Endian, Os: Windows, Version 4.10, Code page: 1252\nwhile the output for the PHPExcel generated file is:\ntemp.xls:  CDF V2 Document, corrupt: Cannot read summary info\n \nWhich, AFAIK means that some part of the header is corrupted. I guess that the spreadsheet\nsoftware tools can \"handle\" this corruption but https//eps.banorte.com can't ¿is there any quick\n solution to fix this?",
    "LastUpdatedDate": "2017-11-27T22:26:09.287-08:00",
    "PlannedForRelease": "PHPExcel 1.7.3 Production",
    "ReleaseVisibleToPublic": false,
    "Priority": {
      "Name": "Low",
      "Severity": 50,
      "Id": 1
    },
    "ProjectName": "PHPExcel",
    "ReportedDate": "2010-02-01T10:42:03.487-08:00",
    "Status": {
      "Name": "Closed",
      "Id": 4
    },
    "ReasonClosed": {
      "Name": "Unassigned"
    },
    "Summary": "BIFF8 File Format problem (too short COLINFO record)",
    "Type": {
      "Name": "Issue",
      "Id": 3
    },
    "VoteCount": 1,
    "Id": 11672
  },
  "FileAttachments": [
    {
      "FileId": 3827,
      "FileName": "tempOOffice.xls",
      "DownloadUrl": ".\\3827"
    },
    {
      "FileId": 3831,
      "FileName": "tempOOffice-corrupt-summary.xls",
      "DownloadUrl": ".\\3831"
    },
    {
      "FileId": 3832,
      "FileName": "tempOOffice-repacked.xls",
      "DownloadUrl": ".\\3832"
    },
    {
      "FileId": 3836,
      "FileName": "tempOOffice-phpexcel.xls",
      "DownloadUrl": ".\\3836"
    },
    {
      "FileId": 3860,
      "FileName": "tempOOffice-repacked-2.xls",
      "DownloadUrl": ".\\3860"
    },
    {
      "FileId": 3950,
      "FileName": "tempOOffice-repacked-3.xls",
      "DownloadUrl": ".\\3950"
    },
    {
      "FileId": 3951,
      "FileName": "tempOOffice-phpexcel-2.xls",
      "DownloadUrl": ".\\3951"
    },
    {
      "FileId": 3960,
      "FileName": "tempOOffice-repacked-4.xls",
      "DownloadUrl": ".\\3960"
    },
    {
      "FileId": 3961,
      "FileName": "tempOOffice-repacked-5.xls",
      "DownloadUrl": ".\\3961"
    },
    {
      "FileId": 3968,
      "FileName": "tempOOffice-phpexcel-3.xls",
      "DownloadUrl": ".\\3968"
    },
    {
      "FileId": 3978,
      "FileName": "tempOOffice-phpexcel-4.xls",
      "DownloadUrl": ".\\3978"
    },
    {
      "FileId": 3983,
      "FileName": "wi-11672.patch",
      "DownloadUrl": ".\\3983"
    }
  ],
  "Comments": [
    {
      "Message": "It could be true that the problem is missing summary information.\r\n\r\nExcel5 reader/writer does not read summary information / document properties\r\nhttp://phpexcel.codeplex.com/WorkItem/View.aspx?WorkItemId=9759\r\n\r\nCan you try to upload a valid sample file created in Microsoft Excel (or some other program) which the system does accept?\r\n\r\nI will then try to upload back the same file with a corrupt summary information which you can test with again.",
      "PostedDate": "2010-02-01T21:06:12.167-08:00",
      "Id": -2147483648
    },
    {
      "Message": "Anja Schaffhirt (SednaSoft) explains the SummaryInformation stream\r\n\r\n\"Notes on the SummaryInformation stream\"\r\nhttp://sedna-soft.de/summary-information-stream/\r\n",
      "PostedDate": "2010-02-01T21:08:47.143-08:00",
      "Id": -2147483648
    },
    {
      "Message": "Here it is, generated with OpenOffice 3.1.1 under gentoo-linux.\r\n\r\nThanks a lot! I'll really appreciate any advice or solution. By now \r\nwe were forced to use csv and excel (exporting manually to xls) \r\nas a completely awful workaround :-( ",
      "PostedDate": "2010-02-02T20:23:24.857-08:00",
      "Id": -2147483648
    },
    {
      "Message": "",
      "PostedDate": "2010-02-02T20:23:26.2-08:00",
      "Id": -2147483648
    },
    {
      "Message": "Thanks for the link too. Although I'm not an expert on this summary stream stuff, I'll try to\r\nunderstand it (and your code) better hoping I can help in some way.\r\n\r\nIs there a chance that the tool the system is using could be \"validating\" the summary\r\nstream before even try to read the content of the file?\r\nI'm trying to contact the developers and administrators of the system but, meanwhile, \r\nassuming the answer to the question above is yes, do you think we can find a workaround?\r\n\r\nAgain, thanks a  lot for your time and effort. I hope all this helps to make PHPExcel even better.",
      "PostedDate": "2010-02-02T21:02:24.5-08:00",
      "Id": -2147483648
    },
    {
      "Message": "Please try with uploaded file tempOOffice-corrupt-summary.xls to see if your system accepts it or not.\r\n\r\nI modified your file in a HEX editor to corrupt the SummaryInformation stream.",
      "PostedDate": "2010-02-03T15:38:22.37-08:00",
      "Id": -2147483648
    },
    {
      "Message": "",
      "PostedDate": "2010-02-03T15:38:26.82-08:00",
      "Id": -2147483648
    },
    {
      "Message": "Also try with tempOOffice.xls-repacked.xls\r\n\r\nI repacked your file using the OLE writer bundled with PHPExcel.\r\n\r\nReport back whether your system accepts any of these files:\r\n\r\ntempOOffice-corrupt-summary.xls\r\ntempOOffice-repacked.xls\r\n",
      "PostedDate": "2010-02-03T15:46:30.64-08:00",
      "Id": -2147483648
    },
    {
      "Message": "",
      "PostedDate": "2010-02-03T15:46:35.303-08:00",
      "Id": -2147483648
    },
    {
      "Message": "I tested the files yesterday and surprisingly (hope this is not bad news) \r\nboth worked perfectly although the \"file\" command keeps reporting \r\nCDF V2 Document, corrupt: Cannot read summary info\r\n\r\nSo, the problem is not related to the summary stream :-(\r\nI tested again the file generated by PHPExcel, no luck, \r\nbut now we have an error message:\r\n\"Existio un error al cargar el archivo, por favor verifique la información contenida en el archivo e intente de nuevo. Registro: 1 Columna: 1 Registros Totales: 1\"\r\nWich means something like \"There was a problem uploading the file, please check the information within the file and try again. Record: 1 Column:  1 Total Records: 1\" \r\nApparently the system found something wrong in the first column of the second row (the first row contains the headers). Could it be some kind of \"insignificant\" bit corruption or something alike?\r\n\r\nThanks a lot.\r\n ",
      "PostedDate": "2010-02-04T14:44:02-08:00",
      "Id": -2147483648
    },
    {
      "Message": "Just to be sure, the system will not accept\r\ntempOOffice-phpexcel.xls\r\n\r\nRight?\r\nThe particular file is generated by PHPExcel (plain/read write).",
      "PostedDate": "2010-02-04T15:34:14.827-08:00",
      "Id": -2147483648
    },
    {
      "Message": "",
      "PostedDate": "2010-02-04T15:34:17.727-08:00",
      "Id": -2147483648
    },
    {
      "Message": "In deed, the system rejected it and dumped the same error message.",
      "PostedDate": "2010-02-04T21:00:04.243-08:00",
      "Id": -2147483648
    },
    {
      "Message": "In that case the problem must be somewhere in the Workbook stream.\r\nIs there somehow I can test the system by uploading various files to https://eps.banorte.com ? Or do I need some login?\r\n",
      "PostedDate": "2010-02-09T16:20:56.877-08:00",
      "Id": -2147483648
    },
    {
      "Message": "A login is needed and actually I don't have a personal one, every test was made under the supervision of an account holder :-(\r\nAnyway, this guy is really willing to help, so, no matter it means test hundreds of files, I guess we can take our chances.\r\nI'll try to get some kind of test account or something alike but the feedback from the system developers and administrators is getting really slow and useless :-(",
      "PostedDate": "2010-02-09T18:10:22.05-08:00",
      "Id": -2147483648
    },
    {
      "Message": "Removing following records from tempOOffice-repacked.xls and saving to tempOOffice-repacked-2.xls\r\n\r\nMMS: ADDMENU/DELMENU, INTERFACEEND, DSF, TABID, FNGROUPCOUNT, WINDOWPROTECT, PROTECT, PASSWORD, \r\nPROT4REV, PROT4REVPASS, BACKUP, HIDEOBJ, PRECISION, REFRESHALL, BOOKBOOL, USESELFS\r\n\r\nCan you test with this file and see if system still accepts it:\r\ntempOOffice-repacked-2.xls\r\n",
      "PostedDate": "2010-02-11T18:47:29.37-08:00",
      "Id": -2147483648
    },
    {
      "Message": "",
      "PostedDate": "2010-02-11T18:47:32.563-08:00",
      "Id": -2147483648
    },
    {
      "Message": "I'm truly sorry about the delay. From now on I'll be 24/7 on this till we can get it \r\nto work.\r\n\r\nYep, the system accepted tempOOffice-repacked-2.xls",
      "PostedDate": "2010-02-23T04:01:37.937-08:00",
      "Id": -2147483648
    },
    {
      "Message": "Removing following records from tempOOffice-repacked-2.xls and saving to tempOOffice-repacked-3.xls\r\n\r\nCOUNTRY, MSODRAWINGGROUP, EXTSST, CALCCOUNT, REFMODE, ITERATION, DELTA, MSODRAWING, SAVERECALC\r\n\r\nCan you test with this file and see if system still accepts it:\r\ntempOOffice-repacked-3.xls",
      "PostedDate": "2010-03-09T19:49:28.567-08:00",
      "Id": -2147483648
    },
    {
      "Message": "",
      "PostedDate": "2010-03-09T19:49:30.07-08:00",
      "Id": -2147483648
    },
    {
      "Message": "Yep, the system accepts tempOOffice-repacked-3.xls with no complain at all :-(",
      "PostedDate": "2010-03-09T21:09:12.983-08:00",
      "Id": -2147483648
    },
    {
      "Message": "How about tempOOffice-phpexcel-2.xls ?\r\n[Changed sequence of some records to imitate real Excel files better]\r\n\r\nIs system still rejecting with tempOOffice-phpexcel-2.xls ?",
      "PostedDate": "2010-03-09T21:46:31.483-08:00",
      "Id": -2147483648
    },
    {
      "Message": "",
      "PostedDate": "2010-03-09T21:46:32.353-08:00",
      "Id": -2147483648
    },
    {
      "Message": "No luck with  tempOOffice-phpexcel-2.xls. The system reports: \r\n\"There was a problem uploading the file, please check the information within the file and try again. Record: 1 Column: 1 Total Records: 1\" \r\nagain :-(",
      "PostedDate": "2010-03-10T08:16:51.587-08:00",
      "Id": -2147483648
    },
    {
      "Message": "Can you try with tempOOffice-repacked-4.xls ?\r\n[removed 3 font records]\r\n\r\nIs system still accepting?\r\n",
      "PostedDate": "2010-03-11T14:13:29.263-08:00",
      "Id": -2147483648
    },
    {
      "Message": "",
      "PostedDate": "2010-03-11T14:13:30.083-08:00",
      "Id": -2147483648
    },
    {
      "Message": "Yep, the system still accepts  tempOOffice-repacked-4.xls :-(",
      "PostedDate": "2010-03-11T16:08:46.12-08:00",
      "Id": -2147483648
    },
    {
      "Message": "Can you try with tempOOffice-repacked-5.xls ?\r\n[changed BOF records]\r\n\r\nIs system still accepting?",
      "PostedDate": "2010-03-11T19:20:32.823-08:00",
      "Id": -2147483648
    },
    {
      "Message": "",
      "PostedDate": "2010-03-11T19:20:33.73-08:00",
      "Id": -2147483648
    },
    {
      "Message": "Yep, the system still accepts tempOOffice-repacked-5.xls :-(",
      "PostedDate": "2010-03-12T09:42:39.25-08:00",
      "Id": -2147483648
    },
    {
      "Message": "How about tempOOffice-phpexcel-3.xls ?\r\n[Removed EXTERNALBOOK, EXTERNSHEET, PALETTE records]\r\n\r\nIs system still rejecting with tempOOffice-phpexcel-3.xls ?\r\n",
      "PostedDate": "2010-03-15T16:23:56.093-07:00",
      "Id": -2147483648
    },
    {
      "Message": "",
      "PostedDate": "2010-03-15T16:23:59.367-07:00",
      "Id": -2147483648
    },
    {
      "Message": "Yep tempOOffice-phpexcel-3.xls was rejected, same error message :-(",
      "PostedDate": "2010-03-16T10:38:08.88-07:00",
      "Id": -2147483648
    },
    {
      "Message": "How about tempOOffice-phpexcel-4.xls ?\r\n[Fixed COLINFO records which was 1 byte too short]\r\n\r\nIs system still rejecting with tempOOffice-phpexcel-4.xls ?",
      "PostedDate": "2010-03-16T18:50:59.657-07:00",
      "Id": -2147483648
    },
    {
      "Message": "",
      "PostedDate": "2010-03-16T18:51:00.473-07:00",
      "Id": -2147483648
    },
    {
      "Message": "OMG! \r\nIt works Man!\r\nSystem ACCEPTED  tempOOffice-phpexcel-4.xls with no complain at all!\r\nTime to celebrate? What's next?\r\n",
      "PostedDate": "2010-03-16T20:23:26.363-07:00",
      "Id": -2147483648
    },
    {
      "Message": "Great! Try with latest source code in about 5 hours then.\r\nhttp://phpexcel.codeplex.com/SourceControl/list/changesets\r\n\r\nAlternatively, try to look at attached wi-11672.patch",
      "PostedDate": "2010-03-16T21:16:14.093-07:00",
      "Id": -2147483648
    },
    {
      "Message": "",
      "PostedDate": "2010-03-16T21:16:14.713-07:00",
      "Id": -2147483648
    },
    {
      "Message": "",
      "PostedDate": "2010-03-16T21:18:12.063-07:00",
      "Id": -2147483648
    },
    {
      "Message": "",
      "PostedDate": "2010-05-11T00:59:12.027-07:00",
      "Id": -2147483648
    },
    {
      "Message": "",
      "PostedDate": "2013-02-21T19:03:15.847-08:00",
      "Id": -2147483648
    },
    {
      "Message": "",
      "PostedDate": "2013-05-16T05:42:09.403-07:00",
      "Id": -2147483648
    },
    {
      "Message": "",
      "PostedDate": "2017-11-27T22:26:09.287-08:00",
      "Id": -2147483648
    }
  ]
}