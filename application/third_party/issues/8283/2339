Index: Classes/PHPExcel/Writer/HTML.php
===================================================================
--- Classes/PHPExcel/Writer/HTML.php	(revision 643)
+++ Classes/PHPExcel/Writer/HTML.php	(working copy)
@@ -106,8 +106,7 @@
 		}
 
 		// Write headers
-		fwrite($fileHandle, $this->generateHTMLHeader());
-		fwrite($fileHandle, $this->generateStyles(true));
+		fwrite($fileHandle, $this->generateHTMLHeader(true));
 
 		// Write data
 		fwrite($fileHandle, $this->generateSheetData());
@@ -187,10 +186,11 @@
 	/**
 	 * Generate HTML header
 	 *
+	 * @param	boolean		$pIncludeStyles		Include styles?
 	 * @return	string
 	 * @throws Exception
 	 */
-	public function generateHTMLHeader() {
+	public function generateHTMLHeader($pIncludeStyles = false) {
 		// PHPExcel object known?
 		if (is_null($this->_phpExcel)) {
 			throw new Exception('Internal PHPExcel object not set to an instance of an object.');
@@ -198,11 +198,15 @@
 
 		// Construct HTML
 		$html = '';
+		$html .= '<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">' . "\r\n";
 		$html .= '<!-- Generated by PHPExcel - http://www.phpexcel.net -->' . "\r\n";
 		$html .= '<html>' . "\r\n";
 		$html .= '  <head>' . "\r\n";
 		$html .= '    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">' . "\r\n";
 		$html .= '    <title>' . htmlspecialchars($this->_phpExcel->getProperties()->getTitle()) . '</title>' . "\r\n";
+		if ($pIncludeStyles) {
+			$html .= $this->generateStyles(true);
+		}
 		$html .= '  </head>' . "\r\n";
 		$html .= '' . "\r\n";
 		$html .= '  <body>' . "\r\n";
@@ -342,10 +346,9 @@
 
 		// Start styles
 		if ($generateSurroundingHTML) {
-			$html .= '    <style>' . "\r\n";
-			$html .= '    <!--' . "\r\n";
+			$html .= '    <style type="text/css">' . "\r\n";
 			$html .= '      html {' . "\r\n";
-			$html .= '        font-family: Calibri, Arial, Helvetica, Sans Serif;' . "\r\n";
+			$html .= '        font-family: Calibri, Arial, Helvetica, sans-serif;' . "\r\n";
 			$html .= '        font-size: 10pt;' . "\r\n";
 			$html .= '        background-color: white;' . "\r\n";
 			$html .= '      }' . "\r\n";
@@ -437,7 +440,6 @@
 
 		// End styles
 		if ($generateSurroundingHTML) {
-			$html .= '    -->' . "\r\n";
 			$html .= '    </style>' . "\r\n";
 		}
 
@@ -511,7 +513,7 @@
 		}
 
 		$html .= '        color: ' 				. '#' . $pStyle->getColor()->getRGB() . ';' . "\r\n";
-		$html .= '        font-family: ' 		. $pStyle->getName() . ';' . "\r\n";
+		$html .= '        font-family: ' 		. '\'' . $pStyle->getName() . '\';' . "\r\n";
 		$html .= '        font-size: ' 			. $pStyle->getSize() . 'pt;' . "\r\n";
 
 		// Return
