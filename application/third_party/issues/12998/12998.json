{
  "WorkItem": {
    "AffectedComponent": {
      "Name": "PHPExcel_Reader_Excel2007",
      "DisplayName": "PHPExcel_Reader_Excel2007"
    },
    "ClosedComment": "Fixed in SVN",
    "ClosedDate": "2010-10-12T11:53:58.143-07:00",
    "CommentCount": 0,
    "Custom": null,
    "Description": "When there is no type attribute on gradientFill node then reading XLSX and then saving it will generate corrupt excel file.\nHere is a sample fill(from xl\\styles.xml) generated by Microsoft Excel 2007\n<fill><gradientFill degree=\"90\"><stop position=\"0\"><color theme=\"4\" tint=\"0.40000610370189521\"/></stop><stop position=\"1\"><color theme=\"4\"/></stop></gradientFill></fill>\nBelow is the piece of code from PHPExcel_Reader_Excel2007 that sets type attribute\n \n$gradientFill = $style->fill->gradientFill[0];\n$docStyle->getFill()->setFillType((string) $gradientFill[\"type\"]);\n$docStyle->getFill()->setRotation(floatval($gradientFill[\"degree\"]));\n \nThere should be a check before setting it or $docStyle->getFill()->setFillType() should handle empty case:\n \nif( !empty($gradientFill[\"type\"]) ){\n    $docStyle->getFill()->setFillType((string) $gradientFill[\"type\"]);\n}",
    "LastUpdatedDate": "2013-05-16T05:42:00.36-07:00",
    "PlannedForRelease": "PHPExcel 1.7.5 Production",
    "ReleaseVisibleToPublic": false,
    "Priority": {
      "Name": "Low",
      "Severity": 50,
      "Id": 1
    },
    "ProjectName": "PHPExcel",
    "ReportedDate": "2010-05-11T12:49:15.53-07:00",
    "Status": {
      "Name": "Closed",
      "Id": 4
    },
    "ReasonClosed": {
      "Name": "Unassigned"
    },
    "Summary": "PHPExcel_Reader_Excel2007 fails when gradient fill without type is present in a file(with patch)",
    "Type": {
      "Name": "Issue",
      "Id": 3
    },
    "VoteCount": 1,
    "Id": 12998
  },
  "FileAttachments": [
    {
      "FileId": 4813,
      "FileName": "PHPExcel_gradient_12998.patch",
      "DownloadUrl": ".\\4813"
    }
  ],
  "Comments": [
    {
      "Message": "adding patch against 1.7.4",
      "PostedDate": "2010-09-02T08:36:57.983-07:00",
      "Id": -2147483648
    },
    {
      "Message": "",
      "PostedDate": "2010-09-02T08:37:19.41-07:00",
      "Id": -2147483648
    },
    {
      "Message": "Thanks for bringing this to our attention, and for providing a fix",
      "PostedDate": "2010-09-03T03:38:29.34-07:00",
      "Id": -2147483648
    },
    {
      "Message": "",
      "PostedDate": "2010-09-03T03:39:28.683-07:00",
      "Id": -2147483648
    },
    {
      "Message": "",
      "PostedDate": "2010-10-12T11:53:58.143-07:00",
      "Id": -2147483648
    },
    {
      "Message": "",
      "PostedDate": "2013-02-21T19:02:59.63-08:00",
      "Id": -2147483648
    },
    {
      "Message": "",
      "PostedDate": "2013-05-16T05:42:00.36-07:00",
      "Id": -2147483648
    }
  ]
}