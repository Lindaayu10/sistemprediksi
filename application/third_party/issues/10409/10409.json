{
  "WorkItem": {
    "AffectedComponent": {
      "Name": "All",
      "DisplayName": "All"
    },
    "ClosedComment": "",
    "ClosedDate": null,
    "CommentCount": 0,
    "Custom": null,
    "Description": "1. Problem with Excel5 reader:\n----\nWhen a (binary) xls file created in MS Office Excel 2007 is read with Excel5 reader, colors may be a bit off.\n \n2. Problem with Excel5 writer:\n----\nWith xls files generated by Excel5 writer one observes that colors change after doing copy/paste of some text from the generated Excel file to another workbook.\n \nProblem:\n----\nThe first problem is directly related to Excel5 reader's lacking support for the XFEXT records (Extended Format Extension). Note that Microsoft Office 2003 and OpenOffice 3.1.0 don't support these Excel 2007 specific records either, therefore also in these programs, xls files created in MS Office Excel 2007 will also open with colors that are slightly off.\n \nNote how colors are slightly off after a plain read/write:\nhttp://img188.imageshack.us/img188/8061/ss20090807002711.png\nhttp://img294.imageshack.us/img294/3107/ss20090807001142.png\n \n \nThe second problem has to do with Excel5 writer (PEAR:Spreadsheet_Excel_Writer) altering the default BIFF8 colors in the PALETTE record. Using the default paste option \"Match destination formatting\" colors in pasted elements will in general change.\n \nBoth of these problems can be avoided if Excel5 reader/writer starts to support XFEXT records. Excel5 writer should stop altering the BIFF8 default color PALETTE.\n \nNote how text color becomes red instead of green in document where we paste the text \"hello\"\nhttp://img196.imageshack.us/img196/2272/ss20090807001540.png\nhttp://img36.imageshack.us/img36/4678/ss20090807001803.png\n \n(That is with the default paste option \"Match destination formatting\".)\n \nRelated threads/issues:\nhttp://phpexcel.codeplex.com/Thread/View.aspx?ThreadId=60285\nhttp://phpexcel.codeplex.com/WorkItem/View.aspx?WorkItemId=10181",
    "LastUpdatedDate": "2017-11-27T22:26:08.18-08:00",
    "PlannedForRelease": "",
    "ReleaseVisibleToPublic": false,
    "Priority": {
      "Name": "Low",
      "Severity": 50,
      "Id": 1
    },
    "ProjectName": "PHPExcel",
    "ReportedDate": "2009-08-06T15:25:47.867-07:00",
    "Status": {
      "Name": "Proposed",
      "Id": 1
    },
    "ReasonClosed": {
      "Name": "Unassigned"
    },
    "Summary": "XFEXT record support to fix colors change from Excel5 reader, and copy/paste color change with Excel5 writer",
    "Type": {
      "Name": "Feature",
      "Id": 1
    },
    "VoteCount": 5,
    "Id": 10409
  },
  "FileAttachments": [
    {
      "FileId": 3239,
      "FileName": "problem-1.xls",
      "DownloadUrl": ".\\3239"
    },
    {
      "FileId": 3240,
      "FileName": "problem-2.xls",
      "DownloadUrl": ".\\3240"
    },
    {
      "FileId": 3496,
      "FileName": "read.xls",
      "DownloadUrl": ".\\3496"
    },
    {
      "FileId": 4566,
      "FileName": "cp.png",
      "DownloadUrl": ".\\4566"
    }
  ],
  "Comments": [
    {
      "Message": "Changelog:\r\n- Excel5 reader reads RGB color information in XFEXT records for borders, font color and fill color\r\n\r\nThis means that RGB colors are now read accurately in xls files saved from MS Office Excel 2007.\r\n\r\nTest xls file created in MS Office Excel 2007 (read.xls)\r\nhttp://img41.imageshack.us/img41/9083/ss20091106041918.png\r\n\r\nPlain read/write xls->xlsx using PHPExcel: (notice how colors are a bit off)\r\nhttp://img41.imageshack.us/img41/6871/ss20091106042029.png\r\n\r\nAfter the change, plain read/write now gives correct result:\r\nhttp://img41.imageshack.us/img41/7743/ss20091106042105.png\r\n",
      "PostedDate": "2009-11-05T19:40:25.58-08:00",
      "Id": -2147483648
    },
    {
      "Message": "",
      "PostedDate": "2009-11-05T19:40:26.993-08:00",
      "Id": -2147483648
    },
    {
      "Message": "",
      "PostedDate": "2010-06-14T06:05:23.02-07:00",
      "Id": -2147483648
    },
    {
      "Message": "I am using the official 1.7.3c release and still experience the 2nd problem. The code I'm using to create the excel5 file is:\r\n\r\n$workbook = new PHPExcel;\r\n$sheet = $workbook->getActiveSheet();\r\n$sheet->setCellValue(\"A1\", \"Hello\");\r\n$sheet->getStyle('A1')->applyFromArray(array('fill' => array('type' => PHPExcel_Style_Fill::FILL_SOLID, 'color' => array('rgb' => '00ff00'))));\r\n$sheet->setCellValue(\"A2\", \"Bye\");\r\n$sheet->getStyle('A2')->applyFromArray(array('fill' => array('type' => PHPExcel_Style_Fill::FILL_SOLID, 'color' => array('rgb' => '0000ff'))));\r\n$writer = PHPExcel_IOFactory::createWriter($workbook, 'Excel5');\r\nheader('Content-type: application/vnd.ms-excel');\r\nheader('Content-Disposition:inline;filename=mytest.xls');\r\nheader('Cache-Control: max-age=0');\r\n$writer->save('php://output');\r\n\r\nWhen I copy the green cell, I end up with a red cell, etc. See attached screenshot for the result.\r\n\r\nBTW, for release 1.7.3c, I had to apply the following patch:\r\n--- PHPExcel.php\t(revision 567)\r\n+++ PHPExcel.php\t(working copy)\r\n@@ -434,7 +434,7 @@\r\n \r\n \t\t// update the cellXfs\r\n \t\tforeach ($pSheet->getCellCollection(false) as $cellID) {\r\n-\t\t\t$cell = $sheet->getCell($cellID);\r\n+\t\t\t$cell = $pSheet->getCell($cellID);\r\n \t\t\t$cell->setXfIndex( $cell->getXfIndex() + $countCellXfs );\r\n \t\t}\r\n",
      "PostedDate": "2010-06-14T06:05:23.743-07:00",
      "Id": -2147483648
    },
    {
      "Message": "",
      "PostedDate": "2010-07-27T00:20:19.17-07:00",
      "Id": -2147483648
    },
    {
      "Message": "I experienced the same problem like DavidDecotigny mentioned before. \r\nThe Excel color palette seems to be modified in the resulting document and\r\nif you try copy/paste from one to another (new) worksheet you end up getting\r\ne.g. different background-colors than intended (eg. green turns into red).\r\nIs there any solution yet?  \r\n  ",
      "PostedDate": "2010-07-27T00:33:31.913-07:00",
      "Id": -2147483648
    },
    {
      "Message": "",
      "PostedDate": "2010-08-02T07:34:58.803-07:00",
      "Id": -2147483648
    },
    {
      "Message": "",
      "PostedDate": "2011-03-05T04:05:33.32-08:00",
      "Id": -2147483648
    },
    {
      "Message": "",
      "PostedDate": "2013-02-21T19:03:47.927-08:00",
      "Id": -2147483648
    },
    {
      "Message": "",
      "PostedDate": "2017-11-27T22:26:08.18-08:00",
      "Id": -2147483648
    }
  ]
}